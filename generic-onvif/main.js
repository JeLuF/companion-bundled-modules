/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={7169:(e,t,n)=>{"use strict";const i=n(2017);i.code='require("ajv/dist/runtime/equal").default',t.A=i},2719:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__},2581:(e,t,n)=>{"use strict";n.d(t,{l:()=>s});var i=n(6641),o=n(8325),r=n(258);function s(){(0,o.U)(),(0,r.wD)()&&function(){const t=(0,i.EU)();if(!t.__SENTRY__)return;const n={mongodb:()=>new((0,r.fj)(e,"./node/integrations/mongo").Mongo),mongoose:()=>new((0,r.fj)(e,"./node/integrations/mongo").Mongo),mysql:()=>new((0,r.fj)(e,"./node/integrations/mysql").Mysql),pg:()=>new((0,r.fj)(e,"./node/integrations/postgres").Postgres)},o=Object.keys(n).filter((e=>!!(0,r.Vw)(e))).map((e=>{try{return n[e]()}catch(e){return}})).filter((e=>e));o.length>0&&(t.__SENTRY__.integrations=[...t.__SENTRY__.integrations||[],...o])}()}e=n.hmd(e)},2543:(e,t,n)=>{"use strict";n.d(t,{I:()=>d});var i=n(853),o=n(258),r=n(7412),s=n(8411),a=n(6936),c=n(3816),l=n(2719),u=n(6354);class d{static __initStatic(){this.id="Apollo"}constructor(e={useNestjs:!1}){this.name=d.id,this._useNest=!!e.useNestjs}loadDependency(){return this._useNest?this._module=this._module||(0,o.Vw)("@nestjs/graphql"):this._module=this._module||(0,o.Vw)("apollo-server-core"),this._module}setupOnce(e,t){if((0,u.H)(t))l.T&&r.vF.log("Apollo Integration is skipped because of instrumenter configuration.");else if(this._useNest){const e=this.loadDependency();if(!e)return void(l.T&&r.vF.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package."));(0,s.GS)(e.GraphQLFactory.prototype,"mergeWithSchema",(function(e){return function(...n){return(0,s.GS)(this.resolversExplorerService,"explore",(function(e){return function(){return g((0,a.k9)(e.call(this)),t)}})),e.call(this,...n)}}))}else{const e=this.loadDependency();if(!e)return void(l.T&&r.vF.error("Apollo Integration was unable to require apollo-server-core package."));(0,s.GS)(e.ApolloServerBase.prototype,"constructSchema",(function(e){return function(){if(!this.config.resolvers)return l.T&&(this.config.schema?(r.vF.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),r.vF.warn()):this.config.modules&&r.vF.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),r.vF.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),e.call(this);const n=(0,a.k9)(this.config.resolvers);return this.config.resolvers=g(n,t),e.call(this)}}))}}}function g(e,t){return e.map((e=>(Object.keys(e).forEach((n=>{Object.keys(e[n]).forEach((o=>{"function"==typeof e[n][o]&&function(e,t,n,o){(0,s.GS)(e[t],n,(function(e){return function(...r){const s=o().getScope().getSpan(),a=(0,i.z)([s,"optionalAccess",e=>e.startChild,"call",e=>e({description:`${t}.${n}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),l=e.call(this,...r);return(0,c.Qg)(l)?l.then((e=>((0,i.z)([a,"optionalAccess",e=>e.end,"call",e=>e()]),e))):((0,i.z)([a,"optionalAccess",e=>e.end,"call",e=>e()]),l)}}))}(e,n,o,t)}))})),e)))}d.__initStatic()},5838:(e,t,n)=>{"use strict";n.d(t,{JF:()=>p});var i=n(853),o=n(3445),r=n(1869),s=n(7412),a=n(2879),c=n(1040),l=n(3816),u=n(6341),d=n(2719),g=n(6354);class p{static __initStatic(){this.id="Express"}constructor(e={}){this.name=p.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}setupOnce(e,t){this._router?(0,g.H)(t)?d.T&&s.vF.log("Express Integration is skipped because of instrumenter configuration."):(function(e,t=[]){t.forEach((t=>function(e,t){const n=e[t];return e[t]=function(...e){return n.call(this,...function(e,t){return e.map((e=>"function"==typeof e?h(e,t):Array.isArray(e)?e.map((e=>"function"==typeof e?h(e,t):e)):e))}(e,t))},e}(e,t)))}(this._router,this._methods),function(e){const t="settings"in e;t&&void 0===e._router&&e.lazyrouter&&e.lazyrouter();const n=t?e._router:e;if(!n)return d.T&&s.vF.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),void(d.T&&s.vF.debug("Routing instrumentation is currently only supported in Express 4."));const g=Object.getPrototypeOf(n),p=g.process_params;g.process_params=function(e,t,n,s,d){n._reconstructedRoute||(n._reconstructedRoute="");const{layerRoutePath:g,isRegex:h,isArray:I,numExtraSegments:b}=function(e){let t=(0,i.z)([e,"access",e=>e.route,"optionalAccess",e=>e.path]);const n=(0,l.gd)(t),o=Array.isArray(t);if(!t){const[n]=u.OW.process.versions.node.split(".").map(Number);n>=16&&(t=m(e.path,e.regexp,e.keys))}if(!t)return{isRegex:n,isArray:o,numExtraSegments:0};const r=o?Math.max(t.reduce(((e,t)=>e+(0,a.c4)(t.toString())),0)-(0,a.c4)(e.path||""),0):0,s=function(e,t){return e?t.map((e=>e.toString())).join(","):t&&t.toString()}(o,t);return{layerRoutePath:s,isRegex:n,isArray:o,numExtraSegments:r}}(e);let f;(g||h||I)&&(n._hasParameters=!0),f=g||function(e,t,n){const o=(0,a.f)(e||""),r=(0,i.z)([o,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e))]);let s=0;const c=(0,i.z)([t,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>!!e)),"access",e=>e.length])||0;return(0,i.z)([n,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e((e=>(0,i.z)([r,"optionalAccess",e=>e[c+s]])===e&&(s+=1,!0))),"access",e=>e.join,"call",e=>e("/")])}(n.originalUrl,n._reconstructedRoute,e.path)||"";const y=f.split("/").filter((e=>e.length>0&&(h||I||!e.includes("*")))).join("/");if(y&&y.length>0&&(n._reconstructedRoute+=`/${y}${h?"/":""}`),(0,a.c4)((0,a.f)(n.originalUrl||""))+b===(0,a.c4)(n._reconstructedRoute)){n._hasParameters||n._reconstructedRoute!==n.originalUrl&&(n._reconstructedRoute=n.originalUrl?(0,a.f)(n.originalUrl):n.originalUrl);const e=s.__sentry_transaction,t=e&&(0,o.et)(e).data||{};if(e&&"custom"!==t[r.i_]){const t=n._reconstructedRoute||"/",[i,o]=(0,c.Up)(n,{path:!0,method:!0,customRoute:t});e.updateName(i),e.setAttribute(r.i_,o)}}return p.call(this,e,t,n,s,d)}}(this._router)):d.T&&s.vF.error("ExpressIntegration is missing an Express instance")}}function h(e,t){const n=e.length;switch(n){case 2:return function(n,i){const o=i.__sentry_transaction;if(o){const n=o.startChild({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"});i.once("finish",(()=>{n.end()}))}return e.call(this,n,i)};case 3:return function(n,o,r){const s=o.__sentry_transaction,a=(0,i.z)([s,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,o,(function(...e){(0,i.z)([a,"optionalAccess",e=>e.end,"call",e=>e()]),r.call(this,...e)}))};case 4:return function(n,o,r,s){const a=r.__sentry_transaction,c=(0,i.z)([a,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,o,r,(function(...e){(0,i.z)([c,"optionalAccess",e=>e.end,"call",e=>e()]),s.call(this,...e)}))};default:throw new Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}p.__initStatic();const m=(e,t,n)=>{if(!(e&&t&&n&&0!==Object.keys(n).length&&(0,i.z)([n,"access",e=>e[0],"optionalAccess",e=>e.offset])))return;const o=n.sort(((e,t)=>e.offset-t.offset)),r=new RegExp(t,`${t.flags}d`).exec(e);if(!r||!r.indices)return;const[,...s]=r.indices;if(s.length!==o.length)return;let a=e,c=0;return s.forEach(((e,t)=>{if(e){const[n,i]=e,r=a.substring(0,n-c),s=`:${o[t].name}`,l=a.substring(i-c);a=r+s+l,c+=i-n-s.length}})),a}},875:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var i=n(853),o=n(258),r=n(7412),s=n(8411),a=n(3816),c=n(2719),l=n(6354);class u{static __initStatic(){this.id="GraphQL"}constructor(){this.name=u.id}loadDependency(){return this._module=this._module||(0,o.Vw)("graphql/execution/execute.js")}setupOnce(e,t){if((0,l.H)(t))return void(c.T&&r.vF.log("GraphQL Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();n?(0,s.GS)(n,"execute",(function(e){return function(...n){const o=t().getScope(),r=o.getSpan(),s=(0,i.z)([r,"optionalAccess",e=>e.startChild,"call",e=>e({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);(0,i.z)([o,"optionalAccess",e=>e.setSpan,"call",e=>e(s)]);const c=e.call(this,...n);return(0,a.Qg)(c)?c.then((e=>((0,i.z)([s,"optionalAccess",e=>e.end,"call",e=>e()]),(0,i.z)([o,"optionalAccess",e=>e.setSpan,"call",e=>e(r)]),e))):((0,i.z)([s,"optionalAccess",e=>e.end,"call",e=>e()]),(0,i.z)([o,"optionalAccess",e=>e.setSpan,"call",e=>e(r)]),c)}})):c.T&&r.vF.error("GraphQL Integration was unable to require graphql/execution package.")}}u.__initStatic()},8402:(e,t,n)=>{"use strict";n.d(t,{j:()=>o});var i=n(258);e=n.hmd(e);const o=[()=>new((0,i.fj)(e,"./apollo").Apollo),()=>new((0,i.fj)(e,"./apollo").Apollo)({useNestjs:!0}),()=>new((0,i.fj)(e,"./graphql").GraphQL),()=>new((0,i.fj)(e,"./mongo").Mongo),()=>new((0,i.fj)(e,"./mongo").Mongo)({mongoose:!0}),()=>new((0,i.fj)(e,"./mysql").Mysql),()=>new((0,i.fj)(e,"./postgres").Postgres)]},3114:(e,t,n)=>{"use strict";n.d(t,{N:()=>g});var i=n(853),o=n(258),r=n(7412),s=n(8411),a=n(3816),c=n(2719),l=n(6354);const u=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],d={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};class g{static __initStatic(){this.id="Mongo"}constructor(e={}){this.name=g.id,this._operations=Array.isArray(e.operations)?e.operations:u,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}loadDependency(){const e=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||(0,o.Vw)(e)}setupOnce(e,t){if((0,l.H)(t))return void(c.T&&r.vF.log("Mongo Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(n)this._instrumentOperations(n.Collection,this._operations,t);else{const e=this._useMongoose?"mongoose":"mongodb";c.T&&r.vF.error(`Mongo Integration was unable to require \`${e}\` package.`)}}_instrumentOperations(e,t,n){t.forEach((t=>this._patchOperation(e,t,n)))}_patchOperation(e,t,n){if(!(t in e.prototype))return;const o=this._getSpanContextFromOperationArguments.bind(this);(0,s.GS)(e.prototype,t,(function(e){return function(...r){const s=r[r.length-1],c=n(),l=c.getScope(),u=c.getClient(),d=l.getSpan(),g=(0,i.z)([u,"optionalAccess",e=>e.getOptions,"call",e=>e(),"access",e=>e.sendDefaultPii]);if("function"!=typeof s||"mapReduce"===t&&2===r.length){const n=(0,i.z)([d,"optionalAccess",e=>e.startChild,"call",e=>e(o(this,t,r,g))]),s=e.call(this,...r);if((0,a.Qg)(s))return s.then((e=>((0,i.z)([n,"optionalAccess",e=>e.end,"call",e=>e()]),e)));if((p=s)&&"object"==typeof p&&p.once&&"function"==typeof p.once){const e=s;try{e.once("close",(()=>{(0,i.z)([n,"optionalAccess",e=>e.end,"call",e=>e()])}))}catch(e){(0,i.z)([n,"optionalAccess",e=>e.end,"call",e=>e()])}return e}return(0,i.z)([n,"optionalAccess",e=>e.end,"call",e=>e()]),s}var p;const h=(0,i.z)([d,"optionalAccess",e=>e.startChild,"call",e=>e(o(this,t,r.slice(0,-1)))]);return e.call(this,...r.slice(0,-1),(function(e,t){(0,i.z)([h,"optionalAccess",e=>e.end,"call",e=>e()]),s(e,t)}))}}))}_getSpanContextFromOperationArguments(e,t,n,i=!1){const o={"db.system":"mongodb","db.name":e.dbName,"db.operation":t,"db.mongodb.collection":e.collectionName},r={op:"db",origin:"auto.db.mongo",description:t,data:o},s=d[t],a=Array.isArray(this._describeOperations)?this._describeOperations.includes(t):this._describeOperations;if(!s||!a||!i)return r;try{if("mapReduce"===t){const[e,t]=n;o[s[0]]="string"==typeof e?e:e.name||"<anonymous>",o[s[1]]="string"==typeof t?t:t.name||"<anonymous>"}else for(let e=0;e<s.length;e++)o[`db.mongodb.${s[e]}`]=JSON.stringify(n[e])}catch(e){}return r}}g.__initStatic()},9336:(e,t,n)=>{"use strict";n.d(t,{d:()=>l});var i=n(853),o=n(258),r=n(7412),s=n(8411),a=n(2719),c=n(6354);class l{static __initStatic(){this.id="Mysql"}constructor(){this.name=l.id}loadDependency(){return this._module=this._module||(0,o.Vw)("mysql/lib/Connection.js")}setupOnce(e,t){if((0,c.H)(t))return void(a.T&&r.vF.log("Mysql Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(a.T&&r.vF.error("Mysql Integration was unable to require `mysql` package."));let o;try{n.prototype.connect=new Proxy(n.prototype.connect,{apply:(e,t,n)=>(o||(o=t.config),e.apply(t,n))})}catch(e){a.T&&r.vF.error("Mysql Integration was unable to instrument `mysql` config.")}function l(e){if(!e)return;const t=o?{"server.address":o.host,"server.port":o.port,"db.user":o.user}:{};Object.keys(t).forEach((n=>{e.setAttribute(n,t[n])})),e.end()}(0,s.GS)(n,"createQuery",(function(e){return function(n,o,r){const s=t().getScope().getSpan(),a=(0,i.z)([s,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if("function"==typeof r)return e.call(this,n,o,(function(e,t,n){l(a),r(e,t,n)}));if("function"==typeof o)return e.call(this,n,(function(e,t,n){l(a),o(e,t,n)}));const c=e.call(this,n,o);return c.on("end",(()=>{l(a)})),c}}))}}l.__initStatic()},5455:(e,t,n)=>{"use strict";n.d(t,{E:()=>u});var i=n(853),o=n(258),r=n(7412),s=n(8411),a=n(3816),c=n(2719),l=n(6354);class u{static __initStatic(){this.id="Postgres"}constructor(e={}){this.name=u.id,this._usePgNative=!!e.usePgNative,this._module=e.module}loadDependency(){return this._module=this._module||(0,o.Vw)("pg")}setupOnce(e,t){if((0,l.H)(t))return void(c.T&&r.vF.log("Postgres Integration is skipped because of instrumenter configuration."));const n=this.loadDependency();if(!n)return void(c.T&&r.vF.error("Postgres Integration was unable to require `pg` package."));const o=this._usePgNative?(0,i.z)([n,"access",e=>e.native,"optionalAccess",e=>e.Client]):n.Client;o?(0,s.GS)(o.prototype,"query",(function(e){return function(n,o,r){const s=t().getScope().getSpan(),c={"db.system":"postgresql"};try{this.database&&(c["db.name"]=this.database),this.host&&(c["server.address"]=this.host),this.port&&(c["server.port"]=this.port),this.user&&(c["db.user"]=this.user)}catch(e){}const l=(0,i.z)([s,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.text,op:"db",origin:"auto.db.postgres",data:c})]);if("function"==typeof r)return e.call(this,n,o,(function(e,t){(0,i.z)([l,"optionalAccess",e=>e.end,"call",e=>e()]),r(e,t)}));if("function"==typeof o)return e.call(this,n,(function(e,t){(0,i.z)([l,"optionalAccess",e=>e.end,"call",e=>e()]),o(e,t)}));const u=void 0!==o?e.call(this,n,o):e.call(this,n);return(0,a.Qg)(u)?u.then((e=>((0,i.z)([l,"optionalAccess",e=>e.end,"call",e=>e()]),e))):((0,i.z)([l,"optionalAccess",e=>e.end,"call",e=>e()]),u)}})):c.T&&r.vF.error("Postgres Integration was unable to access 'pg-native' bindings.")}}u.__initStatic()},9932:(e,t,n)=>{"use strict";n.d(t,{D:()=>u});var i=n(6641),o=n(3095),r=n(1869),s=n(8411),a=n(7412),c=n(2719),l=n(6354);class u{static __initStatic(){this.id="Prisma"}constructor(e={}){if(this.name=u.id,(t=e.client)&&t.$use&&!e.client._sentryInstrumented){(0,s.my)(e.client,"_sentryInstrumented",!0);const t={};try{const n=e.client._engineConfig;if(n){const{activeProvider:e,clientVersion:i}=n;e&&(t["db.system"]=e),i&&(t["db.prisma.version"]=i)}}catch(e){}e.client.$use(((e,n)=>{if((0,l.H)(i.BF))return n(e);const s=e.action,a=e.model;return(0,o.Lk)({name:a?`${a} ${s}`:s,onlyIfParent:!0,op:"db.prisma",attributes:{[r.JD]:"auto.db.prisma"},data:{...t,"db.operation":s}},(()=>n(e)))}))}else c.T&&a.vF.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",e.client);var t}setupOnce(){}}u.__initStatic()},6354:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var i=n(853);function o(e){const t=(0,i.z)([e,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]);return"sentry"!==((0,i.z)([t,"optionalAccess",e=>e.instrumenter])||"sentry")}},2967:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});const i="production"},2220:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__},2531:(e,t,n)=>{"use strict";n.d(t,{jB:()=>u,lG:()=>c,lb:()=>l});var i=n(6341),o=n(690),r=n(7412),s=n(3816),a=n(2220);function c(){return(0,i.BY)("globalEventProcessors",(()=>[]))}function l(e){c().push(e)}function u(e,t,n,i=0){return new o.T2(((o,c)=>{const l=e[i];if(null===t||"function"!=typeof l)o(t);else{const d=l({...t},n);a.T&&l.id&&null===d&&r.vF.log(`Event processor "${l.id}" dropped event`),(0,s.Qg)(d)?d.then((t=>u(e,t,n,i+1).then(o))).then(null,c):u(e,d,n,i+1).then(o).then(null,c)}}))}},3741:(e,t,n)=>{"use strict";n.d(t,{Cp:()=>p,Dp:()=>H,J0:()=>Y,J5:()=>x,KU:()=>_,NA:()=>A,PN:()=>I,Q:()=>N,SE:()=>V,T$:()=>W,VN:()=>T,Wt:()=>v,ZQ:()=>b,bX:()=>R,cx:()=>y,gV:()=>Z,hb:()=>w,ky:()=>X,l7:()=>C,nb:()=>S,o:()=>f,o5:()=>k,r:()=>m,rB:()=>B,v4:()=>G,wd:()=>h});var i=n(7412),o=n(6936),r=n(9297),s=n(3816),a=n(6341),c=n(2967),l=n(2220),u=n(6641),d=n(7058),g=n(9475);function p(e,t){return(0,u.BF)().captureException(e,(0,g.li)(t))}function h(e,t){const n="string"==typeof t?t:void 0,i="string"!=typeof t?{captureContext:t}:void 0;return(0,u.BF)().captureMessage(e,n,i)}function m(e,t){return(0,u.BF)().captureEvent(e,t)}function I(e){(0,u.BF)().configureScope(e)}function b(e,t){(0,u.BF)().addBreadcrumb(e,t)}function f(e,t){(0,u.BF)().setContext(e,t)}function y(e){(0,u.BF)().setExtras(e)}function C(e,t){(0,u.BF)().setExtra(e,t)}function v(e){(0,u.BF)().setTags(e)}function A(e,t){(0,u.BF)().setTag(e,t)}function Z(e){(0,u.BF)().setUser(e)}function G(...e){const t=(0,u.BF)();if(2===e.length){const[n,i]=e;return n?t.withScope((()=>(t.getStackTop().scope=n,i(n)))):t.withScope(i)}return t.withScope(e[0])}function B(e){return(0,u.fx)((()=>e((0,u.rm)())))}function w(e,t){return G((n=>(n.setSpan(e),t(n))))}function S(e,t){return(0,u.BF)().startTransaction({...e},t)}function V(e,t){const n=k(),r=_();if(r){if(r.captureCheckIn)return r.captureCheckIn(e,t,n);l.T&&i.vF.warn("Cannot capture check-in. Client does not support sending check-ins.")}else l.T&&i.vF.warn("Cannot capture check-in. No client defined.");return(0,o.eJ)()}function W(e,t,n){const i=V({monitorSlug:e,status:"in_progress"},n),o=(0,r.zf)();function a(t){V({monitorSlug:e,status:t,checkInId:i,duration:(0,r.zf)()-o})}let c;try{c=t()}catch(e){throw a("error"),e}return(0,s.Qg)(c)?Promise.resolve(c).then((()=>{a("ok")}),(()=>{a("error")})):a("ok"),c}async function R(e){const t=_();return t?t.flush(e):(l.T&&i.vF.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function T(e){const t=_();return t?t.close(e):(l.T&&i.vF.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function N(){return(0,u.BF)().lastEventId()}function _(){return(0,u.BF)().getClient()}function H(){return!!_()}function k(){return(0,u.BF)().getScope()}function Y(e){const t=_(),n=(0,u.rm)(),i=k(),{release:o,environment:r=c.U}=t&&t.getOptions()||{},{userAgent:s}=a.OW.navigator||{},l=(0,d.fj)({release:o,environment:r,user:i.getUser()||n.getUser(),...s&&{userAgent:s},...e}),g=n.getSession();return g&&"ok"===g.status&&(0,d.qO)(g,{status:"exited"}),X(),n.setSession(l),i.setSession(l),l}function X(){const e=(0,u.rm)(),t=k(),n=t.getSession()||e.getSession();n&&(0,d.Vu)(n),F(),e.setSession(),t.setSession()}function F(){const e=(0,u.rm)(),t=k(),n=_(),i=t.getSession()||e.getSession();i&&n&&n.captureSession&&n.captureSession(i)}function x(e=!1){e?X():F()}},6641:(e,t,n)=>{"use strict";n.d(t,{BF:()=>f,EU:()=>I,Me:()=>B,TF:()=>v,YZ:()=>m,fx:()=>Z,gM:()=>b,lq:()=>w,nX:()=>A,rm:()=>y});var i=n(3816),o=n(6936),r=n(9297),s=n(7412),a=n(6341),c=n(2967),l=n(2220),u=n(2486),d=n(7058),g=n(7986);const p=parseFloat(g.M),h=100;class m{constructor(e,t,n,i=p){let o,r;this._version=i,t?o=t:(o=new u.HG,o.setClient(e)),n?r=n:(r=new u.HG,r.setClient(e)),this._stack=[{scope:o}],e&&this.bindClient(e),this._isolationScope=r}isOlderThan(e){return this._version<e}bindClient(e){const t=this.getStackTop();t.client=e,t.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1||!this.getStack().pop())}withScope(e){const t=this.pushScope();let n;try{n=e(t)}catch(e){throw this.popScope(),e}return(0,i.Qg)(n)?n.then((e=>(this.popScope(),e)),(e=>{throw this.popScope(),e})):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){const n=this._lastEventId=t&&t.event_id?t.event_id:(0,o.eJ)(),i=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:i,...t,event_id:n}),n}captureMessage(e,t,n){const i=this._lastEventId=n&&n.event_id?n.event_id:(0,o.eJ)(),r=new Error(e);return this.getScope().captureMessage(e,t,{originalException:e,syntheticException:r,...n,event_id:i}),i}captureEvent(e,t){const n=t&&t.event_id?t.event_id:(0,o.eJ)();return e.type||(this._lastEventId=n),this.getScope().captureEvent(e,{...t,event_id:n}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){const{scope:n,client:i}=this.getStackTop();if(!i)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:a=h}=i.getOptions&&i.getOptions()||{};if(a<=0)return;const c={timestamp:(0,r.lu)(),...e},l=o?(0,s.pq)((()=>o(c,t))):c;null!==l&&(i.emit&&i.emit("beforeAddBreadcrumb",l,t),n.addBreadcrumb(l,a))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t),this.getIsolationScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t),this.getIsolationScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t),this.getIsolationScope().setContext(e,t)}configureScope(e){const{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){const t=b(this);try{e(this)}finally{b(t)}}getIntegration(e){const t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return l.T&&s.vF.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){const n=this._callExtensionMethod("startTransaction",e,t);return l.T&&!n&&(this.getClient()?s.vF.warn("Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':\nSentry.addTracingExtensions();\nSentry.init({...});\n"):s.vF.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const e=this.getStackTop().scope,t=e.getSession();t&&(0,d.Vu)(t),this._sendSessionUpdate(),e.setSession()}startSession(e){const{scope:t,client:n}=this.getStackTop(),{release:i,environment:o=c.U}=n&&n.getOptions()||{},{userAgent:r}=a.OW.navigator||{},s=(0,d.fj)({release:i,environment:o,user:t.getUser(),...r&&{userAgent:r},...e}),l=t.getSession&&t.getSession();return l&&"ok"===l.status&&(0,d.qO)(l,{status:"exited"}),this.endSession(),t.setSession(s),s}shouldSendDefaultPii(){const e=this.getClient(),t=e&&e.getOptions();return Boolean(t&&t.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_callExtensionMethod(e,...t){const n=I().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);l.T&&s.vF.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function I(){return a.OW.__SENTRY__=a.OW.__SENTRY__||{extensions:{},hub:void 0},a.OW}function b(e){const t=I(),n=B(t);return w(t,e),n}function f(){const e=I();if(e.__SENTRY__&&e.__SENTRY__.acs){const t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return C(e)}function y(){return f().getIsolationScope()}function C(e=I()){return G(e)&&!B(e).isOlderThan(p)||w(e,new m),B(e)}function v(e,t=C()){if(!G(e)||B(e).isOlderThan(p)){const n=t.getClient(),i=t.getScope(),o=t.getIsolationScope();w(e,new m(n,i.clone(),o.clone()))}}function A(e){const t=I();t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.acs=e}function Z(e,t={}){const n=I();return n.__SENTRY__&&n.__SENTRY__.acs?n.__SENTRY__.acs.runWithAsyncContext(e,t):e()}function G(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function B(e){return(0,a.BY)("hub",(()=>new m),e)}function w(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}},5836:(e,t,n)=>{"use strict";n.d(t,{F:()=>m,P$:()=>d,Q8:()=>h,_C:()=>I,lc:()=>g,mH:()=>u,qm:()=>p});var i=n(6936),o=n(7412),r=n(2220),s=n(2531),a=n(3741),c=n(6641);const l=[];function u(e){const t=e.defaultIntegrations||[],n=e.integrations;let o;t.forEach((e=>{e.isDefaultInstance=!0})),o=Array.isArray(n)?[...t,...n]:"function"==typeof n?(0,i.k9)(n(t)):t;const r=function(e){const t={};return e.forEach((e=>{const{name:n}=e,i=t[n];i&&!i.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)})),Object.keys(t).map((e=>t[e]))}(o),s=function(e,t){for(let t=0;t<e.length;t++)if(!0==("Debug"===e[t].name))return t;return-1}(r);if(-1!==s){const[e]=r.splice(s,1);r.push(e)}return r}function d(e,t){const n={};return t.forEach((t=>{t&&p(e,t,n)})),n}function g(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function p(e,t,n){if(n[t.name])r.T&&o.vF.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===l.indexOf(t.name)&&(t.setupOnce(s.lb,c.BF),l.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),e.on&&"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,i)=>n(t,i,e)))}if(e.addEventProcessor&&"function"==typeof t.processEvent){const n=t.processEvent.bind(t),i=Object.assign(((t,i)=>n(t,i,e)),{id:t.name});e.addEventProcessor(i)}r.T&&o.vF.log(`Integration installed: ${t.name}`)}}function h(e){const t=(0,a.KU)();t&&t.addIntegration?t.addIntegration(e):r.T&&o.vF.warn(`Cannot add integration "${e.name}" because no SDK Client is available.`)}function m(e,t){return Object.assign((function(...e){return t(...e)}),{id:e})}function I(e){return e}},2512:(e,t,n)=>{"use strict";n.d(t,{g:()=>a,r:()=>c});var i=n(8411),o=n(3095);let r;function s(e){return r?r.get(e):void 0}function a(e){const t=s(e);if(!t)return;const n={};for(const[,[e,o]]of t)n[e]||(n[e]=[]),n[e].push((0,i.Ce)(o));return n}function c(e,t,n,i,a,c){const l=(0,o.Bk)();if(l){const o=s(l)||new Map,u=`${e}:${t}@${i}`,d=o.get(c);if(d){const[,e]=d;o.set(c,[u,{min:Math.min(e.min,n),max:Math.max(e.max,n),count:e.count+=1,sum:e.sum+=n,tags:e.tags}])}else o.set(c,[u,{min:n,max:n,count:1,sum:n,tags:a}]);r||(r=new WeakMap),r.set(l,o)}}},2486:(e,t,n)=>{"use strict";n.d(t,{HG:()=>d,m6:()=>g});var i=n(3816),o=n(9297),r=n(6936),s=n(7412),a=n(2531),c=n(7058),l=n(1535);let u;class d{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=p()}static clone(e){return e?e.clone():new d}clone(){const e=new d;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&(0,c.qO)(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e;if(t instanceof d){const e=t.getScopeData();this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&Object.keys(e.user).length&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint.length&&(this._fingerprint=e.fingerprint),t.getRequestSession()&&(this._requestSession=t.getRequestSession()),e.propagationContext&&(this._propagationContext=e.propagationContext)}else if((0,i.Qd)(t)){const t=e;this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext)}return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=p(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const i={timestamp:(0,o.lu)(),...e},r=this._breadcrumbs;return r.push(i),this._breadcrumbs=r.length>n?r.slice(-n):r,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:t,_contexts:n,_tags:i,_extra:o,_user:r,_level:s,_fingerprint:a,_eventProcessors:c,_propagationContext:l,_sdkProcessingMetadata:u,_transactionName:d,_span:g}=this;return{breadcrumbs:e,attachments:t,contexts:n,tags:i,extra:o,user:r,level:s,fingerprint:a||[],eventProcessors:c,propagationContext:l,sdkProcessingMetadata:u,transactionName:d,span:g}}applyToEvent(e,t={},n=[]){(0,l.e2)(e,this.getScopeData());const i=[...n,...(0,a.lG)(),...this._eventProcessors];return(0,a.jB)(i,e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:(0,r.eJ)();if(!this._client)return s.vF.warn("No client configured on scope - will not capture exception!"),n;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...t,event_id:n},this),n}captureMessage(e,t,n){const i=n&&n.event_id?n.event_id:(0,r.eJ)();if(!this._client)return s.vF.warn("No client configured on scope - will not capture message!"),i;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:i},this),i}captureEvent(e,t){const n=t&&t.event_id?t.event_id:(0,r.eJ)();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(s.vF.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}function g(){return u||(u=new d),u}function p(){return{traceId:(0,r.eJ)(),spanId:(0,r.eJ)().substring(16)}}},1869:(e,t,n)=>{"use strict";n.d(t,{E1:()=>a,JD:()=>s,i_:()=>i,sy:()=>o,uT:()=>r});const i="sentry.source",o="sentry.sample_rate",r="sentry.op",s="sentry.origin",a="profile_id"},7058:(e,t,n)=>{"use strict";n.d(t,{Vu:()=>c,fj:()=>s,qO:()=>a});var i=n(9297),o=n(6936),r=n(8411);function s(e){const t=(0,i.zf)(),n={sid:(0,o.eJ)(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return(0,r.Ce)({sid:`${e.sid}`,init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?`${e.did}`:void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}})}(n)};return e&&a(n,e),n}function a(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,i.zf)(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:(0,o.eJ)()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function c(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),a(e,n)}},5452:(e,t,n)=>{"use strict";n.d(t,{k:()=>l,l:()=>c});var i=n(8411),o=n(2967),r=n(3741),s=n(4636),a=n(3445);function c(e,t,n){const r=t.getOptions(),{publicKey:s}=t.getDsn()||{},{segment:a}=n&&n.getUser()||{},c=(0,i.Ce)({environment:r.environment||o.U,release:r.release,user_segment:a,public_key:s,trace_id:e});return t.emit&&t.emit("createDsc",c),c}function l(e){const t=(0,r.KU)();if(!t)return{};const n=c((0,a.et)(e).trace_id||"",t,(0,r.o5)()),i=(0,s.z)(e);if(!i)return n;const o=i&&i._frozenDynamicSamplingContext;if(o)return o;const{sampleRate:l,source:u}=i.metadata;null!=l&&(n.sample_rate=`${l}`);const d=(0,a.et)(i);return u&&"url"!==u&&(n.transaction=d.description),n.sampled=String((0,a.pK)(i)),t.emit&&t.emit("createDsc",n),n}},8325:(e,t,n)=>{"use strict";n.d(t,{U:()=>A,p:()=>v});var i=n(7412),o=n(2220),r=n(6641),s=n(3445),a=n(6341),c=n(718);let l=null;function u(){l=a.OW.onerror,a.OW.onerror=function(e,t,n,i,o){const r={column:i,error:o,line:n,msg:e,url:t};return(0,c.aj)("error",r),!(!l||l.__SENTRY_LOADER__)&&l.apply(this,arguments)},a.OW.onerror.__SENTRY_INSTRUMENTED__=!0}let d=null;function g(){d=a.OW.onunhandledrejection,a.OW.onunhandledrejection=function(e){const t=e;return(0,c.aj)("unhandledrejection",t),!(d&&!d.__SENTRY_LOADER__)||d.apply(this,arguments)},a.OW.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}var p=n(7998);let h=!1;function m(){const e=(0,p.Z7)();if(e){const t="internal_error";o.T&&i.vF.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}m.tag="sentry_tracingErrorCallback";var I=n(6849),b=n(4662),f=n(7927);function y(){const e=this.getScope().getSpan();return e?{"sentry-trace":(0,s.Qh)(e)}:{}}function C(e,t){const n=this.getClient(),r=n&&n.getOptions()||{},s=r.instrumenter||"sentry",a=e.instrumenter||"sentry";s!==a&&(o.T&&i.vF.error(`A transaction was started with instrumenter=\`${a}\`, but the SDK is configured with the \`${s}\` instrumenter.\nThe transaction will not be sampled. Please use the ${s} instrumentation to start transactions.`),e.sampled=!1);let c=new f.Z(e,this);return c=(0,b.T)(c,r,{name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t}),c.isRecording()&&c.initSpanRecorder(r._experiments&&r._experiments.maxSpans),n&&n.emit&&n.emit("startTransaction",c),c}function v(e,t,n,i,o,r,s,a=!1){const c=e.getClient(),l=c&&c.getOptions()||{};let u=new I.zX(t,e,n,i,s,o,a);return u=(0,b.T)(u,l,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...r}),u.isRecording()&&u.initSpanRecorder(l._experiments&&l._experiments.maxSpans),c&&c.emit&&c.emit("startTransaction",u),u}function A(){const e=(0,r.EU)();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=C),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=y),h||(h=!0,function(e){const t="error";(0,c.s5)(t,e),(0,c.AS)(t,u)}(m),function(e){const t="unhandledrejection";(0,c.s5)(t,e),(0,c.AS)(t,g)}(m)))}},6849:(e,t,n)=>{"use strict";n.d(t,{Cq:()=>l,zX:()=>g});var i=n(7412),o=n(9297),r=n(2220),s=n(3445),a=n(5527),c=n(7927);const l={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3},u=["heartbeatFailed","idleTimeout","documentHidden","finalTimeout","externalFinish","cancelled"];class d extends a.l{constructor(e,t,n,i){super(i),this._pushActivity=e,this._popActivity=t,this.transactionSpanId=n}add(e){if(e.spanContext().spanId!==this.transactionSpanId){const t=e.end;e.end=(...n)=>(this._popActivity(e.spanContext().spanId),t.apply(e,n)),void 0===(0,s.et)(e).timestamp&&this._pushActivity(e.spanContext().spanId)}super.add(e)}}class g extends c.Z{constructor(e,t,n=l.idleTimeout,o=l.finalTimeout,s=l.heartbeatInterval,a=!1,c=!1){super(e,t),this._idleHub=t,this._idleTimeout=n,this._finalTimeout=o,this._heartbeatInterval=s,this._onScope=a,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason=u[4],this._autoFinishAllowed=!c,a&&(r.T&&i.vF.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),t.getScope().setSpan(this)),c||this._restartIdleTimeout(),setTimeout((()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason=u[3],this.end())}),this._finalTimeout)}end(e){const t=(0,s.cI)(e);if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setAttribute("finishReason",this._finishReason),this.spanRecorder){r.T&&i.vF.log("[Tracing] finishing IdleTransaction",new Date(1e3*t).toISOString(),this.op);for(const e of this._beforeFinishCallbacks)e(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter((e=>{if(e.spanContext().spanId===this.spanContext().spanId)return!0;(0,s.et)(e).timestamp||(e.setStatus("cancelled"),e.end(t),r.T&&i.vF.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(e,void 0,2)));const{start_timestamp:n,timestamp:o}=(0,s.et)(e),a=n&&n<t,c=(this._finalTimeout+this._idleTimeout)/1e3,l=o&&n&&o-n<c;if(r.T){const t=JSON.stringify(e,void 0,2);a?l||i.vF.log("[Tracing] discarding Span since it finished after Transaction final timeout",t):i.vF.log("[Tracing] discarding Span since it happened after Transaction was finished",t)}return a&&l})),r.T&&i.vF.log("[Tracing] flushing IdleTransaction")}else r.T&&i.vF.log("[Tracing] No active IdleTransaction");if(this._onScope){const e=this._idleHub.getScope();e.getTransaction()===this&&e.setSpan(void 0)}return super.end(e)}registerBeforeFinishCallback(e){this._beforeFinishCallbacks.push(e)}initSpanRecorder(e){if(!this.spanRecorder){const t=e=>{this._finished||this._pushActivity(e)},n=e=>{this._finished||this._popActivity(e)};this.spanRecorder=new d(t,n,this.spanContext().spanId,e),r.T&&i.vF.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}cancelIdleTimeout(e,{restartOnChildSpanChange:t}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===t,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason=u[5],this.end(e)))}setFinishReason(e){this._finishReason=e}sendAutoFinishSignal(){this._autoFinishAllowed||(r.T&&i.vF.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(e){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout((()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason=u[1],this.end(e))}),this._idleTimeout)}_pushActivity(e){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),r.T&&i.vF.log(`[Tracing] pushActivity: ${e}`),this.activities[e]=!0,r.T&&i.vF.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(e){if(this.activities[e]&&(r.T&&i.vF.log(`[Tracing] popActivity ${e}`),delete this.activities[e],r.T&&i.vF.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const e=(0,o.zf)();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason=u[5],this.end(e)):this._restartIdleTimeout(e+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;const e=Object.keys(this.activities).join("");e===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=e,this._heartbeatCounter>=3?this._autoFinishAllowed&&(r.T&&i.vF.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason=u[0],this.end()):this._pingHeartbeat()}_pingHeartbeat(){r.T&&i.vF.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),this._heartbeatInterval)}}},1939:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var i=n(7998);function o(e,t,n){const o=(0,i.Z7)();o&&o.setMeasurement(e,t,n)}},4662:(e,t,n)=>{"use strict";n.d(t,{T:()=>l,v:()=>u});var i=n(7412),o=n(3816),r=n(2220),s=n(1869),a=n(3551),c=n(3445);function l(e,t,n){if(!(0,a.w)(t))return e.sampled=!1,e;if(void 0!==e.sampled)return e.setAttribute(s.sy,Number(e.sampled)),e;let o;return"function"==typeof t.tracesSampler?(o=t.tracesSampler(n),e.setAttribute(s.sy,Number(o))):void 0!==n.parentSampled?o=n.parentSampled:void 0!==t.tracesSampleRate?(o=t.tracesSampleRate,e.setAttribute(s.sy,Number(o))):(o=1,e.setAttribute(s.sy,o)),u(o)?o?(e.sampled=Math.random()<o,e.sampled?(r.T&&i.vF.log(`[Tracing] starting ${e.op} transaction - ${(0,c.et)(e).description}`),e):(r.T&&i.vF.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(o)})`),e)):(r.T&&i.vF.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),e.sampled=!1,e):(r.T&&i.vF.warn("[Tracing] Discarding transaction because of invalid sample rate."),e.sampled=!1,e)}function u(e){return(0,o.yr)(e)||"number"!=typeof e&&"boolean"!=typeof e?(r.T&&i.vF.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`),!1):!(e<0||e>1)||(r.T&&i.vF.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${e}.`),!1)}},5527:(e,t,n)=>{"use strict";n.d(t,{L:()=>h,l:()=>p});var i=n(6936),o=n(9297),r=n(7412),s=n(8411),a=n(2220),c=n(2512),l=n(1869),u=n(4636),d=n(3445),g=n(3317);class p{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class h{constructor(e={}){this._traceId=e.traceId||(0,i.eJ)(),this._spanId=e.spanId||(0,i.eJ)().substring(16),this._startTime=e.startTimestamp||(0,o.zf)(),this.tags=e.tags?{...e.tags}:{},this.data=e.data?{...e.data}:{},this.instrumenter=e.instrumenter||"sentry",this._attributes={},this.setAttributes({[l.JD]:e.origin||"manual",[l.uT]:e.op,...e.attributes}),this._name=e.name||e.description,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.status&&(this._status=e.status),e.endTimestamp&&(this._endTime=e.endTimestamp),e.exclusiveTime&&(this._exclusiveTime=e.exclusiveTime),this._measurements=e.measurements?{...e.measurements}:{}}get name(){return this._name||""}set name(e){this.updateName(e)}get description(){return this._name}set description(e){this._name=e}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get spanId(){return this._spanId}set spanId(e){this._spanId=e}set parentSpanId(e){this._parentSpanId=e}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(e){this._sampled=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get startTimestamp(){return this._startTime}set startTimestamp(e){this._startTime=e}get endTimestamp(){return this._endTime}set endTimestamp(e){this._endTime=e}get status(){return this._status}set status(e){this._status=e}get op(){return this._attributes[l.uT]}set op(e){this.setAttribute(l.uT,e)}get origin(){return this._attributes[l.JD]}set origin(e){this.setAttribute(l.JD,e)}spanContext(){const{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?d.aO:d.CC}}startChild(e){const t=new h({...e,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t);const n=(0,u.z)(this);if(t.transaction=n,a.T&&n){const i=`[Tracing] Starting '${e&&e.op||"< unknown op >"}' span on transaction '${(0,d.et)(t).description||"< unknown name >"}' (${n.spanContext().spanId}).`;r.vF.log(i),this._logMessage=i}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setAttribute(e,t){void 0===t?delete this._attributes[e]:this._attributes[e]=t}setAttributes(e){Object.keys(e).forEach((t=>this.setAttribute(t,e[t])))}setStatus(e){return this._status=e,this}setHttpStatus(e){return(0,g.N8)(this,e),this}setName(e){this.updateName(e)}updateName(e){return this._name=e,this}isSuccess(){return"ok"===this._status}finish(e){return this.end(e)}end(e){if(this._endTime)return;const t=(0,u.z)(this);if(a.T&&t&&t.spanContext().spanId!==this._spanId){const e=this._logMessage;e&&r.vF.log(e.replace("Starting","Finishing"))}this._endTime=(0,d.cI)(e)}toTraceparent(){return(0,d.Qh)(this)}toContext(){return(0,s.Ce)({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(e){return this.data=e.data||{},this._name=e.name||e.description,this._endTime=e.endTimestamp,this.op=e.op,this._parentSpanId=e.parentSpanId,this._sampled=e.sampled,this._spanId=e.spanId||this._spanId,this._startTime=e.startTimestamp||this._startTime,this._status=e.status,this.tags=e.tags||{},this._traceId=e.traceId||this._traceId,this}getTraceContext(){return(0,d.kX)(this)}getSpanJSON(){return(0,s.Ce)({data:this._getData(),description:this._name,op:this._attributes[l.uT],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[l.JD],_metrics_summary:(0,c.g)(this),profile_id:this._attributes[l.E1],exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){const{data:e,_attributes:t}=this,n=Object.keys(e).length>0,i=Object.keys(t).length>0;if(n||i)return n&&i?{...e,...t}:n?e:t}}},3317:(e,t,n)=>{"use strict";var i;function o(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}n.d(t,{AJ:()=>o,Fp:()=>i,N8:()=>s,o6:()=>r}),function(e){e.Ok="ok",e.DeadlineExceeded="deadline_exceeded",e.Unauthenticated="unauthenticated",e.PermissionDenied="permission_denied",e.NotFound="not_found",e.ResourceExhausted="resource_exhausted",e.InvalidArgument="invalid_argument",e.Unimplemented="unimplemented",e.Unavailable="unavailable",e.InternalError="internal_error",e.UnknownError="unknown_error",e.Cancelled="cancelled",e.AlreadyExists="already_exists",e.FailedPrecondition="failed_precondition",e.Aborted="aborted",e.OutOfRange="out_of_range",e.DataLoss="data_loss"}(i||(i={}));const r=o;function s(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);const n=o(t);"unknown_error"!==n&&e.setStatus(n)}},3095:(e,t,n)=>{"use strict";n.d(t,{V4:()=>C,Bk:()=>y,Lb:()=>B,D7:()=>I,Uk:()=>f,Lk:()=>m,nV:()=>b,uP:()=>h});var i=n(6524),o=n(7412),r=n(8411),s=n(2220),a=n(6641),c=n(3445),l=n(5452),u=n(3741),d=n(3816);function g(e,t,n=(()=>{})){let i;try{i=e()}catch(e){throw t(e),n(),e}return function(e,t,n){return(0,d.Qg)(e)?e.then((e=>(n(),e)),(e=>{throw t(e),n(),e})):(n(),e)}(i,t,n)}var p=n(3551);function h(e,t,n=(()=>{}),i=(()=>{})){const o=(0,a.BF)(),r=(0,u.o5)(),s=r.getSpan(),c=A(e),l=v(o,{parentSpan:s,spanContext:c,forceTransaction:!1,scope:r});return r.setSpan(l),g((()=>t(l)),(e=>{l&&l.setStatus("internal_error"),n(e,l)}),(()=>{l&&l.end(),r.setSpan(s),i()}))}function m(e,t){const n=A(e);return(0,a.fx)((()=>(0,u.v4)(e.scope,(i=>{const o=(0,a.BF)(),r=i.getSpan(),s=e.onlyIfParent&&!r?void 0:v(o,{parentSpan:r,spanContext:n,forceTransaction:e.forceTransaction,scope:i});return g((()=>t(s)),(()=>{if(s){const{status:e}=(0,c.et)(s);e&&"ok"!==e||s.setStatus("internal_error")}}),(()=>s&&s.end()))}))))}const I=m;function b(e,t){const n=A(e);return(0,a.fx)((()=>(0,u.v4)(e.scope,(i=>{const o=(0,a.BF)(),r=i.getSpan(),s=e.onlyIfParent&&!r?void 0:v(o,{parentSpan:r,spanContext:n,forceTransaction:e.forceTransaction,scope:i});function l(){s&&s.end()}return g((()=>t(s,l)),(()=>{if(s&&s.isRecording()){const{status:e}=(0,c.et)(s);e&&"ok"!==e||s.setStatus("internal_error")}}))}))))}function f(e){if(!(0,p.w)())return;const t=A(e),n=(0,a.BF)(),i=e.scope?e.scope.getSpan():y();if(e.onlyIfParent&&!i)return;const o=(e.scope||(0,u.o5)()).clone();return v(n,{parentSpan:i,spanContext:t,forceTransaction:e.forceTransaction,scope:o})}function y(){return(0,u.o5)().getSpan()}const C=({sentryTrace:e,baggage:t},n)=>{const c=(0,u.o5)(),{traceparentData:l,dynamicSamplingContext:d,propagationContext:g}=(0,i.E0)(e,t);c.setPropagationContext(g),s.T&&l&&o.vF.log(`[Tracing] Continuing trace ${l.traceId}.`);const p={...l,metadata:(0,r.Ce)({dynamicSamplingContext:d})};return n?(0,a.fx)((()=>n(p))):p};function v(e,{parentSpan:t,spanContext:n,forceTransaction:i,scope:o}){if(!(0,p.w)())return;const s=(0,a.rm)();let u;if(t&&!i)u=t.startChild(n);else if(t){const i=(0,l.k)(t),{traceId:o,spanId:r}=t.spanContext(),s=(0,c.pK)(t);u=e.startTransaction({traceId:o,parentSpanId:r,parentSampled:s,...n,metadata:{dynamicSamplingContext:i,...n.metadata}})}else{const{traceId:t,dsc:i,parentSpanId:r,sampled:a}={...s.getPropagationContext(),...o.getPropagationContext()};u=e.startTransaction({traceId:t,parentSpanId:r,parentSampled:a,...n,metadata:{dynamicSamplingContext:i,...n.metadata}})}return o.setSpan(u),function(e,t,n){e&&((0,r.my)(e,G,n),(0,r.my)(e,Z,t))}(u,o,s),u}function A(e){if(e.startTime){const t={...e};return t.startTimestamp=(0,c.cI)(e.startTime),delete t.startTime,t}return e}const Z="_sentryScope",G="_sentryIsolationScope";function B(e){return{scope:e[Z],isolationScope:e[G]}}},7927:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(8411),o=n(7412),r=n(2220),s=n(6641),a=n(2512),c=n(1869),l=n(3445),u=n(5452),d=n(5527),g=n(3095);class p extends d.L{constructor(e,t){super(e),this._contexts={},this._hub=t||(0,s.BF)(),this._name=e.name||"",this._metadata={...e.metadata},this._trimEnd=e.trimEnd,this.transaction=this;const n=this._metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[c.i_]&&{source:this._attributes[c.i_]},...this._attributes[c.sy]&&{sampleRate:this._attributes[c.sy]}}}set metadata(e){this._metadata=e}setName(e,t="custom"){this._name=e,this.setAttribute(c.i_,t)}updateName(e){return this._name=e,this}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new d.l(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this._metadata={...this._metadata,...e}}end(e){const t=(0,l.cI)(e),n=this._finishTransaction(t);if(n)return this._hub.captureEvent(n)}toContext(){const e=super.toContext();return(0,i.Ce)({...e,name:this._name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this._name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){return(0,u.k)(this)}setHub(e){this._hub=e}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(e){if(void 0!==this._endTime)return;this._name||(r.T&&o.vF.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(e);const t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this._sampled)return r.T&&o.vF.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),void(t&&t.recordDroppedEvent("sample_rate","transaction"));const n=this.spanRecorder?this.spanRecorder.spans.filter((e=>e!==this&&(0,l.et)(e).timestamp)):[];if(this._trimEnd&&n.length>0){const e=n.map((e=>(0,l.et)(e).timestamp)).filter(Boolean);this._endTime=e.reduce(((e,t)=>e>t?e:t))}const{scope:s,isolationScope:c}=(0,g.Lb)(this),{metadata:d}=this,{source:p}=d,h={contexts:{...this._contexts,trace:(0,l.kX)(this)},spans:n,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...d,capturedSpanScope:s,capturedSpanIsolationScope:c,...(0,i.Ce)({dynamicSamplingContext:(0,u.k)(this)})},_metrics_summary:(0,a.g)(this),...p&&{transaction_info:{source:p}}};return Object.keys(this._measurements).length>0&&(r.T&&o.vF.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),h.measurements=this._measurements),r.T&&o.vF.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),h}}},7998:(e,t,n)=>{"use strict";n.d(t,{Z7:()=>r,nc:()=>s});var i=n(6524),o=n(6641);function r(e){return(e||(0,o.BF)()).getScope().getTransaction()}const s=i.nc},1535:(e,t,n)=>{"use strict";n.d(t,{Rg:()=>l,e2:()=>c});var i=n(8411),o=n(6936),r=n(5452),s=n(4636),a=n(3445);function c(e,t){const{fingerprint:n,span:c,breadcrumbs:l,sdkProcessingMetadata:u}=t;!function(e,t){const{extra:n,tags:o,user:r,contexts:s,level:a,transactionName:c}=t,l=(0,i.Ce)(n);l&&Object.keys(l).length&&(e.extra={...l,...e.extra});const u=(0,i.Ce)(o);u&&Object.keys(u).length&&(e.tags={...u,...e.tags});const d=(0,i.Ce)(r);d&&Object.keys(d).length&&(e.user={...d,...e.user});const g=(0,i.Ce)(s);g&&Object.keys(g).length&&(e.contexts={...g,...e.contexts}),a&&(e.level=a),c&&(e.transaction=c)}(e,t),c&&function(e,t){e.contexts={trace:(0,a.kX)(t),...e.contexts};const n=(0,s.z)(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:(0,r.k)(t),...e.sdkProcessingMetadata};const i=(0,a.et)(n).description;i&&(e.tags={transaction:i,...e.tags})}}(e,c),function(e,t){e.fingerprint=e.fingerprint?(0,o.k9)(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,l),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,u)}function l(e,t){const{extra:n,tags:i,user:o,contexts:r,level:s,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:l,eventProcessors:d,attachments:g,propagationContext:p,transactionName:h,span:m}=t;u(e,"extra",n),u(e,"tags",i),u(e,"user",o),u(e,"contexts",r),u(e,"sdkProcessingMetadata",a),s&&(e.level=s),h&&(e.transactionName=h),m&&(e.span=m),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),l.length&&(e.fingerprint=[...e.fingerprint,...l]),d.length&&(e.eventProcessors=[...e.eventProcessors,...d]),g.length&&(e.attachments=[...e.attachments,...g]),e.propagationContext={...e.propagationContext,...p}}function u(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[t][i]=n[i])}}},4636:(e,t,n)=>{"use strict";function i(e){return e.transaction}n.d(t,{z:()=>i})},3551:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var i=n(3741);function o(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const t=(0,i.KU)(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}},9475:(e,t,n)=>{"use strict";n.d(t,{li:()=>m,mG:()=>p});var i=n(6936),o=n(9297),r=n(9653),s=n(6341),a=n(2181),c=n(2967),l=n(2531),u=n(2486),d=n(1535),g=n(3445);function p(e,t,n,p,m,I){const{normalizeDepth:b=3,normalizeMaxBreadth:f=1e3}=e,y={...t,event_id:t.event_id||n.event_id||(0,i.eJ)(),timestamp:t.timestamp||(0,o.lu)()},C=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:i,dist:o,maxValueLength:s=250}=t;"environment"in e||(e.environment="environment"in t?n:c.U),void 0===e.release&&void 0!==i&&(e.release=i),void 0===e.dist&&void 0!==o&&(e.dist=o),e.message&&(e.message=(0,r.xv)(e.message,s));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=(0,r.xv)(a.value,s));const l=e.request;l&&l.url&&(l.url=(0,r.xv)(l.url,s))}(y,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(y,C),void 0===t.type&&function(e,t){const n=s.OW._sentryDebugIds;if(!n)return;let i;const o=h.get(t);o?i=o:(i=new Map,h.set(t,i));const r=Object.keys(n).reduce(((e,o)=>{let r;const s=i.get(o);s?r=s:(r=t(o),i.set(o,r));for(let t=r.length-1;t>=0;t--){const i=r[t];if(i.filename){e[i.filename]=n[o];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=r[e.filename])}))}))}catch(e){}}(y,e.stackParser);const v=function(e,t){if(!t)return e;const n=e?e.clone():new u.HG;return n.update(t),n}(p,n.captureContext);n.mechanism&&(0,i.M6)(y,n.mechanism);const A=m&&m.getEventProcessors?m.getEventProcessors():[],Z=(0,u.m6)().getScopeData();if(I){const e=I.getScopeData();(0,d.Rg)(Z,e)}if(v){const e=v.getScopeData();(0,d.Rg)(Z,e)}const G=[...n.attachments||[],...Z.attachments];G.length&&(n.attachments=G),(0,d.e2)(y,Z);const B=[...A,...(0,l.lG)(),...Z.eventProcessors];return(0,l.jB)(B,y,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof b&&b>0?function(e,t,n){if(!e)return null;const i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:(0,a.S8)(e.data,t,n)}})))},...e.user&&{user:(0,a.S8)(e.user,t,n)},...e.contexts&&{contexts:(0,a.S8)(e.contexts,t,n)},...e.extra&&{extra:(0,a.S8)(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=(0,a.S8)(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map((e=>{const i=(0,g.et)(e).data;return i&&(e.data=(0,a.S8)(i,t,n)),e}))),i}(e,b,f):e)))}const h=new WeakMap;function m(e){if(e)return function(e){return e instanceof u.HG||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>I.includes(e)))}(e)?{captureContext:e}:e}const I=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"]},3445:(e,t,n)=>{"use strict";n.d(t,{CC:()=>s,Qh:()=>l,aO:()=>a,cI:()=>u,et:()=>g,kX:()=>c,pK:()=>p});var i=n(8411),o=n(6524),r=n(9297);const s=0,a=1;function c(e){const{spanId:t,traceId:n}=e.spanContext(),{data:o,op:r,parent_span_id:s,status:a,tags:c,origin:l}=g(e);return(0,i.Ce)({data:o,op:r,parent_span_id:s,span_id:t,status:a,tags:c,trace_id:n,origin:l})}function l(e){const{traceId:t,spanId:n}=e.spanContext(),i=p(e);return(0,o.TC)(t,n,i)}function u(e){return"number"==typeof e?d(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?d(e.getTime()):(0,r.zf)()}function d(e){return e>9999999999?e/1e3:e}function g(e){return function(e){return"function"==typeof e.getSpanJSON}(e)?e.getSpanJSON():"function"==typeof e.toJSON?e.toJSON():{}}function p(e){const{traceFlags:t}=e.spanContext();return Boolean(t&a)}},7986:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});const i="7.107.0"},8737:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_USER_INCLUDES:()=>me.cx,Handlers:()=>o,Http:()=>Qt,Hub:()=>J.YZ,Integrations:()=>di,NodeClient:()=>Fe,SDK_VERSION:()=>ve.M,SEMANTIC_ATTRIBUTE_SENTRY_OP:()=>Ae.uT,SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN:()=>Ae.JD,SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE:()=>Ae.sy,SEMANTIC_ATTRIBUTE_SENTRY_SOURCE:()=>Ae.i_,Scope:()=>Ze.HG,Undici:()=>Sn,addBreadcrumb:()=>c.ZQ,addEventProcessor:()=>ee,addGlobalEventProcessor:()=>Ge.lb,addIntegration:()=>l.Q8,addRequestDataToEvent:()=>me.GY,anrIntegration:()=>Fn.a,autoDiscoverNodePerformanceMonitoringIntegrations:()=>Re,captureCheckIn:()=>c.SE,captureEvent:()=>c.r,captureException:()=>c.Cp,captureMessage:()=>c.wd,captureSession:()=>c.J5,close:()=>c.VN,configureScope:()=>c.PN,consoleIntegration:()=>yt,contextLinesIntegration:()=>Xt,continueTrace:()=>Be.V4,createGetModuleFromFilename:()=>Rn,createTransport:()=>ie,cron:()=>gi,deepReadDirSync:()=>Xn,defaultIntegrations:()=>Tn,defaultStackParser:()=>Yn,enableAnrDetection:()=>xn,endSession:()=>c.ky,extractRequestData:()=>me.Rj,extractTraceparentData:()=>we.nc,flush:()=>c.bX,functionToStringIntegration:()=>p,getActiveSpan:()=>Be.Bk,getActiveTransaction:()=>we.Z7,getClient:()=>c.KU,getCurrentHub:()=>J.BF,getCurrentScope:()=>c.o5,getDefaultIntegrations:()=>Nn,getGlobalScope:()=>Ze.m6,getHubFromCarrier:()=>J.Me,getIsolationScope:()=>J.rm,getModuleFromFilename:()=>ui,getSentryRelease:()=>kn,getSpanStatusFromHttpCode:()=>Se.AJ,hapiErrorPlugin:()=>jn,hapiIntegration:()=>qn,httpIntegration:()=>Mt,inboundFiltersIntegration:()=>A,init:()=>_n,isInitialized:()=>c.Dp,lastEventId:()=>c.Q,linkedErrorsIntegration:()=>H,localVariablesIntegration:()=>cn,makeMain:()=>J.gM,makeNodeTransport:()=>nt,metrics:()=>pe,modulesIntegration:()=>gn,nativeNodeFetchintegration:()=>wn,nodeContextIntegration:()=>St,onUncaughtExceptionIntegration:()=>In,onUnhandledRejectionIntegration:()=>yn,parameterize:()=>he,requestDataIntegration:()=>fe,runWithAsyncContext:()=>J.fx,setContext:()=>c.o,setCurrentClient:()=>Ce,setExtra:()=>c.l7,setExtras:()=>c.cx,setHttpStatus:()=>Se.N8,setMeasurement:()=>Ve.X,setTag:()=>c.NA,setTags:()=>c.Wt,setUser:()=>c.gV,spanStatusfromHttpCode:()=>Se.o6,spotlightIntegration:()=>An,startActiveSpan:()=>Be.D7,startInactiveSpan:()=>Be.Uk,startSession:()=>c.J0,startSpan:()=>Be.Lk,startSpanManual:()=>Be.nV,startTransaction:()=>c.nb,trace:()=>Be.uP,withActiveSpan:()=>c.hb,withIsolationScope:()=>c.rB,withMonitor:()=>c.T$,withScope:()=>c.v4});var i={};n.r(i),n.d(i,{FunctionToString:()=>h,InboundFilters:()=>Z,LinkedErrors:()=>k});var o={};n.r(o),n.d(o,{errorHandler:()=>Un,extractRequestData:()=>En,parseRequest:()=>Jn,requestHandler:()=>Pn,tracingHandler:()=>Kn,trpcMiddleware:()=>On});var r={};n.r(r),n.d(r,{Anr:()=>Fn.M,Console:()=>Ct,Context:()=>Vt,ContextLines:()=>Ft,Hapi:()=>$n,Http:()=>Qt,LocalVariables:()=>an,Modules:()=>pn,OnUncaughtException:()=>bn,OnUnhandledRejection:()=>Cn,RequestData:()=>ye,Spotlight:()=>Zn,Undici:()=>Sn});var s={};n.r(s),n.d(s,{Apollo:()=>ei.I,Express:()=>ti.JF,GraphQL:()=>ni.c,Mongo:()=>ii.N,Mysql:()=>oi.d,Postgres:()=>ri.E,Prisma:()=>si.D});var a=n(8411),c=n(3741),l=n(5836);let u;const d="FunctionToString",g=new WeakMap,p=(0,l._C)((()=>({name:d,setupOnce(){u=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=(0,a.sp)(this),n=g.has((0,c.KU)())&&void 0!==t?t:this;return u.apply(n,e)}}catch(e){}},setup(e){g.set(e,!0)}}))),h=(0,l.F)(d,p);var m=n(7412),I=n(6936),b=n(9653),f=n(2220);const y=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],C=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],v="InboundFilters",A=(0,l._C)(((e={})=>({name:v,setupOnce(){},processEvent(t,n,i){const o=i.getOptions(),r=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:y],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:C],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,o);return function(e,t){return t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e)?(f.T&&m.vF.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${(0,I.$X)(e)}`),!0):function(e,t){return!(e.type||!t||!t.length)&&function(e){const t=[];let n;e.message&&t.push(e.message);try{n=e.exception.values[e.exception.values.length-1]}catch(e){}return n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`)),f.T&&0===t.length&&m.vF.error(`Could not extract message for event ${(0,I.$X)(e)}`),t}(e).some((e=>(0,b.Xr)(e,t)))}(e,t.ignoreErrors)?(f.T&&m.vF.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${(0,I.$X)(e)}`),!0):function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&(0,b.Xr)(n,t)}(e,t.ignoreTransactions)?(f.T&&m.vF.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${(0,I.$X)(e)}`),!0):function(e,t){if(!t||!t.length)return!1;const n=G(e);return!!n&&(0,b.Xr)(n,t)}(e,t.denyUrls)?(f.T&&m.vF.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${(0,I.$X)(e)}.\nUrl: ${G(e)}`),!0):!function(e,t){if(!t||!t.length)return!0;const n=G(e);return!n||(0,b.Xr)(n,t)}(e,t.allowUrls)&&(f.T&&m.vF.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${(0,I.$X)(e)}.\nUrl: ${G(e)}`),!0)}(t,r)?null:t}}))),Z=(0,l.F)(v,A);function G(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return f.T&&m.vF.error(`Cannot extract url for event ${(0,I.$X)(e)}`),null}}var B=n(3816);function w(e,t,n=250,i,o,r,s){if(!(r.exception&&r.exception.values&&s&&(0,B.tH)(s.originalException,Error)))return;const a=r.exception.values.length>0?r.exception.values[r.exception.values.length-1]:void 0;var c,l;a&&(r.exception.values=(c=S(e,t,o,s.originalException,i,r.exception.values,a,0),l=n,c.map((e=>(e.value&&(e.value=(0,b.xv)(e.value,l)),e)))))}function S(e,t,n,i,o,r,s,a){if(r.length>=n+1)return r;let c=[...r];if((0,B.tH)(i[o],Error)){V(s,a);const r=e(t,i[o]),l=c.length;W(r,o,l,a),c=S(e,t,n,i[o],o,[r,...c],r,l)}return Array.isArray(i.errors)&&i.errors.forEach(((i,r)=>{if((0,B.tH)(i,Error)){V(s,a);const l=e(t,i),u=c.length;W(l,`errors[${r}]`,u,a),c=S(e,t,n,i,o,[l,...c],l,u)}})),c}function V(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function W(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}var R=n(2181);function T(e,t){return e(t.stack||"",1)}function N(e,t){const n={type:t.name||t.constructor.name,value:t.message},i=T(e,t);return i.length&&(n.stacktrace={frames:i}),n}const _="LinkedErrors",H=(0,l._C)(((e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:_,setupOnce(){},preprocessEvent(e,i,o){const r=o.getOptions();w(N,r.stackParser,r.maxValueLength,n,t,e,i)}}})),k=(0,l.F)(_,H),Y=i;var X=n(831),F=n(690),x=n(8880);class E extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}var J=n(6641);const K="s",P=/[^a-zA-Z0-9_/.-]+/g,z=/[^\w\d\s_:/@.{}[\]$-]+/g;function U(e,t,n,i){return`${e}${t}${n}${Object.entries((0,a.Ce)(i)).sort(((e,t)=>e[0].localeCompare(t[0])))}`}function O(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n.replace(P,"_")]=String(e[n]).replace(z,""));return t}var L=n(7058),D=n(5452),j=n(9475);const M="Not capturing exception because it's already been captured.";class Q{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=(0,X.AD)(e.dsn):f.T&&m.vF.warn("No DSN provided, client will not send events."),this._dsn){const t=function(e,t={}){const n="string"==typeof t?t:t.tunnel,i="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){return`${function(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/`}(e)}?${function(e,t){return(0,a.u4)({sentry_key:e.publicKey,sentry_version:"7",...t&&{sentry_client:`${t.name}/${t.version}`}})}(e,i)}`}(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if((0,I.GR)(e))return void(f.T&&m.vF.log(M));let i=t&&t.event_id;return this._process(this.eventFromException(e,t).then((e=>this._captureEvent(e,t,n))).then((e=>{i=e}))),i}captureMessage(e,t,n,i){let o=n&&n.event_id;const r=(0,B.NF)(e)?e:String(e),s=(0,B.sO)(e)?this.eventFromMessage(r,t,n):this.eventFromException(e,n);return this._process(s.then((e=>this._captureEvent(e,n,i))).then((e=>{o=e}))),o}captureEvent(e,t,n){if(t&&t.originalException&&(0,I.GR)(t.originalException))return void(f.T&&m.vF.log(M));let i=t&&t.event_id;const o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,t,o||n).then((e=>{i=e}))),i}captureSession(e){"string"!=typeof e.release?f.T&&m.vF.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),(0,L.qO)(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):(0,F.XW)(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return f.T&&m.vF.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){const t=this._integrations[e.name];(0,l.qm)(this,e,this._integrations),t||(0,l.lc)(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,i){const o=(0,x.Cj)(n),r=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const s=(0,x.n2)(e,o,i,t);delete e.sdkProcessingMetadata;const a=[{type:r},e];return(0,x.h4)(s,[a])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=(0,x.W3)(n,(0,x.bm)(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));const i=this._sendEnvelope(n);i&&i.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,i){const o=(0,x.Cj)(n),r={sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!i&&t&&{dsn:(0,X.SB)(t)}},s="aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()];return(0,x.h4)(r,[s])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;f.T&&m.vF.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}captureAggregateMetrics(e){f.T&&m.vF.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const t=function(e,t,n,i){const o={sent_at:(new Date).toISOString()};n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),i&&t&&(o.dsn=(0,X.SB)(t));const r=function(e){const t=function(e){let t="";for(const n of e){const e=Object.entries(n.tags),i=e.length>0?`|#${e.map((([e,t])=>`${e}:${t}`)).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}\n`}return t}(e);return[{type:"statsd",length:t.length},t]}(e);return(0,x.h4)(o,[r])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=(0,l.P$)(this,e),(0,l.lc)(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,t){let n=!1,i=!1;const o=t.exception&&t.exception.values;if(o){i=!0;for(const e of o){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const r="ok"===e.status;(r&&0===e.errors||r&&n)&&((0,L.qO)(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new F.T2((t=>{let n=0;const i=setInterval((()=>{0==this._numProcessing?(clearInterval(i),t(!0)):(n+=1,e&&n>=e&&(clearInterval(i),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,i=(0,J.rm)()){const o=this.getOptions(),r=Object.keys(this._integrations);return!t.integrations&&r.length>0&&(t.integrations=r),this.emit("preprocessEvent",e,t),(0,j.mG)(o,e,t,n,this,i).then((e=>{if(null===e)return e;const t={...i.getPropagationContext(),...n?n.getPropagationContext():void 0};if((!e.contexts||!e.contexts.trace)&&t){const{traceId:i,spanId:o,parentSpanId:r,dsc:s}=t;e.contexts={trace:{trace_id:i,span_id:o,parent_span_id:r},...e.contexts};const a=s||(0,D.l)(i,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:a,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(f.T){const t=e;"log"===t.logLevel?m.vF.log(t.message):m.vF.warn(t)}}))}_processEvent(e,t,n){const i=this.getOptions(),{sampleRate:o}=i,r=$(e),s=q(e),a=e.type||"error",c=`before send for type \`${a}\``;if(s&&"number"==typeof o&&Math.random()>o)return this.recordDroppedEvent("sample_rate","error",e),(0,F.xg)(new E(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const l="replay_event"===a?"replay":a,u=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,u).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new E("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const o=function(e,t,n){const{beforeSend:i,beforeSendTransaction:o}=e;return q(t)&&i?i(t,n):$(t)&&o?o(t,n):t}(i,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if((0,B.Qg)(e))return e.then((e=>{if(!(0,B.Qd)(e)&&null!==e)throw new E(n);return e}),(e=>{throw new E(`${t} rejected with ${e}`)}));if(!(0,B.Qd)(e)&&null!==e)throw new E(n);return e}(o,c)})).then((i=>{if(null===i)throw this.recordDroppedEvent("before_send",l,e),new E(`${c} returned \`null\`, will not send event.`,"log");const o=n&&n.getSession();!r&&o&&this._updateSessionFromEvent(o,i);const s=i.transaction_info;if(r&&s&&i.transaction!==e.transaction){const e="custom";i.transaction_info={...s,source:e}}return this.sendEvent(i,t),i})).then(null,(e=>{if(e instanceof E)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new E(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,(e=>{f.T&&m.vF.error("Error while sending event:",e)}));f.T&&m.vF.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,i]=t.split(":");return{reason:n,category:i,quantity:e[t]}}))}}function q(e){return void 0===e.type}function $(e){return"transaction"===e.type}function ee(e){const t=(0,c.KU)();t&&t.addEventProcessor&&t.addEventProcessor(e)}const te=6e4;const ne=30;function ie(e,t,n=function(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(i){if(!(void 0===e||t.length<e))return(0,F.xg)(new E("Not adding Promise because buffer limit was reached."));const o=i();return-1===t.indexOf(o)&&t.push(o),o.then((()=>n(o))).then(null,(()=>n(o).then(null,(()=>{})))),o},drain:function(e){return new F.T2(((n,i)=>{let o=t.length;if(!o)return n(!0);const r=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{(0,F.XW)(e).then((()=>{--o||(clearTimeout(r),n(!0))}),i)}))}))}}}(e.bufferSize||ne)){let i={};function o(o){const r=[];if((0,x.yH)(o,((t,n)=>{const o=(0,x.zk)(n);if(function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(i,o)){const i=oe(t,n);e.recordDroppedEvent("ratelimit_backoff",o,i)}else r.push(t)})),0===r.length)return(0,F.XW)();const s=(0,x.h4)(o[0],r),a=t=>{(0,x.yH)(s,((n,i)=>{const o=oe(n,i);e.recordDroppedEvent(t,(0,x.zk)(i),o)}))};return n.add((()=>t({body:(0,x.bN)(s,e.textEncoder)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&f.T&&m.vF.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),i=function(e,{statusCode:t,headers:n},i=Date.now()){const o={...e},r=n&&n["x-sentry-rate-limits"],s=n&&n["retry-after"];if(r)for(const e of r.trim().split(",")){const[t,n]=e.split(":",2),r=parseInt(t,10),s=1e3*(isNaN(r)?60:r);if(n)for(const e of n.split(";"))o[e]=i+s;else o.all=i+s}else s?o.all=i+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const i=Date.parse(`${e}`);return isNaN(i)?te:i-t}(s,i):429===t&&(o.all=i+6e4);return o}(i,e),e)),(e=>{throw a("network_error"),e})))).then((e=>e),(e=>{if(e instanceof E)return f.T&&m.vF.error("Skipped sending event because buffer is full."),a("queue_overflow"),(0,F.XW)();throw e}))}return o.__sentry__baseTransport__=!0,{send:o,flush:e=>n.drain(e)}}function oe(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}var re=n(3445),se=n(9297);const ae={c:class{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}},g:class{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}},d:class{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}},[K]:class{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map((e=>"string"==typeof e?function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t>>>0}(e):e)).join(":")}}};var ce=n(2512);class le{constructor(e){this._client=e,this._buckets=new Map,this._interval=setInterval((()=>this.flush()),5e3)}add(e,t,n,i="none",o={},r=(0,se.zf)()){const s=Math.floor(r),a=t.replace(P,"_"),c=O(o),l=U(e,a,i,c);let u=this._buckets.get(l);const d=u&&e===K?u.metric.weight:0;u?(u.metric.add(n),u.timestamp<s&&(u.timestamp=s)):(u={metric:new ae[e](n),timestamp:s,metricType:e,name:a,unit:i,tags:c},this._buckets.set(l,u));const g="string"==typeof n?u.metric.weight-d:n;(0,ce.r)(e,a,g,i,o,l)}flush(){if(0!==this._buckets.size){if(this._client.captureAggregateMetrics){const e=Array.from(this._buckets).map((([,e])=>e));this._client.captureAggregateMetrics(e)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}}const ue="MetricsAggregator",de=(0,l._C)((()=>({name:ue,setupOnce(){},setup(e){e.metricsAggregator=new le(e)}})));function ge(e,t,n,i={}){const o=(0,c.KU)(),r=(0,c.o5)();if(o){if(!o.metricsAggregator)return void(f.T&&m.vF.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs"));const{unit:s,tags:a,timestamp:c}=i,{release:l,environment:u}=o.getOptions(),d=r.getTransaction(),g={};l&&(g.release=l),u&&(g.environment=u),d&&(g.transaction=(0,re.et)(d).description||""),f.T&&m.vF.log(`Adding value of ${n} to ${e} metric ${t}`),o.metricsAggregator.add(e,t,n,s,{...g,...a},c)}}const pe={increment:function(e,t=1,n){ge("c",e,t,n)},distribution:function(e,t,n){ge("d",e,t,n)},set:function(e,t,n){ge(K,e,t,n)},gauge:function(e,t,n){ge("g",e,t,n)},MetricsAggregator:(0,l.F)(ue,de),metricsAggregatorIntegration:de};function he(e,...t){const n=new String(String.raw(e,...t));return n.__sentry_template_string__=e.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=t,n}var me=n(1040);const Ie={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},be="RequestData",fe=(0,l._C)(((e={})=>{const t=me.GY,n={...Ie,...e,include:{method:!0,...Ie.include,...e.include,user:e.include&&"boolean"==typeof e.include.user?e.include.user:{...Ie.include.user,...(e.include||{}).user}}};return{name:be,setupOnce(){},processEvent(e,i,o){const{transactionNamingScheme:r}=n,{sdkProcessingMetadata:s={}}=e,a=s.request;if(!a)return e;const c=s.requestDataOptionsFromExpressHandler||s.requestDataOptionsFromGCPWrapper||function(e){const{transactionNamingScheme:t,include:{ip:n,user:i,...o}}=e,r=[];for(const[e,t]of Object.entries(o))t&&r.push(e);let s;if(void 0===i)s=!0;else if("boolean"==typeof i)s=i;else{const e=[];for(const[t,n]of Object.entries(i))n&&e.push(t);s=e}return{include:{ip:n,user:s,request:0!==r.length?r:void 0,transaction:t}}}(n),l=t(e,a,c);if("transaction"===e.type||"handler"===r)return l;const u=a._sentryTransaction;if(u){const e=(0,re.et)(u).description||"",t="sentry.javascript.nextjs"===function(e){try{return e.getOptions()._metadata.sdk.name}catch(e){return}}(o)?e.startsWith("/api"):"path"!==r,[n]=(0,me.Up)(a,{path:!0,method:t,customRoute:e});l.transaction=n}return l}}})),ye=(0,l.F)(be,fe);function Ce(e){const t=(0,J.BF)().getStackTop();t.client=e,t.scope.setClient(e)}var ve=n(7986),Ae=n(1869),Ze=n(2486),Ge=n(2531),Be=n(3095),we=n(7998),Se=n(3317),Ve=n(1939),We=n(8402);function Re(){const e=We.j.map((e=>{try{return e()}catch(e){return}})).filter((e=>!!e));return 0===e.length&&m.vF.warn("Performance monitoring integrations could not be automatically loaded."),e.filter((e=>!!e.loadDependency()))}var Te=n(857),Ne=n(9023);class _e{constructor(e){this._client=e,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval((()=>this._flush()),1e4),this._flushShift=Math.floor(1e4*Math.random()/1e3),this._forceFlush=!1}add(e,t,n,i="none",o={},r=(0,se.zf)()){const s=Math.floor(r),a=t.replace(P,"_"),c=O(o),l=U(e,a,i,c);let u=this._buckets.get(l);const d=u&&e===K?u.metric.weight:0;u?(u.metric.add(n),u.timestamp<s&&(u.timestamp=s)):(u={metric:new ae[e](n),timestamp:s,metricType:e,name:a,unit:i,tags:c},this._buckets.set(l,u));const g="string"==typeof n?u.metric.weight-d:n;(0,ce.r)(e,a,g,i,o,l),this._bucketsTotalWeight+=u.metric.weight,this._bucketsTotalWeight>=1e4&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush)return this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),void this._buckets.clear();const e=Math.floor((0,se.zf)())-10-this._flushShift,t=new Map;for(const[n,i]of this._buckets)i.timestamp<=e&&(t.set(n,i),this._bucketsTotalWeight-=i.metric.weight);for(const[e]of t)this._buckets.delete(e);this._captureMetrics(t)}_captureMetrics(e){if(e.size>0&&this._client.captureAggregateMetrics){const t=Array.from(e).map((([,e])=>e));this._client.captureAggregateMetrics(t)}}}class He{constructor(e,t){this._client=e,this.flushTimeout=60,this._pendingAggregates={},this._isEnabled=!0,this._intervalId=setInterval((()=>this.flush()),1e3*this.flushTimeout),this._sessionAttrs=t}flush(){const e=this.getSessionAggregates();0!==e.aggregates.length&&(this._pendingAggregates={},this._client.sendSession(e))}getSessionAggregates(){const e=Object.keys(this._pendingAggregates).map((e=>this._pendingAggregates[parseInt(e)])),t={attrs:this._sessionAttrs,aggregates:e};return(0,a.Ce)(t)}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;const e=(0,c.o5)(),t=e.getRequestSession();t&&t.status&&(this._incrementSessionStatusCount(t.status,new Date),e.setRequestSession(void 0))}_incrementSessionStatusCount(e,t){const n=new Date(t).setSeconds(0,0);this._pendingAggregates[n]=this._pendingAggregates[n]||{};const i=this._pendingAggregates[n];switch(i.started||(i.started=new Date(n).toISOString()),e){case"errored":return i.errored=(i.errored||0)+1,i.errored;case"ok":return i.exited=(i.exited||0)+1,i.exited;default:return i.crashed=(i.crashed||0)+1,i.crashed}}}var ke=n(8325),Ye=n(4636);class Xe extends Q{constructor(e){(0,ke.U)(),super(e),e._experiments&&e._experiments.metricsAggregator&&(this.metricsAggregator=new _e(this))}eventFromException(e,t){return(0,F.XW)(function(e,t,n,i){const o="function"==typeof e?e().getClient():e;let r=n;const s=i&&i.data&&i.data.mechanism||{handled:!0,type:"generic"};let c;if(!(0,B.bJ)(n)){if((0,B.Qd)(n)){const e=o&&o.getOptions().normalizeDepth;c={__serialized__:(0,R.cd)(n,e)};const t=function(e){if("name"in e&&"string"==typeof e.name){let t=`'${e.name}' captured as exception`;return"message"in e&&"string"==typeof e.message&&(t+=` with message '${e.message}'`),t}return"message"in e&&"string"==typeof e.message?e.message:`Object captured as exception with keys: ${(0,a.HF)(e)}`}(n);r=i&&i.syntheticException||new Error(t),r.message=t}else r=i&&i.syntheticException||new Error(n),r.message=n;s.synthetic=!0}const l={exception:{values:[N(t,r)]}};return c&&(l.extra=c),(0,I.gO)(l,void 0,void 0),(0,I.M6)(l,s),{...l,event_id:i&&i.event_id}}((0,c.KU)(),this._options.stackParser,e,t))}eventFromMessage(e,t="info",n){return(0,F.XW)(function(e,t,n="info",i,o){const r={event_id:i&&i.event_id,level:n};if(o&&i&&i.syntheticException){const n=T(e,i.syntheticException);n.length&&(r.exception={values:[{value:t,stacktrace:{frames:n}}]})}if((0,B.NF)(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return r.logentry={message:e,params:n},r}return r.message=t,r}(this._options.stackParser,e,t,n,this._options.attachStacktrace))}captureException(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n){const e=n.getRequestSession();e&&"ok"===e.status&&(e.status="errored")}return super.captureException(e,t,n)}captureEvent(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n&&"exception"===(e.type||"exception")&&e.exception&&e.exception.values&&e.exception.values.length>0){const e=n.getRequestSession();e&&"ok"===e.status&&(e.status="errored")}return super.captureEvent(e,t,n)}close(e){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(e)}initSessionFlusher(){const{release:e,environment:t}=this._options;e?this._sessionFlusher=new He(this,{release:e,environment:t}):f.T&&m.vF.warn("Cannot initialise an instance of SessionFlusher if no release is provided!")}captureCheckIn(e,t,n){const i="checkInId"in e&&e.checkInId?e.checkInId:(0,I.eJ)();if(!this._isEnabled())return f.T&&m.vF.warn("SDK not enabled, will not capture checkin."),i;const o=this.getOptions(),{release:r,environment:s,tunnel:c}=o,l={check_in_id:i,monitor_slug:e.monitorSlug,status:e.status,release:r,environment:s};"duration"in e&&(l.duration=e.duration),t&&(l.monitor_config={schedule:t.schedule,checkin_margin:t.checkinMargin,max_runtime:t.maxRuntime,timezone:t.timezone});const[u,d]=this._getTraceInfoFromScope(n);d&&(l.contexts={trace:d});const g=function(e,t,n,i,o){const r={sent_at:(new Date).toISOString()};n&&n.sdk&&(r.sdk={name:n.sdk.name,version:n.sdk.version}),i&&o&&(r.dsn=(0,X.SB)(o)),t&&(r.trace=(0,a.Ce)(t));const s=function(e){return[{type:"check_in"},e]}(e);return(0,x.h4)(r,[s])}(l,u,this.getSdkMetadata(),c,this.getDsn());return f.T&&m.vF.info("Sending checkin:",e.monitorSlug,e.status),this._sendEnvelope(g),i}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():f.T&&m.vF.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(e,t,n,i){return this._options.platform&&(e.platform=e.platform||this._options.platform),this._options.runtime&&(e.contexts={...e.contexts,runtime:(e.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(e.server_name=e.server_name||this._options.serverName),super._prepareEvent(e,t,n,i)}_getTraceInfoFromScope(e){if(!e)return[void 0,void 0];const t=e.getSpan();if(t)return[(0,Ye.z)(t)?(0,D.k)(t):void 0,(0,re.kX)(t)];const{traceId:n,spanId:i,parentSpanId:o,dsc:r}=e.getPropagationContext(),s={trace_id:n,span_id:i,parent_span_id:o};return r?[r,s]:[(0,D.l)(n,this,e),s]}}class Fe extends Xe{constructor(e){!function(e,t,n=[t],i="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${i}:@sentry/${e}`,version:ve.M}))),version:ve.M}),e._metadata=o}(e,"node"),e.transportOptions={textEncoder:new Ne.TextEncoder,...e.transportOptions},super({...e,platform:"node",runtime:{name:"node",version:global.process.version},serverName:e.serverName||global.process.env.SENTRY_NAME||Te.hostname()})}}function xe(e,t){return null!=e?e:t()}var Ee=n(8611),Je=n(5692),Ke=n(2203),Pe=n(7016);const ze=require("zlib");var Ue=n(853),Oe=n(9278);const Le=require("tls"),De=Symbol("AgentBaseInternalState");class je extends Ee.Agent{constructor(e){super(e),this[De]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}const{stack:t}=new Error;return"string"==typeof t&&t.split("\n").some((e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:")))}createSocket(e,t,n){const i={...t,secureEndpoint:this.isSecureEndpoint(t)};Promise.resolve().then((()=>this.connect(e,i))).then((o=>{if(o instanceof Ee.Agent)return o.addRequest(e,i);this[De].currentSocket=o,super.createSocket(e,t,n)}),n)}createConnection(){const e=this[De].currentSocket;if(this[De].currentSocket=void 0,!e)throw new Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return xe(this[De].defaultPort,(()=>"https:"===this.protocol?443:80))}set defaultPort(e){this[De]&&(this[De].defaultPort=e)}get protocol(){return xe(this[De].protocol,(()=>this.isSecureEndpoint()?"https:":"http:"))}set protocol(e){this[De]&&(this[De].protocol=e)}}function Me(...e){m.vF.log("[https-proxy-agent:parse-proxy-response]",...e)}function Qe(...e){m.vF.log("[https-proxy-agent]",...e)}class qe extends je{static __initStatic(){this.protocols=["http","https"]}constructor(e,t){super(t),this.options={},this.proxy="string"==typeof e?new Pe.URL(e):e,this.proxyHeaders=xe((0,Ue.z)([t,"optionalAccess",e=>e.headers]),(()=>({}))),Qe("Creating new HttpsProxyAgent instance: %o",this.proxy.href);const n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?et(t,"headers"):null,host:n,port:i}}async connect(e,t){const{proxy:n}=this;if(!t.host)throw new TypeError('No "host" provided');let i;if("https:"===n.protocol){Qe("Creating `tls.Socket`: %o",this.connectOpts);const e=this.connectOpts.servername||this.connectOpts.host;i=Le.connect({...this.connectOpts,servername:e&&Oe.isIP(e)?void 0:e})}else Qe("Creating `net.Socket`: %o",this.connectOpts),i=Oe.connect(this.connectOpts);const o="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},r=Oe.isIPv6(t.host)?`[${t.host}]`:t.host;let s=`CONNECT ${r}:${t.port} HTTP/1.1\r\n`;if(n.username||n.password){const e=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}o.Host=`${r}:${t.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close");for(const e of Object.keys(o))s+=`${e}: ${o[e]}\r\n`;const a=function(e){return new Promise(((t,n)=>{let i=0;const o=[];function r(){const a=e.read();a?function(a){o.push(a),i+=a.length;const c=Buffer.concat(o,i),l=c.indexOf("\r\n\r\n");if(-1===l)return Me("have not received end of HTTP headers yet..."),void r();const u=c.slice(0,l).toString("ascii").split("\r\n"),d=u.shift();if(!d)return e.destroy(),n(new Error("No header received from proxy CONNECT response"));const g=d.split(" "),p=+g[1],h=g.slice(2).join(" "),m={};for(const t of u){if(!t)continue;const i=t.indexOf(":");if(-1===i)return e.destroy(),n(new Error(`Invalid header from proxy CONNECT response: "${t}"`));const o=t.slice(0,i).toLowerCase(),r=t.slice(i+1).trimStart(),s=m[o];"string"==typeof s?m[o]=[s,r]:Array.isArray(s)?s.push(r):m[o]=r}Me("got proxy server response: %o %o",d,m),s(),t({connect:{statusCode:p,statusText:h,headers:m},buffered:c})}(a):e.once("readable",r)}function s(){e.removeListener("end",a),e.removeListener("error",c),e.removeListener("readable",r)}function a(){s(),Me("onend"),n(new Error("Proxy connection ended before receiving CONNECT response"))}function c(e){s(),Me("onerror %o",e),n(e)}e.on("error",c),e.on("end",a),r()}))}(i);i.write(`${s}\r\n`);const{connect:c,buffered:l}=await a;if(e.emit("proxyConnect",c),this.emit("proxyConnect",c,e),200===c.statusCode){if(e.once("socket",$e),t.secureEndpoint){Qe("Upgrading socket connection to TLS");const e=t.servername||t.host;return Le.connect({...et(t,"host","path","port"),socket:i,servername:Oe.isIP(e)?void 0:e})}return i}i.destroy();const u=new Oe.Socket({writable:!1});return u.readable=!0,e.once("socket",(e=>{Qe("Replaying proxy buffer for failed request"),e.push(l),e.push(null)})),u}}function $e(e){e.resume()}function et(e,...t){const n={};let i;for(i in e)t.includes(i)||(n[i]=e[i]);return n}qe.__initStatic();const tt=32768;function nt(e){let t;try{t=new Pe.URL(e.url)}catch(t){return(0,m.pq)((()=>{console.warn("[@sentry/node]: Invalid dsn or tunnel option, will not send any events. The tunnel option must be a full URL when used.")})),ie(e,(()=>Promise.resolve({})))}const n="https:"===t.protocol,i=function(e,t){const{no_proxy:n}=process.env;return n&&n.split(",").some((t=>e.host.endsWith(t)||e.hostname.endsWith(t)))?void 0:t}(t,e.proxy||(n?process.env.https_proxy:void 0)||process.env.http_proxy),o=n?Je:Ee,r=void 0!==e.keepAlive&&e.keepAlive,s=i?new qe(i):new o.Agent({keepAlive:r,maxSockets:30,timeout:2e3}),a=function(e,t,n){const{hostname:i,pathname:o,port:r,protocol:s,search:a}=new Pe.URL(e.url);return function(c){return new Promise(((l,u)=>{let d=function(e){return new Ke.Readable({read(){this.push(e),this.push(null)}})}(c.body);const g={...e.headers};c.body.length>tt&&(g["content-encoding"]="gzip",d=d.pipe((0,ze.createGzip)()));const p=t.request({method:"POST",agent:n,headers:g,hostname:i,path:`${o}${a}`,port:r,protocol:s,ca:e.caCerts},(e=>{e.on("data",(()=>{})),e.on("end",(()=>{})),e.setEncoding("utf8");const t=xe(e.headers["retry-after"],(()=>null)),n=xe(e.headers["x-sentry-rate-limits"],(()=>null));l({statusCode:e.statusCode,headers:{"retry-after":t,"x-sentry-rate-limits":Array.isArray(n)?n[0]:n}})}));p.on("error",u),d.pipe(p)}))}}(e,xe(e.httpModule,(()=>o)),s);return ie(e,a)}var it=n(7930),ot=n(6341),rt=n(6524),st=n(3245);const at=require("domain");function ct(){return at.active}function lt(){const e=ct();if(e)return(0,J.TF)(e),(0,J.Me)(e)}function ut(e,t){const n=ct();if(n&&(0,Ue.z)([t,"optionalAccess",e=>e.reuseExisting]))return e();const i=at.create(),o=function(e){const t={};return(0,J.TF)(t,e),(0,J.Me)(t)}(n?(0,J.Me)(n):void 0);return(0,J.lq)(i,o),i.bind((()=>e()))()}const dt=require("async_hooks");let gt;function pt(){st.S.major>=14?function(){function e(){return gt.getStore()}gt||(gt=new dt.AsyncLocalStorage),(0,J.nX)({getCurrentHub:e,runWithAsyncContext:function(t,n){const i=e();if(i&&(0,Ue.z)([n,"optionalAccess",e=>e.reuseExisting]))return t();const o=function(e){const t={};return(0,J.TF)(t,e),(0,J.Me)(t)}(i);return gt.run(o,(()=>t()))}})}():(0,J.nX)({getCurrentHub:lt,runWithAsyncContext:ut})}var ht=n(718);function mt(){"console"in ot.OW&&m.Ow.forEach((function(e){e in ot.OW.console&&(0,a.GS)(ot.OW.console,e,(function(t){return m.Z9[e]=t,function(...t){const n={args:t,level:e};(0,ht.aj)("console",n);const i=m.Z9[e];i&&i.apply(ot.OW.console,t)}}))}))}const It=["fatal","error","warning","log","info","debug"];function bt(e){return"warn"===e?"warning":It.includes(e)?e:"log"}const ft="Console",yt=(0,l._C)((()=>({name:ft,setupOnce(){},setup(e){!function(t){const n="console";(0,ht.s5)(n,(({args:t,level:n})=>{(0,c.KU)()===e&&(0,c.ZQ)({category:"console",level:bt(n),message:Ne.format.apply(void 0,t)},{input:[...t],level:n})})),(0,ht.AS)(n,mt)}()}}))),Ct=(0,l.F)(ft,yt),vt=require("child_process"),At=require("fs");var Zt=n(6928);const Gt=(0,Ne.promisify)(At.readFile),Bt=(0,Ne.promisify)(At.readdir),wt="Context",St=(0,l._C)(((e={})=>{let t;const n={app:!0,os:!0,device:!0,culture:!0,cloudResource:!0,...e};return{name:wt,setupOnce(){},processEvent:e=>async function(e){void 0===t&&(t=async function(){const e={};if(n.os&&(e.os=await async function(){const e=Te.platform();switch(e){case"darwin":return async function(){const e={kernel_version:Te.release(),name:"Mac OS X",version:"10."+(Number(Te.release().split(".")[0])-4)};try{const t=await new Promise(((e,t)=>{(0,vt.execFile)("/usr/bin/sw_vers",((n,i)=>{n?t(n):e(i)}))}));e.name=Nt(/^ProductName:\s+(.*)$/m,t),e.version=Nt(/^ProductVersion:\s+(.*)$/m,t),e.build=Nt(/^BuildVersion:\s+(.*)$/m,t)}catch(e){}return e}();case"linux":return async function(){const e={kernel_version:Te.release(),name:"Linux"};try{const t=await Bt("/etc"),n=Rt.find((e=>t.includes(e.name)));if(!n)return e;const i=(0,Zt.join)("/etc",n.name),o=(await Gt(i,{encoding:"utf-8"})).toLowerCase(),{distros:r}=n;e.name=r.find((e=>o.indexOf(_t(e))>=0))||r[0];const s=_t(e.name);e.version=Tt[s](o)}catch(e){}return e}();default:return{name:Wt[e]||e,version:Te.release()}}}()),n.app&&(e.app=function(){const e=process.memoryUsage().rss;return{app_start_time:new Date(Date.now()-1e3*process.uptime()).toISOString(),app_memory:e}}()),n.device&&(e.device=function(e){const t={};let n;try{n=Te.uptime&&Te.uptime()}catch(e){}if("number"==typeof n&&(t.boot_time=new Date(Date.now()-1e3*n).toISOString()),t.arch=Te.arch(),(!0===e||e.memory)&&(t.memory_size=Te.totalmem(),t.free_memory=Te.freemem()),!0===e||e.cpu){const e=Te.cpus();if(e&&e.length){const n=e[0];t.processor_count=e.length,t.cpu_description=n.model,t.processor_frequency=n.speed}}return t}(n.device)),n.culture){const t=function(){try{if("string"!=typeof process.versions.icu)return;const e=new Date(9e8);if("enero"===new Intl.DateTimeFormat("es",{month:"long"}).format(e)){const e=Intl.DateTimeFormat().resolvedOptions();return{locale:e.locale,timezone:e.timeZone}}}catch(e){}}();t&&(e.culture=t)}return n.cloudResource&&(e.cloud_resource=process.env.VERCEL?{"cloud.provider":"vercel","cloud.region":process.env.VERCEL_REGION}:process.env.AWS_REGION?{"cloud.provider":"aws","cloud.region":process.env.AWS_REGION,"cloud.platform":process.env.AWS_EXECUTION_ENV}:process.env.GCP_PROJECT?{"cloud.provider":"gcp"}:process.env.ALIYUN_REGION_ID?{"cloud.provider":"alibaba_cloud","cloud.region":process.env.ALIYUN_REGION_ID}:process.env.WEBSITE_SITE_NAME&&process.env.REGION_NAME?{"cloud.provider":"azure","cloud.region":process.env.REGION_NAME}:process.env.IBM_CLOUD_REGION?{"cloud.provider":"ibm_cloud","cloud.region":process.env.IBM_CLOUD_REGION}:process.env.TENCENTCLOUD_REGION?{"cloud.provider":"tencent_cloud","cloud.region":process.env.TENCENTCLOUD_REGION,"cloud.account.id":process.env.TENCENTCLOUD_APPID,"cloud.availability_zone":process.env.TENCENTCLOUD_ZONE}:process.env.NETLIFY?{"cloud.provider":"netlify"}:process.env.FLY_REGION?{"cloud.provider":"fly.io","cloud.region":process.env.FLY_REGION}:process.env.DYNO?{"cloud.provider":"heroku"}:void 0),e}());const i=(o=await t,(0,Ue.z)([o,"optionalAccess",e=>e.app,"optionalAccess",e=>e.app_memory])&&(o.app.app_memory=process.memoryUsage().rss),(0,Ue.z)([o,"optionalAccess",e=>e.device,"optionalAccess",e=>e.free_memory])&&(o.device.free_memory=Te.freemem()),o);var o;return e.contexts={...e.contexts,app:{...i.app,...(0,Ue.z)([e,"access",e=>e.contexts,"optionalAccess",e=>e.app])},os:{...i.os,...(0,Ue.z)([e,"access",e=>e.contexts,"optionalAccess",e=>e.os])},device:{...i.device,...(0,Ue.z)([e,"access",e=>e.contexts,"optionalAccess",e=>e.device])},culture:{...i.culture,...(0,Ue.z)([e,"access",e=>e.contexts,"optionalAccess",e=>e.culture])},cloud_resource:{...i.cloud_resource,...(0,Ue.z)([e,"access",e=>e.contexts,"optionalAccess",e=>e.cloud_resource])}},e}(e)}})),Vt=(0,l.F)(wt,St),Wt={aix:"IBM AIX",freebsd:"FreeBSD",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"},Rt=[{name:"fedora-release",distros:["Fedora"]},{name:"redhat-release",distros:["Red Hat Linux","Centos"]},{name:"redhat_version",distros:["Red Hat Linux"]},{name:"SuSE-release",distros:["SUSE Linux"]},{name:"lsb-release",distros:["Ubuntu Linux","Arch Linux"]},{name:"debian_version",distros:["Debian"]},{name:"debian_release",distros:["Debian"]},{name:"arch-release",distros:["Arch Linux"]},{name:"gentoo-release",distros:["Gentoo Linux"]},{name:"novell-release",distros:["SUSE Linux"]},{name:"alpine-release",distros:["Alpine Linux"]}],Tt={alpine:e=>e,arch:e=>Nt(/distrib_release=(.*)/,e),centos:e=>Nt(/release ([^ ]+)/,e),debian:e=>e,fedora:e=>Nt(/release (..)/,e),mint:e=>Nt(/distrib_release=(.*)/,e),red:e=>Nt(/release ([^ ]+)/,e),suse:e=>Nt(/VERSION = (.*)\n/,e),ubuntu:e=>Nt(/distrib_release=(.*)/,e)};function Nt(e,t){const n=e.exec(t);return n?n[1]:void 0}function _t(e){return e.split(" ")[0].toLowerCase()}class Ht{constructor(e){this._maxSize=e,this._cache=new Map}get size(){return this._cache.size}get(e){const t=this._cache.get(e);if(void 0!==t)return this._cache.delete(e),this._cache.set(e,t),t}set(e,t){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(e,t)}remove(e){const t=this._cache.get(e);return t&&this._cache.delete(e),t}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){const e=[];return this._cache.forEach((t=>e.push(t))),e}}const kt=new Ht(100),Yt="ContextLines",Xt=(0,l._C)(((e={})=>{const t=void 0!==e.frameContextLines?e.frameContextLines:7;return{name:Yt,setupOnce(){},processEvent:e=>async function(e,t){const n={},i=[];if(t>0&&(0,Ue.z)([e,"access",e=>e.exception,"optionalAccess",e=>e.values]))for(const t of e.exception.values)if((0,Ue.z)([t,"access",e=>e.stacktrace,"optionalAccess",e=>e.frames]))for(let e=t.stacktrace.frames.length-1;e>=0;e--){const o=t.stacktrace.frames[e];!o.filename||n[o.filename]||kt.get(o.filename)||(i.push(Et(o.filename)),n[o.filename]=1)}if(i.length>0&&await Promise.all(i),t>0&&(0,Ue.z)([e,"access",e=>e.exception,"optionalAccess",e=>e.values]))for(const n of e.exception.values)n.stacktrace&&n.stacktrace.frames&&await xt(n.stacktrace.frames,t);return e}(e,t)}})),Ft=(0,l.F)(Yt,Xt);function xt(e,t){for(const n of e)if(n.filename&&void 0===n.context_line){const e=kt.get(n.filename);if(e)try{(0,I.db)(e,n,t)}catch(e){}}}async function Et(e){const t=kt.get(e);if(null===t)return null;if(void 0!==t)return t;let n=null;try{n=(await(i=e,new Promise(((e,t)=>{(0,At.readFile)(i,"utf8",((n,i)=>{n?t(n):e(i)}))})))).split("\n")}catch(e){}var i;return kt.set(e,n),n}function Jt(e,t){const n=t&&function(e){return void 0!==e.getClient}(t)?t.getClient():t,i=n&&n.getDsn(),o=n&&n.getOptions().tunnel;return function(e,t){return!!t&&e.includes(t.host)}(e,i)||function(e,t){return!!t&&Kt(e)===Kt(t)}(e,o)}function Kt(e){return"/"===e[e.length-1]?e.slice(0,-1):e}var Pt=n(3551),zt=n(5584);const Ut="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function Ot(e){const{protocol:t,hostname:n,port:i}=jt(e),o=e.pathname||"/";return`${t}//${e.auth?function(e){const[t,n]=e.split(":");return`${t?"[Filtered]":""}:${n?"[Filtered]":""}@`}(e.auth):""}${n}${i}${o}`}function Lt(e,t,n){if(!e)return e;let[i,o]=e.split(" ");return t.host&&!t.protocol&&(t.protocol=(0,Ue.z)([n,"optionalAccess",e=>e.agent,"optionalAccess",e=>e.protocol]),o=Ot(t)),(0,Ue.z)([o,"optionalAccess",e=>e.startsWith,"call",e=>e("///")])&&(o=o.slice(2)),`${i} ${o}`}function Dt(e){const t={protocol:e.protocol,hostname:"string"==typeof e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return""!==e.port&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t}function jt(e){const t=e.protocol||"",n=e.hostname||e.host||"";return{protocol:t,hostname:n,port:!e.port||80===e.port||443===e.port||/^(.*):(\d+)$/.test(n)?"":`:${e.port}`}}const Mt=(0,l._C)(((e={})=>{const{breadcrumbs:t,tracing:n,shouldCreateSpanForRequest:i}=e,o={breadcrumbs:t,tracing:!1!==n&&(0,a.Ce)({enableIfHasTracingEnabled:!0!==n||void 0,shouldCreateSpanForRequest:i})};return new Qt(o)}));class Qt{static __initStatic(){this.id="Http"}__init(){this.name=Qt.id}constructor(e={}){Qt.prototype.__init.call(this),this._breadcrumbs=void 0===e.breadcrumbs||e.breadcrumbs,this._tracing=e.tracing?!0===e.tracing?{}:e.tracing:void 0}setupOnce(e,t){const i=(0,Ue.z)([t,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]),o=function(e,t){return void 0!==e&&(!e.enableIfHasTracingEnabled||(0,Pt.w)(t))}(this._tracing,i);if(!this._breadcrumbs&&!o)return;if(i&&"sentry"!==i.instrumenter)return void(Ut&&m.vF.log("HTTP Integration is skipped because of instrumenter configuration."));const r=function(e,t,n){return e?(0,Ue.z)([t,"optionalAccess",e=>e.shouldCreateSpanForRequest])||(0,Ue.z)([n,"optionalAccess",e=>e.shouldCreateSpanForRequest]):()=>!1}(o,this._tracing,i),s=(0,Ue.z)([i,"optionalAccess",e=>e.tracePropagationTargets])||(0,Ue.z)([this,"access",e=>e._tracing,"optionalAccess",e=>e.tracePropagationTargets]),c=n(8611),l=qt(c,this._breadcrumbs,r,s);if((0,a.GS)(c,"get",l),(0,a.GS)(c,"request",l),st.S.major>8){const e=n(5692),t=qt(e,this._breadcrumbs,r,s);(0,a.GS)(e,"get",t),(0,a.GS)(e,"request",t)}}}function qt(e,t,n,i){const o=new Ht(100),r=new Ht(100);function s(e,t,n,i){(0,J.BF)().getIntegration(Qt)&&(0,c.ZQ)({category:"http",data:{status_code:i&&i.statusCode,...t},type:"http"},{event:e,request:n,response:i})}return function(a){return function(...l){const u=function(e,t){let n,i;if("function"==typeof t[t.length-1]&&(n=t.pop()),"string"==typeof t[0])i=Dt(new Pe.URL(t[0]));else if(t[0]instanceof Pe.URL)i=Dt(t[0]);else{i=t[0];try{const e=new Pe.URL(i.path||"",`${i.protocol||"http:"}//${i.hostname}`);i={pathname:e.pathname,search:e.search,hash:e.hash,...i}}catch(e){}}return 2===t.length&&(i={...i,...t[1]}),void 0===i.protocol&&(st.S.major>8?i.protocol=(0,Ue.z)([(0,Ue.z)([e,"optionalAccess",e=>e.globalAgent]),"optionalAccess",e=>e.protocol])||(0,Ue.z)([i.agent,"optionalAccess",e=>e.protocol])||(0,Ue.z)([i._defaultAgent,"optionalAccess",e=>e.protocol]):i.protocol=(0,Ue.z)([i.agent,"optionalAccess",e=>e.protocol])||(0,Ue.z)([i._defaultAgent,"optionalAccess",e=>e.protocol])||(0,Ue.z)([(0,Ue.z)([e,"optionalAccess",e=>e.globalAgent]),"optionalAccess",e=>e.protocol])),n?[i,n]:[i]}(e,l),d=u[0],g=function(e){const{protocol:t,hostname:n,port:i}=jt(e);return`${t}//${n}${i}${e.path?e.path:"/"}`}(d),p=Ot(d),h=(0,c.KU)();if(Jt(p,h))return a.apply(e,u);const I=(0,c.o5)(),f=(0,J.rm)(),y=(0,Be.Bk)(),C=function(e,t){const n={url:e,"http.method":t.method||"GET"};return t.hash&&(n["http.fragment"]=t.hash.substring(1)),t.search&&(n["http.query"]=t.search.substring(1)),n}(p,d),v=(e=>{if(void 0===n)return!0;const t=o.get(e);if(void 0!==t)return t;const i=n(e);return o.set(e,i),i})(g)?(0,Ue.z)([y,"optionalAccess",e=>e.startChild,"call",e=>e({op:"http.client",origin:"auto.http.node.http",description:`${C["http.method"]} ${C.url}`,data:C})]):void 0;if(h&&(e=>{if(void 0===i)return!0;const t=r.get(e);if(void 0!==t)return t;const n=(0,b.Xr)(e,i);return r.set(e,n),n})(g)){const{traceId:e,spanId:t,sampled:n,dsc:i}={...f.getPropagationContext(),...I.getPropagationContext()},o=v?(0,re.Qh)(v):(0,rt.TC)(e,t,n),r=(0,zt.De)(i||(v?(0,D.k)(v):(0,D.l)(e,h,I)));!function(e,t,n,i){(e.headers||{})["sentry-trace"]||(Ut&&m.vF.log(`[Tracing] Adding sentry-trace header ${n} to outgoing request to "${t}": `),e.headers={...e.headers,"sentry-trace":n,...i&&i.length>0&&{baggage:$t(e,i)}})}(d,p,o,r)}else Ut&&m.vF.log(`[Tracing] Not adding sentry-trace header to outgoing request (${p}) due to mismatching tracePropagationTargets option.`);return a.apply(e,u).once("response",(function(e){t&&s("response",C,this,e),v&&(e.statusCode&&(0,Se.N8)(v,e.statusCode),v.updateName(Lt((0,re.et)(v).description||"",d,this)||""),v.end())})).once("error",(function(){t&&s("error",C,this),v&&((0,Se.N8)(v,500),v.updateName(Lt((0,re.et)(v).description||"",d,this)||""),v.end())}))}}}function $t(e,t){return e.headers&&e.headers.baggage?t?Array.isArray(e.headers.baggage)?[...e.headers.baggage,t]:[e.headers.baggage,t]:e.headers.baggage:t}function en(e){return void 0!==e&&(0===e.length||"?"===e||"<anonymous>"===e)}function tn(e){if(void 0!==e)return e.slice(-10).reduce(((e,t)=>`${e},${t.function},${t.lineno},${t.colno}`),"")}function nn(e){let t=[],n=!1;function i(i){t=[],n||(n=!0,e(i))}return t.push(i),{add:function(e){t.push(e)},next:function(e){const n=t.pop()||i;try{n(e)}catch(t){i(e)}}}}Qt.__initStatic();class on{constructor(){const{Session:e}=n(264);this._session=new e}configureAndConnect(e,t){this._session.connect(),this._session.on("Debugger.paused",(t=>{e(t,(()=>{this._session.post("Debugger.resume")}))})),this._session.post("Debugger.enable"),this._session.post("Debugger.setPauseOnExceptions",{state:t?"all":"uncaught"})}setPauseOnExceptions(e){this._session.post("Debugger.setPauseOnExceptions",{state:e?"all":"uncaught"})}getLocalVariables(e,t){this._getProperties(e,(e=>{const{add:n,next:i}=nn(t);for(const t of e)if((0,Ue.z)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.objectId])&&"Array"===(0,Ue.z)([t,"optionalAccess",e=>e.value,"access",e=>e.className])){const e=t.value.objectId;n((n=>this._unrollArray(e,t.name,n,i)))}else if((0,Ue.z)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.objectId])&&"Object"===(0,Ue.z)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.className])){const e=t.value.objectId;n((n=>this._unrollObject(e,t.name,n,i)))}else((0,Ue.z)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])||(0,Ue.z)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.description]))&&n((e=>this._unrollOther(t,e,i)));i({})}))}_getProperties(e,t){this._session.post("Runtime.getProperties",{objectId:e,ownProperties:!0},((e,n)=>{t(e?[]:n.result)}))}_unrollArray(e,t,n,i){this._getProperties(e,(e=>{n[t]=e.filter((e=>"length"!==e.name&&!isNaN(parseInt(e.name,10)))).sort(((e,t)=>parseInt(e.name,10)-parseInt(t.name,10))).map((e=>(0,Ue.z)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value]))),i(n)}))}_unrollObject(e,t,n,i){this._getProperties(e,(e=>{n[t]=e.map((e=>[e.name,(0,Ue.z)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])])).reduce(((e,[t,n])=>(e[t]=n,e)),{}),i(n)}))}_unrollOther(e,t,n){(0,Ue.z)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])?t[e.name]=e.value.value:(0,Ue.z)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.description])&&"function"!==(0,Ue.z)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.type])&&(t[e.name]=`<${e.value.description}>`),n(t)}}const rn="LocalVariables",sn=(0,l._C)(((e={},t=function(){try{return new on}catch(e){return}}())=>{const n=new Ht(20);let i,o=!1;function r(e){const t=tn((0,Ue.z)([e,"optionalAccess",e=>e.stacktrace,"optionalAccess",e=>e.frames]));if(void 0===t)return;const i=n.remove(t);if(void 0===i)return;const o=(0,Ue.z)([e,"access",e=>e.stacktrace,"optionalAccess",e=>e.frames,"optionalAccess",e=>e.length])||0;for(let t=0;t<o;t++){const n=o-t-1;if(!(0,Ue.z)([e,"optionalAccess",e=>e.stacktrace,"optionalAccess",e=>e.frames,"optionalAccess",e=>e[n]])||!i[t])break;void 0!==i[t].vars&&!1!==e.stacktrace.frames[n].in_app&&((r=e.stacktrace.frames[n].function)===(s=i[t].function)||en(r)&&en(s))&&(e.stacktrace.frames[n].vars=i[t].vars)}var r,s}return{name:rn,setupOnce(){const r=(0,c.KU)(),s=(0,Ue.z)([r,"optionalAccess",e=>e.getOptions,"call",e=>e()]);if(t&&(0,Ue.z)([s,"optionalAccess",e=>e.includeLocalVariables])){if(st.S.major<18)return void m.vF.log("The `LocalVariables` integration is only supported on Node >= v18.");const r=!1!==e.captureAllExceptions;if(t.configureAndConnect(((e,o)=>function(e,{params:{reason:o,data:r,callFrames:s}},a){if("exception"!==o&&"promiseRejection"!==o)return void a();(0,Ue.z)([i,"optionalCall",e=>e()]);const c=function(e,t){if(void 0!==t)return tn(e(t,1))}(e,(0,Ue.z)([r,"optionalAccess",e=>e.description]));if(null==c)return void a();const{add:l,next:u}=nn((e=>{n.set(c,e),a()}));for(let e=0;e<Math.min(s.length,5);e++){const{scopeChain:n,functionName:i,this:o}=s[e],r=n.find((e=>"local"===e.type)),a="global"!==o.className&&o.className?`${o.className}.${i}`:i;if(void 0===(0,Ue.z)([r,"optionalAccess",e=>e.object,"access",e=>e.objectId]))l((t=>{t[e]={function:a},u(t)}));else{const n=r.object.objectId;l((i=>(0,Ue.z)([t,"optionalAccess",e=>e.getLocalVariables,"call",t=>t(n,(t=>{i[e]={function:a,vars:t},u(i)}))])))}}u([])}(s.stackParser,e,o)),r),r){const n=e.maxExceptionsPerSecond||50;i=function(e,n,i){let o=0,r=5,s=0;return setInterval((()=>{var n;0===s?o>e&&(r*=2,n=r,m.vF.log(`Local variables rate-limit exceeded. Disabling capturing of caught exceptions for ${n} seconds.`),(0,Ue.z)([t,"optionalAccess",e=>e.setPauseOnExceptions,"call",e=>e(!1)]),r>86400&&(r=86400),s=r):(s-=1,0===s&&(m.vF.log("Local variables rate-limit lifted."),(0,Ue.z)([t,"optionalAccess",e=>e.setPauseOnExceptions,"call",e=>e(!0)]))),o=0}),1e3).unref(),()=>{o+=1}}(n)}o=!0}},processEvent:e=>o?function(e){for(const t of(0,Ue.z)([e,"optionalAccess",e=>e.exception,"optionalAccess",e=>e.values])||[])r(t);return e}(e):e,_getCachedFramesCount:()=>n.size,_getFirstCachedFrame:()=>n.values()[0]}})),an=(0,l.F)(rn,sn),cn=sn;let ln;const un="Modules";function dn(){const e=n.c[n.s]&&n.c[n.s].paths||[],t=function(){try{return n.c?Object.keys(n.c):[]}catch(e){return[]}}(),i={},o={};return t.forEach((t=>{let n=t;const r=()=>{const t=n;if(n=(0,Zt.dirname)(t),!n||t===n||o[t])return;if(e.indexOf(n)<0)return r();const s=(0,Zt.join)(t,"package.json");if(o[t]=!0,!(0,At.existsSync)(s))return r();try{const e=JSON.parse((0,At.readFileSync)(s,"utf8"));i[e.name]=e.version}catch(e){}};r()})),i}const gn=(0,l._C)((()=>({name:un,setupOnce(){},processEvent:e=>(e.modules={...e.modules,...(ln||(ln=dn()),ln)},e)}))),pn=(0,l.F)(un,gn);function hn(e){(0,m.pq)((()=>{console.error(e)}));const t=(0,c.KU)();void 0===t&&(Ut&&m.vF.warn("No NodeClient was defined, we are exiting the process now."),global.process.exit(1));const n=t.getOptions(),i=n&&n.shutdownTimeout&&n.shutdownTimeout>0&&n.shutdownTimeout||2e3;t.close(i).then((e=>{e||Ut&&m.vF.warn("We reached the timeout for emptying the request buffer, still exiting now!"),global.process.exit(1)}),(e=>{Ut&&m.vF.error(e)}))}const mn="OnUncaughtException",In=(0,l._C)(((e={})=>{const t={exitEvenIfOtherHandlersAreRegistered:!0,...e};return{name:mn,setupOnce(){},setup(e){global.process.on("uncaughtException",function(e,t){let n,i=!1,o=!1,r=!1;const s=e.getOptions();return Object.assign((a=>{let l=hn;t.onFatalError?l=t.onFatalError:s.onFatalError&&(l=s.onFatalError);const u=0===global.process.listeners("uncaughtException").reduce(((e,t)=>"domainUncaughtExceptionClear"===t.name||t.tag&&"sentry_tracingErrorCallback"===t.tag||t._errorHandler?e:e+1),0),d=t.exitEvenIfOtherHandlersAreRegistered||u;i?d&&(r?(Ut&&m.vF.warn("uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown"),hn(a)):o||(o=!0,setTimeout((()=>{r||(r=!0,l(n,a))}),2e3))):(n=a,i=!0,(0,c.KU)()===e&&(0,c.Cp)(a,{originalException:a,captureContext:{level:"fatal"},mechanism:{handled:!1,type:"onuncaughtexception"}}),!r&&d&&(r=!0,l(a)))}),{_errorHandler:!0})}(e,t))}}})),bn=(0,l.F)(mn,In),fn="OnUnhandledRejection",yn=(0,l._C)(((e={})=>{const t=e.mode||"warn";return{name:fn,setupOnce(){},setup(e){global.process.on("unhandledRejection",function(e,t){return function(n,i){(0,c.KU)()===e&&((0,c.Cp)(n,{originalException:i,captureContext:{extra:{unhandledPromiseRejection:!0}},mechanism:{handled:!1,type:"onunhandledrejection"}}),function(e,t){const n="This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:";"warn"===t.mode?(0,m.pq)((()=>{console.warn(n),console.error(e&&e.stack?e.stack:e)})):"strict"===t.mode&&((0,m.pq)((()=>{console.warn(n)})),hn(e))}(n,t))}}(e,{mode:t}))}}})),Cn=(0,l.F)(fn,yn),vn="Spotlight",An=(0,l._C)(((e={})=>{const t={sidecarUrl:e.sidecarUrl||"http://localhost:8969/stream"};return{name:vn,setupOnce(){},setup(e){"object"==typeof process&&process.env&&m.vF.warn("[Spotlight] It seems you're not in dev mode. Do you really want to have Spotlight enabled?"),function(e,t){const n=function(e){try{return new Pe.URL(`${e}`)}catch(t){return void m.vF.warn(`[Spotlight] Invalid sidecar URL: ${e}`)}}(t.sidecarUrl);if(!n)return;let i=0;"function"==typeof e.on?e.on("beforeEnvelope",(e=>{if(i>3)return void m.vF.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests");const t=(0,x.bN)(e),o=function(){const{request:e}=Ee;return"__sentry_original__"in e?e.__sentry_original__:e}()({method:"POST",path:n.pathname,hostname:n.hostname,port:n.port,headers:{"Content-Type":"application/x-sentry-envelope"}},(e=>{e.on("data",(()=>{})),e.on("end",(()=>{})),e.setEncoding("utf8")}));o.on("error",(()=>{i++,m.vF.warn("[Spotlight] Failed to send envelope to Spotlight Sidecar")})),o.write(t),o.end()})):m.vF.warn("[Spotlight] Cannot connect to spotlight due to missing method on SDK client (`client.on`)")}(e,t)}}})),Zn=(0,l.F)(vn,An);var Gn,Bn=n(2879);!function(e){e.RequestCreate="undici:request:create",e.RequestEnd="undici:request:headers",e.RequestError="undici:request:error"}(Gn||(Gn={}));const wn=(0,l._C)((e=>new Sn(e)));class Sn{static __initStatic(){this.id="Undici"}__init(){this.name=Sn.id}__init2(){this._createSpanUrlMap=new Ht(100)}__init3(){this._headersUrlMap=new Ht(100)}constructor(e={}){Sn.prototype.__init.call(this),Sn.prototype.__init2.call(this),Sn.prototype.__init3.call(this),Sn.prototype.__init4.call(this),Sn.prototype.__init5.call(this),Sn.prototype.__init6.call(this),this._options={breadcrumbs:void 0===e.breadcrumbs||e.breadcrumbs,tracing:e.tracing,shouldCreateSpanForRequest:e.shouldCreateSpanForRequest}}setupOnce(e){if(st.S.major<16)return;let t;try{t=n(1637)}catch(e){}t&&t.subscribe&&(t.subscribe(Gn.RequestCreate,this._onRequestCreate),t.subscribe(Gn.RequestEnd,this._onRequestEnd),t.subscribe(Gn.RequestError,this._onRequestError))}_shouldCreateSpan(e){if(!1===this._options.tracing||void 0===this._options.tracing&&!(0,Pt.w)())return!1;if(void 0===this._options.shouldCreateSpanForRequest)return!0;const t=this._createSpanUrlMap.get(e);if(void 0!==t)return t;const n=this._options.shouldCreateSpanForRequest(e);return this._createSpanUrlMap.set(e,n),n}__init4(){this._onRequestCreate=e=>{if(!(0,Ue.z)([c.KU,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(Sn)]))return;const{request:t}=e,n=t.origin?t.origin.toString()+t.path:t.path,i=(0,c.KU)();if(!i)return;if(Jt(n,i)||void 0!==t.__sentry_span__)return;const o=i.getOptions(),r=(0,c.o5)(),s=(0,J.rm)(),a=(0,Be.Bk)(),l=this._shouldCreateSpan(n)?function(e,t,n){const i=(0,Bn.Dl)(n),o=t.method||"GET",r={"http.method":o};return i.search&&(r["http.query"]=i.search),i.hash&&(r["http.fragment"]=i.hash),(0,Ue.z)([e,"optionalAccess",e=>e.startChild,"call",e=>e({op:"http.client",origin:"auto.http.node.undici",description:`${o} ${(0,Bn.e_)(i)}`,data:r})])}(a,t,n):void 0;if(l&&(t.__sentry_span__=l),(e=>{if(void 0===o.tracePropagationTargets)return!0;const t=this._headersUrlMap.get(e);if(void 0!==t)return t;const n=(0,b.Xr)(e,o.tracePropagationTargets);return this._headersUrlMap.set(e,n),n})(n)){const{traceId:e,spanId:n,sampled:o,dsc:a}={...s.getPropagationContext(),...r.getPropagationContext()};!function(e,t,n){let i;i=Array.isArray(e.headers)?e.headers.some((e=>"sentry-trace"===e)):e.headers.split("\r\n").some((e=>e.startsWith("sentry-trace:"))),i||(e.addHeader("sentry-trace",t),n&&e.addHeader("baggage",n))}(t,l?(0,re.Qh)(l):(0,rt.TC)(e,n,o),(0,zt.De)(a||(l?(0,D.k)(l):(0,D.l)(e,i,r))))}}}__init5(){this._onRequestEnd=e=>{if(!(0,Ue.z)([c.KU,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(Sn)]))return;const{request:t,response:n}=e,i=t.origin?t.origin.toString()+t.path:t.path;if(Jt(i,(0,c.KU)()))return;const o=t.__sentry_span__;o&&((0,Se.N8)(o,n.statusCode),o.end()),this._options.breadcrumbs&&(0,c.ZQ)({category:"http",data:{method:t.method,status_code:n.statusCode,url:i},type:"http"},{event:"response",request:t,response:n})}}__init6(){this._onRequestError=e=>{if(!(0,Ue.z)([c.KU,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(Sn)]))return;const{request:t}=e,n=t.origin?t.origin.toString()+t.path:t.path;if(Jt(n,(0,c.KU)()))return;const i=t.__sentry_span__;i&&(i.setStatus("internal_error"),i.end()),this._options.breadcrumbs&&(0,c.ZQ)({category:"http",data:{method:t.method,url:n},level:"error",type:"http"},{event:"error",request:t})}}}Sn.__initStatic();const Vn=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function Wn(e){return e.replace(/^[A-Z]:/,"").replace(/\\/g,"/")}function Rn(e=(process.argv[1]?function(e){const t=function(e){const t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=Vn.exec(t);return n?n.slice(1):[]}(process.argv[1]),n=t[0];let i=t[1];return n||i?(i&&(i=i.slice(0,i.length-1)),n+i):"."}():process.cwd()),t="\\"===Zt.sep){const n=t?Wn(e):e;return e=>{if(!e)return;const i=t?Wn(e):e;let{dir:o,base:r,ext:s}=Zt.posix.parse(i);".js"!==s&&".mjs"!==s&&".cjs"!==s||(r=r.slice(0,-1*s.length)),o||(o=".");const a=o.lastIndexOf("/node_modules");if(a>-1)return`${o.slice(a+14).replace(/\//g,".")}:${r}`;if(o.startsWith(n)){let e=o.slice(n.length+1).replace(/\//g,".");return e&&(e+=":"),e+=r,e}return r}}const Tn=[A(),p(),H(),fe(),yt(),Mt(),wn(),In(),yn(),Xt(),cn(),St(),gn()];function Nn(e){const t=(0,J.EU)(),n=(0,Ue.z)([t,"access",e=>e.__SENTRY__,"optionalAccess",e=>e.integrations])||[];return[...Tn,...n]}function _n(e={}){pt(),void 0===e.defaultIntegrations&&(e.defaultIntegrations=Nn()),void 0===e.dsn&&process.env.SENTRY_DSN&&(e.dsn=process.env.SENTRY_DSN);const t=process.env.SENTRY_TRACES_SAMPLE_RATE;if(void 0===e.tracesSampleRate&&t){const n=parseFloat(t);isFinite(n)&&(e.tracesSampleRate=n)}if(void 0===e.release){const t=kn();void 0!==t?e.release=t:e.autoSessionTracking=!1}void 0===e.environment&&process.env.SENTRY_ENVIRONMENT&&(e.environment=process.env.SENTRY_ENVIRONMENT),void 0===e.autoSessionTracking&&void 0!==e.dsn&&(e.autoSessionTracking=!0),void 0===e.instrumenter&&(e.instrumenter="sentry");const n={...e,stackParser:(0,it.vk)(e.stackParser||Yn),integrations:(0,l.mH)(e),transport:e.transport||nt};if(function(e,t){!0===t.debug&&(f.T?m.vF.enable():(0,m.pq)((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}))),(0,c.o5)().update(t.initialScope);const n=new e(t);Ce(n),function(e){e.init?e.init():e.setupIntegrations&&e.setupIntegrations()}(n)}(e.clientClass||Fe,n),e.autoSessionTracking&&((0,c.J0)(),process.on("beforeExit",(()=>{const e=(0,J.rm)().getSession();e&&!["exited","crashed"].includes(e.status)&&(0,c.ky)()}))),function(){const e=(process.env.SENTRY_USE_ENVIRONMENT||"").toLowerCase();if(!["false","n","no","off","0"].includes(e)){const e=process.env.SENTRY_TRACE,t=process.env.SENTRY_BAGGAGE,n=(0,rt.kM)(e,t);(0,c.o5)().setPropagationContext(n)}}(),e.spotlight){const t=(0,c.KU)();if(t&&t.addIntegration){const n=t.getOptions().integrations;for(const e of n)t.addIntegration(e);t.addIntegration(An({sidecarUrl:"string"==typeof e.spotlight?e.spotlight:void 0}))}}}function Hn(e){if(void 0===e)return!1;const t=e&&e.getOptions();return!(!t||void 0===t.autoSessionTracking)&&t.autoSessionTracking}function kn(e){return process.env.SENTRY_RELEASE?process.env.SENTRY_RELEASE:ot.OW.SENTRY_RELEASE&&ot.OW.SENTRY_RELEASE.id?ot.OW.SENTRY_RELEASE.id:process.env.GITHUB_SHA||process.env.COMMIT_REF||process.env.VERCEL_GIT_COMMIT_SHA||process.env.VERCEL_GITHUB_COMMIT_SHA||process.env.VERCEL_GITLAB_COMMIT_SHA||process.env.VERCEL_BITBUCKET_COMMIT_SHA||process.env.ZEIT_GITHUB_COMMIT_SHA||process.env.ZEIT_GITLAB_COMMIT_SHA||process.env.ZEIT_BITBUCKET_COMMIT_SHA||process.env.CF_PAGES_COMMIT_SHA||e}const Yn=(0,it.gd)((0,it.o)(Rn()));function Xn(e){const t=Zt.resolve(e);if(!At.existsSync(t))throw new Error(`Cannot read contents of ${t}. Directory does not exist.`);if(!At.statSync(t).isDirectory())throw new Error(`Cannot read contents of ${t}, because it is not a directory.`);const n=e=>At.readdirSync(e).reduce(((t,i)=>{const o=Zt.join(e,i);return At.statSync(o).isDirectory()?t.concat(n(o)):(t.push(o),t)}),[]);return n(t).map((e=>Zt.relative(t,e)))}var Fn=n(1615);function xn(e){const t=(0,c.KU)();return new Fn.M(e).setup(t),Promise.resolve()}function En(e,t){return(0,me.Rj)(e,{include:t})}function Jn(e,t,n={}){return(0,me.GY)(e,t,{include:n})}function Kn(){return function(e,t,n){const i=(0,Ue.z)([c.KU,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]);if(!i||"sentry"!==i.instrumenter||"OPTIONS"===(0,Ue.z)([e,"access",e=>e.method,"optionalAccess",e=>e.toUpperCase,"call",e=>e()])||"HEAD"===(0,Ue.z)([e,"access",e=>e.method,"optionalAccess",e=>e.toUpperCase,"call",e=>e()]))return n();const o=e.headers&&(0,B.Kg)(e.headers["sentry-trace"])?e.headers["sentry-trace"]:void 0,r=(0,Ue.z)([e,"access",e=>e.headers,"optionalAccess",e=>e.baggage]);if(!(0,Pt.w)(i))return n();const[s,a]=(0,me.Up)(e,{path:!0,method:!0}),l=(0,Be.V4)({sentryTrace:o,baggage:r},(t=>(0,c.nb)({name:s,op:"http.server",origin:"auto.http.node.tracingHandler",...t,data:{[Ae.i_]:a},metadata:{...t.metadata,request:e}},{request:(0,me.Rj)(e)})));(0,c.o5)().setSpan(l),t.__sentry_transaction=l,t.once("finish",(()=>{setImmediate((()=>{(0,me.em)(l,e),(0,Se.N8)(l,t.statusCode),l.end()}))})),n()}}function Pn(e){const t=function(e={}){let t;if("include"in e)t={include:e.include};else{const{ip:n,request:i,transaction:o,user:r}=e;(n||i||o||r)&&(t={include:(0,a.Ce)({ip:n,request:i,transaction:o,user:r})})}return t}(e),n=(0,c.KU)();if(n&&Hn(n)){n.initSessionFlusher();const e=(0,c.o5)();e.getSession()&&e.setSession()}return function(n,i,o){if(e&&e.flushTimeout&&e.flushTimeout>0){const t=i.end;i.end=function(n,i,o){(0,c.bX)(e.flushTimeout).then((()=>{t.call(this,n,i,o)})).then(null,(e=>{Ut&&m.vF.error(e),t.call(this,n,i,o)}))}}(0,J.fx)((()=>{const e=(0,c.o5)();e.setSDKProcessingMetadata({request:n,requestDataOptionsFromExpressHandler:t}),Hn((0,c.KU)())&&e.setRequestSession({status:"ok"}),i.once("finish",(()=>{const e=(0,c.KU)();Hn(e)&&setImmediate((()=>{e&&e._captureRequestSession&&e._captureRequestSession()}))})),o()}))}}function zn(e){const t=function(e){const t=e.status||e.statusCode||e.status_code||e.output&&e.output.statusCode;return t?parseInt(t,10):500}(e);return t>=500}function Un(e){return function(t,n,i,o){(e&&e.shouldHandleError||zn)(t)?(0,c.v4)((e=>{e.setSDKProcessingMetadata({request:n});const r=i.__sentry_transaction;r&&!(0,Be.Bk)()&&e.setSpan(r);const s=(0,c.KU)();if(s&&Hn(s)&&void 0!==s._sessionFlusher){const t=e.getRequestSession();t&&void 0!==t.status&&(t.status="crashed")}const a=(0,c.Cp)(t,{mechanism:{type:"middleware",handled:!1}});i.sentry=a,o(t)})):o(t)}}function On(e={}){return function({path:t,type:n,next:i,rawInput:o}){const r=(0,Ue.z)([c.KU,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]),s=(0,c.o5)().getTransaction();if(s){s.updateName(`trpc/${t}`),s.setAttribute(Ae.i_,"route"),s.op="rpc.server";const i={procedure_type:n};(void 0!==e.attachRpcInput?e.attachRpcInput:(0,Ue.z)([r,"optionalAccess",e=>e.sendDefaultPii]))&&(i.input=(0,R.S8)(o)),s.setContext("trpc",i)}function a(e){e.ok||(0,c.Cp)(e.error,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}let l;try{l=i()}catch(e){throw(0,c.Cp)(e,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}}),e}return(0,B.Qg)(l)?Promise.resolve(l).then((e=>{a(e)}),(e=>{(0,c.Cp)(e,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})})):a(l),l}}function Ln(e){return e&&void 0!==e.statusCode}function Dn(e){(0,c.Cp)(e,{mechanism:{type:"hapi",handled:!1,data:{function:"hapiErrorPlugin"}}})}const jn={name:"SentryHapiErrorPlugin",version:ve.M,register:async function(e){e.events.on("request",((e,t)=>{const n=(0,we.Z7)();var i;e.response&&(i=e.response)&&void 0!==i.isBoom?Dn(e.response):function(e){return e&&void 0!==e.error}(t)&&Dn(t.error),n&&(n.setStatus("internal_error"),n.end())}))}},Mn={name:"SentryHapiTracingPlugin",version:ve.M,register:async function(e){const t=e;t.ext("onPreHandler",((e,t)=>{const n=(0,Be.V4)({sentryTrace:e.headers["sentry-trace"]||void 0,baggage:e.headers.baggage||void 0},(t=>(0,c.nb)({...t,op:"hapi.request",name:e.route.path,description:`${e.route.method} ${e.path}`})));return(0,c.o5)().setSpan(n),t.continue})),t.ext("onPreResponse",((e,t)=>{const n=(0,we.Z7)();if(e.response&&Ln(e.response)&&n){const t=e.response;t.header("sentry-trace",(0,re.Qh)(n));const i=(0,zt.De)((0,D.k)(n));i&&t.header("baggage",i)}return t.continue})),t.ext("onPostHandler",((e,t)=>{const n=(0,we.Z7)();return n&&(e.response&&Ln(e.response)&&(0,Se.N8)(n,e.response.statusCode),n.end()),t.continue}))}},Qn="Hapi",qn=(0,l._C)(((e={})=>{const t=e.server;return{name:Qn,setupOnce(){t&&(0,a.GS)(t,"start",(e=>async function(){return await this.register(Mn),await this.register(jn),e.apply(this)}))}}})),$n=(0,l.F)(Qn,qn);var ei=n(2543),ti=n(5838),ni=n(875),ii=n(3114),oi=n(9336),ri=n(5455),si=n(9932);const ai=[["january","1"],["february","2"],["march","3"],["april","4"],["may","5"],["june","6"],["july","7"],["august","8"],["september","9"],["october","10"],["november","11"],["december","12"],["jan","1"],["feb","2"],["mar","3"],["apr","4"],["may","5"],["jun","6"],["jul","7"],["aug","8"],["sep","9"],["oct","10"],["nov","11"],["dec","12"],["sunday","0"],["monday","1"],["tuesday","2"],["wednesday","3"],["thursday","4"],["friday","5"],["saturday","6"],["sun","0"],["mon","1"],["tue","2"],["wed","3"],["thu","4"],["fri","5"],["sat","6"]];function ci(e){return ai.reduce(((e,[t,n])=>e.replace(new RegExp(t,"gi"),n)),e)}const li="Automatic instrumentation of CronJob only supports crontab string",ui=Rn(),di={...Y,...r,...s},gi={instrumentCron:function(e,t){let n=!1;return new Proxy(e,{construct(e,i){const[o,r,s,a,l,...u]=i;if("string"!=typeof o)throw new Error(li);if(n)throw new Error(`A job named '${t}' has already been scheduled`);n=!0;const d=ci(o);return new e(o,(function(e,n){return(0,c.T$)(t,(()=>r(e,n)),{schedule:{type:"crontab",value:d},...l?{timeZone:l}:{}})}),s,a,l,...u)},get:(e,i)=>"from"===i?i=>{const{cronTime:o,onTick:r,timeZone:s}=i;if("string"!=typeof o)throw new Error(li);if(n)throw new Error(`A job named '${t}' has already been scheduled`);n=!0;const a=ci(o);return i.onTick=(e,n)=>(0,c.T$)(t,(()=>r(e,n)),{schedule:{type:"crontab",value:a},...s?{timeZone:s}:{}}),e.from(i)}:e[i]})},instrumentNodeCron:function(e){return new Proxy(e,{get:(e,t)=>"schedule"===t&&e.schedule?new Proxy(e.schedule,{apply(e,t,n){const[i,,o]=n;if(!(0,Ue.z)([o,"optionalAccess",e=>e.name]))throw new Error('Missing "name" for scheduled job. A name is required for Sentry check-in monitoring.');return(0,c.T$)(o.name,(()=>e.apply(t,n)),{schedule:{type:"crontab",value:ci(i)},timezone:(0,Ue.z)([o,"optionalAccess",e=>e.timezone])})}}):e[t]})},instrumentNodeSchedule:function(e){return new Proxy(e,{get:(e,t)=>"scheduleJob"===t?new Proxy(e.scheduleJob,{apply(e,t,n){const[i,o]=n;if("string"!=typeof i||"string"!=typeof o)throw new Error("Automatic instrumentation of 'node-schedule' requires the first parameter of 'scheduleJob' to be a job name string and the second parameter to be a crontab string");const r=i,s=o;return(0,c.T$)(r,(()=>e.apply(t,n)),{schedule:{type:"crontab",value:ci(s)}})}}):e[t]})}}},1615:(e,t,n)=>{"use strict";n.d(t,{M:()=>p,a:()=>g});var i=n(853);function o(e){const t=(0,i.z)(e);return null==t||t}var r=n(7016),s=n(5836),a=n(3741),c=n(7412),l=n(258),u=n(3245);function d(e,...t){c.vF.log(`[ANR] ${e}`,...t)}e=n.hmd(e);const g=(0,s._C)(((t={})=>({name:"Anr",setupOnce(){},setup(s){if(u.S.major<16||16===u.S.major&&u.S.minor<17)throw new Error("ANR detection requires Node 16.17.0 or later");setImmediate((()=>async function(t,s){const u=await async function(e){let t={message:"ANR"};const n={};for(const i of e.getEventProcessors()){if(null===t)break;t=await i(t,n)}return(0,i.z)([t,"optionalAccess",e=>e.contexts])||{}}(t),g=t.getDsn();if(!g)return;o([u,"access",e=>e.app,"optionalAccess",e=>delete e.app_memory]),o([u,"access",e=>e.device,"optionalAccess",e=>delete e.free_memory]);const p=t.getOptions(),h=t.getSdkMetadata()||{};h.sdk&&(h.sdk.integrations=p.integrations.map((e=>e.name)));const m={debug:c.vF.isEnabled(),dsn:g,environment:p.environment||"production",release:p.release,dist:p.dist,sdkMetadata:h,appRootPath:s.appRootPath,pollInterval:s.pollInterval||50,anrThreshold:s.anrThreshold||5e3,captureStackTrace:!!s.captureStackTrace,staticTags:s.staticTags||{},contexts:u};if(m.captureStackTrace){const e=n(264);e.url()||e.open(0)}const{Worker:I}=(0,l.fj)(e,"worker_threads"),b=new I(new r.URL("data:application/javascript;base64,aW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJ2luc3BlY3Rvcic7CmltcG9ydCB7IHdvcmtlckRhdGEsIHBhcmVudFBvcnQgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7CmltcG9ydCB7IHBvc2l4LCBzZXAgfSBmcm9tICdwYXRoJzsKaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJzsKaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnOwppbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7CmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7CmltcG9ydCB7IGNyZWF0ZUd6aXAgfSBmcm9tICd6bGliJzsKaW1wb3J0ICogYXMgbmV0IGZyb20gJ25ldCc7CmltcG9ydCAqIGFzIHRscyBmcm9tICd0bHMnOwoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZApjb25zdCBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIG9uZSBvZiBhIGZldyBFcnJvciBvciBFcnJvci1saWtlCiAqIHtAbGluayBpc0Vycm9yfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXJyb3Iod2F0KSB7CiAgc3dpdGNoIChvYmplY3RUb1N0cmluZy5jYWxsKHdhdCkpIHsKICAgIGNhc2UgJ1tvYmplY3QgRXJyb3JdJzoKICAgIGNhc2UgJ1tvYmplY3QgRXhjZXB0aW9uXSc6CiAgICBjYXNlICdbb2JqZWN0IERPTUV4Y2VwdGlvbl0nOgogICAgICByZXR1cm4gdHJ1ZTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBpc0luc3RhbmNlT2Yod2F0LCBFcnJvcik7CiAgfQp9Ci8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW4gYnVpbHQtaW4gY2xhc3MuCiAqCiAqIEBwYXJhbSB3YXQgVGhlIHZhbHVlIHRvIGJlIGNoZWNrZWQKICogQHBhcmFtIGNsYXNzTmFtZQogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0J1aWx0aW4od2F0LCBjbGFzc05hbWUpIHsKICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh3YXQpID09PSBgW29iamVjdCAke2NsYXNzTmFtZX1dYDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIHN0cmluZwogKiB7QGxpbmsgaXNTdHJpbmd9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNTdHJpbmcod2F0KSB7CiAgcmV0dXJuIGlzQnVpbHRpbih3YXQsICdTdHJpbmcnKTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBvYmplY3QgbGl0ZXJhbCwgb3IgYSBjbGFzcyBpbnN0YW5jZS4KICoge0BsaW5rIGlzUGxhaW5PYmplY3R9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh3YXQpIHsKICByZXR1cm4gaXNCdWlsdGluKHdhdCwgJ09iamVjdCcpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEV2ZW50IGluc3RhbmNlCiAqIHtAbGluayBpc0V2ZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXZlbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHdhdCwgRXZlbnQpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEVsZW1lbnQgaW5zdGFuY2UKICoge0BsaW5rIGlzRWxlbWVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0VsZW1lbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFbGVtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2Yod2F0LCBFbGVtZW50KTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlIGhhcyBhIHRoZW4gZnVuY3Rpb24uCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKi8KZnVuY3Rpb24gaXNUaGVuYWJsZSh3YXQpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgcmV0dXJuIEJvb2xlYW4od2F0ICYmIHdhdC50aGVuICYmIHR5cGVvZiB3YXQudGhlbiA9PT0gJ2Z1bmN0aW9uJyk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYSBTeW50aGV0aWNFdmVudAogKiB7QGxpbmsgaXNTeW50aGV0aWNFdmVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1N5bnRoZXRpY0V2ZW50KHdhdCkgewogIHJldHVybiBpc1BsYWluT2JqZWN0KHdhdCkgJiYgJ25hdGl2ZUV2ZW50JyBpbiB3YXQgJiYgJ3ByZXZlbnREZWZhdWx0JyBpbiB3YXQgJiYgJ3N0b3BQcm9wYWdhdGlvbicgaW4gd2F0Owp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUgaXMgTmFOCiAqIHtAbGluayBpc05hTn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc05hTiQxKHdhdCkgewogIHJldHVybiB0eXBlb2Ygd2F0ID09PSAnbnVtYmVyJyAmJiB3YXQgIT09IHdhdDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBpbnN0YW5jZSBvZiBwcm92aWRlZCBjb25zdHJ1Y3Rvci4KICoge0BsaW5rIGlzSW5zdGFuY2VPZn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcGFyYW0gYmFzZSBBIGNvbnN0cnVjdG9yIHRvIGJlIHVzZWQgaW4gYSBjaGVjay4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNJbnN0YW5jZU9mKHdhdCwgYmFzZSkgewogIHRyeSB7CiAgICByZXR1cm4gd2F0IGluc3RhbmNlb2YgYmFzZTsKICB9IGNhdGNoIChfZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIFZ1ZSBWaWV3TW9kZWwuCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1Z1ZVZpZXdNb2RlbCh3YXQpIHsKICAvLyBOb3QgdXNpbmcgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyBiZWNhdXNlIGluIFZ1ZSAzIGl0IHdvdWxkIHJlYWQgdGhlIGluc3RhbmNlJ3MgU3ltYm9sKFN5bWJvbC50b1N0cmluZ1RhZykgcHJvcGVydHkuCiAgcmV0dXJuICEhKHR5cGVvZiB3YXQgPT09ICdvYmplY3QnICYmIHdhdCAhPT0gbnVsbCAmJiAoKHdhdCApLl9faXNWdWUgfHwgKHdhdCApLl9pc1Z1ZSkpOwp9CgovKiogSW50ZXJuYWwgZ2xvYmFsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIFNlbnRyeSBleHRlbnNpb25zICAqLwoKLy8gVGhlIGNvZGUgYmVsb3cgZm9yICdpc0dsb2JhbE9iaicgYW5kICdHTE9CQUxfT0JKJyB3YXMgY29waWVkIGZyb20gY29yZS1qcyBiZWZvcmUgbW9kaWZpY2F0aW9uCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2Jsb2IvMWI5NDRkZjU1MjgyY2RjOTljOTBkYjVmNDllYjBiNmVkYTJjYzBhMy9wYWNrYWdlcy9jb3JlLWpzL2ludGVybmFscy9nbG9iYWwuanMKLy8gY29yZS1qcyBoYXMgdGhlIGZvbGxvd2luZyBsaWNlbmNlOgovLwovLyBDb3B5cmlnaHQgKGMpIDIwMTQtMjAyMiBEZW5pcyBQdXNoa2FyZXYKLy8KLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQovLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAovLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci8vCi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgovLwovLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgovLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgovLyBUSEUgU09GVFdBUkUuCgovKiogUmV0dXJucyAnb2JqJyBpZiBpdCdzIHRoZSBnbG9iYWwgb2JqZWN0LCBvdGhlcndpc2UgcmV0dXJucyB1bmRlZmluZWQgKi8KZnVuY3Rpb24gaXNHbG9iYWxPYmoob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouTWF0aCA9PSBNYXRoID8gb2JqIDogdW5kZWZpbmVkOwp9CgovKiogR2V0J3MgdGhlIGdsb2JhbCBvYmplY3QgZm9yIHRoZSBjdXJyZW50IEphdmFTY3JpcHQgcnVudGltZSAqLwpjb25zdCBHTE9CQUxfT0JKID0KICAodHlwZW9mIGdsb2JhbFRoaXMgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooZ2xvYmFsVGhpcykpIHx8CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICh0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHdpbmRvdykpIHx8CiAgKHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHNlbGYpKSB8fAogICh0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKGdsb2JhbCkpIHx8CiAgKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzOwogIH0pKCkgfHwKICB7fTsKCi8qKgogKiBAZGVwcmVjYXRlZCBVc2UgR0xPQkFMX09CSiBpbnN0ZWFkIG9yIFdJTkRPVyBmcm9tIEBzZW50cnkvYnJvd3Nlci4gVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjgKICovCmZ1bmN0aW9uIGdldEdsb2JhbE9iamVjdCgpIHsKICByZXR1cm4gR0xPQkFMX09CSiA7Cn0KCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpjb25zdCBXSU5ET1cgPSBnZXRHbG9iYWxPYmplY3QoKTsKCmNvbnN0IERFRkFVTFRfTUFYX1NUUklOR19MRU5HVEggPSA4MDsKCi8qKgogKiBHaXZlbiBhIGNoaWxkIERPTSBlbGVtZW50LCByZXR1cm5zIGEgcXVlcnktc2VsZWN0b3Igc3RhdGVtZW50IGRlc2NyaWJpbmcgdGhhdAogKiBhbmQgaXRzIGFuY2VzdG9ycwogKiBlLmcuIFtIVE1MRWxlbWVudF0gPT4gYm9keSA+IGRpdiA+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gaHRtbFRyZWVBc1N0cmluZygKICBlbGVtLAogIG9wdGlvbnMgPSB7fSwKKSB7CiAgaWYgKCFlbGVtKSB7CiAgICByZXR1cm4gJzx1bmtub3duPic7CiAgfQoKICAvLyB0cnkvY2F0Y2ggYm90aDoKICAvLyAtIGFjY2Vzc2luZyBldmVudC50YXJnZXQgKHNlZSBnZXRzZW50cnkvcmF2ZW4tanMjODM4LCAjNzY4KQogIC8vIC0gYGh0bWxUcmVlQXNTdHJpbmdgIGJlY2F1c2UgaXQncyBjb21wbGV4LCBhbmQganVzdCBhY2Nlc3NpbmcgdGhlIERPTSBpbmNvcnJlY3RseQogIC8vIC0gY2FuIHRocm93IGFuIGV4Y2VwdGlvbiBpbiBzb21lIGNpcmN1bXN0YW5jZXMuCiAgdHJ5IHsKICAgIGxldCBjdXJyZW50RWxlbSA9IGVsZW0gOwogICAgY29uc3QgTUFYX1RSQVZFUlNFX0hFSUdIVCA9IDU7CiAgICBjb25zdCBvdXQgPSBbXTsKICAgIGxldCBoZWlnaHQgPSAwOwogICAgbGV0IGxlbiA9IDA7CiAgICBjb25zdCBzZXBhcmF0b3IgPSAnID4gJzsKICAgIGNvbnN0IHNlcExlbmd0aCA9IHNlcGFyYXRvci5sZW5ndGg7CiAgICBsZXQgbmV4dFN0cjsKICAgIGNvbnN0IGtleUF0dHJzID0gQXJyYXkuaXNBcnJheShvcHRpb25zKSA/IG9wdGlvbnMgOiBvcHRpb25zLmtleUF0dHJzOwogICAgY29uc3QgbWF4U3RyaW5nTGVuZ3RoID0gKCFBcnJheS5pc0FycmF5KG9wdGlvbnMpICYmIG9wdGlvbnMubWF4U3RyaW5nTGVuZ3RoKSB8fCBERUZBVUxUX01BWF9TVFJJTkdfTEVOR1RIOwoKICAgIHdoaWxlIChjdXJyZW50RWxlbSAmJiBoZWlnaHQrKyA8IE1BWF9UUkFWRVJTRV9IRUlHSFQpIHsKICAgICAgbmV4dFN0ciA9IF9odG1sRWxlbWVudEFzU3RyaW5nKGN1cnJlbnRFbGVtLCBrZXlBdHRycyk7CiAgICAgIC8vIGJhaWwgb3V0IGlmCiAgICAgIC8vIC0gbmV4dFN0ciBpcyB0aGUgJ2h0bWwnIGVsZW1lbnQKICAgICAgLy8gLSB0aGUgbGVuZ3RoIG9mIHRoZSBzdHJpbmcgdGhhdCB3b3VsZCBiZSBjcmVhdGVkIGV4Y2VlZHMgbWF4U3RyaW5nTGVuZ3RoCiAgICAgIC8vICAgKGlnbm9yZSB0aGlzIGxpbWl0IGlmIHdlIGFyZSBvbiB0aGUgZmlyc3QgaXRlcmF0aW9uKQogICAgICBpZiAobmV4dFN0ciA9PT0gJ2h0bWwnIHx8IChoZWlnaHQgPiAxICYmIGxlbiArIG91dC5sZW5ndGggKiBzZXBMZW5ndGggKyBuZXh0U3RyLmxlbmd0aCA+PSBtYXhTdHJpbmdMZW5ndGgpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIG91dC5wdXNoKG5leHRTdHIpOwoKICAgICAgbGVuICs9IG5leHRTdHIubGVuZ3RoOwogICAgICBjdXJyZW50RWxlbSA9IGN1cnJlbnRFbGVtLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIG91dC5yZXZlcnNlKCkuam9pbihzZXBhcmF0b3IpOwogIH0gY2F0Y2ggKF9vTykgewogICAgcmV0dXJuICc8dW5rbm93bj4nOwogIH0KfQoKLyoqCiAqIFJldHVybnMgYSBzaW1wbGUsIHF1ZXJ5LXNlbGVjdG9yIHJlcHJlc2VudGF0aW9uIG9mIGEgRE9NIGVsZW1lbnQKICogZS5nLiBbSFRNTEVsZW1lbnRdID0+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gX2h0bWxFbGVtZW50QXNTdHJpbmcoZWwsIGtleUF0dHJzKSB7CiAgY29uc3QgZWxlbSA9IGVsCgo7CgogIGNvbnN0IG91dCA9IFtdOwogIGxldCBjbGFzc05hbWU7CiAgbGV0IGNsYXNzZXM7CiAgbGV0IGtleTsKICBsZXQgYXR0cjsKICBsZXQgaTsKCiAgaWYgKCFlbGVtIHx8ICFlbGVtLnRhZ05hbWUpIHsKICAgIHJldHVybiAnJzsKICB9CgogIC8vIEB0cy1leHBlY3QtZXJyb3IgV0lORE9XIGhhcyBIVE1MRWxlbWVudAogIGlmIChXSU5ET1cuSFRNTEVsZW1lbnQpIHsKICAgIC8vIElmIHVzaW5nIHRoZSBjb21wb25lbnQgbmFtZSBhbm5vdGF0aW9uIHBsdWdpbiwgdGhpcyB2YWx1ZSBtYXkgYmUgYXZhaWxhYmxlIG9uIHRoZSBET00gbm9kZQogICAgaWYgKGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBlbGVtLmRhdGFzZXQgJiYgZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXSkgewogICAgICByZXR1cm4gZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXTsKICAgIH0KICB9CgogIG91dC5wdXNoKGVsZW0udGFnTmFtZS50b0xvd2VyQ2FzZSgpKTsKCiAgLy8gUGFpcnMgb2YgYXR0cmlidXRlIGtleXMgZGVmaW5lZCBpbiBgc2VyaWFsaXplQXR0cmlidXRlYCBhbmQgdGhlaXIgdmFsdWVzIG9uIGVsZW1lbnQuCiAgY29uc3Qga2V5QXR0clBhaXJzID0KICAgIGtleUF0dHJzICYmIGtleUF0dHJzLmxlbmd0aAogICAgICA/IGtleUF0dHJzLmZpbHRlcihrZXlBdHRyID0+IGVsZW0uZ2V0QXR0cmlidXRlKGtleUF0dHIpKS5tYXAoa2V5QXR0ciA9PiBba2V5QXR0ciwgZWxlbS5nZXRBdHRyaWJ1dGUoa2V5QXR0cildKQogICAgICA6IG51bGw7CgogIGlmIChrZXlBdHRyUGFpcnMgJiYga2V5QXR0clBhaXJzLmxlbmd0aCkgewogICAga2V5QXR0clBhaXJzLmZvckVhY2goa2V5QXR0clBhaXIgPT4gewogICAgICBvdXQucHVzaChgWyR7a2V5QXR0clBhaXJbMF19PSIke2tleUF0dHJQYWlyWzFdfSJdYCk7CiAgICB9KTsKICB9IGVsc2UgewogICAgaWYgKGVsZW0uaWQpIHsKICAgICAgb3V0LnB1c2goYCMke2VsZW0uaWR9YCk7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgY2xhc3NOYW1lID0gZWxlbS5jbGFzc05hbWU7CiAgICBpZiAoY2xhc3NOYW1lICYmIGlzU3RyaW5nKGNsYXNzTmFtZSkpIHsKICAgICAgY2xhc3NlcyA9IGNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgb3V0LnB1c2goYC4ke2NsYXNzZXNbaV19YCk7CiAgICAgIH0KICAgIH0KICB9CiAgY29uc3QgYWxsb3dlZEF0dHJzID0gWydhcmlhLWxhYmVsJywgJ3R5cGUnLCAnbmFtZScsICd0aXRsZScsICdhbHQnXTsKICBmb3IgKGkgPSAwOyBpIDwgYWxsb3dlZEF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICBrZXkgPSBhbGxvd2VkQXR0cnNbaV07CiAgICBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoa2V5KTsKICAgIGlmIChhdHRyKSB7CiAgICAgIG91dC5wdXNoKGBbJHtrZXl9PSIke2F0dHJ9Il1gKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dC5qb2luKCcnKTsKfQoKLyoqCiAqIFRoaXMgc2VydmVzIGFzIGEgYnVpbGQgdGltZSBmbGFnIHRoYXQgd2lsbCBiZSB0cnVlIGJ5IGRlZmF1bHQsIGJ1dCBmYWxzZSBpbiBub24tZGVidWcgYnVpbGRzIG9yIGlmIHVzZXJzIHJlcGxhY2UgYF9fU0VOVFJZX0RFQlVHX19gIGluIHRoZWlyIGdlbmVyYXRlZCBjb2RlLgogKgogKiBBVFRFTlRJT046IFRoaXMgY29uc3RhbnQgbXVzdCBuZXZlciBjcm9zcyBwYWNrYWdlIGJvdW5kYXJpZXMgKGkuZS4gYmUgZXhwb3J0ZWQpIHRvIGd1YXJhbnRlZSB0aGF0IGl0IGNhbiBiZSB1c2VkIGZvciB0cmVlIHNoYWtpbmcuCiAqLwpjb25zdCBERUJVR19CVUlMRCQxID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCi8qKiBQcmVmaXggZm9yIGxvZ2dpbmcgc3RyaW5ncyAqLwpjb25zdCBQUkVGSVggPSAnU2VudHJ5IExvZ2dlciAnOwoKY29uc3QgQ09OU09MRV9MRVZFTFMgPSBbCiAgJ2RlYnVnJywKICAnaW5mbycsCiAgJ3dhcm4nLAogICdlcnJvcicsCiAgJ2xvZycsCiAgJ2Fzc2VydCcsCiAgJ3RyYWNlJywKXSA7CgovKiogVGhpcyBtYXkgYmUgbXV0YXRlZCBieSB0aGUgY29uc29sZSBpbnN0cnVtZW50YXRpb24uICovCmNvbnN0IG9yaWdpbmFsQ29uc29sZU1ldGhvZHMKCiA9IHt9OwoKLyoqIEpTRG9jICovCgovKioKICogVGVtcG9yYXJpbHkgZGlzYWJsZSBzZW50cnkgY29uc29sZSBpbnN0cnVtZW50YXRpb25zLgogKgogKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBgY29uc29sZWAgbWVzc2FnZXMKICogQHJldHVybnMgVGhlIHJlc3VsdHMgb2YgdGhlIGNhbGxiYWNrCiAqLwpmdW5jdGlvbiBjb25zb2xlU2FuZGJveChjYWxsYmFjaykgewogIGlmICghKCdjb25zb2xlJyBpbiBHTE9CQUxfT0JKKSkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfQoKICBjb25zdCBjb25zb2xlID0gR0xPQkFMX09CSi5jb25zb2xlIDsKICBjb25zdCB3cmFwcGVkRnVuY3MgPSB7fTsKCiAgY29uc3Qgd3JhcHBlZExldmVscyA9IE9iamVjdC5rZXlzKG9yaWdpbmFsQ29uc29sZU1ldGhvZHMpIDsKCiAgLy8gUmVzdG9yZSBhbGwgd3JhcHBlZCBjb25zb2xlIG1ldGhvZHMKICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgY29uc3Qgb3JpZ2luYWxDb25zb2xlTWV0aG9kID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kc1tsZXZlbF0gOwogICAgd3JhcHBlZEZ1bmNzW2xldmVsXSA9IGNvbnNvbGVbbGV2ZWxdIDsKICAgIGNvbnNvbGVbbGV2ZWxdID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kOwogIH0pOwoKICB0cnkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfSBmaW5hbGx5IHsKICAgIC8vIFJldmVydCByZXN0b3JhdGlvbiB0byB3cmFwcGVkIHN0YXRlCiAgICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgICBjb25zb2xlW2xldmVsXSA9IHdyYXBwZWRGdW5jc1tsZXZlbF0gOwogICAgfSk7CiAgfQp9CgpmdW5jdGlvbiBtYWtlTG9nZ2VyKCkgewogIGxldCBlbmFibGVkID0gZmFsc2U7CiAgY29uc3QgbG9nZ2VyID0gewogICAgZW5hYmxlOiAoKSA9PiB7CiAgICAgIGVuYWJsZWQgPSB0cnVlOwogICAgfSwKICAgIGRpc2FibGU6ICgpID0+IHsKICAgICAgZW5hYmxlZCA9IGZhbHNlOwogICAgfSwKICAgIGlzRW5hYmxlZDogKCkgPT4gZW5hYmxlZCwKICB9OwoKICBpZiAoREVCVUdfQlVJTEQkMSkgewogICAgQ09OU09MRV9MRVZFTFMuZm9yRWFjaChuYW1lID0+IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgICAgbG9nZ2VyW25hbWVdID0gKC4uLmFyZ3MpID0+IHsKICAgICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgICAgY29uc29sZVNhbmRib3goKCkgPT4gewogICAgICAgICAgICBHTE9CQUxfT0JKLmNvbnNvbGVbbmFtZV0oYCR7UFJFRklYfVske25hbWV9XTpgLCAuLi5hcmdzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBDT05TT0xFX0xFVkVMUy5mb3JFYWNoKG5hbWUgPT4gewogICAgICBsb2dnZXJbbmFtZV0gPSAoKSA9PiB1bmRlZmluZWQ7CiAgICB9KTsKICB9CgogIHJldHVybiBsb2dnZXIgOwp9Cgpjb25zdCBsb2dnZXIgPSBtYWtlTG9nZ2VyKCk7CgovKioKICogUmVuZGVycyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgRHNuLgogKgogKiBCeSBkZWZhdWx0LCB0aGlzIHdpbGwgcmVuZGVyIHRoZSBwdWJsaWMgcmVwcmVzZW50YXRpb24gd2l0aG91dCB0aGUgcGFzc3dvcmQKICogY29tcG9uZW50LiBUbyBnZXQgdGhlIGRlcHJlY2F0ZWQgcHJpdmF0ZSByZXByZXNlbnRhdGlvbiwgc2V0IGB3aXRoUGFzc3dvcmRgCiAqIHRvIHRydWUuCiAqCiAqIEBwYXJhbSB3aXRoUGFzc3dvcmQgV2hlbiBzZXQgdG8gdHJ1ZSwgdGhlIHBhc3N3b3JkIHdpbGwgYmUgaW5jbHVkZWQuCiAqLwpmdW5jdGlvbiBkc25Ub1N0cmluZyhkc24sIHdpdGhQYXNzd29yZCA9IGZhbHNlKSB7CiAgY29uc3QgeyBob3N0LCBwYXRoLCBwYXNzLCBwb3J0LCBwcm9qZWN0SWQsIHByb3RvY29sLCBwdWJsaWNLZXkgfSA9IGRzbjsKICByZXR1cm4gKAogICAgYCR7cHJvdG9jb2x9Oi8vJHtwdWJsaWNLZXl9JHt3aXRoUGFzc3dvcmQgJiYgcGFzcyA/IGA6JHtwYXNzfWAgOiAnJ31gICsKICAgIGBAJHtob3N0fSR7cG9ydCA/IGA6JHtwb3J0fWAgOiAnJ30vJHtwYXRoID8gYCR7cGF0aH0vYCA6IHBhdGh9JHtwcm9qZWN0SWR9YAogICk7Cn0KCi8qKiBBbiBlcnJvciBlbWl0dGVkIGJ5IFNlbnRyeSBTREtzIGFuZCByZWxhdGVkIHV0aWxpdGllcy4gKi8KY2xhc3MgU2VudHJ5RXJyb3IgZXh0ZW5kcyBFcnJvciB7CiAgLyoqIERpc3BsYXkgbmFtZSBvZiB0aGlzIGVycm9yIGluc3RhbmNlLiAqLwoKICAgY29uc3RydWN0b3IoIG1lc3NhZ2UsIGxvZ0xldmVsID0gJ3dhcm4nKSB7CiAgICBzdXBlcihtZXNzYWdlKTt0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgdGhpcy5uYW1lID0gbmV3LnRhcmdldC5wcm90b3R5cGUuY29uc3RydWN0b3IubmFtZTsKICAgIC8vIFRoaXMgc2V0cyB0aGUgcHJvdG90eXBlIHRvIGJlIGBFcnJvcmAsIG5vdCBgU2VudHJ5RXJyb3JgLiBJdCdzIHVuY2xlYXIgd2h5IHdlIGRvIHRoaXMsIGJ1dCBjb21tZW50aW5nIHRoaXMgbGluZQogICAgLy8gb3V0IGNhdXNlcyB2YXJpb3VzIChzZWVtaW5nbHkgdG90YWxseSB1bnJlbGF0ZWQpIHBsYXl3cmlnaHQgdGVzdHMgY29uc2lzdGVudGx5IHRpbWUgb3V0LiBGWUksIHRoaXMgbWFrZXMKICAgIC8vIGluc3RhbmNlcyBvZiBgU2VudHJ5RXJyb3JgIGZhaWwgYG9iaiBpbnN0YW5jZW9mIFNlbnRyeUVycm9yYCBjaGVja3MuCiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgbmV3LnRhcmdldC5wcm90b3R5cGUpOwogICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsOwogIH0KfQoKLyoqCiAqIEVuY29kZXMgZ2l2ZW4gb2JqZWN0IGludG8gdXJsLWZyaWVuZGx5IGZvcm1hdAogKgogKiBAcGFyYW0gb2JqZWN0IEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHNlcmlhbGl6YWJsZSB2YWx1ZXMKICogQHJldHVybnMgc3RyaW5nIEVuY29kZWQKICovCmZ1bmN0aW9uIHVybEVuY29kZShvYmplY3QpIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqZWN0KQogICAgLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdFtrZXldKX1gKQogICAgLmpvaW4oJyYnKTsKfQoKLyoqCiAqIFRyYW5zZm9ybXMgYW55IGBFcnJvcmAgb3IgYEV2ZW50YCBpbnRvIGEgcGxhaW4gb2JqZWN0IHdpdGggYWxsIG9mIHRoZWlyIGVudW1lcmFibGUgcHJvcGVydGllcywgYW5kIHNvbWUgb2YgdGhlaXIKICogbm9uLWVudW1lcmFibGUgcHJvcGVydGllcyBhdHRhY2hlZC4KICoKICogQHBhcmFtIHZhbHVlIEluaXRpYWwgc291cmNlIHRoYXQgd2UgaGF2ZSB0byB0cmFuc2Zvcm0gaW4gb3JkZXIgZm9yIGl0IHRvIGJlIHVzYWJsZSBieSB0aGUgc2VyaWFsaXplcgogKiBAcmV0dXJucyBBbiBFdmVudCBvciBFcnJvciB0dXJuZWQgaW50byBhbiBvYmplY3QgLSBvciB0aGUgdmFsdWUgYXJndXJtZW50IGl0c2VsZiwgd2hlbiB2YWx1ZSBpcyBuZWl0aGVyIGFuIEV2ZW50IG5vcgogKiAgYW4gRXJyb3IuCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9QbGFpbk9iamVjdCgKICB2YWx1ZSwKKQoKIHsKICBpZiAoaXNFcnJvcih2YWx1ZSkpIHsKICAgIHJldHVybiB7CiAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsCiAgICAgIG5hbWU6IHZhbHVlLm5hbWUsCiAgICAgIHN0YWNrOiB2YWx1ZS5zdGFjaywKICAgICAgLi4uZ2V0T3duUHJvcGVydGllcyh2YWx1ZSksCiAgICB9OwogIH0gZWxzZSBpZiAoaXNFdmVudCh2YWx1ZSkpIHsKICAgIGNvbnN0IG5ld09iagoKID0gewogICAgICB0eXBlOiB2YWx1ZS50eXBlLAogICAgICB0YXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLnRhcmdldCksCiAgICAgIGN1cnJlbnRUYXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLmN1cnJlbnRUYXJnZXQpLAogICAgICAuLi5nZXRPd25Qcm9wZXJ0aWVzKHZhbHVlKSwKICAgIH07CgogICAgaWYgKHR5cGVvZiBDdXN0b21FdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHZhbHVlLCBDdXN0b21FdmVudCkpIHsKICAgICAgbmV3T2JqLmRldGFpbCA9IHZhbHVlLmRldGFpbDsKICAgIH0KCiAgICByZXR1cm4gbmV3T2JqOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfQp9CgovKiogQ3JlYXRlcyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGFyZ2V0IG9mIGFuIGBFdmVudGAgb2JqZWN0ICovCmZ1bmN0aW9uIHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHRhcmdldCkgewogIHRyeSB7CiAgICByZXR1cm4gaXNFbGVtZW50KHRhcmdldCkgPyBodG1sVHJlZUFzU3RyaW5nKHRhcmdldCkgOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGFyZ2V0KTsKICB9IGNhdGNoIChfb08pIHsKICAgIHJldHVybiAnPHVua25vd24+JzsKICB9Cn0KCi8qKiBGaWx0ZXJzIG91dCBhbGwgYnV0IGFuIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzICovCmZ1bmN0aW9uIGdldE93blByb3BlcnRpZXMob2JqKSB7CiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIG9iaiAhPT0gbnVsbCkgewogICAgY29uc3QgZXh0cmFjdGVkUHJvcHMgPSB7fTsKICAgIGZvciAoY29uc3QgcHJvcGVydHkgaW4gb2JqKSB7CiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wZXJ0eSkpIHsKICAgICAgICBleHRyYWN0ZWRQcm9wc1twcm9wZXJ0eV0gPSAob2JqIClbcHJvcGVydHldOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZXh0cmFjdGVkUHJvcHM7CiAgfSBlbHNlIHsKICAgIHJldHVybiB7fTsKICB9Cn0KCi8qKgogKiBHaXZlbiBhbnkgb2JqZWN0LCByZXR1cm4gYSBuZXcgb2JqZWN0IGhhdmluZyByZW1vdmVkIGFsbCBmaWVsZHMgd2hvc2UgdmFsdWUgd2FzIGB1bmRlZmluZWRgLgogKiBXb3JrcyByZWN1cnNpdmVseSBvbiBvYmplY3RzIGFuZCBhcnJheXMuCiAqCiAqIEF0dGVudGlvbjogVGhpcyBmdW5jdGlvbiBrZWVwcyBjaXJjdWxhciByZWZlcmVuY2VzIGluIHRoZSByZXR1cm5lZCBvYmplY3QuCiAqLwpmdW5jdGlvbiBkcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlKSB7CiAgLy8gVGhpcyBtYXAga2VlcHMgdHJhY2sgb2Ygd2hhdCBhbHJlYWR5IHZpc2l0ZWQgbm9kZXMgbWFwIHRvLgogIC8vIE91ciBTZXQgLSBiYXNlZCBtZW1vQnVpbGRlciBkb2Vzbid0IHdvcmsgaGVyZSBiZWNhdXNlIHdlIHdhbnQgdG8gdGhlIG91dHB1dCBvYmplY3QgdG8gaGF2ZSB0aGUgc2FtZSBjaXJjdWxhcgogIC8vIHJlZmVyZW5jZXMgYXMgdGhlIGlucHV0IG9iamVjdC4KICBjb25zdCBtZW1vaXphdGlvbk1hcCA9IG5ldyBNYXAoKTsKCiAgLy8gVGhpcyBmdW5jdGlvbiBqdXN0IHByb3hpZXMgYF9kcm9wVW5kZWZpbmVkS2V5c2AgdG8ga2VlcCB0aGUgYG1lbW9CdWlsZGVyYCBvdXQgb2YgdGhpcyBmdW5jdGlvbidzIEFQSQogIHJldHVybiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApOwp9CgpmdW5jdGlvbiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApIHsKICBpZiAoaXNQb2pvKGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBvYmplY3QgaXQgd2FzIG1hcHBlZCB0byBpbiB0aGUgbmV3IG9iamVjdAogICAgY29uc3QgbWVtb1ZhbCA9IG1lbW9pemF0aW9uTWFwLmdldChpbnB1dFZhbHVlKTsKICAgIGlmIChtZW1vVmFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIG1lbW9WYWwgOwogICAgfQoKICAgIGNvbnN0IHJldHVyblZhbHVlID0ge307CiAgICAvLyBTdG9yZSB0aGUgbWFwcGluZyBvZiB0aGlzIHZhbHVlIGluIGNhc2Ugd2UgdmlzaXQgaXQgYWdhaW4sIGluIGNhc2Ugb2YgY2lyY3VsYXIgZGF0YQogICAgbWVtb2l6YXRpb25NYXAuc2V0KGlucHV0VmFsdWUsIHJldHVyblZhbHVlKTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhpbnB1dFZhbHVlKSkgewogICAgICBpZiAodHlwZW9mIGlucHV0VmFsdWVba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICByZXR1cm5WYWx1ZVtrZXldID0gX2Ryb3BVbmRlZmluZWRLZXlzKGlucHV0VmFsdWVba2V5XSwgbWVtb2l6YXRpb25NYXApOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIGlmIChBcnJheS5pc0FycmF5KGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBhcnJheSBpdCB3YXMgbWFwcGVkIHRvIGluIHRoZSBuZXcgb2JqZWN0CiAgICBjb25zdCBtZW1vVmFsID0gbWVtb2l6YXRpb25NYXAuZ2V0KGlucHV0VmFsdWUpOwogICAgaWYgKG1lbW9WYWwgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbWVtb1ZhbCA7CiAgICB9CgogICAgY29uc3QgcmV0dXJuVmFsdWUgPSBbXTsKICAgIC8vIFN0b3JlIHRoZSBtYXBwaW5nIG9mIHRoaXMgdmFsdWUgaW4gY2FzZSB3ZSB2aXNpdCBpdCBhZ2FpbiwgaW4gY2FzZSBvZiBjaXJjdWxhciBkYXRhCiAgICBtZW1vaXphdGlvbk1hcC5zZXQoaW5wdXRWYWx1ZSwgcmV0dXJuVmFsdWUpOwoKICAgIGlucHV0VmFsdWUuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICByZXR1cm5WYWx1ZS5wdXNoKF9kcm9wVW5kZWZpbmVkS2V5cyhpdGVtLCBtZW1vaXphdGlvbk1hcCkpOwogICAgfSk7CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIHJldHVybiBpbnB1dFZhbHVlOwp9CgpmdW5jdGlvbiBpc1Bvam8oaW5wdXQpIHsKICBpZiAoIWlzUGxhaW5PYmplY3QoaW5wdXQpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB0cnkgewogICAgY29uc3QgbmFtZSA9IChPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5wdXQpICkuY29uc3RydWN0b3IubmFtZTsKICAgIHJldHVybiAhbmFtZSB8fCBuYW1lID09PSAnT2JqZWN0JzsKICB9IGNhdGNoIChlKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgogKiBEb2VzIHRoaXMgZmlsZW5hbWUgbG9vayBsaWtlIGl0J3MgcGFydCBvZiB0aGUgYXBwIGNvZGU/CiAqLwpmdW5jdGlvbiBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUsIGlzTmF0aXZlID0gZmFsc2UpIHsKICBjb25zdCBpc0ludGVybmFsID0KICAgIGlzTmF0aXZlIHx8CiAgICAoZmlsZW5hbWUgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSBsaW51eCBwYXRoCiAgICAgICFmaWxlbmFtZS5zdGFydHNXaXRoKCcvJykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSB3aW5kb3dzIHBhdGgKICAgICAgIWZpbGVuYW1lLm1hdGNoKC9eW0EtWl06LykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgdGhlIHBhdGggaXMgc3RhcnRpbmcgd2l0aCBhIGRvdAogICAgICAhZmlsZW5hbWUuc3RhcnRzV2l0aCgnLicpICYmCiAgICAgIC8vIEl0J3Mgbm90IGludGVybmFsIGlmIHRoZSBmcmFtZSBoYXMgYSBwcm90b2NvbC4gSW4gbm9kZSwgdGhpcyBpcyB1c3VhbGx5IHRoZSBjYXNlIGlmIHRoZSBmaWxlIGdvdCBwcmUtcHJvY2Vzc2VkIHdpdGggYSBidW5kbGVyIGxpa2Ugd2VicGFjawogICAgICAhZmlsZW5hbWUubWF0Y2goL15bYS16QS1aXShbYS16QS1aMC05LlwtK10pKjpcL1wvLykpOyAvLyBTY2hlbWEgZnJvbTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM2NDE3ODIKCiAgLy8gaW5fYXBwIGlzIGFsbCB0aGF0J3Mgbm90IGFuIGludGVybmFsIE5vZGUgZnVuY3Rpb24gb3IgYSBtb2R1bGUgd2l0aGluIG5vZGVfbW9kdWxlcwogIC8vIG5vdGUgdGhhdCBpc05hdGl2ZSBhcHBlYXJzIHRvIHJldHVybiB0cnVlIGV2ZW4gZm9yIG5vZGUgY29yZSBsaWJyYXJpZXMKICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9yYXZlbi1ub2RlL2lzc3Vlcy8xNzYKCiAgcmV0dXJuICFpc0ludGVybmFsICYmIGZpbGVuYW1lICE9PSB1bmRlZmluZWQgJiYgIWZpbGVuYW1lLmluY2x1ZGVzKCdub2RlX21vZHVsZXMvJyk7Cn0KCmNvbnN0IFNUQUNLVFJBQ0VfRlJBTUVfTElNSVQgPSA1MDsKY29uc3QgU1RSSVBfRlJBTUVfUkVHRVhQID0gL2NhcHR1cmVNZXNzYWdlfGNhcHR1cmVFeGNlcHRpb24vOwoKLyoqCiAqIFJlbW92ZXMgU2VudHJ5IGZyYW1lcyBmcm9tIHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgc3RhY2sgaWYgcHJlc2VudCBhbmQgZW5mb3JjZXMgYSBsaW1pdCBvZiBtYXggbnVtYmVyIG9mIGZyYW1lcy4KICogQXNzdW1lcyBzdGFjayBpbnB1dCBpcyBvcmRlcmVkIGZyb20gdG9wIHRvIGJvdHRvbSBhbmQgcmV0dXJucyB0aGUgcmV2ZXJzZSByZXByZXNlbnRhdGlvbiBzbyBjYWxsIHNpdGUgb2YgdGhlCiAqIGZ1bmN0aW9uIHRoYXQgY2F1c2VkIHRoZSBjcmFzaCBpcyB0aGUgbGFzdCBmcmFtZSBpbiB0aGUgYXJyYXkuCiAqIEBoaWRkZW4KICovCmZ1bmN0aW9uIHN0cmlwU2VudHJ5RnJhbWVzQW5kUmV2ZXJzZShzdGFjaykgewogIGlmICghc3RhY2subGVuZ3RoKSB7CiAgICByZXR1cm4gW107CiAgfQoKICBjb25zdCBsb2NhbFN0YWNrID0gQXJyYXkuZnJvbShzdGFjayk7CgogIC8vIElmIHN0YWNrIHN0YXJ0cyB3aXRoIG9uZSBvZiBvdXIgQVBJIGNhbGxzLCByZW1vdmUgaXQgKHN0YXJ0cywgbWVhbmluZyBpdCdzIHRoZSB0b3Agb2YgdGhlIHN0YWNrIC0gYWthIGxhc3QgY2FsbCkKICBpZiAoL3NlbnRyeVdyYXBwZWQvLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgbG9jYWxTdGFjay5wb3AoKTsKICB9CgogIC8vIFJldmVyc2luZyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBwcm9jZWR1cmUgYWxsb3dzIHVzIHRvIGp1c3QgcG9wIHRoZSB2YWx1ZXMgb2ZmIHRoZSBzdGFjawogIGxvY2FsU3RhY2sucmV2ZXJzZSgpOwoKICAvLyBJZiBzdGFjayBlbmRzIHdpdGggb25lIG9mIG91ciBpbnRlcm5hbCBBUEkgY2FsbHMsIHJlbW92ZSBpdCAoZW5kcywgbWVhbmluZyBpdCdzIHRoZSBib3R0b20gb2YgdGhlIHN0YWNrIC0gYWthIHRvcC1tb3N0IGNhbGwpCiAgaWYgKFNUUklQX0ZSQU1FX1JFR0VYUC50ZXN0KGxvY2FsU3RhY2tbbG9jYWxTdGFjay5sZW5ndGggLSAxXS5mdW5jdGlvbiB8fCAnJykpIHsKICAgIGxvY2FsU3RhY2sucG9wKCk7CgogICAgLy8gV2hlbiB1c2luZyBzeW50aGV0aWMgZXZlbnRzLCB3ZSB3aWxsIGhhdmUgYSAyIGxldmVscyBkZWVwIHN0YWNrLCBhcyBgbmV3IEVycm9yKCdTZW50cnkgc3ludGhldGljRXhjZXB0aW9uJylgCiAgICAvLyBpcyBwcm9kdWNlZCB3aXRoaW4gdGhlIGh1YiBpdHNlbGYsIG1ha2luZyBpdDoKICAgIC8vCiAgICAvLyAgIFNlbnRyeS5jYXB0dXJlRXhjZXB0aW9uKCkKICAgIC8vICAgZ2V0Q3VycmVudEh1YigpLmNhcHR1cmVFeGNlcHRpb24oKQogICAgLy8KICAgIC8vIGluc3RlYWQgb2YganVzdCB0aGUgdG9wIGBTZW50cnlgIGNhbGwgaXRzZWxmLgogICAgLy8gVGhpcyBmb3JjZXMgdXMgdG8gcG9zc2libHkgc3RyaXAgYW4gYWRkaXRpb25hbCBmcmFtZSBpbiB0aGUgZXhhY3Qgc2FtZSB3YXMgYXMgYWJvdmUuCiAgICBpZiAoU1RSSVBfRlJBTUVfUkVHRVhQLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgICBsb2NhbFN0YWNrLnBvcCgpOwogICAgfQogIH0KCiAgcmV0dXJuIGxvY2FsU3RhY2suc2xpY2UoMCwgU1RBQ0tUUkFDRV9GUkFNRV9MSU1JVCkubWFwKGZyYW1lID0+ICh7CiAgICAuLi5mcmFtZSwKICAgIGZpbGVuYW1lOiBmcmFtZS5maWxlbmFtZSB8fCBsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZmlsZW5hbWUsCiAgICBmdW5jdGlvbjogZnJhbWUuZnVuY3Rpb24gfHwgJz8nLAogIH0pKTsKfQoKY29uc3QgZGVmYXVsdEZ1bmN0aW9uTmFtZSA9ICc8YW5vbnltb3VzPic7CgovKioKICogU2FmZWx5IGV4dHJhY3QgZnVuY3Rpb24gbmFtZSBmcm9tIGl0c2VsZgogKi8KZnVuY3Rpb24gZ2V0RnVuY3Rpb25OYW1lKGZuKSB7CiAgdHJ5IHsKICAgIGlmICghZm4gfHwgdHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogICAgfQogICAgcmV0dXJuIGZuLm5hbWUgfHwgZGVmYXVsdEZ1bmN0aW9uTmFtZTsKICB9IGNhdGNoIChlKSB7CiAgICAvLyBKdXN0IGFjY2Vzc2luZyBjdXN0b20gcHJvcHMgaW4gc29tZSBTZWxlbml1bSBlbnZpcm9ubWVudHMKICAgIC8vIGNhbiBjYXVzZSBhICJQZXJtaXNzaW9uIGRlbmllZCIgZXhjZXB0aW9uIChzZWUgcmF2ZW4tanMjNDk1KS4KICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogIH0KfQoKLyoqCiAqIFVVSUQ0IGdlbmVyYXRvcgogKgogKiBAcmV0dXJucyBzdHJpbmcgR2VuZXJhdGVkIFVVSUQ0LgogKi8KZnVuY3Rpb24gdXVpZDQoKSB7CiAgY29uc3QgZ2JsID0gR0xPQkFMX09CSiA7CiAgY29uc3QgY3J5cHRvID0gZ2JsLmNyeXB0byB8fCBnYmwubXNDcnlwdG87CgogIGxldCBnZXRSYW5kb21CeXRlID0gKCkgPT4gTWF0aC5yYW5kb20oKSAqIDE2OwogIHRyeSB7CiAgICBpZiAoY3J5cHRvICYmIGNyeXB0by5yYW5kb21VVUlEKSB7CiAgICAgIHJldHVybiBjcnlwdG8ucmFuZG9tVVVJRCgpLnJlcGxhY2UoLy0vZywgJycpOwogICAgfQogICAgaWYgKGNyeXB0byAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKSB7CiAgICAgIGdldFJhbmRvbUJ5dGUgPSAoKSA9PiB7CiAgICAgICAgLy8gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtaWdodCByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIHR5cGVkIGFycmF5CiAgICAgICAgLy8gaW4gb2xkIENocm9taXVtIHZlcnNpb25zIChlLmcuIDIzLjAuMTIzNS4wICgxNTE0MjIpKQogICAgICAgIC8vIEhvd2V2ZXIsIGB0eXBlZEFycmF5YCBpcyBzdGlsbCBmaWxsZWQgaW4tcGxhY2UuCiAgICAgICAgLy8gQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3J5cHRvL2dldFJhbmRvbVZhbHVlcyN0eXBlZGFycmF5CiAgICAgICAgY29uc3QgdHlwZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KDEpOwogICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXModHlwZWRBcnJheSk7CiAgICAgICAgcmV0dXJuIHR5cGVkQXJyYXlbMF07CiAgICAgIH07CiAgICB9CiAgfSBjYXRjaCAoXykgewogICAgLy8gc29tZSBydW50aW1lcyBjYW4gY3Jhc2ggaW52b2tpbmcgY3J5cHRvCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy84OTM1CiAgfQoKICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHQvMjExNzUyMyMyMTE3NTIzCiAgLy8gQ29uY2F0ZW5hdGluZyB0aGUgZm9sbG93aW5nIG51bWJlcnMgYXMgc3RyaW5ncyByZXN1bHRzIGluICcxMDAwMDAwMDEwMDA0MDAwODAwMDEwMDAwMDAwMDAwMCcKICByZXR1cm4gKChbMWU3XSApICsgMWUzICsgNGUzICsgOGUzICsgMWUxMSkucmVwbGFjZSgvWzAxOF0vZywgYyA9PgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2UKICAgICgoYyApIF4gKChnZXRSYW5kb21CeXRlKCkgJiAxNSkgPj4gKChjICkgLyA0KSkpLnRvU3RyaW5nKDE2KSwKICApOwp9CgovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MgKi8KLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqLwoKLyoqCiAqIEhlbHBlciB0byBkZWN5Y2xlIGpzb24gb2JqZWN0cwogKi8KZnVuY3Rpb24gbWVtb0J1aWxkZXIoKSB7CiAgY29uc3QgaGFzV2Vha1NldCA9IHR5cGVvZiBXZWFrU2V0ID09PSAnZnVuY3Rpb24nOwogIGNvbnN0IGlubmVyID0gaGFzV2Vha1NldCA/IG5ldyBXZWFrU2V0KCkgOiBbXTsKICBmdW5jdGlvbiBtZW1vaXplKG9iaikgewogICAgaWYgKGhhc1dlYWtTZXQpIHsKICAgICAgaWYgKGlubmVyLmhhcyhvYmopKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgaW5uZXIuYWRkKG9iaik7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvcHJlZmVyLWZvci1vZgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbm5lci5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCB2YWx1ZSA9IGlubmVyW2ldOwogICAgICBpZiAodmFsdWUgPT09IG9iaikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9CiAgICBpbm5lci5wdXNoKG9iaik7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBmdW5jdGlvbiB1bm1lbW9pemUob2JqKSB7CiAgICBpZiAoaGFzV2Vha1NldCkgewogICAgICBpbm5lci5kZWxldGUob2JqKTsKICAgIH0gZWxzZSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5uZXIubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoaW5uZXJbaV0gPT09IG9iaikgewogICAgICAgICAgaW5uZXIuc3BsaWNlKGksIDEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIHJldHVybiBbbWVtb2l6ZSwgdW5tZW1vaXplXTsKfQoKLyoqCiAqIFJlY3Vyc2l2ZWx5IG5vcm1hbGl6ZXMgdGhlIGdpdmVuIG9iamVjdC4KICoKICogLSBDcmVhdGVzIGEgY29weSB0byBwcmV2ZW50IG9yaWdpbmFsIGlucHV0IG11dGF0aW9uCiAqIC0gU2tpcHMgbm9uLWVudW1lcmFibGUgcHJvcGVydGllcwogKiAtIFdoZW4gc3RyaW5naWZ5aW5nLCBjYWxscyBgdG9KU09OYCBpZiBpbXBsZW1lbnRlZAogKiAtIFJlbW92ZXMgY2lyY3VsYXIgcmVmZXJlbmNlcwogKiAtIFRyYW5zbGF0ZXMgbm9uLXNlcmlhbGl6YWJsZSB2YWx1ZXMgKGB1bmRlZmluZWRgL2BOYU5gL2Z1bmN0aW9ucykgdG8gc2VyaWFsaXphYmxlIGZvcm1hdAogKiAtIFRyYW5zbGF0ZXMga25vd24gZ2xvYmFsIG9iamVjdHMvY2xhc3NlcyB0byBhIHN0cmluZyByZXByZXNlbnRhdGlvbnMKICogLSBUYWtlcyBjYXJlIG9mIGBFcnJvcmAgb2JqZWN0IHNlcmlhbGl6YXRpb24KICogLSBPcHRpb25hbGx5IGxpbWl0cyBkZXB0aCBvZiBmaW5hbCBvdXRwdXQKICogLSBPcHRpb25hbGx5IGxpbWl0cyBudW1iZXIgb2YgcHJvcGVydGllcy9lbGVtZW50cyBpbmNsdWRlZCBpbiBhbnkgc2luZ2xlIG9iamVjdC9hcnJheQogKgogKiBAcGFyYW0gaW5wdXQgVGhlIG9iamVjdCB0byBiZSBub3JtYWxpemVkLgogKiBAcGFyYW0gZGVwdGggVGhlIG1heCBkZXB0aCB0byB3aGljaCB0byBub3JtYWxpemUgdGhlIG9iamVjdC4gKEFueXRoaW5nIGRlZXBlciBzdHJpbmdpZmllZCB3aG9sZS4pCiAqIEBwYXJhbSBtYXhQcm9wZXJ0aWVzIFRoZSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIG9yIHByb3BlcnRpZXMgdG8gYmUgaW5jbHVkZWQgaW4gYW55IHNpbmdsZSBhcnJheSBvcgogKiBvYmplY3QgaW4gdGhlIG5vcm1hbGxpemVkIG91dHB1dC4KICogQHJldHVybnMgQSBub3JtYWxpemVkIHZlcnNpb24gb2YgdGhlIG9iamVjdCwgb3IgYCIqKm5vbi1zZXJpYWxpemFibGUqKiJgIGlmIGFueSBlcnJvcnMgYXJlIHRocm93biBkdXJpbmcgbm9ybWFsaXphdGlvbi4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55CmZ1bmN0aW9uIG5vcm1hbGl6ZShpbnB1dCwgZGVwdGggPSAxMDAsIG1heFByb3BlcnRpZXMgPSArSW5maW5pdHkpIHsKICB0cnkgewogICAgLy8gc2luY2Ugd2UncmUgYXQgdGhlIG91dGVybW9zdCBsZXZlbCwgd2UgZG9uJ3QgcHJvdmlkZSBhIGtleQogICAgcmV0dXJuIHZpc2l0KCcnLCBpbnB1dCwgZGVwdGgsIG1heFByb3BlcnRpZXMpOwogIH0gY2F0Y2ggKGVycikgewogICAgcmV0dXJuIHsgRVJST1I6IGAqKm5vbi1zZXJpYWxpemFibGUqKiAoJHtlcnJ9KWAgfTsKICB9Cn0KCi8qKgogKiBWaXNpdHMgYSBub2RlIHRvIHBlcmZvcm0gbm9ybWFsaXphdGlvbiBvbiBpdAogKgogKiBAcGFyYW0ga2V5IFRoZSBrZXkgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gbm9kZQogKiBAcGFyYW0gdmFsdWUgVGhlIG5vZGUgdG8gYmUgdmlzaXRlZAogKiBAcGFyYW0gZGVwdGggT3B0aW9uYWwgbnVtYmVyIGluZGljYXRpbmcgdGhlIG1heGltdW0gcmVjdXJzaW9uIGRlcHRoCiAqIEBwYXJhbSBtYXhQcm9wZXJ0aWVzIE9wdGlvbmFsIG1heGltdW0gbnVtYmVyIG9mIHByb3BlcnRpZXMvZWxlbWVudHMgaW5jbHVkZWQgaW4gYW55IHNpbmdsZSBvYmplY3QvYXJyYXkKICogQHBhcmFtIG1lbW8gT3B0aW9uYWwgTWVtbyBjbGFzcyBoYW5kbGluZyBkZWN5Y2xpbmcKICovCmZ1bmN0aW9uIHZpc2l0KAogIGtleSwKICB2YWx1ZSwKICBkZXB0aCA9ICtJbmZpbml0eSwKICBtYXhQcm9wZXJ0aWVzID0gK0luZmluaXR5LAogIG1lbW8gPSBtZW1vQnVpbGRlcigpLAopIHsKICBjb25zdCBbbWVtb2l6ZSwgdW5tZW1vaXplXSA9IG1lbW87CgogIC8vIEdldCB0aGUgc2ltcGxlIGNhc2VzIG91dCBvZiB0aGUgd2F5IGZpcnN0CiAgaWYgKAogICAgdmFsdWUgPT0gbnVsbCB8fCAvLyB0aGlzIG1hdGNoZXMgbnVsbCBhbmQgdW5kZWZpbmVkIC0+IGVxZXEgbm90IGVxZXFlcQogICAgKFsnbnVtYmVyJywgJ2Jvb2xlYW4nLCAnc3RyaW5nJ10uaW5jbHVkZXModHlwZW9mIHZhbHVlKSAmJiAhaXNOYU4kMSh2YWx1ZSkpCiAgKSB7CiAgICByZXR1cm4gdmFsdWUgOwogIH0KCiAgY29uc3Qgc3RyaW5naWZpZWQgPSBzdHJpbmdpZnlWYWx1ZShrZXksIHZhbHVlKTsKCiAgLy8gQW55dGhpbmcgd2UgY291bGQgcG90ZW50aWFsbHkgZGlnIGludG8gbW9yZSAob2JqZWN0cyBvciBhcnJheXMpIHdpbGwgaGF2ZSBjb21lIGJhY2sgYXMgYCJbb2JqZWN0IFhYWFhdImAuCiAgLy8gRXZlcnl0aGluZyBlbHNlIHdpbGwgaGF2ZSBhbHJlYWR5IGJlZW4gc2VyaWFsaXplZCwgc28gaWYgd2UgZG9uJ3Qgc2VlIHRoYXQgcGF0dGVybiwgd2UncmUgZG9uZS4KICBpZiAoIXN0cmluZ2lmaWVkLnN0YXJ0c1dpdGgoJ1tvYmplY3QgJykpIHsKICAgIHJldHVybiBzdHJpbmdpZmllZDsKICB9CgogIC8vIEZyb20gaGVyZSBvbiwgd2UgY2FuIGFzc2VydCB0aGF0IGB2YWx1ZWAgaXMgZWl0aGVyIGFuIG9iamVjdCBvciBhbiBhcnJheS4KCiAgLy8gRG8gbm90IG5vcm1hbGl6ZSBvYmplY3RzIHRoYXQgd2Uga25vdyBoYXZlIGFscmVhZHkgYmVlbiBub3JtYWxpemVkLiBBcyBhIGdlbmVyYWwgcnVsZSwgdGhlCiAgLy8gIl9fc2VudHJ5X3NraXBfbm9ybWFsaXphdGlvbl9fIiBwcm9wZXJ0eSBzaG91bGQgb25seSBiZSB1c2VkIHNwYXJpbmdseSBhbmQgb25seSBzaG91bGQgb25seSBiZSBzZXQgb24gb2JqZWN0cyB0aGF0CiAgLy8gaGF2ZSBhbHJlYWR5IGJlZW4gbm9ybWFsaXplZC4KICBpZiAoKHZhbHVlIClbJ19fc2VudHJ5X3NraXBfbm9ybWFsaXphdGlvbl9fJ10pIHsKICAgIHJldHVybiB2YWx1ZSA7CiAgfQoKICAvLyBXZSBjYW4gc2V0IGBfX3NlbnRyeV9vdmVycmlkZV9ub3JtYWxpemF0aW9uX2RlcHRoX19gIG9uIGFuIG9iamVjdCB0byBlbnN1cmUgdGhhdCBmcm9tIHRoZXJlCiAgLy8gV2Uga2VlcCBhIGNlcnRhaW4gYW1vdW50IG9mIGRlcHRoLgogIC8vIFRoaXMgc2hvdWxkIGJlIHVzZWQgc3BhcmluZ2x5LCBlLmcuIHdlIHVzZSBpdCBmb3IgdGhlIHJlZHV4IGludGVncmF0aW9uIHRvIGVuc3VyZSB3ZSBnZXQgYSBjZXJ0YWluIGFtb3VudCBvZiBzdGF0ZS4KICBjb25zdCByZW1haW5pbmdEZXB0aCA9CiAgICB0eXBlb2YgKHZhbHVlIClbJ19fc2VudHJ5X292ZXJyaWRlX25vcm1hbGl6YXRpb25fZGVwdGhfXyddID09PSAnbnVtYmVyJwogICAgICA/ICgodmFsdWUgKVsnX19zZW50cnlfb3ZlcnJpZGVfbm9ybWFsaXphdGlvbl9kZXB0aF9fJ10gKQogICAgICA6IGRlcHRoOwoKICAvLyBXZSdyZSBhbHNvIGRvbmUgaWYgd2UndmUgcmVhY2hlZCB0aGUgbWF4IGRlcHRoCiAgaWYgKHJlbWFpbmluZ0RlcHRoID09PSAwKSB7CiAgICAvLyBBdCB0aGlzIHBvaW50IHdlIGtub3cgYHNlcmlhbGl6ZWRgIGlzIGEgc3RyaW5nIG9mIHRoZSBmb3JtIGAiW29iamVjdCBYWFhYXSJgLiBDbGVhbiBpdCB1cCBzbyBpdCdzIGp1c3QgYCJbWFhYWF0iYC4KICAgIHJldHVybiBzdHJpbmdpZmllZC5yZXBsYWNlKCdvYmplY3QgJywgJycpOwogIH0KCiAgLy8gSWYgd2UndmUgYWxyZWFkeSB2aXNpdGVkIHRoaXMgYnJhbmNoLCBiYWlsIG91dCwgYXMgaXQncyBjaXJjdWxhciByZWZlcmVuY2UuIElmIG5vdCwgbm90ZSB0aGF0IHdlJ3JlIHNlZWluZyBpdCBub3cuCiAgaWYgKG1lbW9pemUodmFsdWUpKSB7CiAgICByZXR1cm4gJ1tDaXJjdWxhciB+XSc7CiAgfQoKICAvLyBJZiB0aGUgdmFsdWUgaGFzIGEgYHRvSlNPTmAgbWV0aG9kLCB3ZSBjYWxsIGl0IHRvIGV4dHJhY3QgbW9yZSBpbmZvcm1hdGlvbgogIGNvbnN0IHZhbHVlV2l0aFRvSlNPTiA9IHZhbHVlIDsKICBpZiAodmFsdWVXaXRoVG9KU09OICYmIHR5cGVvZiB2YWx1ZVdpdGhUb0pTT04udG9KU09OID09PSAnZnVuY3Rpb24nKSB7CiAgICB0cnkgewogICAgICBjb25zdCBqc29uVmFsdWUgPSB2YWx1ZVdpdGhUb0pTT04udG9KU09OKCk7CiAgICAgIC8vIFdlIG5lZWQgdG8gbm9ybWFsaXplIHRoZSByZXR1cm4gdmFsdWUgb2YgYC50b0pTT04oKWAgaW4gY2FzZSBpdCBoYXMgY2lyY3VsYXIgcmVmZXJlbmNlcwogICAgICByZXR1cm4gdmlzaXQoJycsIGpzb25WYWx1ZSwgcmVtYWluaW5nRGVwdGggLSAxLCBtYXhQcm9wZXJ0aWVzLCBtZW1vKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICAvLyBwYXNzIChUaGUgYnVpbHQtaW4gYHRvSlNPTmAgZmFpbGVkLCBidXQgd2UgY2FuIHN0aWxsIHRyeSB0byBkbyBpdCBvdXJzZWx2ZXMpCiAgICB9CiAgfQoKICAvLyBBdCB0aGlzIHBvaW50IHdlIGtub3cgd2UgZWl0aGVyIGhhdmUgYW4gb2JqZWN0IG9yIGFuIGFycmF5LCB3ZSBoYXZlbid0IHNlZW4gaXQgYmVmb3JlLCBhbmQgd2UncmUgZ29pbmcgdG8gcmVjdXJzZQogIC8vIGJlY2F1c2Ugd2UgaGF2ZW4ndCB5ZXQgcmVhY2hlZCB0aGUgbWF4IGRlcHRoLiBDcmVhdGUgYW4gYWNjdW11bGF0b3IgdG8gaG9sZCB0aGUgcmVzdWx0cyBvZiB2aXNpdGluZyBlYWNoCiAgLy8gcHJvcGVydHkvZW50cnksIGFuZCBrZWVwIHRyYWNrIG9mIHRoZSBudW1iZXIgb2YgaXRlbXMgd2UgYWRkIHRvIGl0LgogIGNvbnN0IG5vcm1hbGl6ZWQgPSAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBbXSA6IHt9KSA7CiAgbGV0IG51bUFkZGVkID0gMDsKCiAgLy8gQmVmb3JlIHdlIGJlZ2luLCBjb252ZXJ0YEVycm9yYCBhbmRgRXZlbnRgIGluc3RhbmNlcyBpbnRvIHBsYWluIG9iamVjdHMsIHNpbmNlIHNvbWUgb2YgZWFjaCBvZiB0aGVpciByZWxldmFudAogIC8vIHByb3BlcnRpZXMgYXJlIG5vbi1lbnVtZXJhYmxlIGFuZCBvdGhlcndpc2Ugd291bGQgZ2V0IG1pc3NlZC4KICBjb25zdCB2aXNpdGFibGUgPSBjb252ZXJ0VG9QbGFpbk9iamVjdCh2YWx1ZSApOwoKICBmb3IgKGNvbnN0IHZpc2l0S2V5IGluIHZpc2l0YWJsZSkgewogICAgLy8gQXZvaWQgaXRlcmF0aW5nIG92ZXIgZmllbGRzIGluIHRoZSBwcm90b3R5cGUgaWYgdGhleSd2ZSBzb21laG93IGJlZW4gZXhwb3NlZCB0byBlbnVtZXJhdGlvbi4KICAgIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZpc2l0YWJsZSwgdmlzaXRLZXkpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmIChudW1BZGRlZCA+PSBtYXhQcm9wZXJ0aWVzKSB7CiAgICAgIG5vcm1hbGl6ZWRbdmlzaXRLZXldID0gJ1tNYXhQcm9wZXJ0aWVzIH5dJzsKICAgICAgYnJlYWs7CiAgICB9CgogICAgLy8gUmVjdXJzaXZlbHkgdmlzaXQgYWxsIHRoZSBjaGlsZCBub2RlcwogICAgY29uc3QgdmlzaXRWYWx1ZSA9IHZpc2l0YWJsZVt2aXNpdEtleV07CiAgICBub3JtYWxpemVkW3Zpc2l0S2V5XSA9IHZpc2l0KHZpc2l0S2V5LCB2aXNpdFZhbHVlLCByZW1haW5pbmdEZXB0aCAtIDEsIG1heFByb3BlcnRpZXMsIG1lbW8pOwoKICAgIG51bUFkZGVkKys7CiAgfQoKICAvLyBPbmNlIHdlJ3ZlIHZpc2l0ZWQgYWxsIHRoZSBicmFuY2hlcywgcmVtb3ZlIHRoZSBwYXJlbnQgZnJvbSBtZW1vIHN0b3JhZ2UKICB1bm1lbW9pemUodmFsdWUpOwoKICAvLyBSZXR1cm4gYWNjdW11bGF0ZWQgdmFsdWVzCiAgcmV0dXJuIG5vcm1hbGl6ZWQ7Cn0KCi8qIGVzbGludC1kaXNhYmxlIGNvbXBsZXhpdHkgKi8KLyoqCiAqIFN0cmluZ2lmeSB0aGUgZ2l2ZW4gdmFsdWUuIEhhbmRsZXMgdmFyaW91cyBrbm93biBzcGVjaWFsIHZhbHVlcyBhbmQgdHlwZXMuCiAqCiAqIE5vdCBtZWFudCB0byBiZSB1c2VkIG9uIHNpbXBsZSBwcmltaXRpdmVzIHdoaWNoIGFscmVhZHkgaGF2ZSBhIHN0cmluZyByZXByZXNlbnRhdGlvbiwgYXMgaXQgd2lsbCwgZm9yIGV4YW1wbGUsIHR1cm4KICogdGhlIG51bWJlciAxMjMxIGludG8gIltPYmplY3QgTnVtYmVyXSIsIG5vciBvbiBgbnVsbGAsIGFzIGl0IHdpbGwgdGhyb3cuCiAqCiAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gc3RyaW5naWZ5CiAqIEByZXR1cm5zIEEgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIHZhbHVlCiAqLwpmdW5jdGlvbiBzdHJpbmdpZnlWYWx1ZSgKICBrZXksCiAgLy8gdGhpcyB0eXBlIGlzIGEgdGlueSBiaXQgb2YgYSBjaGVhdCwgc2luY2UgdGhpcyBmdW5jdGlvbiBkb2VzIGhhbmRsZSBOYU4gKHdoaWNoIGlzIHRlY2huaWNhbGx5IGEgbnVtYmVyKSwgYnV0IGZvcgogIC8vIG91ciBpbnRlcm5hbCB1c2UsIGl0J2xsIGRvCiAgdmFsdWUsCikgewogIHRyeSB7CiAgICBpZiAoa2V5ID09PSAnZG9tYWluJyAmJiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICh2YWx1ZSApLl9ldmVudHMpIHsKICAgICAgcmV0dXJuICdbRG9tYWluXSc7CiAgICB9CgogICAgaWYgKGtleSA9PT0gJ2RvbWFpbkVtaXR0ZXInKSB7CiAgICAgIHJldHVybiAnW0RvbWFpbkVtaXR0ZXJdJzsKICAgIH0KCiAgICAvLyBJdCdzIHNhZmUgdG8gdXNlIGBnbG9iYWxgLCBgd2luZG93YCwgYW5kIGBkb2N1bWVudGAgaGVyZSBpbiB0aGlzIG1hbm5lciwgYXMgd2UgYXJlIGFzc2VydGluZyB1c2luZyBgdHlwZW9mYCBmaXJzdAogICAgLy8gd2hpY2ggd29uJ3QgdGhyb3cgaWYgdGhleSBhcmUgbm90IHByZXNlbnQuCgogICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlID09PSBnbG9iYWwpIHsKICAgICAgcmV0dXJuICdbR2xvYmFsXSc7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlID09PSB3aW5kb3cpIHsKICAgICAgcmV0dXJuICdbV2luZG93XSc7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgPT09IGRvY3VtZW50KSB7CiAgICAgIHJldHVybiAnW0RvY3VtZW50XSc7CiAgICB9CgogICAgaWYgKGlzVnVlVmlld01vZGVsKHZhbHVlKSkgewogICAgICByZXR1cm4gJ1tWdWVWaWV3TW9kZWxdJzsKICAgIH0KCiAgICAvLyBSZWFjdCdzIFN5bnRoZXRpY0V2ZW50IHRoaW5neQogICAgaWYgKGlzU3ludGhldGljRXZlbnQodmFsdWUpKSB7CiAgICAgIHJldHVybiAnW1N5bnRoZXRpY0V2ZW50XSc7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgdmFsdWUgIT09IHZhbHVlKSB7CiAgICAgIHJldHVybiAnW05hTl0nOwogICAgfQoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIGBbRnVuY3Rpb246ICR7Z2V0RnVuY3Rpb25OYW1lKHZhbHVlKX1dYDsKICAgIH0KCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3ltYm9sJykgewogICAgICByZXR1cm4gYFske1N0cmluZyh2YWx1ZSl9XWA7CiAgICB9CgogICAgLy8gc3RyaW5naWZpZWQgQmlnSW50cyBhcmUgaW5kaXN0aW5ndWlzaGFibGUgZnJvbSByZWd1bGFyIG51bWJlcnMsIHNvIHdlIG5lZWQgdG8gbGFiZWwgdGhlbSB0byBhdm9pZCBjb25mdXNpb24KICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdiaWdpbnQnKSB7CiAgICAgIHJldHVybiBgW0JpZ0ludDogJHtTdHJpbmcodmFsdWUpfV1gOwogICAgfQoKICAgIC8vIE5vdyB0aGF0IHdlJ3ZlIGtub2NrZWQgb3V0IGFsbCB0aGUgc3BlY2lhbCBjYXNlcyBhbmQgdGhlIHByaW1pdGl2ZXMsIGFsbCB3ZSBoYXZlIGxlZnQgYXJlIG9iamVjdHMuIFNpbXBseSBjYXN0aW5nCiAgICAvLyB0aGVtIHRvIHN0cmluZ3MgbWVhbnMgdGhhdCBpbnN0YW5jZXMgb2YgY2xhc3NlcyB3aGljaCBoYXZlbid0IGRlZmluZWQgdGhlaXIgYHRvU3RyaW5nVGFnYCB3aWxsIGp1c3QgY29tZSBvdXQgYXMKICAgIC8vIGAiW29iamVjdCBPYmplY3RdImAuIElmIHdlIGluc3RlYWQgbG9vayBhdCB0aGUgY29uc3RydWN0b3IncyBuYW1lICh3aGljaCBpcyB0aGUgc2FtZSBhcyB0aGUgbmFtZSBvZiB0aGUgY2xhc3MpLAogICAgLy8gd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IG9ubHkgcGxhaW4gb2JqZWN0cyBjb21lIG91dCB0aGF0IHdheS4KICAgIGNvbnN0IG9iak5hbWUgPSBnZXRDb25zdHJ1Y3Rvck5hbWUodmFsdWUpOwoKICAgIC8vIEhhbmRsZSBIVE1MIEVsZW1lbnRzCiAgICBpZiAoL15IVE1MKFx3KilFbGVtZW50JC8udGVzdChvYmpOYW1lKSkgewogICAgICByZXR1cm4gYFtIVE1MRWxlbWVudDogJHtvYmpOYW1lfV1gOwogICAgfQoKICAgIHJldHVybiBgW29iamVjdCAke29iak5hbWV9XWA7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXR1cm4gYCoqbm9uLXNlcmlhbGl6YWJsZSoqICgke2Vycn0pYDsKICB9Cn0KLyogZXNsaW50LWVuYWJsZSBjb21wbGV4aXR5ICovCgpmdW5jdGlvbiBnZXRDb25zdHJ1Y3Rvck5hbWUodmFsdWUpIHsKICBjb25zdCBwcm90b3R5cGUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodmFsdWUpOwoKICByZXR1cm4gcHJvdG90eXBlID8gcHJvdG90eXBlLmNvbnN0cnVjdG9yLm5hbWUgOiAnbnVsbCBwcm90b3R5cGUnOwp9CgovKioKICogTm9ybWFsaXplcyBVUkxzIGluIGV4Y2VwdGlvbnMgYW5kIHN0YWNrdHJhY2VzIHRvIGEgYmFzZSBwYXRoIHNvIFNlbnRyeSBjYW4gZmluZ2VycHJpbnQKICogYWNyb3NzIHBsYXRmb3JtcyBhbmQgd29ya2luZyBkaXJlY3RvcnkuCiAqCiAqIEBwYXJhbSB1cmwgVGhlIFVSTCB0byBiZSBub3JtYWxpemVkLgogKiBAcGFyYW0gYmFzZVBhdGggVGhlIGFwcGxpY2F0aW9uIGJhc2UgcGF0aC4KICogQHJldHVybnMgVGhlIG5vcm1hbGl6ZWQgVVJMLgogKi8KZnVuY3Rpb24gbm9ybWFsaXplVXJsVG9CYXNlKHVybCwgYmFzZVBhdGgpIHsKICBjb25zdCBlc2NhcGVkQmFzZSA9IGJhc2VQYXRoCiAgICAvLyBCYWNrc2xhc2ggdG8gZm9yd2FyZAogICAgLnJlcGxhY2UoL1xcL2csICcvJykKICAgIC8vIEVzY2FwZSBSZWdFeHAgc3BlY2lhbCBjaGFyYWN0ZXJzCiAgICAucmVwbGFjZSgvW3xcXHt9KClbXF1eJCsqPy5dL2csICdcXCQmJyk7CgogIGxldCBuZXdVcmwgPSB1cmw7CiAgdHJ5IHsKICAgIG5ld1VybCA9IGRlY29kZVVSSSh1cmwpOwogIH0gY2F0Y2ggKF9PbykgewogICAgLy8gU29tZXRpbWUgdGhpcyBicmVha3MKICB9CiAgcmV0dXJuICgKICAgIG5ld1VybAogICAgICAucmVwbGFjZSgvXFwvZywgJy8nKQogICAgICAucmVwbGFjZSgvd2VicGFjazpcLz8vZywgJycpIC8vIFJlbW92ZSBpbnRlcm1lZGlhdGUgYmFzZSBwYXRoCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAc2VudHJ5LWludGVybmFsL3Nkay9uby1yZWdleHAtY29uc3RydWN0b3IKICAgICAgLnJlcGxhY2UobmV3IFJlZ0V4cChgKGZpbGU6Ly8pPy8qJHtlc2NhcGVkQmFzZX0vKmAsICdpZycpLCAnYXBwOi8vLycpCiAgKTsKfQoKLy8gU2xpZ2h0bHkgbW9kaWZpZWQgKG5vIElFOCBzdXBwb3J0LCBFUzYpIGFuZCB0cmFuc2NyaWJlZCB0byBUeXBlU2NyaXB0CgovLyBTcGxpdCBhIGZpbGVuYW1lIGludG8gW3Jvb3QsIGRpciwgYmFzZW5hbWUsIGV4dF0sIHVuaXggdmVyc2lvbgovLyAncm9vdCcgaXMganVzdCBhIHNsYXNoLCBvciBub3RoaW5nLgpjb25zdCBzcGxpdFBhdGhSZSA9IC9eKFxTKzpcXHxcLz8pKFtcc1xTXSo/KSgoPzpcLnsxLDJ9fFteL1xcXSs/fCkoXC5bXi4vXFxdKnwpKSg/OlsvXFxdKikkLzsKLyoqIEpTRG9jICovCmZ1bmN0aW9uIHNwbGl0UGF0aChmaWxlbmFtZSkgewogIC8vIFRydW5jYXRlIGZpbGVzIG5hbWVzIGdyZWF0ZXIgdGhhbiAxMDI0IGNoYXJhY3RlcnMgdG8gYXZvaWQgcmVnZXggZG9zCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9wdWxsLzg3MzcjZGlzY3Vzc2lvbl9yMTI4NTcxOTE3MgogIGNvbnN0IHRydW5jYXRlZCA9IGZpbGVuYW1lLmxlbmd0aCA+IDEwMjQgPyBgPHRydW5jYXRlZD4ke2ZpbGVuYW1lLnNsaWNlKC0xMDI0KX1gIDogZmlsZW5hbWU7CiAgY29uc3QgcGFydHMgPSBzcGxpdFBhdGhSZS5leGVjKHRydW5jYXRlZCk7CiAgcmV0dXJuIHBhcnRzID8gcGFydHMuc2xpY2UoMSkgOiBbXTsKfQoKLyoqIEpTRG9jICovCmZ1bmN0aW9uIGRpcm5hbWUocGF0aCkgewogIGNvbnN0IHJlc3VsdCA9IHNwbGl0UGF0aChwYXRoKTsKICBjb25zdCByb290ID0gcmVzdWx0WzBdOwogIGxldCBkaXIgPSByZXN1bHRbMV07CgogIGlmICghcm9vdCAmJiAhZGlyKSB7CiAgICAvLyBObyBkaXJuYW1lIHdoYXRzb2V2ZXIKICAgIHJldHVybiAnLic7CiAgfQoKICBpZiAoZGlyKSB7CiAgICAvLyBJdCBoYXMgYSBkaXJuYW1lLCBzdHJpcCB0cmFpbGluZyBzbGFzaAogICAgZGlyID0gZGlyLnNsaWNlKDAsIGRpci5sZW5ndGggLSAxKTsKICB9CgogIHJldHVybiByb290ICsgZGlyOwp9CgovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvZXhwbGljaXQtZnVuY3Rpb24tcmV0dXJuLXR5cGUgKi8KCi8qKiBTeW5jUHJvbWlzZSBpbnRlcm5hbCBzdGF0ZXMgKi8KdmFyIFN0YXRlczsgKGZ1bmN0aW9uIChTdGF0ZXMpIHsKICAvKiogUGVuZGluZyAqLwogIGNvbnN0IFBFTkRJTkcgPSAwOyBTdGF0ZXNbU3RhdGVzWyJQRU5ESU5HIl0gPSBQRU5ESU5HXSA9ICJQRU5ESU5HIjsKICAvKiogUmVzb2x2ZWQgLyBPSyAqLwogIGNvbnN0IFJFU09MVkVEID0gMTsgU3RhdGVzW1N0YXRlc1siUkVTT0xWRUQiXSA9IFJFU09MVkVEXSA9ICJSRVNPTFZFRCI7CiAgLyoqIFJlamVjdGVkIC8gRXJyb3IgKi8KICBjb25zdCBSRUpFQ1RFRCA9IDI7IFN0YXRlc1tTdGF0ZXNbIlJFSkVDVEVEIl0gPSBSRUpFQ1RFRF0gPSAiUkVKRUNURUQiOwp9KShTdGF0ZXMgfHwgKFN0YXRlcyA9IHt9KSk7CgovLyBPdmVybG9hZHMgc28gd2UgY2FuIGNhbGwgcmVzb2x2ZWRTeW5jUHJvbWlzZSB3aXRob3V0IGFyZ3VtZW50cyBhbmQgZ2VuZXJpYyBhcmd1bWVudAoKLyoqCiAqIENyZWF0ZXMgYSByZXNvbHZlZCBzeW5jIHByb21pc2UuCiAqCiAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgdG8gcmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoCiAqIEByZXR1cm5zIHRoZSByZXNvbHZlZCBzeW5jIHByb21pc2UKICovCmZ1bmN0aW9uIHJlc29sdmVkU3luY1Byb21pc2UodmFsdWUpIHsKICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKHJlc29sdmUgPT4gewogICAgcmVzb2x2ZSh2YWx1ZSk7CiAgfSk7Cn0KCi8qKgogKiBDcmVhdGVzIGEgcmVqZWN0ZWQgc3luYyBwcm9taXNlLgogKgogKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIHJlamVjdCB0aGUgcHJvbWlzZSB3aXRoCiAqIEByZXR1cm5zIHRoZSByZWplY3RlZCBzeW5jIHByb21pc2UKICovCmZ1bmN0aW9uIHJlamVjdGVkU3luY1Byb21pc2UocmVhc29uKSB7CiAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7CiAgICByZWplY3QocmVhc29uKTsKICB9KTsKfQoKLyoqCiAqIFRoZW5hYmxlIGNsYXNzIHRoYXQgYmVoYXZlcyBsaWtlIGEgUHJvbWlzZSBhbmQgZm9sbG93cyBpdCdzIGludGVyZmFjZQogKiBidXQgaXMgbm90IGFzeW5jIGludGVybmFsbHkKICovCmNsYXNzIFN5bmNQcm9taXNlIHsKCiAgIGNvbnN0cnVjdG9yKAogICAgZXhlY3V0b3IsCiAgKSB7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdC5jYWxsKHRoaXMpO1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQyLmNhbGwodGhpcyk7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdDMuY2FsbCh0aGlzKTtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0NC5jYWxsKHRoaXMpOwogICAgdGhpcy5fc3RhdGUgPSBTdGF0ZXMuUEVORElORzsKICAgIHRoaXMuX2hhbmRsZXJzID0gW107CgogICAgdHJ5IHsKICAgICAgZXhlY3V0b3IodGhpcy5fcmVzb2x2ZSwgdGhpcy5fcmVqZWN0KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhpcy5fcmVqZWN0KGUpOwogICAgfQogIH0KCiAgLyoqIEpTRG9jICovCiAgIHRoZW4oCiAgICBvbmZ1bGZpbGxlZCwKICAgIG9ucmVqZWN0ZWQsCiAgKSB7CiAgICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgdGhpcy5faGFuZGxlcnMucHVzaChbCiAgICAgICAgZmFsc2UsCiAgICAgICAgcmVzdWx0ID0+IHsKICAgICAgICAgIGlmICghb25mdWxmaWxsZWQpIHsKICAgICAgICAgICAgLy8gVE9ETzogwq9cXyjjg4QpXy/CrwogICAgICAgICAgICAvLyBUT0RPOiBGSVhNRQogICAgICAgICAgICByZXNvbHZlKHJlc3VsdCApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICByZXNvbHZlKG9uZnVsZmlsbGVkKHJlc3VsdCkpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZWFzb24gPT4gewogICAgICAgICAgaWYgKCFvbnJlamVjdGVkKSB7CiAgICAgICAgICAgIHJlamVjdChyZWFzb24pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICByZXNvbHZlKG9ucmVqZWN0ZWQocmVhc29uKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICBdKTsKICAgICAgdGhpcy5fZXhlY3V0ZUhhbmRsZXJzKCk7CiAgICB9KTsKICB9CgogIC8qKiBKU0RvYyAqLwogICBjYXRjaCgKICAgIG9ucmVqZWN0ZWQsCiAgKSB7CiAgICByZXR1cm4gdGhpcy50aGVuKHZhbCA9PiB2YWwsIG9ucmVqZWN0ZWQpOwogIH0KCiAgLyoqIEpTRG9jICovCiAgIGZpbmFsbHkob25maW5hbGx5KSB7CiAgICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbGV0IHZhbDsKICAgICAgbGV0IGlzUmVqZWN0ZWQ7CgogICAgICByZXR1cm4gdGhpcy50aGVuKAogICAgICAgIHZhbHVlID0+IHsKICAgICAgICAgIGlzUmVqZWN0ZWQgPSBmYWxzZTsKICAgICAgICAgIHZhbCA9IHZhbHVlOwogICAgICAgICAgaWYgKG9uZmluYWxseSkgewogICAgICAgICAgICBvbmZpbmFsbHkoKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlYXNvbiA9PiB7CiAgICAgICAgICBpc1JlamVjdGVkID0gdHJ1ZTsKICAgICAgICAgIHZhbCA9IHJlYXNvbjsKICAgICAgICAgIGlmIChvbmZpbmFsbHkpIHsKICAgICAgICAgICAgb25maW5hbGx5KCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgKS50aGVuKCgpID0+IHsKICAgICAgICBpZiAoaXNSZWplY3RlZCkgewogICAgICAgICAgcmVqZWN0KHZhbCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICByZXNvbHZlKHZhbCApOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQoKSB7dGhpcy5fcmVzb2x2ZSA9ICh2YWx1ZSkgPT4gewogICAgdGhpcy5fc2V0UmVzdWx0KFN0YXRlcy5SRVNPTFZFRCwgdmFsdWUpOwogIH07fQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdDIoKSB7dGhpcy5fcmVqZWN0ID0gKHJlYXNvbikgPT4gewogICAgdGhpcy5fc2V0UmVzdWx0KFN0YXRlcy5SRUpFQ1RFRCwgcmVhc29uKTsKICB9O30KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQzKCkge3RoaXMuX3NldFJlc3VsdCA9IChzdGF0ZSwgdmFsdWUpID0+IHsKICAgIGlmICh0aGlzLl9zdGF0ZSAhPT0gU3RhdGVzLlBFTkRJTkcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChpc1RoZW5hYmxlKHZhbHVlKSkgewogICAgICB2b2lkICh2YWx1ZSApLnRoZW4odGhpcy5fcmVzb2x2ZSwgdGhpcy5fcmVqZWN0KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7CiAgICB0aGlzLl92YWx1ZSA9IHZhbHVlOwoKICAgIHRoaXMuX2V4ZWN1dGVIYW5kbGVycygpOwogIH07fQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdDQoKSB7dGhpcy5fZXhlY3V0ZUhhbmRsZXJzID0gKCkgPT4gewogICAgaWYgKHRoaXMuX3N0YXRlID09PSBTdGF0ZXMuUEVORElORykgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3QgY2FjaGVkSGFuZGxlcnMgPSB0aGlzLl9oYW5kbGVycy5zbGljZSgpOwogICAgdGhpcy5faGFuZGxlcnMgPSBbXTsKCiAgICBjYWNoZWRIYW5kbGVycy5mb3JFYWNoKGhhbmRsZXIgPT4gewogICAgICBpZiAoaGFuZGxlclswXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBTdGF0ZXMuUkVTT0xWRUQpIHsKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzCiAgICAgICAgaGFuZGxlclsxXSh0aGlzLl92YWx1ZSApOwogICAgICB9CgogICAgICBpZiAodGhpcy5fc3RhdGUgPT09IFN0YXRlcy5SRUpFQ1RFRCkgewogICAgICAgIGhhbmRsZXJbMl0odGhpcy5fdmFsdWUpOwogICAgICB9CgogICAgICBoYW5kbGVyWzBdID0gdHJ1ZTsKICAgIH0pOwogIH07fQp9CgovKioKICogQ3JlYXRlcyBhbiBuZXcgUHJvbWlzZUJ1ZmZlciBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGxpbWl0CiAqIEBwYXJhbSBsaW1pdCBtYXggbnVtYmVyIG9mIHByb21pc2VzIHRoYXQgY2FuIGJlIHN0b3JlZCBpbiB0aGUgYnVmZmVyCiAqLwpmdW5jdGlvbiBtYWtlUHJvbWlzZUJ1ZmZlcihsaW1pdCkgewogIGNvbnN0IGJ1ZmZlciA9IFtdOwoKICBmdW5jdGlvbiBpc1JlYWR5KCkgewogICAgcmV0dXJuIGxpbWl0ID09PSB1bmRlZmluZWQgfHwgYnVmZmVyLmxlbmd0aCA8IGxpbWl0OwogIH0KCiAgLyoqCiAgICogUmVtb3ZlIGEgcHJvbWlzZSBmcm9tIHRoZSBxdWV1ZS4KICAgKgogICAqIEBwYXJhbSB0YXNrIENhbiBiZSBhbnkgUHJvbWlzZUxpa2U8VD4KICAgKiBAcmV0dXJucyBSZW1vdmVkIHByb21pc2UuCiAgICovCiAgZnVuY3Rpb24gcmVtb3ZlKHRhc2spIHsKICAgIHJldHVybiBidWZmZXIuc3BsaWNlKGJ1ZmZlci5pbmRleE9mKHRhc2spLCAxKVswXTsKICB9CgogIC8qKgogICAqIEFkZCBhIHByb21pc2UgKHJlcHJlc2VudGluZyBhbiBpbi1mbGlnaHQgYWN0aW9uKSB0byB0aGUgcXVldWUsIGFuZCBzZXQgaXQgdG8gcmVtb3ZlIGl0c2VsZiBvbiBmdWxmaWxsbWVudC4KICAgKgogICAqIEBwYXJhbSB0YXNrUHJvZHVjZXIgQSBmdW5jdGlvbiBwcm9kdWNpbmcgYW55IFByb21pc2VMaWtlPFQ+OyBJbiBwcmV2aW91cyB2ZXJzaW9ucyB0aGlzIHVzZWQgdG8gYmUgYHRhc2s6CiAgICogICAgICAgIFByb21pc2VMaWtlPFQ+YCwgYnV0IHVuZGVyIHRoYXQgbW9kZWwsIFByb21pc2VzIHdlcmUgaW5zdGFudGx5IGNyZWF0ZWQgb24gdGhlIGNhbGwtc2l0ZSBhbmQgdGhlaXIgZXhlY3V0b3IKICAgKiAgICAgICAgZnVuY3Rpb25zIHRoZXJlZm9yZSByYW4gaW1tZWRpYXRlbHkuIFRodXMsIGV2ZW4gaWYgdGhlIGJ1ZmZlciB3YXMgZnVsbCwgdGhlIGFjdGlvbiBzdGlsbCBoYXBwZW5lZC4gQnkKICAgKiAgICAgICAgcmVxdWlyaW5nIHRoZSBwcm9taXNlIHRvIGJlIHdyYXBwZWQgaW4gYSBmdW5jdGlvbiwgd2UgY2FuIGRlZmVyIHByb21pc2UgY3JlYXRpb24gdW50aWwgYWZ0ZXIgdGhlIGJ1ZmZlcgogICAqICAgICAgICBsaW1pdCBjaGVjay4KICAgKiBAcmV0dXJucyBUaGUgb3JpZ2luYWwgcHJvbWlzZS4KICAgKi8KICBmdW5jdGlvbiBhZGQodGFza1Byb2R1Y2VyKSB7CiAgICBpZiAoIWlzUmVhZHkoKSkgewogICAgICByZXR1cm4gcmVqZWN0ZWRTeW5jUHJvbWlzZShuZXcgU2VudHJ5RXJyb3IoJ05vdCBhZGRpbmcgUHJvbWlzZSBiZWNhdXNlIGJ1ZmZlciBsaW1pdCB3YXMgcmVhY2hlZC4nKSk7CiAgICB9CgogICAgLy8gc3RhcnQgdGhlIHRhc2sgYW5kIGFkZCBpdHMgcHJvbWlzZSB0byB0aGUgcXVldWUKICAgIGNvbnN0IHRhc2sgPSB0YXNrUHJvZHVjZXIoKTsKICAgIGlmIChidWZmZXIuaW5kZXhPZih0YXNrKSA9PT0gLTEpIHsKICAgICAgYnVmZmVyLnB1c2godGFzayk7CiAgICB9CiAgICB2b2lkIHRhc2sKICAgICAgLnRoZW4oKCkgPT4gcmVtb3ZlKHRhc2spKQogICAgICAvLyBVc2UgYHRoZW4obnVsbCwgcmVqZWN0aW9uSGFuZGxlcilgIHJhdGhlciB0aGFuIGBjYXRjaChyZWplY3Rpb25IYW5kbGVyKWAgc28gdGhhdCB3ZSBjYW4gdXNlIGBQcm9taXNlTGlrZWAKICAgICAgLy8gcmF0aGVyIHRoYW4gYFByb21pc2VgLiBgUHJvbWlzZUxpa2VgIGRvZXNuJ3QgaGF2ZSBhIGAuY2F0Y2hgIG1ldGhvZCwgbWFraW5nIGl0cyBwb2x5ZmlsbCBzbWFsbGVyLiAoRVM1IGRpZG4ndAogICAgICAvLyBoYXZlIHByb21pc2VzLCBzbyBUUyBoYXMgdG8gcG9seWZpbGwgd2hlbiBkb3duLWNvbXBpbGluZy4pCiAgICAgIC50aGVuKG51bGwsICgpID0+CiAgICAgICAgcmVtb3ZlKHRhc2spLnRoZW4obnVsbCwgKCkgPT4gewogICAgICAgICAgLy8gV2UgaGF2ZSB0byBhZGQgYW5vdGhlciBjYXRjaCBoZXJlIGJlY2F1c2UgYHJlbW92ZSgpYCBzdGFydHMgYSBuZXcgcHJvbWlzZSBjaGFpbi4KICAgICAgICB9KSwKICAgICAgKTsKICAgIHJldHVybiB0YXNrOwogIH0KCiAgLyoqCiAgICogV2FpdCBmb3IgYWxsIHByb21pc2VzIGluIHRoZSBxdWV1ZSB0byByZXNvbHZlIG9yIGZvciB0aW1lb3V0IHRvIGV4cGlyZSwgd2hpY2hldmVyIGNvbWVzIGZpcnN0LgogICAqCiAgICogQHBhcmFtIHRpbWVvdXQgVGhlIHRpbWUsIGluIG1zLCBhZnRlciB3aGljaCB0byByZXNvbHZlIHRvIGBmYWxzZWAgaWYgdGhlIHF1ZXVlIGlzIHN0aWxsIG5vbi1lbXB0eS4gUGFzc2luZyBgMGAgKG9yCiAgICogbm90IHBhc3NpbmcgYW55dGhpbmcpIHdpbGwgbWFrZSB0aGUgcHJvbWlzZSB3YWl0IGFzIGxvbmcgYXMgaXQgdGFrZXMgZm9yIHRoZSBxdWV1ZSB0byBkcmFpbiBiZWZvcmUgcmVzb2x2aW5nIHRvCiAgICogYHRydWVgLgogICAqIEByZXR1cm5zIEEgcHJvbWlzZSB3aGljaCB3aWxsIHJlc29sdmUgdG8gYHRydWVgIGlmIHRoZSBxdWV1ZSBpcyBhbHJlYWR5IGVtcHR5IG9yIGRyYWlucyBiZWZvcmUgdGhlIHRpbWVvdXQsIGFuZAogICAqIGBmYWxzZWAgb3RoZXJ3aXNlCiAgICovCiAgZnVuY3Rpb24gZHJhaW4odGltZW91dCkgewogICAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGxldCBjb3VudGVyID0gYnVmZmVyLmxlbmd0aDsKCiAgICAgIGlmICghY291bnRlcikgewogICAgICAgIHJldHVybiByZXNvbHZlKHRydWUpOwogICAgICB9CgogICAgICAvLyB3YWl0IGZvciBgdGltZW91dGAgbXMgYW5kIHRoZW4gcmVzb2x2ZSB0byBgZmFsc2VgIChpZiBub3QgY2FuY2VsbGVkIGZpcnN0KQogICAgICBjb25zdCBjYXB0dXJlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICBpZiAodGltZW91dCAmJiB0aW1lb3V0ID4gMCkgewogICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CiAgICAgICAgfQogICAgICB9LCB0aW1lb3V0KTsKCiAgICAgIC8vIGlmIGFsbCBwcm9taXNlcyByZXNvbHZlIGluIHRpbWUsIGNhbmNlbCB0aGUgdGltZXIgYW5kIHJlc29sdmUgdG8gYHRydWVgCiAgICAgIGJ1ZmZlci5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIHZvaWQgcmVzb2x2ZWRTeW5jUHJvbWlzZShpdGVtKS50aGVuKCgpID0+IHsKICAgICAgICAgIGlmICghLS1jb3VudGVyKSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dChjYXB0dXJlZFNldFRpbWVvdXQpOwogICAgICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0sIHJlamVjdCk7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICByZXR1cm4gewogICAgJDogYnVmZmVyLAogICAgYWRkLAogICAgZHJhaW4sCiAgfTsKfQoKY29uc3QgT05FX1NFQ09ORF9JTl9NUyA9IDEwMDA7CgovKioKICogQSBwYXJ0aWFsIGRlZmluaXRpb24gb2YgdGhlIFtQZXJmb3JtYW5jZSBXZWIgQVBJXXtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUGVyZm9ybWFuY2V9CiAqIGZvciBhY2Nlc3NpbmcgYSBoaWdoLXJlc29sdXRpb24gbW9ub3RvbmljIGNsb2NrLgogKi8KCi8qKgogKiBSZXR1cm5zIGEgdGltZXN0YW1wIGluIHNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2ggdXNpbmcgdGhlIERhdGUgQVBJLgogKgogKiBUT0RPKHY4KTogUmV0dXJuIHR5cGUgc2hvdWxkIGJlIHJvdW5kZWQuCiAqLwpmdW5jdGlvbiBkYXRlVGltZXN0YW1wSW5TZWNvbmRzKCkgewogIHJldHVybiBEYXRlLm5vdygpIC8gT05FX1NFQ09ORF9JTl9NUzsKfQoKLyoqCiAqIFJldHVybnMgYSB3cmFwcGVyIGFyb3VuZCB0aGUgbmF0aXZlIFBlcmZvcm1hbmNlIEFQSSBicm93c2VyIGltcGxlbWVudGF0aW9uLCBvciB1bmRlZmluZWQgZm9yIGJyb3dzZXJzIHRoYXQgZG8gbm90CiAqIHN1cHBvcnQgdGhlIEFQSS4KICoKICogV3JhcHBpbmcgdGhlIG5hdGl2ZSBBUEkgd29ya3MgYXJvdW5kIGRpZmZlcmVuY2VzIGluIGJlaGF2aW9yIGZyb20gZGlmZmVyZW50IGJyb3dzZXJzLgogKi8KZnVuY3Rpb24gY3JlYXRlVW5peFRpbWVzdGFtcEluU2Vjb25kc0Z1bmMoKSB7CiAgY29uc3QgeyBwZXJmb3JtYW5jZSB9ID0gR0xPQkFMX09CSiA7CiAgaWYgKCFwZXJmb3JtYW5jZSB8fCAhcGVyZm9ybWFuY2Uubm93KSB7CiAgICByZXR1cm4gZGF0ZVRpbWVzdGFtcEluU2Vjb25kczsKICB9CgogIC8vIFNvbWUgYnJvd3NlciBhbmQgZW52aXJvbm1lbnRzIGRvbid0IGhhdmUgYSB0aW1lT3JpZ2luLCBzbyB3ZSBmYWxsYmFjayB0bwogIC8vIHVzaW5nIERhdGUubm93KCkgdG8gY29tcHV0ZSB0aGUgc3RhcnRpbmcgdGltZS4KICBjb25zdCBhcHByb3hTdGFydGluZ1RpbWVPcmlnaW4gPSBEYXRlLm5vdygpIC0gcGVyZm9ybWFuY2Uubm93KCk7CiAgY29uc3QgdGltZU9yaWdpbiA9IHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gPT0gdW5kZWZpbmVkID8gYXBwcm94U3RhcnRpbmdUaW1lT3JpZ2luIDogcGVyZm9ybWFuY2UudGltZU9yaWdpbjsKCiAgLy8gcGVyZm9ybWFuY2Uubm93KCkgaXMgYSBtb25vdG9uaWMgY2xvY2ssIHdoaWNoIG1lYW5zIGl0IHN0YXJ0cyBhdCAwIHdoZW4gdGhlIHByb2Nlc3MgYmVnaW5zLiBUbyBnZXQgdGhlIGN1cnJlbnQKICAvLyB3YWxsIGNsb2NrIHRpbWUgKGFjdHVhbCBVTklYIHRpbWVzdGFtcCksIHdlIG5lZWQgdG8gYWRkIHRoZSBzdGFydGluZyB0aW1lIG9yaWdpbiBhbmQgdGhlIGN1cnJlbnQgdGltZSBlbGFwc2VkLgogIC8vCiAgLy8gVE9ETzogVGhpcyBkb2VzIG5vdCBhY2NvdW50IGZvciB0aGUgY2FzZSB3aGVyZSB0aGUgbW9ub3RvbmljIGNsb2NrIHRoYXQgcG93ZXJzIHBlcmZvcm1hbmNlLm5vdygpIGRyaWZ0cyBmcm9tIHRoZQogIC8vIHdhbGwgY2xvY2sgdGltZSwgd2hpY2ggY2F1c2VzIHRoZSByZXR1cm5lZCB0aW1lc3RhbXAgdG8gYmUgaW5hY2N1cmF0ZS4gV2Ugc2hvdWxkIGludmVzdGlnYXRlIGhvdyB0byBkZXRlY3QgYW5kCiAgLy8gY29ycmVjdCBmb3IgdGhpcy4KICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzI1OTAKICAvLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9tZG4vY29udGVudC9pc3N1ZXMvNDcxMwogIC8vIFNlZTogaHR0cHM6Ly9kZXYudG8vbm9hbXIvd2hlbi1hLW1pbGxpc2Vjb25kLWlzLW5vdC1hLW1pbGxpc2Vjb25kLTNoNgogIHJldHVybiAoKSA9PiB7CiAgICByZXR1cm4gKHRpbWVPcmlnaW4gKyBwZXJmb3JtYW5jZS5ub3coKSkgLyBPTkVfU0VDT05EX0lOX01TOwogIH07Cn0KCi8qKgogKiBSZXR1cm5zIGEgdGltZXN0YW1wIGluIHNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2ggdXNpbmcgZWl0aGVyIHRoZSBQZXJmb3JtYW5jZSBvciBEYXRlIEFQSXMsIGRlcGVuZGluZyBvbiB0aGUKICogYXZhaWxhYmlsaXR5IG9mIHRoZSBQZXJmb3JtYW5jZSBBUEkuCiAqCiAqIEJVRzogTm90ZSB0aGF0IGJlY2F1c2Ugb2YgaG93IGJyb3dzZXJzIGltcGxlbWVudCB0aGUgUGVyZm9ybWFuY2UgQVBJLCB0aGUgY2xvY2sgbWlnaHQgc3RvcCB3aGVuIHRoZSBjb21wdXRlciBpcwogKiBhc2xlZXAuIFRoaXMgY3JlYXRlcyBhIHNrZXcgYmV0d2VlbiBgZGF0ZVRpbWVzdGFtcEluU2Vjb25kc2AgYW5kIGB0aW1lc3RhbXBJblNlY29uZHNgLiBUaGUKICogc2tldyBjYW4gZ3JvdyB0byBhcmJpdHJhcnkgYW1vdW50cyBsaWtlIGRheXMsIHdlZWtzIG9yIG1vbnRocy4KICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzI1OTAuCiAqLwpjb25zdCB0aW1lc3RhbXBJblNlY29uZHMgPSBjcmVhdGVVbml4VGltZXN0YW1wSW5TZWNvbmRzRnVuYygpOwoKLyoqCiAqIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoLiBUaGlzIHZhbHVlIGlzIG9ubHkgdXNhYmxlIGluIGEgYnJvd3NlciwgYW5kIG9ubHkgd2hlbiB0aGUKICogcGVyZm9ybWFuY2UgQVBJIGlzIGF2YWlsYWJsZS4KICovCigoKSA9PiB7CiAgLy8gVW5mb3J0dW5hdGVseSBicm93c2VycyBtYXkgcmVwb3J0IGFuIGluYWNjdXJhdGUgdGltZSBvcmlnaW4gZGF0YSwgdGhyb3VnaCBlaXRoZXIgcGVyZm9ybWFuY2UudGltZU9yaWdpbiBvcgogIC8vIHBlcmZvcm1hbmNlLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQsIHdoaWNoIHJlc3VsdHMgaW4gcG9vciByZXN1bHRzIGluIHBlcmZvcm1hbmNlIGRhdGEuIFdlIG9ubHkgdHJlYXQgdGltZSBvcmlnaW4KICAvLyBkYXRhIGFzIHJlbGlhYmxlIGlmIHRoZXkgYXJlIHdpdGhpbiBhIHJlYXNvbmFibGUgdGhyZXNob2xkIG9mIHRoZSBjdXJyZW50IHRpbWUuCgogIGNvbnN0IHsgcGVyZm9ybWFuY2UgfSA9IEdMT0JBTF9PQkogOwogIGlmICghcGVyZm9ybWFuY2UgfHwgIXBlcmZvcm1hbmNlLm5vdykgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIGNvbnN0IHRocmVzaG9sZCA9IDM2MDAgKiAxMDAwOwogIGNvbnN0IHBlcmZvcm1hbmNlTm93ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgY29uc3QgZGF0ZU5vdyA9IERhdGUubm93KCk7CgogIC8vIGlmIHRpbWVPcmlnaW4gaXNuJ3QgYXZhaWxhYmxlIHNldCBkZWx0YSB0byB0aHJlc2hvbGQgc28gaXQgaXNuJ3QgdXNlZAogIGNvbnN0IHRpbWVPcmlnaW5EZWx0YSA9IHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4KICAgID8gTWF0aC5hYnMocGVyZm9ybWFuY2UudGltZU9yaWdpbiArIHBlcmZvcm1hbmNlTm93IC0gZGF0ZU5vdykKICAgIDogdGhyZXNob2xkOwogIGNvbnN0IHRpbWVPcmlnaW5Jc1JlbGlhYmxlID0gdGltZU9yaWdpbkRlbHRhIDwgdGhyZXNob2xkOwoKICAvLyBXaGlsZSBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0IGlzIGRlcHJlY2F0ZWQgaW4gZmF2b3Igb2YgcGVyZm9ybWFuY2UudGltZU9yaWdpbiwgcGVyZm9ybWFuY2UudGltZU9yaWdpbgogIC8vIGlzIG5vdCBhcyB3aWRlbHkgc3VwcG9ydGVkLiBOYW1lbHksIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gaXMgdW5kZWZpbmVkIGluIFNhZmFyaSBhcyBvZiB3cml0aW5nLgogIC8vIEFsc28gYXMgb2Ygd3JpdGluZywgcGVyZm9ybWFuY2UudGltaW5nIGlzIG5vdCBhdmFpbGFibGUgaW4gV2ViIFdvcmtlcnMgaW4gbWFpbnN0cmVhbSBicm93c2Vycywgc28gaXQgaXMgbm90IGFsd2F5cwogIC8vIGEgdmFsaWQgZmFsbGJhY2suIEluIHRoZSBhYnNlbmNlIG9mIGFuIGluaXRpYWwgdGltZSBwcm92aWRlZCBieSB0aGUgYnJvd3NlciwgZmFsbGJhY2sgdG8gdGhlIGN1cnJlbnQgdGltZSBmcm9tIHRoZQogIC8vIERhdGUgQVBJLgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIGNvbnN0IG5hdmlnYXRpb25TdGFydCA9IHBlcmZvcm1hbmNlLnRpbWluZyAmJiBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0OwogIGNvbnN0IGhhc05hdmlnYXRpb25TdGFydCA9IHR5cGVvZiBuYXZpZ2F0aW9uU3RhcnQgPT09ICdudW1iZXInOwogIC8vIGlmIG5hdmlnYXRpb25TdGFydCBpc24ndCBhdmFpbGFibGUgc2V0IGRlbHRhIHRvIHRocmVzaG9sZCBzbyBpdCBpc24ndCB1c2VkCiAgY29uc3QgbmF2aWdhdGlvblN0YXJ0RGVsdGEgPSBoYXNOYXZpZ2F0aW9uU3RhcnQgPyBNYXRoLmFicyhuYXZpZ2F0aW9uU3RhcnQgKyBwZXJmb3JtYW5jZU5vdyAtIGRhdGVOb3cpIDogdGhyZXNob2xkOwogIGNvbnN0IG5hdmlnYXRpb25TdGFydElzUmVsaWFibGUgPSBuYXZpZ2F0aW9uU3RhcnREZWx0YSA8IHRocmVzaG9sZDsKCiAgaWYgKHRpbWVPcmlnaW5Jc1JlbGlhYmxlIHx8IG5hdmlnYXRpb25TdGFydElzUmVsaWFibGUpIHsKICAgIC8vIFVzZSB0aGUgbW9yZSByZWxpYWJsZSB0aW1lIG9yaWdpbgogICAgaWYgKHRpbWVPcmlnaW5EZWx0YSA8PSBuYXZpZ2F0aW9uU3RhcnREZWx0YSkgewogICAgICByZXR1cm4gcGVyZm9ybWFuY2UudGltZU9yaWdpbjsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBuYXZpZ2F0aW9uU3RhcnQ7CiAgICB9CiAgfQogIHJldHVybiBkYXRlTm93Owp9KSgpOwoKLyoqCiAqIENyZWF0ZXMgYW4gZW52ZWxvcGUuCiAqIE1ha2Ugc3VyZSB0byBhbHdheXMgZXhwbGljaXRseSBwcm92aWRlIHRoZSBnZW5lcmljIHRvIHRoaXMgZnVuY3Rpb24KICogc28gdGhhdCB0aGUgZW52ZWxvcGUgdHlwZXMgcmVzb2x2ZSBjb3JyZWN0bHkuCiAqLwpmdW5jdGlvbiBjcmVhdGVFbnZlbG9wZShoZWFkZXJzLCBpdGVtcyA9IFtdKSB7CiAgcmV0dXJuIFtoZWFkZXJzLCBpdGVtc10gOwp9CgovKioKICogQ29udmVuaWVuY2UgZnVuY3Rpb24gdG8gbG9vcCB0aHJvdWdoIHRoZSBpdGVtcyBhbmQgaXRlbSB0eXBlcyBvZiBhbiBlbnZlbG9wZS4KICogKFRoaXMgZnVuY3Rpb24gd2FzIG1vc3RseSBjcmVhdGVkIGJlY2F1c2Ugd29ya2luZyB3aXRoIGVudmVsb3BlIHR5cGVzIGlzIHBhaW5mdWwgYXQgdGhlIG1vbWVudCkKICoKICogSWYgdGhlIGNhbGxiYWNrIHJldHVybnMgdHJ1ZSwgdGhlIHJlc3Qgb2YgdGhlIGl0ZW1zIHdpbGwgYmUgc2tpcHBlZC4KICovCmZ1bmN0aW9uIGZvckVhY2hFbnZlbG9wZUl0ZW0oCiAgZW52ZWxvcGUsCiAgY2FsbGJhY2ssCikgewogIGNvbnN0IGVudmVsb3BlSXRlbXMgPSBlbnZlbG9wZVsxXTsKCiAgZm9yIChjb25zdCBlbnZlbG9wZUl0ZW0gb2YgZW52ZWxvcGVJdGVtcykgewogICAgY29uc3QgZW52ZWxvcGVJdGVtVHlwZSA9IGVudmVsb3BlSXRlbVswXS50eXBlOwogICAgY29uc3QgcmVzdWx0ID0gY2FsbGJhY2soZW52ZWxvcGVJdGVtLCBlbnZlbG9wZUl0ZW1UeXBlKTsKCiAgICBpZiAocmVzdWx0KSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgovKioKICogRW5jb2RlIGEgc3RyaW5nIHRvIFVURjguCiAqLwpmdW5jdGlvbiBlbmNvZGVVVEY4KGlucHV0LCB0ZXh0RW5jb2RlcikgewogIGNvbnN0IHV0ZjggPSB0ZXh0RW5jb2RlciB8fCBuZXcgVGV4dEVuY29kZXIoKTsKICByZXR1cm4gdXRmOC5lbmNvZGUoaW5wdXQpOwp9CgovKioKICogU2VyaWFsaXplcyBhbiBlbnZlbG9wZS4KICovCmZ1bmN0aW9uIHNlcmlhbGl6ZUVudmVsb3BlKGVudmVsb3BlLCB0ZXh0RW5jb2RlcikgewogIGNvbnN0IFtlbnZIZWFkZXJzLCBpdGVtc10gPSBlbnZlbG9wZTsKCiAgLy8gSW5pdGlhbGx5IHdlIGNvbnN0cnVjdCBvdXIgZW52ZWxvcGUgYXMgYSBzdHJpbmcgYW5kIG9ubHkgY29udmVydCB0byBiaW5hcnkgY2h1bmtzIGlmIHdlIGVuY291bnRlciBiaW5hcnkgZGF0YQogIGxldCBwYXJ0cyA9IEpTT04uc3RyaW5naWZ5KGVudkhlYWRlcnMpOwoKICBmdW5jdGlvbiBhcHBlbmQobmV4dCkgewogICAgaWYgKHR5cGVvZiBwYXJ0cyA9PT0gJ3N0cmluZycpIHsKICAgICAgcGFydHMgPSB0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycgPyBwYXJ0cyArIG5leHQgOiBbZW5jb2RlVVRGOChwYXJ0cywgdGV4dEVuY29kZXIpLCBuZXh0XTsKICAgIH0gZWxzZSB7CiAgICAgIHBhcnRzLnB1c2godHlwZW9mIG5leHQgPT09ICdzdHJpbmcnID8gZW5jb2RlVVRGOChuZXh0LCB0ZXh0RW5jb2RlcikgOiBuZXh0KTsKICAgIH0KICB9CgogIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykgewogICAgY29uc3QgW2l0ZW1IZWFkZXJzLCBwYXlsb2FkXSA9IGl0ZW07CgogICAgYXBwZW5kKGBcbiR7SlNPTi5zdHJpbmdpZnkoaXRlbUhlYWRlcnMpfVxuYCk7CgogICAgaWYgKHR5cGVvZiBwYXlsb2FkID09PSAnc3RyaW5nJyB8fCBwYXlsb2FkIGluc3RhbmNlb2YgVWludDhBcnJheSkgewogICAgICBhcHBlbmQocGF5bG9hZCk7CiAgICB9IGVsc2UgewogICAgICBsZXQgc3RyaW5naWZpZWRQYXlsb2FkOwogICAgICB0cnkgewogICAgICAgIHN0cmluZ2lmaWVkUGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLy8gSW4gY2FzZSwgZGVzcGl0ZSBhbGwgb3VyIGVmZm9ydHMgdG8ga2VlcCBgcGF5bG9hZGAgY2lyY3VsYXItZGVwZW5kZW5jeS1mcmVlLCBgSlNPTi5zdHJpbmlmeSgpYCBzdGlsbAogICAgICAgIC8vIGZhaWxzLCB3ZSB0cnkgYWdhaW4gYWZ0ZXIgbm9ybWFsaXppbmcgaXQgYWdhaW4gd2l0aCBpbmZpbml0ZSBub3JtYWxpemF0aW9uIGRlcHRoLiBUaGlzIG9mIGNvdXJzZSBoYXMgYQogICAgICAgIC8vIHBlcmZvcm1hbmNlIGltcGFjdCBidXQgaW4gdGhpcyBjYXNlIGEgcGVyZm9ybWFuY2UgaGl0IGlzIGJldHRlciB0aGFuIHRocm93aW5nLgogICAgICAgIHN0cmluZ2lmaWVkUGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KG5vcm1hbGl6ZShwYXlsb2FkKSk7CiAgICAgIH0KICAgICAgYXBwZW5kKHN0cmluZ2lmaWVkUGF5bG9hZCk7CiAgICB9CiAgfQoKICByZXR1cm4gdHlwZW9mIHBhcnRzID09PSAnc3RyaW5nJyA/IHBhcnRzIDogY29uY2F0QnVmZmVycyhwYXJ0cyk7Cn0KCmZ1bmN0aW9uIGNvbmNhdEJ1ZmZlcnMoYnVmZmVycykgewogIGNvbnN0IHRvdGFsTGVuZ3RoID0gYnVmZmVycy5yZWR1Y2UoKGFjYywgYnVmKSA9PiBhY2MgKyBidWYubGVuZ3RoLCAwKTsKCiAgY29uc3QgbWVyZ2VkID0gbmV3IFVpbnQ4QXJyYXkodG90YWxMZW5ndGgpOwogIGxldCBvZmZzZXQgPSAwOwogIGZvciAoY29uc3QgYnVmZmVyIG9mIGJ1ZmZlcnMpIHsKICAgIG1lcmdlZC5zZXQoYnVmZmVyLCBvZmZzZXQpOwogICAgb2Zmc2V0ICs9IGJ1ZmZlci5sZW5ndGg7CiAgfQoKICByZXR1cm4gbWVyZ2VkOwp9Cgpjb25zdCBJVEVNX1RZUEVfVE9fREFUQV9DQVRFR09SWV9NQVAgPSB7CiAgc2Vzc2lvbjogJ3Nlc3Npb24nLAogIHNlc3Npb25zOiAnc2Vzc2lvbicsCiAgYXR0YWNobWVudDogJ2F0dGFjaG1lbnQnLAogIHRyYW5zYWN0aW9uOiAndHJhbnNhY3Rpb24nLAogIGV2ZW50OiAnZXJyb3InLAogIGNsaWVudF9yZXBvcnQ6ICdpbnRlcm5hbCcsCiAgdXNlcl9yZXBvcnQ6ICdkZWZhdWx0JywKICBwcm9maWxlOiAncHJvZmlsZScsCiAgcmVwbGF5X2V2ZW50OiAncmVwbGF5JywKICByZXBsYXlfcmVjb3JkaW5nOiAncmVwbGF5JywKICBjaGVja19pbjogJ21vbml0b3InLAogIGZlZWRiYWNrOiAnZmVlZGJhY2snLAogIHNwYW46ICdzcGFuJywKICAvLyBUT0RPOiBUaGlzIGlzIGEgdGVtcG9yYXJ5IHdvcmthcm91bmQgdW50aWwgd2UgaGF2ZSBhIHByb3BlciBkYXRhIGNhdGVnb3J5IGZvciBtZXRyaWNzCiAgc3RhdHNkOiAndW5rbm93bicsCn07CgovKioKICogTWFwcyB0aGUgdHlwZSBvZiBhbiBlbnZlbG9wZSBpdGVtIHRvIGEgZGF0YSBjYXRlZ29yeS4KICovCmZ1bmN0aW9uIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSB7CiAgcmV0dXJuIElURU1fVFlQRV9UT19EQVRBX0NBVEVHT1JZX01BUFt0eXBlXTsKfQoKLyoqIEV4dHJhY3RzIHRoZSBtaW5pbWFsIFNESyBpbmZvIGZyb20gZnJvbSB0aGUgbWV0YWRhdGEgb3IgYW4gZXZlbnRzICovCmZ1bmN0aW9uIGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGFPckV2ZW50KSB7CiAgaWYgKCFtZXRhZGF0YU9yRXZlbnQgfHwgIW1ldGFkYXRhT3JFdmVudC5zZGspIHsKICAgIHJldHVybjsKICB9CiAgY29uc3QgeyBuYW1lLCB2ZXJzaW9uIH0gPSBtZXRhZGF0YU9yRXZlbnQuc2RrOwogIHJldHVybiB7IG5hbWUsIHZlcnNpb24gfTsKfQoKLyoqCiAqIENyZWF0ZXMgZXZlbnQgZW52ZWxvcGUgaGVhZGVycywgYmFzZWQgb24gZXZlbnQsIHNkayBpbmZvIGFuZCB0dW5uZWwKICogTm90ZTogVGhpcyBmdW5jdGlvbiB3YXMgZXh0cmFjdGVkIGZyb20gdGhlIGNvcmUgcGFja2FnZSB0byBtYWtlIGl0IGF2YWlsYWJsZSBpbiBSZXBsYXkKICovCmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW52ZWxvcGVIZWFkZXJzKAogIGV2ZW50LAogIHNka0luZm8sCiAgdHVubmVsLAogIGRzbiwKKSB7CiAgY29uc3QgZHluYW1pY1NhbXBsaW5nQ29udGV4dCA9IGV2ZW50LnNka1Byb2Nlc3NpbmdNZXRhZGF0YSAmJiBldmVudC5zZGtQcm9jZXNzaW5nTWV0YWRhdGEuZHluYW1pY1NhbXBsaW5nQ29udGV4dDsKICByZXR1cm4gewogICAgZXZlbnRfaWQ6IGV2ZW50LmV2ZW50X2lkICwKICAgIHNlbnRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIC4uLihzZGtJbmZvICYmIHsgc2RrOiBzZGtJbmZvIH0pLAogICAgLi4uKCEhdHVubmVsICYmIGRzbiAmJiB7IGRzbjogZHNuVG9TdHJpbmcoZHNuKSB9KSwKICAgIC4uLihkeW5hbWljU2FtcGxpbmdDb250ZXh0ICYmIHsKICAgICAgdHJhY2U6IGRyb3BVbmRlZmluZWRLZXlzKHsgLi4uZHluYW1pY1NhbXBsaW5nQ29udGV4dCB9KSwKICAgIH0pLAogIH07Cn0KCi8vIEludGVudGlvbmFsbHkga2VlcGluZyB0aGUga2V5IGJyb2FkLCBhcyB3ZSBkb24ndCBrbm93IGZvciBzdXJlIHdoYXQgcmF0ZSBsaW1pdCBoZWFkZXJzIGdldCByZXR1cm5lZCBmcm9tIGJhY2tlbmQKCmNvbnN0IERFRkFVTFRfUkVUUllfQUZURVIgPSA2MCAqIDEwMDA7IC8vIDYwIHNlY29uZHMKCi8qKgogKiBFeHRyYWN0cyBSZXRyeS1BZnRlciB2YWx1ZSBmcm9tIHRoZSByZXF1ZXN0IGhlYWRlciBvciByZXR1cm5zIGRlZmF1bHQgdmFsdWUKICogQHBhcmFtIGhlYWRlciBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgJ1JldHJ5LUFmdGVyJyBoZWFkZXIKICogQHBhcmFtIG5vdyBjdXJyZW50IHVuaXggdGltZXN0YW1wCiAqCiAqLwpmdW5jdGlvbiBwYXJzZVJldHJ5QWZ0ZXJIZWFkZXIoaGVhZGVyLCBub3cgPSBEYXRlLm5vdygpKSB7CiAgY29uc3QgaGVhZGVyRGVsYXkgPSBwYXJzZUludChgJHtoZWFkZXJ9YCwgMTApOwogIGlmICghaXNOYU4oaGVhZGVyRGVsYXkpKSB7CiAgICByZXR1cm4gaGVhZGVyRGVsYXkgKiAxMDAwOwogIH0KCiAgY29uc3QgaGVhZGVyRGF0ZSA9IERhdGUucGFyc2UoYCR7aGVhZGVyfWApOwogIGlmICghaXNOYU4oaGVhZGVyRGF0ZSkpIHsKICAgIHJldHVybiBoZWFkZXJEYXRlIC0gbm93OwogIH0KCiAgcmV0dXJuIERFRkFVTFRfUkVUUllfQUZURVI7Cn0KCi8qKgogKiBHZXRzIHRoZSB0aW1lIHRoYXQgdGhlIGdpdmVuIGNhdGVnb3J5IGlzIGRpc2FibGVkIHVudGlsIGZvciByYXRlIGxpbWl0aW5nLgogKiBJbiBjYXNlIG5vIGNhdGVnb3J5LXNwZWNpZmljIGxpbWl0IGlzIHNldCBidXQgYSBnZW5lcmFsIHJhdGUgbGltaXQgYWNyb3NzIGFsbCBjYXRlZ29yaWVzIGlzIGFjdGl2ZSwKICogdGhhdCB0aW1lIGlzIHJldHVybmVkLgogKgogKiBAcmV0dXJuIHRoZSB0aW1lIGluIG1zIHRoYXQgdGhlIGNhdGVnb3J5IGlzIGRpc2FibGVkIHVudGlsIG9yIDAgaWYgdGhlcmUncyBubyBhY3RpdmUgcmF0ZSBsaW1pdC4KICovCmZ1bmN0aW9uIGRpc2FibGVkVW50aWwobGltaXRzLCBjYXRlZ29yeSkgewogIHJldHVybiBsaW1pdHNbY2F0ZWdvcnldIHx8IGxpbWl0cy5hbGwgfHwgMDsKfQoKLyoqCiAqIENoZWNrcyBpZiBhIGNhdGVnb3J5IGlzIHJhdGUgbGltaXRlZAogKi8KZnVuY3Rpb24gaXNSYXRlTGltaXRlZChsaW1pdHMsIGNhdGVnb3J5LCBub3cgPSBEYXRlLm5vdygpKSB7CiAgcmV0dXJuIGRpc2FibGVkVW50aWwobGltaXRzLCBjYXRlZ29yeSkgPiBub3c7Cn0KCi8qKgogKiBVcGRhdGUgcmF0ZWxpbWl0cyBmcm9tIGluY29taW5nIGhlYWRlcnMuCiAqCiAqIEByZXR1cm4gdGhlIHVwZGF0ZWQgUmF0ZUxpbWl0cyBvYmplY3QuCiAqLwpmdW5jdGlvbiB1cGRhdGVSYXRlTGltaXRzKAogIGxpbWl0cywKICB7IHN0YXR1c0NvZGUsIGhlYWRlcnMgfSwKICBub3cgPSBEYXRlLm5vdygpLAopIHsKICBjb25zdCB1cGRhdGVkUmF0ZUxpbWl0cyA9IHsKICAgIC4uLmxpbWl0cywKICB9OwoKICAvLyAiVGhlIG5hbWUgaXMgY2FzZS1pbnNlbnNpdGl2ZS4iCiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hlYWRlcnMvZ2V0CiAgY29uc3QgcmF0ZUxpbWl0SGVhZGVyID0gaGVhZGVycyAmJiBoZWFkZXJzWyd4LXNlbnRyeS1yYXRlLWxpbWl0cyddOwogIGNvbnN0IHJldHJ5QWZ0ZXJIZWFkZXIgPSBoZWFkZXJzICYmIGhlYWRlcnNbJ3JldHJ5LWFmdGVyJ107CgogIGlmIChyYXRlTGltaXRIZWFkZXIpIHsKICAgIC8qKgogICAgICogcmF0ZSBsaW1pdCBoZWFkZXJzIGFyZSBvZiB0aGUgZm9ybQogICAgICogICAgIDxoZWFkZXI+LDxoZWFkZXI+LC4uCiAgICAgKiB3aGVyZSBlYWNoIDxoZWFkZXI+IGlzIG9mIHRoZSBmb3JtCiAgICAgKiAgICAgPHJldHJ5X2FmdGVyPjogPGNhdGVnb3JpZXM+OiA8c2NvcGU+OiA8cmVhc29uX2NvZGU+CiAgICAgKiB3aGVyZQogICAgICogICAgIDxyZXRyeV9hZnRlcj4gaXMgYSBkZWxheSBpbiBzZWNvbmRzCiAgICAgKiAgICAgPGNhdGVnb3JpZXM+IGlzIHRoZSBldmVudCB0eXBlKHMpIChlcnJvciwgdHJhbnNhY3Rpb24sIGV0YykgYmVpbmcgcmF0ZSBsaW1pdGVkIGFuZCBpcyBvZiB0aGUgZm9ybQogICAgICogICAgICAgICA8Y2F0ZWdvcnk+OzxjYXRlZ29yeT47Li4uCiAgICAgKiAgICAgPHNjb3BlPiBpcyB3aGF0J3MgYmVpbmcgbGltaXRlZCAob3JnLCBwcm9qZWN0LCBvciBrZXkpIC0gaWdub3JlZCBieSBTREsKICAgICAqICAgICA8cmVhc29uX2NvZGU+IGlzIGFuIGFyYml0cmFyeSBzdHJpbmcgbGlrZSAib3JnX3F1b3RhIiAtIGlnbm9yZWQgYnkgU0RLCiAgICAgKi8KICAgIGZvciAoY29uc3QgbGltaXQgb2YgcmF0ZUxpbWl0SGVhZGVyLnRyaW0oKS5zcGxpdCgnLCcpKSB7CiAgICAgIGNvbnN0IFtyZXRyeUFmdGVyLCBjYXRlZ29yaWVzXSA9IGxpbWl0LnNwbGl0KCc6JywgMik7CiAgICAgIGNvbnN0IGhlYWRlckRlbGF5ID0gcGFyc2VJbnQocmV0cnlBZnRlciwgMTApOwogICAgICBjb25zdCBkZWxheSA9ICghaXNOYU4oaGVhZGVyRGVsYXkpID8gaGVhZGVyRGVsYXkgOiA2MCkgKiAxMDAwOyAvLyA2MHNlYyBkZWZhdWx0CiAgICAgIGlmICghY2F0ZWdvcmllcykgewogICAgICAgIHVwZGF0ZWRSYXRlTGltaXRzLmFsbCA9IG5vdyArIGRlbGF5OwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoY29uc3QgY2F0ZWdvcnkgb2YgY2F0ZWdvcmllcy5zcGxpdCgnOycpKSB7CiAgICAgICAgICB1cGRhdGVkUmF0ZUxpbWl0c1tjYXRlZ29yeV0gPSBub3cgKyBkZWxheTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHJldHJ5QWZ0ZXJIZWFkZXIpIHsKICAgIHVwZGF0ZWRSYXRlTGltaXRzLmFsbCA9IG5vdyArIHBhcnNlUmV0cnlBZnRlckhlYWRlcihyZXRyeUFmdGVySGVhZGVyLCBub3cpOwogIH0gZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDI5KSB7CiAgICB1cGRhdGVkUmF0ZUxpbWl0cy5hbGwgPSBub3cgKyA2MCAqIDEwMDA7CiAgfQoKICByZXR1cm4gdXBkYXRlZFJhdGVMaW1pdHM7Cn0KCi8qKgogKiBBIG5vZGUuanMgd2F0Y2hkb2cgdGltZXIKICogQHBhcmFtIHBvbGxJbnRlcnZhbCBUaGUgaW50ZXJ2YWwgdGhhdCB3ZSBleHBlY3QgdG8gZ2V0IHBvbGxlZCBhdAogKiBAcGFyYW0gYW5yVGhyZXNob2xkIFRoZSB0aHJlc2hvbGQgZm9yIHdoZW4gd2UgY29uc2lkZXIgQU5SCiAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gY2FsbCBmb3IgQU5SCiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIGBwb2xsYCBhbmQgYGVuYWJsZWRgIGZ1bmN0aW9ucyB7QGxpbmsgV2F0Y2hkb2dSZXR1cm59CiAqLwpmdW5jdGlvbiB3YXRjaGRvZ1RpbWVyKAogIGNyZWF0ZVRpbWVyLAogIHBvbGxJbnRlcnZhbCwKICBhbnJUaHJlc2hvbGQsCiAgY2FsbGJhY2ssCikgewogIGNvbnN0IHRpbWVyID0gY3JlYXRlVGltZXIoKTsKICBsZXQgdHJpZ2dlcmVkID0gZmFsc2U7CiAgbGV0IGVuYWJsZWQgPSB0cnVlOwoKICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICBjb25zdCBkaWZmTXMgPSB0aW1lci5nZXRUaW1lTXMoKTsKCiAgICBpZiAodHJpZ2dlcmVkID09PSBmYWxzZSAmJiBkaWZmTXMgPiBwb2xsSW50ZXJ2YWwgKyBhbnJUaHJlc2hvbGQpIHsKICAgICAgdHJpZ2dlcmVkID0gdHJ1ZTsKICAgICAgaWYgKGVuYWJsZWQpIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9CgogICAgaWYgKGRpZmZNcyA8IHBvbGxJbnRlcnZhbCArIGFuclRocmVzaG9sZCkgewogICAgICB0cmlnZ2VyZWQgPSBmYWxzZTsKICAgIH0KICB9LCAyMCk7CgogIHJldHVybiB7CiAgICBwb2xsOiAoKSA9PiB7CiAgICAgIHRpbWVyLnJlc2V0KCk7CiAgICB9LAogICAgZW5hYmxlZDogKHN0YXRlKSA9PiB7CiAgICAgIGVuYWJsZWQgPSBzdGF0ZTsKICAgIH0sCiAgfTsKfQoKLy8gdHlwZXMgY29waWVkIGZyb20gaW5zcGVjdG9yLmQudHMKCi8qKgogKiBDb252ZXJ0cyBEZWJ1Z2dlci5DYWxsRnJhbWUgdG8gU2VudHJ5IFN0YWNrRnJhbWUKICovCmZ1bmN0aW9uIGNhbGxGcmFtZVRvU3RhY2tGcmFtZSgKICBmcmFtZSwKICB1cmwsCiAgZ2V0TW9kdWxlRnJvbUZpbGVuYW1lLAopIHsKICBjb25zdCBmaWxlbmFtZSA9IHVybCA/IHVybC5yZXBsYWNlKC9eZmlsZTpcL1wvLywgJycpIDogdW5kZWZpbmVkOwoKICAvLyBDYWxsRnJhbWUgcm93L2NvbCBhcmUgMCBiYXNlZCwgd2hlcmVhcyBTdGFja0ZyYW1lIGFyZSAxIGJhc2VkCiAgY29uc3QgY29sbm8gPSBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgKyAxIDogdW5kZWZpbmVkOwogIGNvbnN0IGxpbmVubyA9IGZyYW1lLmxvY2F0aW9uLmxpbmVOdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5saW5lTnVtYmVyICsgMSA6IHVuZGVmaW5lZDsKCiAgcmV0dXJuIGRyb3BVbmRlZmluZWRLZXlzKHsKICAgIGZpbGVuYW1lLAogICAgbW9kdWxlOiBnZXRNb2R1bGVGcm9tRmlsZW5hbWUoZmlsZW5hbWUpLAogICAgZnVuY3Rpb246IGZyYW1lLmZ1bmN0aW9uTmFtZSB8fCAnPycsCiAgICBjb2xubywKICAgIGxpbmVubywKICAgIGluX2FwcDogZmlsZW5hbWUgPyBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUpIDogdW5kZWZpbmVkLAogIH0pOwp9CgovKioKICogVGhpcyBzZXJ2ZXMgYXMgYSBidWlsZCB0aW1lIGZsYWcgdGhhdCB3aWxsIGJlIHRydWUgYnkgZGVmYXVsdCwgYnV0IGZhbHNlIGluIG5vbi1kZWJ1ZyBidWlsZHMgb3IgaWYgdXNlcnMgcmVwbGFjZSBgX19TRU5UUllfREVCVUdfX2AgaW4gdGhlaXIgZ2VuZXJhdGVkIGNvZGUuCiAqCiAqIEFUVEVOVElPTjogVGhpcyBjb25zdGFudCBtdXN0IG5ldmVyIGNyb3NzIHBhY2thZ2UgYm91bmRhcmllcyAoaS5lLiBiZSBleHBvcnRlZCkgdG8gZ3VhcmFudGVlIHRoYXQgaXQgY2FuIGJlIHVzZWQgZm9yIHRyZWUgc2hha2luZy4KICovCmNvbnN0IERFQlVHX0JVSUxEID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCi8qKgogKiBDcmVhdGVzIGEgbmV3IGBTZXNzaW9uYCBvYmplY3QgYnkgc2V0dGluZyBjZXJ0YWluIGRlZmF1bHQgcGFyYW1ldGVycy4gSWYgb3B0aW9uYWwgQHBhcmFtIGNvbnRleHQKICogaXMgcGFzc2VkLCB0aGUgcGFzc2VkIHByb3BlcnRpZXMgYXJlIGFwcGxpZWQgdG8gdGhlIHNlc3Npb24gb2JqZWN0LgogKgogKiBAcGFyYW0gY29udGV4dCAob3B0aW9uYWwpIGFkZGl0aW9uYWwgcHJvcGVydGllcyB0byBiZSBhcHBsaWVkIHRvIHRoZSByZXR1cm5lZCBzZXNzaW9uIG9iamVjdAogKgogKiBAcmV0dXJucyBhIG5ldyBgU2Vzc2lvbmAgb2JqZWN0CiAqLwpmdW5jdGlvbiBtYWtlU2Vzc2lvbihjb250ZXh0KSB7CiAgLy8gQm90aCB0aW1lc3RhbXAgYW5kIHN0YXJ0ZWQgYXJlIGluIHNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2guCiAgY29uc3Qgc3RhcnRpbmdUaW1lID0gdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGNvbnN0IHNlc3Npb24gPSB7CiAgICBzaWQ6IHV1aWQ0KCksCiAgICBpbml0OiB0cnVlLAogICAgdGltZXN0YW1wOiBzdGFydGluZ1RpbWUsCiAgICBzdGFydGVkOiBzdGFydGluZ1RpbWUsCiAgICBkdXJhdGlvbjogMCwKICAgIHN0YXR1czogJ29rJywKICAgIGVycm9yczogMCwKICAgIGlnbm9yZUR1cmF0aW9uOiBmYWxzZSwKICAgIHRvSlNPTjogKCkgPT4gc2Vzc2lvblRvSlNPTihzZXNzaW9uKSwKICB9OwoKICBpZiAoY29udGV4dCkgewogICAgdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0KTsKICB9CgogIHJldHVybiBzZXNzaW9uOwp9CgovKioKICogVXBkYXRlcyBhIHNlc3Npb24gb2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXMgcGFzc2VkIGluIHRoZSBjb250ZXh0LgogKgogKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBtdXRhdGVzIHRoZSBwYXNzZWQgb2JqZWN0IGFuZCByZXR1cm5zIHZvaWQuCiAqIChIYWQgdG8gZG8gdGhpcyBpbnN0ZWFkIG9mIHJldHVybmluZyBhIG5ldyBhbmQgdXBkYXRlZCBzZXNzaW9uIGJlY2F1c2UgY2xvc2luZyBhbmQgc2VuZGluZyBhIHNlc3Npb24KICogbWFrZXMgYW4gdXBkYXRlIHRvIHRoZSBzZXNzaW9uIGFmdGVyIGl0IHdhcyBwYXNzZWQgdG8gdGhlIHNlbmRpbmcgbG9naWMuCiAqIEBzZWUgQmFzZUNsaWVudC5jYXB0dXJlU2Vzc2lvbiApCiAqCiAqIEBwYXJhbSBzZXNzaW9uIHRoZSBgU2Vzc2lvbmAgdG8gdXBkYXRlCiAqIEBwYXJhbSBjb250ZXh0IHRoZSBgU2Vzc2lvbkNvbnRleHRgIGhvbGRpbmcgdGhlIHByb3BlcnRpZXMgdGhhdCBzaG91bGQgYmUgdXBkYXRlZCBpbiBAcGFyYW0gc2Vzc2lvbgogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHkKZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0ID0ge30pIHsKICBpZiAoY29udGV4dC51c2VyKSB7CiAgICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQudXNlci5pcF9hZGRyZXNzKSB7CiAgICAgIHNlc3Npb24uaXBBZGRyZXNzID0gY29udGV4dC51c2VyLmlwX2FkZHJlc3M7CiAgICB9CgogICAgaWYgKCFzZXNzaW9uLmRpZCAmJiAhY29udGV4dC5kaWQpIHsKICAgICAgc2Vzc2lvbi5kaWQgPSBjb250ZXh0LnVzZXIuaWQgfHwgY29udGV4dC51c2VyLmVtYWlsIHx8IGNvbnRleHQudXNlci51c2VybmFtZTsKICAgIH0KICB9CgogIHNlc3Npb24udGltZXN0YW1wID0gY29udGV4dC50aW1lc3RhbXAgfHwgdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGlmIChjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbSkgewogICAgc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20gPSBjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbTsKICB9CgogIGlmIChjb250ZXh0Lmlnbm9yZUR1cmF0aW9uKSB7CiAgICBzZXNzaW9uLmlnbm9yZUR1cmF0aW9uID0gY29udGV4dC5pZ25vcmVEdXJhdGlvbjsKICB9CiAgaWYgKGNvbnRleHQuc2lkKSB7CiAgICAvLyBHb29kIGVub3VnaCB1dWlkIHZhbGlkYXRpb24uIOKAlCBLYW1pbAogICAgc2Vzc2lvbi5zaWQgPSBjb250ZXh0LnNpZC5sZW5ndGggPT09IDMyID8gY29udGV4dC5zaWQgOiB1dWlkNCgpOwogIH0KICBpZiAoY29udGV4dC5pbml0ICE9PSB1bmRlZmluZWQpIHsKICAgIHNlc3Npb24uaW5pdCA9IGNvbnRleHQuaW5pdDsKICB9CiAgaWYgKCFzZXNzaW9uLmRpZCAmJiBjb250ZXh0LmRpZCkgewogICAgc2Vzc2lvbi5kaWQgPSBgJHtjb250ZXh0LmRpZH1gOwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuc3RhcnRlZCA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uc3RhcnRlZCA9IGNvbnRleHQuc3RhcnRlZDsKICB9CiAgaWYgKHNlc3Npb24uaWdub3JlRHVyYXRpb24pIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSB1bmRlZmluZWQ7CiAgfSBlbHNlIGlmICh0eXBlb2YgY29udGV4dC5kdXJhdGlvbiA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSBjb250ZXh0LmR1cmF0aW9uOwogIH0gZWxzZSB7CiAgICBjb25zdCBkdXJhdGlvbiA9IHNlc3Npb24udGltZXN0YW1wIC0gc2Vzc2lvbi5zdGFydGVkOwogICAgc2Vzc2lvbi5kdXJhdGlvbiA9IGR1cmF0aW9uID49IDAgPyBkdXJhdGlvbiA6IDA7CiAgfQogIGlmIChjb250ZXh0LnJlbGVhc2UpIHsKICAgIHNlc3Npb24ucmVsZWFzZSA9IGNvbnRleHQucmVsZWFzZTsKICB9CiAgaWYgKGNvbnRleHQuZW52aXJvbm1lbnQpIHsKICAgIHNlc3Npb24uZW52aXJvbm1lbnQgPSBjb250ZXh0LmVudmlyb25tZW50OwogIH0KICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQuaXBBZGRyZXNzKSB7CiAgICBzZXNzaW9uLmlwQWRkcmVzcyA9IGNvbnRleHQuaXBBZGRyZXNzOwogIH0KICBpZiAoIXNlc3Npb24udXNlckFnZW50ICYmIGNvbnRleHQudXNlckFnZW50KSB7CiAgICBzZXNzaW9uLnVzZXJBZ2VudCA9IGNvbnRleHQudXNlckFnZW50OwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuZXJyb3JzID09PSAnbnVtYmVyJykgewogICAgc2Vzc2lvbi5lcnJvcnMgPSBjb250ZXh0LmVycm9yczsKICB9CiAgaWYgKGNvbnRleHQuc3RhdHVzKSB7CiAgICBzZXNzaW9uLnN0YXR1cyA9IGNvbnRleHQuc3RhdHVzOwogIH0KfQoKLyoqCiAqIFNlcmlhbGl6ZXMgYSBwYXNzZWQgc2Vzc2lvbiBvYmplY3QgdG8gYSBKU09OIG9iamVjdCB3aXRoIGEgc2xpZ2h0bHkgZGlmZmVyZW50IHN0cnVjdHVyZS4KICogVGhpcyBpcyBuZWNlc3NhcnkgYmVjYXVzZSB0aGUgU2VudHJ5IGJhY2tlbmQgcmVxdWlyZXMgYSBzbGlnaHRseSBkaWZmZXJlbnQgc2NoZW1hIG9mIGEgc2Vzc2lvbgogKiB0aGFuIHRoZSBvbmUgdGhlIEpTIFNES3MgdXNlIGludGVybmFsbHkuCiAqCiAqIEBwYXJhbSBzZXNzaW9uIHRoZSBzZXNzaW9uIHRvIGJlIGNvbnZlcnRlZAogKgogKiBAcmV0dXJucyBhIEpTT04gb2JqZWN0IG9mIHRoZSBwYXNzZWQgc2Vzc2lvbgogKi8KZnVuY3Rpb24gc2Vzc2lvblRvSlNPTihzZXNzaW9uKSB7CiAgcmV0dXJuIGRyb3BVbmRlZmluZWRLZXlzKHsKICAgIHNpZDogYCR7c2Vzc2lvbi5zaWR9YCwKICAgIGluaXQ6IHNlc3Npb24uaW5pdCwKICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHNlYyBpcyBjb252ZXJ0ZWQgdG8gbXMgZm9yIGRhdGUgY29uc3RydWN0b3IKICAgIHN0YXJ0ZWQ6IG5ldyBEYXRlKHNlc3Npb24uc3RhcnRlZCAqIDEwMDApLnRvSVNPU3RyaW5nKCksCiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKHNlc3Npb24udGltZXN0YW1wICogMTAwMCkudG9JU09TdHJpbmcoKSwKICAgIHN0YXR1czogc2Vzc2lvbi5zdGF0dXMsCiAgICBlcnJvcnM6IHNlc3Npb24uZXJyb3JzLAogICAgZGlkOiB0eXBlb2Ygc2Vzc2lvbi5kaWQgPT09ICdudW1iZXInIHx8IHR5cGVvZiBzZXNzaW9uLmRpZCA9PT0gJ3N0cmluZycgPyBgJHtzZXNzaW9uLmRpZH1gIDogdW5kZWZpbmVkLAogICAgZHVyYXRpb246IHNlc3Npb24uZHVyYXRpb24sCiAgICBhYm5vcm1hbF9tZWNoYW5pc206IHNlc3Npb24uYWJub3JtYWxfbWVjaGFuaXNtLAogICAgYXR0cnM6IHsKICAgICAgcmVsZWFzZTogc2Vzc2lvbi5yZWxlYXNlLAogICAgICBlbnZpcm9ubWVudDogc2Vzc2lvbi5lbnZpcm9ubWVudCwKICAgICAgaXBfYWRkcmVzczogc2Vzc2lvbi5pcEFkZHJlc3MsCiAgICAgIHVzZXJfYWdlbnQ6IHNlc3Npb24udXNlckFnZW50LAogICAgfSwKICB9KTsKfQoKLyoqCiAqIEFwcGx5IFNka0luZm8gKG5hbWUsIHZlcnNpb24sIHBhY2thZ2VzLCBpbnRlZ3JhdGlvbnMpIHRvIHRoZSBjb3JyZXNwb25kaW5nIGV2ZW50IGtleS4KICogTWVyZ2Ugd2l0aCBleGlzdGluZyBkYXRhIGlmIGFueS4KICoqLwpmdW5jdGlvbiBlbmhhbmNlRXZlbnRXaXRoU2RrSW5mbyhldmVudCwgc2RrSW5mbykgewogIGlmICghc2RrSW5mbykgewogICAgcmV0dXJuIGV2ZW50OwogIH0KICBldmVudC5zZGsgPSBldmVudC5zZGsgfHwge307CiAgZXZlbnQuc2RrLm5hbWUgPSBldmVudC5zZGsubmFtZSB8fCBzZGtJbmZvLm5hbWU7CiAgZXZlbnQuc2RrLnZlcnNpb24gPSBldmVudC5zZGsudmVyc2lvbiB8fCBzZGtJbmZvLnZlcnNpb247CiAgZXZlbnQuc2RrLmludGVncmF0aW9ucyA9IFsuLi4oZXZlbnQuc2RrLmludGVncmF0aW9ucyB8fCBbXSksIC4uLihzZGtJbmZvLmludGVncmF0aW9ucyB8fCBbXSldOwogIGV2ZW50LnNkay5wYWNrYWdlcyA9IFsuLi4oZXZlbnQuc2RrLnBhY2thZ2VzIHx8IFtdKSwgLi4uKHNka0luZm8ucGFja2FnZXMgfHwgW10pXTsKICByZXR1cm4gZXZlbnQ7Cn0KCi8qKiBDcmVhdGVzIGFuIGVudmVsb3BlIGZyb20gYSBTZXNzaW9uICovCmZ1bmN0aW9uIGNyZWF0ZVNlc3Npb25FbnZlbG9wZSgKICBzZXNzaW9uLAogIGRzbiwKICBtZXRhZGF0YSwKICB0dW5uZWwsCikgewogIGNvbnN0IHNka0luZm8gPSBnZXRTZGtNZXRhZGF0YUZvckVudmVsb3BlSGVhZGVyKG1ldGFkYXRhKTsKICBjb25zdCBlbnZlbG9wZUhlYWRlcnMgPSB7CiAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAuLi4oc2RrSW5mbyAmJiB7IHNkazogc2RrSW5mbyB9KSwKICAgIC4uLighIXR1bm5lbCAmJiBkc24gJiYgeyBkc246IGRzblRvU3RyaW5nKGRzbikgfSksCiAgfTsKCiAgY29uc3QgZW52ZWxvcGVJdGVtID0KICAgICdhZ2dyZWdhdGVzJyBpbiBzZXNzaW9uID8gW3sgdHlwZTogJ3Nlc3Npb25zJyB9LCBzZXNzaW9uXSA6IFt7IHR5cGU6ICdzZXNzaW9uJyB9LCBzZXNzaW9uLnRvSlNPTigpXTsKCiAgcmV0dXJuIGNyZWF0ZUVudmVsb3BlKGVudmVsb3BlSGVhZGVycywgW2VudmVsb3BlSXRlbV0pOwp9CgovKioKICogQ3JlYXRlIGFuIEVudmVsb3BlIGZyb20gYW4gZXZlbnQuCiAqLwpmdW5jdGlvbiBjcmVhdGVFdmVudEVudmVsb3BlKAogIGV2ZW50LAogIGRzbiwKICBtZXRhZGF0YSwKICB0dW5uZWwsCikgewogIGNvbnN0IHNka0luZm8gPSBnZXRTZGtNZXRhZGF0YUZvckVudmVsb3BlSGVhZGVyKG1ldGFkYXRhKTsKCiAgLyoKICAgIE5vdGU6IER1ZSB0byBUUywgZXZlbnQudHlwZSBtYXkgYmUgYHJlcGxheV9ldmVudGAsIHRoZW9yZXRpY2FsbHkuCiAgICBJbiBwcmFjdGljZSwgd2UgbmV2ZXIgY2FsbCBgY3JlYXRlRXZlbnRFbnZlbG9wZWAgd2l0aCBgcmVwbGF5X2V2ZW50YCB0eXBlLAogICAgYW5kIHdlJ2QgaGF2ZSB0byBhZGp1dCBhIGxvb290IG9mIHR5cGVzIHRvIG1ha2UgdGhpcyB3b3JrIHByb3Blcmx5LgogICAgV2Ugd2FudCB0byBhdm9pZCBjYXN0aW5nIHRoaXMgYXJvdW5kLCBhcyB0aGF0IGNvdWxkIGxlYWQgdG8gYnVncyAoZS5nLiB3aGVuIHdlIGFkZCBhbm90aGVyIHR5cGUpCiAgICBTbyB0aGUgc2FmZSBjaG9pY2UgaXMgdG8gcmVhbGx5IGd1YXJkIGFnYWluc3QgdGhlIHJlcGxheV9ldmVudCB0eXBlIGhlcmUuCiAgKi8KICBjb25zdCBldmVudFR5cGUgPSBldmVudC50eXBlICYmIGV2ZW50LnR5cGUgIT09ICdyZXBsYXlfZXZlbnQnID8gZXZlbnQudHlwZSA6ICdldmVudCc7CgogIGVuaGFuY2VFdmVudFdpdGhTZGtJbmZvKGV2ZW50LCBtZXRhZGF0YSAmJiBtZXRhZGF0YS5zZGspOwoKICBjb25zdCBlbnZlbG9wZUhlYWRlcnMgPSBjcmVhdGVFdmVudEVudmVsb3BlSGVhZGVycyhldmVudCwgc2RrSW5mbywgdHVubmVsLCBkc24pOwoKICAvLyBQcmV2ZW50IHRoaXMgZGF0YSAod2hpY2gsIGlmIGl0IGV4aXN0cywgd2FzIHVzZWQgaW4gZWFybGllciBzdGVwcyBpbiB0aGUgcHJvY2Vzc2luZyBwaXBlbGluZSkgZnJvbSBiZWluZyBzZW50IHRvCiAgLy8gc2VudHJ5LiAoTm90ZTogT3VyIHVzZSBvZiB0aGlzIHByb3BlcnR5IGNvbWVzIGFuZCBnb2VzIHdpdGggd2hhdGV2ZXIgd2UgbWlnaHQgYmUgZGVidWdnaW5nLCB3aGF0ZXZlciBoYWNrcyB3ZSBtYXkKICAvLyBoYXZlIHRlbXBvcmFyaWx5IGFkZGVkLCBldGMuIEV2ZW4gaWYgd2UgZG9uJ3QgaGFwcGVuIHRvIGJlIHVzaW5nIGl0IGF0IHNvbWUgcG9pbnQgaW4gdGhlIGZ1dHVyZSwgbGV0J3Mgbm90IGdldCByaWQKICAvLyBvZiB0aGlzIGBkZWxldGVgLCBsZXN0IHdlIG1pc3MgcHV0dGluZyBpdCBiYWNrIGluIHRoZSBuZXh0IHRpbWUgdGhlIHByb3BlcnR5IGlzIGluIHVzZS4pCiAgZGVsZXRlIGV2ZW50LnNka1Byb2Nlc3NpbmdNZXRhZGF0YTsKCiAgY29uc3QgZXZlbnRJdGVtID0gW3sgdHlwZTogZXZlbnRUeXBlIH0sIGV2ZW50XTsKICByZXR1cm4gY3JlYXRlRW52ZWxvcGUoZW52ZWxvcGVIZWFkZXJzLCBbZXZlbnRJdGVtXSk7Cn0KCmNvbnN0IFNFTlRSWV9BUElfVkVSU0lPTiA9ICc3JzsKCi8qKiBSZXR1cm5zIHRoZSBwcmVmaXggdG8gY29uc3RydWN0IFNlbnRyeSBpbmdlc3Rpb24gQVBJIGVuZHBvaW50cy4gKi8KZnVuY3Rpb24gZ2V0QmFzZUFwaUVuZHBvaW50KGRzbikgewogIGNvbnN0IHByb3RvY29sID0gZHNuLnByb3RvY29sID8gYCR7ZHNuLnByb3RvY29sfTpgIDogJyc7CiAgY29uc3QgcG9ydCA9IGRzbi5wb3J0ID8gYDoke2Rzbi5wb3J0fWAgOiAnJzsKICByZXR1cm4gYCR7cHJvdG9jb2x9Ly8ke2Rzbi5ob3N0fSR7cG9ydH0ke2Rzbi5wYXRoID8gYC8ke2Rzbi5wYXRofWAgOiAnJ30vYXBpL2A7Cn0KCi8qKiBSZXR1cm5zIHRoZSBpbmdlc3QgQVBJIGVuZHBvaW50IGZvciB0YXJnZXQuICovCmZ1bmN0aW9uIF9nZXRJbmdlc3RFbmRwb2ludChkc24pIHsKICByZXR1cm4gYCR7Z2V0QmFzZUFwaUVuZHBvaW50KGRzbil9JHtkc24ucHJvamVjdElkfS9lbnZlbG9wZS9gOwp9CgovKiogUmV0dXJucyBhIFVSTC1lbmNvZGVkIHN0cmluZyB3aXRoIGF1dGggY29uZmlnIHN1aXRhYmxlIGZvciBhIHF1ZXJ5IHN0cmluZy4gKi8KZnVuY3Rpb24gX2VuY29kZWRBdXRoKGRzbiwgc2RrSW5mbykgewogIHJldHVybiB1cmxFbmNvZGUoewogICAgLy8gV2Ugc2VuZCBvbmx5IHRoZSBtaW5pbXVtIHNldCBvZiByZXF1aXJlZCBpbmZvcm1hdGlvbi4gU2VlCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy8yNTcyLgogICAgc2VudHJ5X2tleTogZHNuLnB1YmxpY0tleSwKICAgIHNlbnRyeV92ZXJzaW9uOiBTRU5UUllfQVBJX1ZFUlNJT04sCiAgICAuLi4oc2RrSW5mbyAmJiB7IHNlbnRyeV9jbGllbnQ6IGAke3Nka0luZm8ubmFtZX0vJHtzZGtJbmZvLnZlcnNpb259YCB9KSwKICB9KTsKfQoKLyoqCiAqIFJldHVybnMgdGhlIGVudmVsb3BlIGVuZHBvaW50IFVSTCB3aXRoIGF1dGggaW4gdGhlIHF1ZXJ5IHN0cmluZy4KICoKICogU2VuZGluZyBhdXRoIGFzIHBhcnQgb2YgdGhlIHF1ZXJ5IHN0cmluZyBhbmQgbm90IGFzIGN1c3RvbSBIVFRQIGhlYWRlcnMgYXZvaWRzIENPUlMgcHJlZmxpZ2h0IHJlcXVlc3RzLgogKi8KZnVuY3Rpb24gZ2V0RW52ZWxvcGVFbmRwb2ludFdpdGhVcmxFbmNvZGVkQXV0aCgKICBkc24sCiAgLy8gVE9ETyAodjgpOiBSZW1vdmUgYHR1bm5lbE9yT3B0aW9uc2AgaW4gZmF2b3Igb2YgYG9wdGlvbnNgLCBhbmQgdXNlIHRoZSBzdWJzdGl0dXRlIGNvZGUgYmVsb3cKICAvLyBvcHRpb25zOiBDbGllbnRPcHRpb25zID0ge30gYXMgQ2xpZW50T3B0aW9ucywKICB0dW5uZWxPck9wdGlvbnMgPSB7fSAsCikgewogIC8vIFRPRE8gKHY4KTogVXNlIHRoaXMgY29kZSBpbnN0ZWFkCiAgLy8gY29uc3QgeyB0dW5uZWwsIF9tZXRhZGF0YSA9IHt9IH0gPSBvcHRpb25zOwogIC8vIHJldHVybiB0dW5uZWwgPyB0dW5uZWwgOiBgJHtfZ2V0SW5nZXN0RW5kcG9pbnQoZHNuKX0/JHtfZW5jb2RlZEF1dGgoZHNuLCBfbWV0YWRhdGEuc2RrKX1gOwoKICBjb25zdCB0dW5uZWwgPSB0eXBlb2YgdHVubmVsT3JPcHRpb25zID09PSAnc3RyaW5nJyA/IHR1bm5lbE9yT3B0aW9ucyA6IHR1bm5lbE9yT3B0aW9ucy50dW5uZWw7CiAgY29uc3Qgc2RrSW5mbyA9CiAgICB0eXBlb2YgdHVubmVsT3JPcHRpb25zID09PSAnc3RyaW5nJyB8fCAhdHVubmVsT3JPcHRpb25zLl9tZXRhZGF0YSA/IHVuZGVmaW5lZCA6IHR1bm5lbE9yT3B0aW9ucy5fbWV0YWRhdGEuc2RrOwoKICByZXR1cm4gdHVubmVsID8gdHVubmVsIDogYCR7X2dldEluZ2VzdEVuZHBvaW50KGRzbil9PyR7X2VuY29kZWRBdXRoKGRzbiwgc2RrSW5mbyl9YDsKfQoKY29uc3QgREVGQVVMVF9UUkFOU1BPUlRfQlVGRkVSX1NJWkUgPSAzMDsKCi8qKgogKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGEgU2VudHJ5IGBUcmFuc3BvcnRgCiAqCiAqIEBwYXJhbSBvcHRpb25zCiAqIEBwYXJhbSBtYWtlUmVxdWVzdAogKi8KZnVuY3Rpb24gY3JlYXRlVHJhbnNwb3J0KAogIG9wdGlvbnMsCiAgbWFrZVJlcXVlc3QsCiAgYnVmZmVyID0gbWFrZVByb21pc2VCdWZmZXIoCiAgICBvcHRpb25zLmJ1ZmZlclNpemUgfHwgREVGQVVMVF9UUkFOU1BPUlRfQlVGRkVSX1NJWkUsCiAgKSwKKSB7CiAgbGV0IHJhdGVMaW1pdHMgPSB7fTsKICBjb25zdCBmbHVzaCA9ICh0aW1lb3V0KSA9PiBidWZmZXIuZHJhaW4odGltZW91dCk7CgogIGZ1bmN0aW9uIHNlbmQoZW52ZWxvcGUpIHsKICAgIGNvbnN0IGZpbHRlcmVkRW52ZWxvcGVJdGVtcyA9IFtdOwoKICAgIC8vIERyb3AgcmF0ZSBsaW1pdGVkIGl0ZW1zIGZyb20gZW52ZWxvcGUKICAgIGZvckVhY2hFbnZlbG9wZUl0ZW0oZW52ZWxvcGUsIChpdGVtLCB0eXBlKSA9PiB7CiAgICAgIGNvbnN0IGVudmVsb3BlSXRlbURhdGFDYXRlZ29yeSA9IGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKTsKICAgICAgaWYgKGlzUmF0ZUxpbWl0ZWQocmF0ZUxpbWl0cywgZW52ZWxvcGVJdGVtRGF0YUNhdGVnb3J5KSkgewogICAgICAgIGNvbnN0IGV2ZW50ID0gZ2V0RXZlbnRGb3JFbnZlbG9wZUl0ZW0oaXRlbSwgdHlwZSk7CiAgICAgICAgb3B0aW9ucy5yZWNvcmREcm9wcGVkRXZlbnQoJ3JhdGVsaW1pdF9iYWNrb2ZmJywgZW52ZWxvcGVJdGVtRGF0YUNhdGVnb3J5LCBldmVudCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZmlsdGVyZWRFbnZlbG9wZUl0ZW1zLnB1c2goaXRlbSk7CiAgICAgIH0KICAgIH0pOwoKICAgIC8vIFNraXAgc2VuZGluZyBpZiBlbnZlbG9wZSBpcyBlbXB0eSBhZnRlciBmaWx0ZXJpbmcgb3V0IHJhdGUgbGltaXRlZCBldmVudHMKICAgIGlmIChmaWx0ZXJlZEVudmVsb3BlSXRlbXMubGVuZ3RoID09PSAwKSB7CiAgICAgIHJldHVybiByZXNvbHZlZFN5bmNQcm9taXNlKCk7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgIGNvbnN0IGZpbHRlcmVkRW52ZWxvcGUgPSBjcmVhdGVFbnZlbG9wZShlbnZlbG9wZVswXSwgZmlsdGVyZWRFbnZlbG9wZUl0ZW1zICk7CgogICAgLy8gQ3JlYXRlcyBjbGllbnQgcmVwb3J0IGZvciBlYWNoIGl0ZW0gaW4gYW4gZW52ZWxvcGUKICAgIGNvbnN0IHJlY29yZEVudmVsb3BlTG9zcyA9IChyZWFzb24pID0+IHsKICAgICAgZm9yRWFjaEVudmVsb3BlSXRlbShmaWx0ZXJlZEVudmVsb3BlLCAoaXRlbSwgdHlwZSkgPT4gewogICAgICAgIGNvbnN0IGV2ZW50ID0gZ2V0RXZlbnRGb3JFbnZlbG9wZUl0ZW0oaXRlbSwgdHlwZSk7CiAgICAgICAgb3B0aW9ucy5yZWNvcmREcm9wcGVkRXZlbnQocmVhc29uLCBlbnZlbG9wZUl0ZW1UeXBlVG9EYXRhQ2F0ZWdvcnkodHlwZSksIGV2ZW50KTsKICAgICAgfSk7CiAgICB9OwoKICAgIGNvbnN0IHJlcXVlc3RUYXNrID0gKCkgPT4KICAgICAgbWFrZVJlcXVlc3QoeyBib2R5OiBzZXJpYWxpemVFbnZlbG9wZShmaWx0ZXJlZEVudmVsb3BlLCBvcHRpb25zLnRleHRFbmNvZGVyKSB9KS50aGVuKAogICAgICAgIHJlc3BvbnNlID0+IHsKICAgICAgICAgIC8vIFdlIGRvbid0IHdhbnQgdG8gdGhyb3cgb24gTk9LIHJlc3BvbnNlcywgYnV0IHdlIHdhbnQgdG8gYXQgbGVhc3QgbG9nIHRoZW0KICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlICE9PSB1bmRlZmluZWQgJiYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPCAyMDAgfHwgcmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAzMDApKSB7CiAgICAgICAgICAgIERFQlVHX0JVSUxEICYmIGxvZ2dlci53YXJuKGBTZW50cnkgcmVzcG9uZGVkIHdpdGggc3RhdHVzIGNvZGUgJHtyZXNwb25zZS5zdGF0dXNDb2RlfSB0byBzZW50IGV2ZW50LmApOwogICAgICAgICAgfQoKICAgICAgICAgIHJhdGVMaW1pdHMgPSB1cGRhdGVSYXRlTGltaXRzKHJhdGVMaW1pdHMsIHJlc3BvbnNlKTsKICAgICAgICAgIHJldHVybiByZXNwb25zZTsKICAgICAgICB9LAogICAgICAgIGVycm9yID0+IHsKICAgICAgICAgIHJlY29yZEVudmVsb3BlTG9zcygnbmV0d29ya19lcnJvcicpOwogICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgfSwKICAgICAgKTsKCiAgICByZXR1cm4gYnVmZmVyLmFkZChyZXF1ZXN0VGFzaykudGhlbigKICAgICAgcmVzdWx0ID0+IHJlc3VsdCwKICAgICAgZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIFNlbnRyeUVycm9yKSB7CiAgICAgICAgICBERUJVR19CVUlMRCAmJiBsb2dnZXIuZXJyb3IoJ1NraXBwZWQgc2VuZGluZyBldmVudCBiZWNhdXNlIGJ1ZmZlciBpcyBmdWxsLicpOwogICAgICAgICAgcmVjb3JkRW52ZWxvcGVMb3NzKCdxdWV1ZV9vdmVyZmxvdycpOwogICAgICAgICAgcmV0dXJuIHJlc29sdmVkU3luY1Byb21pc2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgfQogICAgICB9LAogICAgKTsKICB9CgogIC8vIFdlIHVzZSB0aGlzIHRvIGlkZW50aWZpZnkgaWYgdGhlIHRyYW5zcG9ydCBpcyB0aGUgYmFzZSB0cmFuc3BvcnQKICAvLyBUT0RPICh2OCk6IFJlbW92ZSB0aGlzIGFnYWluIGFzIHdlJ2xsIG5vIGxvbmdlciBuZWVkIGl0CiAgc2VuZC5fX3NlbnRyeV9fYmFzZVRyYW5zcG9ydF9fID0gdHJ1ZTsKCiAgcmV0dXJuIHsKICAgIHNlbmQsCiAgICBmbHVzaCwKICB9Owp9CgpmdW5jdGlvbiBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKSB7CiAgaWYgKHR5cGUgIT09ICdldmVudCcgJiYgdHlwZSAhPT0gJ3RyYW5zYWN0aW9uJykgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIHJldHVybiBBcnJheS5pc0FycmF5KGl0ZW0pID8gKGl0ZW0gKVsxXSA6IHVuZGVmaW5lZDsKfQoKLyoqIG5vcm1hbGl6ZXMgV2luZG93cyBwYXRocyAqLwpmdW5jdGlvbiBub3JtYWxpemVXaW5kb3dzUGF0aChwYXRoKSB7CiAgcmV0dXJuIHBhdGgKICAgIC5yZXBsYWNlKC9eW0EtWl06LywgJycpIC8vIHJlbW92ZSBXaW5kb3dzLXN0eWxlIHByZWZpeAogICAgLnJlcGxhY2UoL1xcL2csICcvJyk7IC8vIHJlcGxhY2UgYWxsIGBcYCBpbnN0YW5jZXMgd2l0aCBgL2AKfQoKLyoqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGdldHMgdGhlIG1vZHVsZSBuYW1lIGZyb20gYSBmaWxlbmFtZSAqLwpmdW5jdGlvbiBjcmVhdGVHZXRNb2R1bGVGcm9tRmlsZW5hbWUoCiAgYmFzZVBhdGggPSBwcm9jZXNzLmFyZ3ZbMV0gPyBkaXJuYW1lKHByb2Nlc3MuYXJndlsxXSkgOiBwcm9jZXNzLmN3ZCgpLAogIGlzV2luZG93cyA9IHNlcCA9PT0gJ1xcJywKKSB7CiAgY29uc3Qgbm9ybWFsaXplZEJhc2UgPSBpc1dpbmRvd3MgPyBub3JtYWxpemVXaW5kb3dzUGF0aChiYXNlUGF0aCkgOiBiYXNlUGF0aDsKCiAgcmV0dXJuIChmaWxlbmFtZSkgPT4gewogICAgaWYgKCFmaWxlbmFtZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgY29uc3Qgbm9ybWFsaXplZEZpbGVuYW1lID0gaXNXaW5kb3dzID8gbm9ybWFsaXplV2luZG93c1BhdGgoZmlsZW5hbWUpIDogZmlsZW5hbWU7CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgbGV0IHsgZGlyLCBiYXNlOiBmaWxlLCBleHQgfSA9IHBvc2l4LnBhcnNlKG5vcm1hbGl6ZWRGaWxlbmFtZSk7CgogICAgaWYgKGV4dCA9PT0gJy5qcycgfHwgZXh0ID09PSAnLm1qcycgfHwgZXh0ID09PSAnLmNqcycpIHsKICAgICAgZmlsZSA9IGZpbGUuc2xpY2UoMCwgZXh0Lmxlbmd0aCAqIC0xKTsKICAgIH0KCiAgICBpZiAoIWRpcikgewogICAgICAvLyBObyBkaXJuYW1lIHdoYXRzb2V2ZXIKICAgICAgZGlyID0gJy4nOwogICAgfQoKICAgIGNvbnN0IG4gPSBkaXIubGFzdEluZGV4T2YoJy9ub2RlX21vZHVsZXMnKTsKICAgIGlmIChuID4gLTEpIHsKICAgICAgcmV0dXJuIGAke2Rpci5zbGljZShuICsgMTQpLnJlcGxhY2UoL1wvL2csICcuJyl9OiR7ZmlsZX1gOwogICAgfQoKICAgIC8vIExldCdzIHNlZSBpZiBpdCdzIGEgcGFydCBvZiB0aGUgbWFpbiBtb2R1bGUKICAgIC8vIFRvIGJlIGEgcGFydCBvZiBtYWluIG1vZHVsZSwgaXQgaGFzIHRvIHNoYXJlIHRoZSBzYW1lIGJhc2UKICAgIGlmIChkaXIuc3RhcnRzV2l0aChub3JtYWxpemVkQmFzZSkpIHsKICAgICAgbGV0IG1vZHVsZU5hbWUgPSBkaXIuc2xpY2Uobm9ybWFsaXplZEJhc2UubGVuZ3RoICsgMSkucmVwbGFjZSgvXC8vZywgJy4nKTsKCiAgICAgIGlmIChtb2R1bGVOYW1lKSB7CiAgICAgICAgbW9kdWxlTmFtZSArPSAnOic7CiAgICAgIH0KICAgICAgbW9kdWxlTmFtZSArPSBmaWxlOwoKICAgICAgcmV0dXJuIG1vZHVsZU5hbWU7CiAgICB9CgogICAgcmV0dXJuIGZpbGU7CiAgfTsKfQoKZnVuY3Rpb24gX251bGxpc2hDb2FsZXNjZSQyKGxocywgcmhzRm4pIHsgaWYgKGxocyAhPSBudWxsKSB7IHJldHVybiBsaHM7IH0gZWxzZSB7IHJldHVybiByaHNGbigpOyB9IH0vKioKICogVGhpcyBjb2RlIHdhcyBvcmlnaW5hbGx5IGZvcmtlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9Ub29UYWxsTmF0ZS9wcm94eS1hZ2VudHMvdHJlZS9iMTMzMjk1ZmQxNmY2NDc1NTc4YjZiMTViZDliNGUzM2VjYjBkMGI3CiAqIFdpdGggdGhlIGZvbGxvd2luZyBsaWNlbmNlOgogKgogKiAoVGhlIE1JVCBMaWNlbnNlKQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTMgTmF0aGFuIFJhamxpY2ggPG5hdGhhbkB0b290YWxsbmF0ZS5uZXQ+KgogKgogKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcKICogYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCiAqICdTb2Z0d2FyZScpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKICogd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAogKiBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8KICogcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvCiAqIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoqCiAqCiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlCiAqIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLioKICoKICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsCiAqIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgogKiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuCiAqIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZCiAqIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsCiAqIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFCiAqIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgogKi8KCmNvbnN0IElOVEVSTkFMID0gU3ltYm9sKCdBZ2VudEJhc2VJbnRlcm5hbFN0YXRlJyk7CgpjbGFzcyBBZ2VudCBleHRlbmRzIGh0dHAuQWdlbnQgewoKICAvLyBTZXQgYnkgYGh0dHAuQWdlbnRgIC0gbWlzc2luZyBmcm9tIGBAdHlwZXMvbm9kZWAKCiAgY29uc3RydWN0b3Iob3B0cykgewogICAgc3VwZXIob3B0cyk7CiAgICB0aGlzW0lOVEVSTkFMXSA9IHt9OwogIH0KCiAgLyoqCiAgICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhpcyBpcyBhbiBgaHR0cGAgb3IgYGh0dHBzYCByZXF1ZXN0LgogICAqLwogIGlzU2VjdXJlRW5kcG9pbnQob3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMpIHsKICAgICAgLy8gRmlyc3QgY2hlY2sgdGhlIGBzZWN1cmVFbmRwb2ludGAgcHJvcGVydHkgZXhwbGljaXRseSwgc2luY2UgdGhpcwogICAgICAvLyBtZWFucyB0aGF0IGEgcGFyZW50IGBBZ2VudGAgaXMgInBhc3NpbmcgdGhyb3VnaCIgdG8gdGhpcyBpbnN0YW5jZS4KICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnksIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2VzcwogICAgICBpZiAodHlwZW9mIChvcHRpb25zICkuc2VjdXJlRW5kcG9pbnQgPT09ICdib29sZWFuJykgewogICAgICAgIHJldHVybiBvcHRpb25zLnNlY3VyZUVuZHBvaW50OwogICAgICB9CgogICAgICAvLyBJZiBubyBleHBsaWNpdCBgc2VjdXJlYCBlbmRwb2ludCwgY2hlY2sgaWYgYHByb3RvY29sYCBwcm9wZXJ0eSBpcwogICAgICAvLyBzZXQuIFRoaXMgd2lsbCB1c3VhbGx5IGJlIHRoZSBjYXNlIHNpbmNlIHVzaW5nIGEgZnVsbCBzdHJpbmcgVVJMCiAgICAgIC8vIG9yIGBVUkxgIGluc3RhbmNlIHNob3VsZCBiZSB0aGUgbW9zdCBjb21tb24gdXNhZ2UuCiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5wcm90b2NvbCA9PT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gb3B0aW9ucy5wcm90b2NvbCA9PT0gJ2h0dHBzOic7CiAgICAgIH0KICAgIH0KCiAgICAvLyBGaW5hbGx5LCBpZiBubyBgcHJvdG9jb2xgIHByb3BlcnR5IHdhcyBzZXQsIHRoZW4gZmFsbCBiYWNrIHRvCiAgICAvLyBjaGVja2luZyB0aGUgc3RhY2sgdHJhY2Ugb2YgdGhlIGN1cnJlbnQgY2FsbCBzdGFjaywgYW5kIHRyeSB0bwogICAgLy8gZGV0ZWN0IHRoZSAiaHR0cHMiIG1vZHVsZS4KICAgIGNvbnN0IHsgc3RhY2sgfSA9IG5ldyBFcnJvcigpOwogICAgaWYgKHR5cGVvZiBzdGFjayAhPT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTsKICAgIHJldHVybiBzdGFjay5zcGxpdCgnXG4nKS5zb21lKGwgPT4gbC5pbmRleE9mKCcoaHR0cHMuanM6JykgIT09IC0xIHx8IGwuaW5kZXhPZignbm9kZTpodHRwczonKSAhPT0gLTEpOwogIH0KCiAgY3JlYXRlU29ja2V0KHJlcSwgb3B0aW9ucywgY2IpIHsKICAgIGNvbnN0IGNvbm5lY3RPcHRzID0gewogICAgICAuLi5vcHRpb25zLAogICAgICBzZWN1cmVFbmRwb2ludDogdGhpcy5pc1NlY3VyZUVuZHBvaW50KG9wdGlvbnMpLAogICAgfTsKICAgIFByb21pc2UucmVzb2x2ZSgpCiAgICAgIC50aGVuKCgpID0+IHRoaXMuY29ubmVjdChyZXEsIGNvbm5lY3RPcHRzKSkKICAgICAgLnRoZW4oc29ja2V0ID0+IHsKICAgICAgICBpZiAoc29ja2V0IGluc3RhbmNlb2YgaHR0cC5BZ2VudCkgewogICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciBgYWRkUmVxdWVzdCgpYCBpc24ndCBkZWZpbmVkIGluIGBAdHlwZXMvbm9kZWAKICAgICAgICAgIHJldHVybiBzb2NrZXQuYWRkUmVxdWVzdChyZXEsIGNvbm5lY3RPcHRzKTsKICAgICAgICB9CiAgICAgICAgdGhpc1tJTlRFUk5BTF0uY3VycmVudFNvY2tldCA9IHNvY2tldDsKICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGBjcmVhdGVTb2NrZXQoKWAgaXNuJ3QgZGVmaW5lZCBpbiBgQHR5cGVzL25vZGVgCiAgICAgICAgc3VwZXIuY3JlYXRlU29ja2V0KHJlcSwgb3B0aW9ucywgY2IpOwogICAgICB9LCBjYik7CiAgfQoKICBjcmVhdGVDb25uZWN0aW9uKCkgewogICAgY29uc3Qgc29ja2V0ID0gdGhpc1tJTlRFUk5BTF0uY3VycmVudFNvY2tldDsKICAgIHRoaXNbSU5URVJOQUxdLmN1cnJlbnRTb2NrZXQgPSB1bmRlZmluZWQ7CiAgICBpZiAoIXNvY2tldCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHNvY2tldCB3YXMgcmV0dXJuZWQgaW4gdGhlIGBjb25uZWN0KClgIGZ1bmN0aW9uJyk7CiAgICB9CiAgICByZXR1cm4gc29ja2V0OwogIH0KCiAgZ2V0IGRlZmF1bHRQb3J0KCkgewogICAgcmV0dXJuIF9udWxsaXNoQ29hbGVzY2UkMih0aGlzW0lOVEVSTkFMXS5kZWZhdWx0UG9ydCwgKCkgPT4gKCAodGhpcy5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyA0NDMgOiA4MCkpKTsKICB9CgogIHNldCBkZWZhdWx0UG9ydCh2KSB7CiAgICBpZiAodGhpc1tJTlRFUk5BTF0pIHsKICAgICAgdGhpc1tJTlRFUk5BTF0uZGVmYXVsdFBvcnQgPSB2OwogICAgfQogIH0KCiAgZ2V0IHByb3RvY29sKCkgewogICAgcmV0dXJuIF9udWxsaXNoQ29hbGVzY2UkMih0aGlzW0lOVEVSTkFMXS5wcm90b2NvbCwgKCkgPT4gKCAodGhpcy5pc1NlY3VyZUVuZHBvaW50KCkgPyAnaHR0cHM6JyA6ICdodHRwOicpKSk7CiAgfQoKICBzZXQgcHJvdG9jb2wodikgewogICAgaWYgKHRoaXNbSU5URVJOQUxdKSB7CiAgICAgIHRoaXNbSU5URVJOQUxdLnByb3RvY29sID0gdjsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIGRlYnVnJDEoLi4uYXJncykgewogIGxvZ2dlci5sb2coJ1todHRwcy1wcm94eS1hZ2VudDpwYXJzZS1wcm94eS1yZXNwb25zZV0nLCAuLi5hcmdzKTsKfQoKZnVuY3Rpb24gcGFyc2VQcm94eVJlc3BvbnNlKHNvY2tldCkgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAvLyB3ZSBuZWVkIHRvIGJ1ZmZlciBhbnkgSFRUUCB0cmFmZmljIHRoYXQgaGFwcGVucyB3aXRoIHRoZSBwcm94eSBiZWZvcmUgd2UgZ2V0CiAgICAvLyB0aGUgQ09OTkVDVCByZXNwb25zZSwgc28gdGhhdCBpZiB0aGUgcmVzcG9uc2UgaXMgYW55dGhpbmcgb3RoZXIgdGhhbiBhbiAiMjAwIgogICAgLy8gcmVzcG9uc2UgY29kZSwgdGhlbiB3ZSBjYW4gcmUtcGxheSB0aGUgImRhdGEiIGV2ZW50cyBvbiB0aGUgc29ja2V0IG9uY2UgdGhlCiAgICAvLyBIVFRQIHBhcnNlciBpcyBob29rZWQgdXAuLi4KICAgIGxldCBidWZmZXJzTGVuZ3RoID0gMDsKICAgIGNvbnN0IGJ1ZmZlcnMgPSBbXTsKCiAgICBmdW5jdGlvbiByZWFkKCkgewogICAgICBjb25zdCBiID0gc29ja2V0LnJlYWQoKTsKICAgICAgaWYgKGIpIG9uZGF0YShiKTsKICAgICAgZWxzZSBzb2NrZXQub25jZSgncmVhZGFibGUnLCByZWFkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGVhbnVwKCkgewogICAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2VuZCcsIG9uZW5kKTsKICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uZXJyb3IpOwogICAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ3JlYWRhYmxlJywgcmVhZCk7CiAgICB9CgogICAgZnVuY3Rpb24gb25lbmQoKSB7CiAgICAgIGNsZWFudXAoKTsKICAgICAgZGVidWckMSgnb25lbmQnKTsKICAgICAgcmVqZWN0KG5ldyBFcnJvcignUHJveHkgY29ubmVjdGlvbiBlbmRlZCBiZWZvcmUgcmVjZWl2aW5nIENPTk5FQ1QgcmVzcG9uc2UnKSk7CiAgICB9CgogICAgZnVuY3Rpb24gb25lcnJvcihlcnIpIHsKICAgICAgY2xlYW51cCgpOwogICAgICBkZWJ1ZyQxKCdvbmVycm9yICVvJywgZXJyKTsKICAgICAgcmVqZWN0KGVycik7CiAgICB9CgogICAgZnVuY3Rpb24gb25kYXRhKGIpIHsKICAgICAgYnVmZmVycy5wdXNoKGIpOwogICAgICBidWZmZXJzTGVuZ3RoICs9IGIubGVuZ3RoOwoKICAgICAgY29uc3QgYnVmZmVyZWQgPSBCdWZmZXIuY29uY2F0KGJ1ZmZlcnMsIGJ1ZmZlcnNMZW5ndGgpOwogICAgICBjb25zdCBlbmRPZkhlYWRlcnMgPSBidWZmZXJlZC5pbmRleE9mKCdcclxuXHJcbicpOwoKICAgICAgaWYgKGVuZE9mSGVhZGVycyA9PT0gLTEpIHsKICAgICAgICAvLyBrZWVwIGJ1ZmZlcmluZwogICAgICAgIGRlYnVnJDEoJ2hhdmUgbm90IHJlY2VpdmVkIGVuZCBvZiBIVFRQIGhlYWRlcnMgeWV0Li4uJyk7CiAgICAgICAgcmVhZCgpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgaGVhZGVyUGFydHMgPSBidWZmZXJlZC5zbGljZSgwLCBlbmRPZkhlYWRlcnMpLnRvU3RyaW5nKCdhc2NpaScpLnNwbGl0KCdcclxuJyk7CiAgICAgIGNvbnN0IGZpcnN0TGluZSA9IGhlYWRlclBhcnRzLnNoaWZ0KCk7CiAgICAgIGlmICghZmlyc3RMaW5lKSB7CiAgICAgICAgc29ja2V0LmRlc3Ryb3koKTsKICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignTm8gaGVhZGVyIHJlY2VpdmVkIGZyb20gcHJveHkgQ09OTkVDVCByZXNwb25zZScpKTsKICAgICAgfQogICAgICBjb25zdCBmaXJzdExpbmVQYXJ0cyA9IGZpcnN0TGluZS5zcGxpdCgnICcpOwogICAgICBjb25zdCBzdGF0dXNDb2RlID0gK2ZpcnN0TGluZVBhcnRzWzFdOwogICAgICBjb25zdCBzdGF0dXNUZXh0ID0gZmlyc3RMaW5lUGFydHMuc2xpY2UoMikuam9pbignICcpOwogICAgICBjb25zdCBoZWFkZXJzID0ge307CiAgICAgIGZvciAoY29uc3QgaGVhZGVyIG9mIGhlYWRlclBhcnRzKSB7CiAgICAgICAgaWYgKCFoZWFkZXIpIGNvbnRpbnVlOwogICAgICAgIGNvbnN0IGZpcnN0Q29sb24gPSBoZWFkZXIuaW5kZXhPZignOicpOwogICAgICAgIGlmIChmaXJzdENvbG9uID09PSAtMSkgewogICAgICAgICAgc29ja2V0LmRlc3Ryb3koKTsKICAgICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKGBJbnZhbGlkIGhlYWRlciBmcm9tIHByb3h5IENPTk5FQ1QgcmVzcG9uc2U6ICIke2hlYWRlcn0iYCkpOwogICAgICAgIH0KICAgICAgICBjb25zdCBrZXkgPSBoZWFkZXIuc2xpY2UoMCwgZmlyc3RDb2xvbikudG9Mb3dlckNhc2UoKTsKICAgICAgICBjb25zdCB2YWx1ZSA9IGhlYWRlci5zbGljZShmaXJzdENvbG9uICsgMSkudHJpbVN0YXJ0KCk7CiAgICAgICAgY29uc3QgY3VycmVudCA9IGhlYWRlcnNba2V5XTsKICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICBoZWFkZXJzW2tleV0gPSBbY3VycmVudCwgdmFsdWVdOwogICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjdXJyZW50KSkgewogICAgICAgICAgY3VycmVudC5wdXNoKHZhbHVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIGRlYnVnJDEoJ2dvdCBwcm94eSBzZXJ2ZXIgcmVzcG9uc2U6ICVvICVvJywgZmlyc3RMaW5lLCBoZWFkZXJzKTsKICAgICAgY2xlYW51cCgpOwogICAgICByZXNvbHZlKHsKICAgICAgICBjb25uZWN0OiB7CiAgICAgICAgICBzdGF0dXNDb2RlLAogICAgICAgICAgc3RhdHVzVGV4dCwKICAgICAgICAgIGhlYWRlcnMsCiAgICAgICAgfSwKICAgICAgICBidWZmZXJlZCwKICAgICAgfSk7CiAgICB9CgogICAgc29ja2V0Lm9uKCdlcnJvcicsIG9uZXJyb3IpOwogICAgc29ja2V0Lm9uKCdlbmQnLCBvbmVuZCk7CgogICAgcmVhZCgpOwogIH0pOwp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlJDEobGhzLCByaHNGbikgeyBpZiAobGhzICE9IG51bGwpIHsgcmV0dXJuIGxoczsgfSBlbHNlIHsgcmV0dXJuIHJoc0ZuKCk7IH0gfSBmdW5jdGlvbiBfb3B0aW9uYWxDaGFpbiQxKG9wcykgeyBsZXQgbGFzdEFjY2Vzc0xIUyA9IHVuZGVmaW5lZDsgbGV0IHZhbHVlID0gb3BzWzBdOyBsZXQgaSA9IDE7IHdoaWxlIChpIDwgb3BzLmxlbmd0aCkgeyBjb25zdCBvcCA9IG9wc1tpXTsgY29uc3QgZm4gPSBvcHNbaSArIDFdOyBpICs9IDI7IGlmICgob3AgPT09ICdvcHRpb25hbEFjY2VzcycgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSAmJiB2YWx1ZSA9PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gaWYgKG9wID09PSAnYWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJykgeyBsYXN0QWNjZXNzTEhTID0gdmFsdWU7IHZhbHVlID0gZm4odmFsdWUpOyB9IGVsc2UgaWYgKG9wID09PSAnY2FsbCcgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSB7IHZhbHVlID0gZm4oKC4uLmFyZ3MpID0+IHZhbHVlLmNhbGwobGFzdEFjY2Vzc0xIUywgLi4uYXJncykpOyBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyB9IH0gcmV0dXJuIHZhbHVlOyB9CgpmdW5jdGlvbiBkZWJ1ZyguLi5hcmdzKSB7CiAgbG9nZ2VyLmxvZygnW2h0dHBzLXByb3h5LWFnZW50XScsIC4uLmFyZ3MpOwp9CgovKioKICogVGhlIGBIdHRwc1Byb3h5QWdlbnRgIGltcGxlbWVudHMgYW4gSFRUUCBBZ2VudCBzdWJjbGFzcyB0aGF0IGNvbm5lY3RzIHRvCiAqIHRoZSBzcGVjaWZpZWQgIkhUVFAocykgcHJveHkgc2VydmVyIiBpbiBvcmRlciB0byBwcm94eSBIVFRQUyByZXF1ZXN0cy4KICoKICogT3V0Z29pbmcgSFRUUCByZXF1ZXN0cyBhcmUgZmlyc3QgdHVubmVsZWQgdGhyb3VnaCB0aGUgcHJveHkgc2VydmVyIHVzaW5nIHRoZQogKiBgQ09OTkVDVGAgSFRUUCByZXF1ZXN0IG1ldGhvZCB0byBlc3RhYmxpc2ggYSBjb25uZWN0aW9uIHRvIHRoZSBwcm94eSBzZXJ2ZXIsCiAqIGFuZCB0aGVuIHRoZSBwcm94eSBzZXJ2ZXIgY29ubmVjdHMgdG8gdGhlIGRlc3RpbmF0aW9uIHRhcmdldCBhbmQgaXNzdWVzIHRoZQogKiBIVFRQIHJlcXVlc3QgZnJvbSB0aGUgcHJveHkgc2VydmVyLgogKgogKiBgaHR0cHM6YCByZXF1ZXN0cyBoYXZlIHRoZWlyIHNvY2tldCBjb25uZWN0aW9uIHVwZ3JhZGVkIHRvIFRMUyBvbmNlCiAqIHRoZSBjb25uZWN0aW9uIHRvIHRoZSBwcm94eSBzZXJ2ZXIgaGFzIGJlZW4gZXN0YWJsaXNoZWQuCiAqLwpjbGFzcyBIdHRwc1Byb3h5QWdlbnQgZXh0ZW5kcyBBZ2VudCB7CiAgc3RhdGljIF9faW5pdFN0YXRpYygpIHt0aGlzLnByb3RvY29scyA9IFsnaHR0cCcsICdodHRwcyddOyB9CgogIGNvbnN0cnVjdG9yKHByb3h5LCBvcHRzKSB7CiAgICBzdXBlcihvcHRzKTsKICAgIHRoaXMub3B0aW9ucyA9IHt9OwogICAgdGhpcy5wcm94eSA9IHR5cGVvZiBwcm94eSA9PT0gJ3N0cmluZycgPyBuZXcgVVJMKHByb3h5KSA6IHByb3h5OwogICAgdGhpcy5wcm94eUhlYWRlcnMgPSBfbnVsbGlzaENvYWxlc2NlJDEoX29wdGlvbmFsQ2hhaW4kMShbb3B0cywgJ29wdGlvbmFsQWNjZXNzJywgXzIgPT4gXzIuaGVhZGVyc10pLCAoKSA9PiAoIHt9KSk7CiAgICBkZWJ1ZygnQ3JlYXRpbmcgbmV3IEh0dHBzUHJveHlBZ2VudCBpbnN0YW5jZTogJW8nLCB0aGlzLnByb3h5LmhyZWYpOwoKICAgIC8vIFRyaW0gb2ZmIHRoZSBicmFja2V0cyBmcm9tIElQdjYgYWRkcmVzc2VzCiAgICBjb25zdCBob3N0ID0gKHRoaXMucHJveHkuaG9zdG5hbWUgfHwgdGhpcy5wcm94eS5ob3N0KS5yZXBsYWNlKC9eXFt8XF0kL2csICcnKTsKICAgIGNvbnN0IHBvcnQgPSB0aGlzLnByb3h5LnBvcnQgPyBwYXJzZUludCh0aGlzLnByb3h5LnBvcnQsIDEwKSA6IHRoaXMucHJveHkucHJvdG9jb2wgPT09ICdodHRwczonID8gNDQzIDogODA7CiAgICB0aGlzLmNvbm5lY3RPcHRzID0gewogICAgICAvLyBBdHRlbXB0IHRvIG5lZ290aWF0ZSBodHRwLzEuMSBmb3IgcHJveHkgc2VydmVycyB0aGF0IHN1cHBvcnQgaHR0cC8yCiAgICAgIEFMUE5Qcm90b2NvbHM6IFsnaHR0cC8xLjEnXSwKICAgICAgLi4uKG9wdHMgPyBvbWl0KG9wdHMsICdoZWFkZXJzJykgOiBudWxsKSwKICAgICAgaG9zdCwKICAgICAgcG9ydCwKICAgIH07CiAgfQoKICAvKioKICAgKiBDYWxsZWQgd2hlbiB0aGUgbm9kZS1jb3JlIEhUVFAgY2xpZW50IGxpYnJhcnkgaXMgY3JlYXRpbmcgYQogICAqIG5ldyBIVFRQIHJlcXVlc3QuCiAgICovCiAgYXN5bmMgY29ubmVjdChyZXEsIG9wdHMpIHsKICAgIGNvbnN0IHsgcHJveHkgfSA9IHRoaXM7CgogICAgaWYgKCFvcHRzLmhvc3QpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignTm8gImhvc3QiIHByb3ZpZGVkJyk7CiAgICB9CgogICAgLy8gQ3JlYXRlIGEgc29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlci4KICAgIGxldCBzb2NrZXQ7CiAgICBpZiAocHJveHkucHJvdG9jb2wgPT09ICdodHRwczonKSB7CiAgICAgIGRlYnVnKCdDcmVhdGluZyBgdGxzLlNvY2tldGA6ICVvJywgdGhpcy5jb25uZWN0T3B0cyk7CiAgICAgIGNvbnN0IHNlcnZlcm5hbWUgPSB0aGlzLmNvbm5lY3RPcHRzLnNlcnZlcm5hbWUgfHwgdGhpcy5jb25uZWN0T3B0cy5ob3N0OwogICAgICBzb2NrZXQgPSB0bHMuY29ubmVjdCh7CiAgICAgICAgLi4udGhpcy5jb25uZWN0T3B0cywKICAgICAgICBzZXJ2ZXJuYW1lOiBzZXJ2ZXJuYW1lICYmIG5ldC5pc0lQKHNlcnZlcm5hbWUpID8gdW5kZWZpbmVkIDogc2VydmVybmFtZSwKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBkZWJ1ZygnQ3JlYXRpbmcgYG5ldC5Tb2NrZXRgOiAlbycsIHRoaXMuY29ubmVjdE9wdHMpOwogICAgICBzb2NrZXQgPSBuZXQuY29ubmVjdCh0aGlzLmNvbm5lY3RPcHRzKTsKICAgIH0KCiAgICBjb25zdCBoZWFkZXJzID0KICAgICAgdHlwZW9mIHRoaXMucHJveHlIZWFkZXJzID09PSAnZnVuY3Rpb24nID8gdGhpcy5wcm94eUhlYWRlcnMoKSA6IHsgLi4udGhpcy5wcm94eUhlYWRlcnMgfTsKICAgIGNvbnN0IGhvc3QgPSBuZXQuaXNJUHY2KG9wdHMuaG9zdCkgPyBgWyR7b3B0cy5ob3N0fV1gIDogb3B0cy5ob3N0OwogICAgbGV0IHBheWxvYWQgPSBgQ09OTkVDVCAke2hvc3R9OiR7b3B0cy5wb3J0fSBIVFRQLzEuMVxyXG5gOwoKICAgIC8vIEluamVjdCB0aGUgYFByb3h5LUF1dGhvcml6YXRpb25gIGhlYWRlciBpZiBuZWNlc3NhcnkuCiAgICBpZiAocHJveHkudXNlcm5hbWUgfHwgcHJveHkucGFzc3dvcmQpIHsKICAgICAgY29uc3QgYXV0aCA9IGAke2RlY29kZVVSSUNvbXBvbmVudChwcm94eS51c2VybmFtZSl9OiR7ZGVjb2RlVVJJQ29tcG9uZW50KHByb3h5LnBhc3N3b3JkKX1gOwogICAgICBoZWFkZXJzWydQcm94eS1BdXRob3JpemF0aW9uJ10gPSBgQmFzaWMgJHtCdWZmZXIuZnJvbShhdXRoKS50b1N0cmluZygnYmFzZTY0Jyl9YDsKICAgIH0KCiAgICBoZWFkZXJzLkhvc3QgPSBgJHtob3N0fToke29wdHMucG9ydH1gOwoKICAgIGlmICghaGVhZGVyc1snUHJveHktQ29ubmVjdGlvbiddKSB7CiAgICAgIGhlYWRlcnNbJ1Byb3h5LUNvbm5lY3Rpb24nXSA9IHRoaXMua2VlcEFsaXZlID8gJ0tlZXAtQWxpdmUnIDogJ2Nsb3NlJzsKICAgIH0KICAgIGZvciAoY29uc3QgbmFtZSBvZiBPYmplY3Qua2V5cyhoZWFkZXJzKSkgewogICAgICBwYXlsb2FkICs9IGAke25hbWV9OiAke2hlYWRlcnNbbmFtZV19XHJcbmA7CiAgICB9CgogICAgY29uc3QgcHJveHlSZXNwb25zZVByb21pc2UgPSBwYXJzZVByb3h5UmVzcG9uc2Uoc29ja2V0KTsKCiAgICBzb2NrZXQud3JpdGUoYCR7cGF5bG9hZH1cclxuYCk7CgogICAgY29uc3QgeyBjb25uZWN0LCBidWZmZXJlZCB9ID0gYXdhaXQgcHJveHlSZXNwb25zZVByb21pc2U7CiAgICByZXEuZW1pdCgncHJveHlDb25uZWN0JywgY29ubmVjdCk7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10cy1jb21tZW50CiAgICAvLyBAdHMtaWdub3JlIE5vdCBFdmVudEVtaXR0ZXIgaW4gTm9kZSB0eXBlcwogICAgdGhpcy5lbWl0KCdwcm94eUNvbm5lY3QnLCBjb25uZWN0LCByZXEpOwoKICAgIGlmIChjb25uZWN0LnN0YXR1c0NvZGUgPT09IDIwMCkgewogICAgICByZXEub25jZSgnc29ja2V0JywgcmVzdW1lKTsKCiAgICAgIGlmIChvcHRzLnNlY3VyZUVuZHBvaW50KSB7CiAgICAgICAgLy8gVGhlIHByb3h5IGlzIGNvbm5lY3RpbmcgdG8gYSBUTFMgc2VydmVyLCBzbyB1cGdyYWRlCiAgICAgICAgLy8gdGhpcyBzb2NrZXQgY29ubmVjdGlvbiB0byBhIFRMUyBjb25uZWN0aW9uLgogICAgICAgIGRlYnVnKCdVcGdyYWRpbmcgc29ja2V0IGNvbm5lY3Rpb24gdG8gVExTJyk7CiAgICAgICAgY29uc3Qgc2VydmVybmFtZSA9IG9wdHMuc2VydmVybmFtZSB8fCBvcHRzLmhvc3Q7CiAgICAgICAgcmV0dXJuIHRscy5jb25uZWN0KHsKICAgICAgICAgIC4uLm9taXQob3B0cywgJ2hvc3QnLCAncGF0aCcsICdwb3J0JyksCiAgICAgICAgICBzb2NrZXQsCiAgICAgICAgICBzZXJ2ZXJuYW1lOiBuZXQuaXNJUChzZXJ2ZXJuYW1lKSA/IHVuZGVmaW5lZCA6IHNlcnZlcm5hbWUsCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzb2NrZXQ7CiAgICB9CgogICAgLy8gU29tZSBvdGhlciBzdGF0dXMgY29kZSB0aGF0J3Mgbm90IDIwMC4uLiBuZWVkIHRvIHJlLXBsYXkgdGhlIEhUVFAKICAgIC8vIGhlYWRlciAiZGF0YSIgZXZlbnRzIG9udG8gdGhlIHNvY2tldCBvbmNlIHRoZSBIVFRQIG1hY2hpbmVyeSBpcwogICAgLy8gYXR0YWNoZWQgc28gdGhhdCB0aGUgbm9kZSBjb3JlIGBodHRwYCBjYW4gcGFyc2UgYW5kIGhhbmRsZSB0aGUKICAgIC8vIGVycm9yIHN0YXR1cyBjb2RlLgoKICAgIC8vIENsb3NlIHRoZSBvcmlnaW5hbCBzb2NrZXQsIGFuZCBhIG5ldyAiZmFrZSIgc29ja2V0IGlzIHJldHVybmVkCiAgICAvLyBpbnN0ZWFkLCBzbyB0aGF0IHRoZSBwcm94eSBkb2Vzbid0IGdldCB0aGUgSFRUUCByZXF1ZXN0CiAgICAvLyB3cml0dGVuIHRvIGl0ICh3aGljaCBtYXkgY29udGFpbiBgQXV0aG9yaXphdGlvbmAgaGVhZGVycyBvciBvdGhlcgogICAgLy8gc2Vuc2l0aXZlIGRhdGEpLgogICAgLy8KICAgIC8vIFNlZTogaHR0cHM6Ly9oYWNrZXJvbmUuY29tL3JlcG9ydHMvNTQxNTAyCiAgICBzb2NrZXQuZGVzdHJveSgpOwoKICAgIGNvbnN0IGZha2VTb2NrZXQgPSBuZXcgbmV0LlNvY2tldCh7IHdyaXRhYmxlOiBmYWxzZSB9KTsKICAgIGZha2VTb2NrZXQucmVhZGFibGUgPSB0cnVlOwoKICAgIC8vIE5lZWQgdG8gd2FpdCBmb3IgdGhlICJzb2NrZXQiIGV2ZW50IHRvIHJlLXBsYXkgdGhlICJkYXRhIiBldmVudHMuCiAgICByZXEub25jZSgnc29ja2V0JywgKHMpID0+IHsKICAgICAgZGVidWcoJ1JlcGxheWluZyBwcm94eSBidWZmZXIgZm9yIGZhaWxlZCByZXF1ZXN0Jyk7CiAgICAgIC8vIFJlcGxheSB0aGUgImJ1ZmZlcmVkIiBCdWZmZXIgb250byB0aGUgZmFrZSBgc29ja2V0YCwgc2luY2UgYXQKICAgICAgLy8gdGhpcyBwb2ludCB0aGUgSFRUUCBtb2R1bGUgbWFjaGluZXJ5IGhhcyBiZWVuIGhvb2tlZCB1cCBmb3IKICAgICAgLy8gdGhlIHVzZXIuCiAgICAgIHMucHVzaChidWZmZXJlZCk7CiAgICAgIHMucHVzaChudWxsKTsKICAgIH0pOwoKICAgIHJldHVybiBmYWtlU29ja2V0OwogIH0KfSBIdHRwc1Byb3h5QWdlbnQuX19pbml0U3RhdGljKCk7CgpmdW5jdGlvbiByZXN1bWUoc29ja2V0KSB7CiAgc29ja2V0LnJlc3VtZSgpOwp9CgpmdW5jdGlvbiBvbWl0KAogIG9iaiwKICAuLi5rZXlzCikKCiB7CiAgY29uc3QgcmV0ID0ge30KCjsKICBsZXQga2V5OwogIGZvciAoa2V5IGluIG9iaikgewogICAgaWYgKCFrZXlzLmluY2x1ZGVzKGtleSkpIHsKICAgICAgcmV0W2tleV0gPSBvYmpba2V5XTsKICAgIH0KICB9CiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gX251bGxpc2hDb2FsZXNjZShsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9Ci8vIEVzdGltYXRlZCBtYXhpbXVtIHNpemUgZm9yIHJlYXNvbmFibGUgc3RhbmRhbG9uZSBldmVudApjb25zdCBHWklQX1RIUkVTSE9MRCA9IDEwMjQgKiAzMjsKCi8qKgogKiBHZXRzIGEgc3RyZWFtIGZyb20gYSBVaW50OEFycmF5IG9yIHN0cmluZwogKiBSZWFkYWJsZS5mcm9tIGlzIGlkZWFsIGJ1dCB3YXMgYWRkZWQgaW4gbm9kZS5qcyB2MTIuMy4wIGFuZCB2MTAuMTcuMAogKi8KZnVuY3Rpb24gc3RyZWFtRnJvbUJvZHkoYm9keSkgewogIHJldHVybiBuZXcgUmVhZGFibGUoewogICAgcmVhZCgpIHsKICAgICAgdGhpcy5wdXNoKGJvZHkpOwogICAgICB0aGlzLnB1c2gobnVsbCk7CiAgICB9LAogIH0pOwp9CgovKioKICogQ3JlYXRlcyBhIFRyYW5zcG9ydCB0aGF0IHVzZXMgbmF0aXZlIHRoZSBuYXRpdmUgJ2h0dHAnIGFuZCAnaHR0cHMnIG1vZHVsZXMgdG8gc2VuZCBldmVudHMgdG8gU2VudHJ5LgogKi8KZnVuY3Rpb24gbWFrZU5vZGVUcmFuc3BvcnQob3B0aW9ucykgewogIGxldCB1cmxTZWdtZW50czsKCiAgdHJ5IHsKICAgIHVybFNlZ21lbnRzID0gbmV3IFVSTChvcHRpb25zLnVybCk7CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZVNhbmRib3goKCkgPT4gewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICBjb25zb2xlLndhcm4oCiAgICAgICAgJ1tAc2VudHJ5L25vZGVdOiBJbnZhbGlkIGRzbiBvciB0dW5uZWwgb3B0aW9uLCB3aWxsIG5vdCBzZW5kIGFueSBldmVudHMuIFRoZSB0dW5uZWwgb3B0aW9uIG11c3QgYmUgYSBmdWxsIFVSTCB3aGVuIHVzZWQuJywKICAgICAgKTsKICAgIH0pOwogICAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydChvcHRpb25zLCAoKSA9PiBQcm9taXNlLnJlc29sdmUoe30pKTsKICB9CgogIGNvbnN0IGlzSHR0cHMgPSB1cmxTZWdtZW50cy5wcm90b2NvbCA9PT0gJ2h0dHBzOic7CgogIC8vIFByb3h5IHByaW9yaXRpemF0aW9uOiBodHRwID0+IGBvcHRpb25zLnByb3h5YCB8IGBwcm9jZXNzLmVudi5odHRwX3Byb3h5YAogIC8vIFByb3h5IHByaW9yaXRpemF0aW9uOiBodHRwcyA9PiBgb3B0aW9ucy5wcm94eWAgfCBgcHJvY2Vzcy5lbnYuaHR0cHNfcHJveHlgIHwgYHByb2Nlc3MuZW52Lmh0dHBfcHJveHlgCiAgY29uc3QgcHJveHkgPSBhcHBseU5vUHJveHlPcHRpb24oCiAgICB1cmxTZWdtZW50cywKICAgIG9wdGlvbnMucHJveHkgfHwgKGlzSHR0cHMgPyBwcm9jZXNzLmVudi5odHRwc19wcm94eSA6IHVuZGVmaW5lZCkgfHwgcHJvY2Vzcy5lbnYuaHR0cF9wcm94eSwKICApOwoKICBjb25zdCBuYXRpdmVIdHRwTW9kdWxlID0gaXNIdHRwcyA/IGh0dHBzIDogaHR0cDsKICBjb25zdCBrZWVwQWxpdmUgPSBvcHRpb25zLmtlZXBBbGl2ZSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBvcHRpb25zLmtlZXBBbGl2ZTsKCiAgLy8gVE9ETyh2Nyk6IEV2YWx1YXRlIGlmIHdlIGNhbiBzZXQga2VlcEFsaXZlIHRvIHRydWUuIFRoaXMgd291bGQgaW52b2x2ZSB0ZXN0aW5nIGZvciBtZW1vcnkgbGVha3MgaW4gb2xkZXIgbm9kZQogIC8vIHZlcnNpb25zKD49IDgpIGFzIHRoZXkgaGFkIG1lbW9yeSBsZWFrcyB3aGVuIHVzaW5nIGl0OiAjMjU1NQogIGNvbnN0IGFnZW50ID0gcHJveHkKICAgID8gKG5ldyBIdHRwc1Byb3h5QWdlbnQocHJveHkpICkKICAgIDogbmV3IG5hdGl2ZUh0dHBNb2R1bGUuQWdlbnQoeyBrZWVwQWxpdmUsIG1heFNvY2tldHM6IDMwLCB0aW1lb3V0OiAyMDAwIH0pOwoKICBjb25zdCByZXF1ZXN0RXhlY3V0b3IgPSBjcmVhdGVSZXF1ZXN0RXhlY3V0b3Iob3B0aW9ucywgX251bGxpc2hDb2FsZXNjZShvcHRpb25zLmh0dHBNb2R1bGUsICgpID0+ICggbmF0aXZlSHR0cE1vZHVsZSkpLCBhZ2VudCk7CiAgcmV0dXJuIGNyZWF0ZVRyYW5zcG9ydChvcHRpb25zLCByZXF1ZXN0RXhlY3V0b3IpOwp9CgovKioKICogSG9ub3JzIHRoZSBgbm9fcHJveHlgIGVudiB2YXJpYWJsZSB3aXRoIHRoZSBoaWdoZXN0IHByaW9yaXR5IHRvIGFsbG93IGZvciBob3N0cyBleGNsdXNpb24uCiAqCiAqIEBwYXJhbSB0cmFuc3BvcnRVcmwgVGhlIFVSTCB0aGUgdHJhbnNwb3J0IGludGVuZHMgdG8gc2VuZCBldmVudHMgdG8uCiAqIEBwYXJhbSBwcm94eSBUaGUgY2xpZW50IGNvbmZpZ3VyZWQgcHJveHkuCiAqIEByZXR1cm5zIEEgcHJveHkgdGhlIHRyYW5zcG9ydCBzaG91bGQgdXNlLgogKi8KZnVuY3Rpb24gYXBwbHlOb1Byb3h5T3B0aW9uKHRyYW5zcG9ydFVybFNlZ21lbnRzLCBwcm94eSkgewogIGNvbnN0IHsgbm9fcHJveHkgfSA9IHByb2Nlc3MuZW52OwoKICBjb25zdCB1cmxJc0V4ZW1wdEZyb21Qcm94eSA9CiAgICBub19wcm94eSAmJgogICAgbm9fcHJveHkKICAgICAgLnNwbGl0KCcsJykKICAgICAgLnNvbWUoCiAgICAgICAgZXhlbXB0aW9uID0+IHRyYW5zcG9ydFVybFNlZ21lbnRzLmhvc3QuZW5kc1dpdGgoZXhlbXB0aW9uKSB8fCB0cmFuc3BvcnRVcmxTZWdtZW50cy5ob3N0bmFtZS5lbmRzV2l0aChleGVtcHRpb24pLAogICAgICApOwoKICBpZiAodXJsSXNFeGVtcHRGcm9tUHJveHkpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfSBlbHNlIHsKICAgIHJldHVybiBwcm94eTsKICB9Cn0KCi8qKgogKiBDcmVhdGVzIGEgUmVxdWVzdEV4ZWN1dG9yIHRvIGJlIHVzZWQgd2l0aCBgY3JlYXRlVHJhbnNwb3J0YC4KICovCmZ1bmN0aW9uIGNyZWF0ZVJlcXVlc3RFeGVjdXRvcigKICBvcHRpb25zLAogIGh0dHBNb2R1bGUsCiAgYWdlbnQsCikgewogIGNvbnN0IHsgaG9zdG5hbWUsIHBhdGhuYW1lLCBwb3J0LCBwcm90b2NvbCwgc2VhcmNoIH0gPSBuZXcgVVJMKG9wdGlvbnMudXJsKTsKICByZXR1cm4gZnVuY3Rpb24gbWFrZVJlcXVlc3QocmVxdWVzdCkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbGV0IGJvZHkgPSBzdHJlYW1Gcm9tQm9keShyZXF1ZXN0LmJvZHkpOwoKICAgICAgY29uc3QgaGVhZGVycyA9IHsgLi4ub3B0aW9ucy5oZWFkZXJzIH07CgogICAgICBpZiAocmVxdWVzdC5ib2R5Lmxlbmd0aCA+IEdaSVBfVEhSRVNIT0xEKSB7CiAgICAgICAgaGVhZGVyc1snY29udGVudC1lbmNvZGluZyddID0gJ2d6aXAnOwogICAgICAgIGJvZHkgPSBib2R5LnBpcGUoY3JlYXRlR3ppcCgpKTsKICAgICAgfQoKICAgICAgY29uc3QgcmVxID0gaHR0cE1vZHVsZS5yZXF1ZXN0KAogICAgICAgIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgYWdlbnQsCiAgICAgICAgICBoZWFkZXJzLAogICAgICAgICAgaG9zdG5hbWUsCiAgICAgICAgICBwYXRoOiBgJHtwYXRobmFtZX0ke3NlYXJjaH1gLAogICAgICAgICAgcG9ydCwKICAgICAgICAgIHByb3RvY29sLAogICAgICAgICAgY2E6IG9wdGlvbnMuY2FDZXJ0cywKICAgICAgICB9LAogICAgICAgIHJlcyA9PiB7CiAgICAgICAgICByZXMub24oJ2RhdGEnLCAoKSA9PiB7CiAgICAgICAgICAgIC8vIERyYWluIHNvY2tldAogICAgICAgICAgfSk7CgogICAgICAgICAgcmVzLm9uKCdlbmQnLCAoKSA9PiB7CiAgICAgICAgICAgIC8vIERyYWluIHNvY2tldAogICAgICAgICAgfSk7CgogICAgICAgICAgcmVzLnNldEVuY29kaW5nKCd1dGY4Jyk7CgogICAgICAgICAgLy8gIktleS12YWx1ZSBwYWlycyBvZiBoZWFkZXIgbmFtZXMgYW5kIHZhbHVlcy4gSGVhZGVyIG5hbWVzIGFyZSBsb3dlci1jYXNlZC4iCiAgICAgICAgICAvLyBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX21lc3NhZ2VfaGVhZGVycwogICAgICAgICAgY29uc3QgcmV0cnlBZnRlckhlYWRlciA9IF9udWxsaXNoQ29hbGVzY2UocmVzLmhlYWRlcnNbJ3JldHJ5LWFmdGVyJ10sICgpID0+ICggbnVsbCkpOwogICAgICAgICAgY29uc3QgcmF0ZUxpbWl0c0hlYWRlciA9IF9udWxsaXNoQ29hbGVzY2UocmVzLmhlYWRlcnNbJ3gtc2VudHJ5LXJhdGUtbGltaXRzJ10sICgpID0+ICggbnVsbCkpOwoKICAgICAgICAgIHJlc29sdmUoewogICAgICAgICAgICBzdGF0dXNDb2RlOiByZXMuc3RhdHVzQ29kZSwKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICdyZXRyeS1hZnRlcic6IHJldHJ5QWZ0ZXJIZWFkZXIsCiAgICAgICAgICAgICAgJ3gtc2VudHJ5LXJhdGUtbGltaXRzJzogQXJyYXkuaXNBcnJheShyYXRlTGltaXRzSGVhZGVyKSA/IHJhdGVMaW1pdHNIZWFkZXJbMF0gOiByYXRlTGltaXRzSGVhZGVyLAogICAgICAgICAgICB9LAogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgKTsKCiAgICAgIHJlcS5vbignZXJyb3InLCByZWplY3QpOwogICAgICBib2R5LnBpcGUocmVxKTsKICAgIH0pOwogIH07Cn0KCmZ1bmN0aW9uIF9vcHRpb25hbENoYWluKG9wcykgeyBsZXQgbGFzdEFjY2Vzc0xIUyA9IHVuZGVmaW5lZDsgbGV0IHZhbHVlID0gb3BzWzBdOyBsZXQgaSA9IDE7IHdoaWxlIChpIDwgb3BzLmxlbmd0aCkgeyBjb25zdCBvcCA9IG9wc1tpXTsgY29uc3QgZm4gPSBvcHNbaSArIDFdOyBpICs9IDI7IGlmICgob3AgPT09ICdvcHRpb25hbEFjY2VzcycgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSAmJiB2YWx1ZSA9PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gaWYgKG9wID09PSAnYWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJykgeyBsYXN0QWNjZXNzTEhTID0gdmFsdWU7IHZhbHVlID0gZm4odmFsdWUpOyB9IGVsc2UgaWYgKG9wID09PSAnY2FsbCcgfHwgb3AgPT09ICdvcHRpb25hbENhbGwnKSB7IHZhbHVlID0gZm4oKC4uLmFyZ3MpID0+IHZhbHVlLmNhbGwobGFzdEFjY2Vzc0xIUywgLi4uYXJncykpOyBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyB9IH0gcmV0dXJuIHZhbHVlOyB9CmNvbnN0IG9wdGlvbnMgPSB3b3JrZXJEYXRhOwpsZXQgc2Vzc2lvbjsKbGV0IGhhc1NlbnRBbnJFdmVudCA9IGZhbHNlOwoKZnVuY3Rpb24gbG9nKG1zZykgewogIGlmIChvcHRpb25zLmRlYnVnKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgY29uc29sZS5sb2coYFtBTlIgV29ya2VyXSAke21zZ31gKTsKICB9Cn0KCmNvbnN0IHVybCA9IGdldEVudmVsb3BlRW5kcG9pbnRXaXRoVXJsRW5jb2RlZEF1dGgob3B0aW9ucy5kc24pOwpjb25zdCB0cmFuc3BvcnQgPSBtYWtlTm9kZVRyYW5zcG9ydCh7CiAgdXJsLAogIHJlY29yZERyb3BwZWRFdmVudDogKCkgPT4gewogICAgLy8KICB9LAp9KTsKCmFzeW5jIGZ1bmN0aW9uIHNlbmRBYm5vcm1hbFNlc3Npb24oKSB7CiAgLy8gb2Ygd2UgaGF2ZSBhbiBleGlzdGluZyBzZXNzaW9uIHBhc3NlZCBmcm9tIHRoZSBtYWluIHRocmVhZCwgc2VuZCBpdCBhcyBhYm5vcm1hbAogIGlmIChzZXNzaW9uKSB7CiAgICBsb2coJ1NlbmRpbmcgYWJub3JtYWwgc2Vzc2lvbicpOwogICAgdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCB7IHN0YXR1czogJ2Fibm9ybWFsJywgYWJub3JtYWxfbWVjaGFuaXNtOiAnYW5yX2ZvcmVncm91bmQnIH0pOwoKICAgIGNvbnN0IGVudmVsb3BlID0gY3JlYXRlU2Vzc2lvbkVudmVsb3BlKHNlc3Npb24sIG9wdGlvbnMuZHNuLCBvcHRpb25zLnNka01ldGFkYXRhKTsKICAgIC8vIExvZyB0aGUgZW52ZWxvcGUgc28gdG8gYWlkIGluIHRlc3RpbmcKICAgIGxvZyhKU09OLnN0cmluZ2lmeShlbnZlbG9wZSkpOwoKICAgIGF3YWl0IHRyYW5zcG9ydC5zZW5kKGVudmVsb3BlKTsKCiAgICB0cnkgewogICAgICAvLyBOb3RpZnkgdGhlIG1haW4gcHJvY2VzcyB0aGF0IHRoZSBzZXNzaW9uIGhhcyBlbmRlZCBzbyB0aGUgc2Vzc2lvbiBjYW4gYmUgY2xlYXJlZCBmcm9tIHRoZSBzY29wZQogICAgICBfb3B0aW9uYWxDaGFpbihbcGFyZW50UG9ydCwgJ29wdGlvbmFsQWNjZXNzJywgXzIgPT4gXzIucG9zdE1lc3NhZ2UsICdjYWxsJywgXzMgPT4gXzMoJ3Nlc3Npb24tZW5kZWQnKV0pOwogICAgfSBjYXRjaCAoXykgewogICAgICAvLyBpZ25vcmUKICAgIH0KICB9Cn0KCmxvZygnU3RhcnRlZCcpOwoKZnVuY3Rpb24gcHJlcGFyZVN0YWNrRnJhbWVzKHN0YWNrRnJhbWVzKSB7CiAgaWYgKCFzdGFja0ZyYW1lcykgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9CgogIC8vIFN0cmlwIFNlbnRyeSBmcmFtZXMgYW5kIHJldmVyc2UgdGhlIHN0YWNrIGZyYW1lcyBzbyB0aGV5IGFyZSBpbiB0aGUgY29ycmVjdCBvcmRlcgogIGNvbnN0IHN0cmlwcGVkRnJhbWVzID0gc3RyaXBTZW50cnlGcmFtZXNBbmRSZXZlcnNlKHN0YWNrRnJhbWVzKTsKCiAgLy8gSWYgd2UgaGF2ZSBhbiBhcHAgcm9vdCBwYXRoLCByZXdyaXRlIHRoZSBmaWxlbmFtZXMgdG8gYmUgcmVsYXRpdmUgdG8gdGhlIGFwcCByb290CiAgaWYgKG9wdGlvbnMuYXBwUm9vdFBhdGgpIHsKICAgIGZvciAoY29uc3QgZnJhbWUgb2Ygc3RyaXBwZWRGcmFtZXMpIHsKICAgICAgaWYgKCFmcmFtZS5maWxlbmFtZSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmcmFtZS5maWxlbmFtZSA9IG5vcm1hbGl6ZVVybFRvQmFzZShmcmFtZS5maWxlbmFtZSwgb3B0aW9ucy5hcHBSb290UGF0aCk7CiAgICB9CiAgfQoKICByZXR1cm4gc3RyaXBwZWRGcmFtZXM7Cn0KCmFzeW5jIGZ1bmN0aW9uIHNlbmRBbnJFdmVudChmcmFtZXMsIHRyYWNlQ29udGV4dCkgewogIGlmIChoYXNTZW50QW5yRXZlbnQpIHsKICAgIHJldHVybjsKICB9CgogIGhhc1NlbnRBbnJFdmVudCA9IHRydWU7CgogIGF3YWl0IHNlbmRBYm5vcm1hbFNlc3Npb24oKTsKCiAgbG9nKCdTZW5kaW5nIGV2ZW50Jyk7CgogIGNvbnN0IGV2ZW50ID0gewogICAgZXZlbnRfaWQ6IHV1aWQ0KCksCiAgICBjb250ZXh0czogeyAuLi5vcHRpb25zLmNvbnRleHRzLCB0cmFjZTogdHJhY2VDb250ZXh0IH0sCiAgICByZWxlYXNlOiBvcHRpb25zLnJlbGVhc2UsCiAgICBlbnZpcm9ubWVudDogb3B0aW9ucy5lbnZpcm9ubWVudCwKICAgIGRpc3Q6IG9wdGlvbnMuZGlzdCwKICAgIHBsYXRmb3JtOiAnbm9kZScsCiAgICBsZXZlbDogJ2Vycm9yJywKICAgIGV4Y2VwdGlvbjogewogICAgICB2YWx1ZXM6IFsKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAnQXBwbGljYXRpb25Ob3RSZXNwb25kaW5nJywKICAgICAgICAgIHZhbHVlOiBgQXBwbGljYXRpb24gTm90IFJlc3BvbmRpbmcgZm9yIGF0IGxlYXN0ICR7b3B0aW9ucy5hbnJUaHJlc2hvbGR9IG1zYCwKICAgICAgICAgIHN0YWNrdHJhY2U6IHsgZnJhbWVzOiBwcmVwYXJlU3RhY2tGcmFtZXMoZnJhbWVzKSB9LAogICAgICAgICAgLy8gVGhpcyBlbnN1cmVzIHRoZSBVSSBkb2Vzbid0IHNheSAnQ3Jhc2hlZCBpbicgZm9yIHRoZSBzdGFjayB0cmFjZQogICAgICAgICAgbWVjaGFuaXNtOiB7IHR5cGU6ICdBTlInIH0sCiAgICAgICAgfSwKICAgICAgXSwKICAgIH0sCiAgICB0YWdzOiBvcHRpb25zLnN0YXRpY1RhZ3MsCiAgfTsKCiAgY29uc3QgZW52ZWxvcGUgPSBjcmVhdGVFdmVudEVudmVsb3BlKGV2ZW50LCBvcHRpb25zLmRzbiwgb3B0aW9ucy5zZGtNZXRhZGF0YSk7CiAgLy8gTG9nIHRoZSBlbnZlbG9wZSBzbyB0byBhaWQgaW4gdGVzdGluZwogIGxvZyhKU09OLnN0cmluZ2lmeShlbnZlbG9wZSkpOwoKICBhd2FpdCB0cmFuc3BvcnQuc2VuZChlbnZlbG9wZSk7CiAgYXdhaXQgdHJhbnNwb3J0LmZsdXNoKDIwMDApOwoKICAvLyBEZWxheSBmb3IgNSBzZWNvbmRzIHNvIHRoYXQgc3RkaW8gY2FuIGZsdXNoIGluIHRoZSBtYWluIGV2ZW50IGxvb3AgZXZlciByZXN0YXJ0cy4KICAvLyBUaGlzIGlzIG1haW5seSBmb3IgdGhlIGJlbmVmaXQgb2YgbG9nZ2luZy9kZWJ1Z2dpbmcgaXNzdWVzLgogIHNldFRpbWVvdXQoKCkgPT4gewogICAgcHJvY2Vzcy5leGl0KDApOwogIH0sIDUwMDApOwp9CgpsZXQgZGVidWdnZXJQYXVzZTsKCmlmIChvcHRpb25zLmNhcHR1cmVTdGFja1RyYWNlKSB7CiAgbG9nKCdDb25uZWN0aW5nIHRvIGRlYnVnZ2VyJyk7CgogIGNvbnN0IHNlc3Npb24gPSBuZXcgU2Vzc2lvbigpIDsKICBzZXNzaW9uLmNvbm5lY3RUb01haW5UaHJlYWQoKTsKCiAgbG9nKCdDb25uZWN0ZWQgdG8gZGVidWdnZXInKTsKCiAgLy8gQ29sbGVjdCBzY3JpcHRJZCAtPiB1cmwgbWFwIHNvIHdlIGNhbiBsb29rIHVwIHRoZSBmaWxlbmFtZXMgbGF0ZXIKICBjb25zdCBzY3JpcHRzID0gbmV3IE1hcCgpOwoKICBzZXNzaW9uLm9uKCdEZWJ1Z2dlci5zY3JpcHRQYXJzZWQnLCBldmVudCA9PiB7CiAgICBzY3JpcHRzLnNldChldmVudC5wYXJhbXMuc2NyaXB0SWQsIGV2ZW50LnBhcmFtcy51cmwpOwogIH0pOwoKICBzZXNzaW9uLm9uKCdEZWJ1Z2dlci5wYXVzZWQnLCBldmVudCA9PiB7CiAgICBpZiAoZXZlbnQucGFyYW1zLnJlYXNvbiAhPT0gJ290aGVyJykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdHJ5IHsKICAgICAgbG9nKCdEZWJ1Z2dlciBwYXVzZWQnKTsKCiAgICAgIC8vIGNvcHkgdGhlIGZyYW1lcwogICAgICBjb25zdCBjYWxsRnJhbWVzID0gWy4uLmV2ZW50LnBhcmFtcy5jYWxsRnJhbWVzXTsKCiAgICAgIGNvbnN0IGdldE1vZHVsZU5hbWUgPSBvcHRpb25zLmFwcFJvb3RQYXRoID8gY3JlYXRlR2V0TW9kdWxlRnJvbUZpbGVuYW1lKG9wdGlvbnMuYXBwUm9vdFBhdGgpIDogKCkgPT4gdW5kZWZpbmVkOwogICAgICBjb25zdCBzdGFja0ZyYW1lcyA9IGNhbGxGcmFtZXMubWFwKGZyYW1lID0+CiAgICAgICAgY2FsbEZyYW1lVG9TdGFja0ZyYW1lKGZyYW1lLCBzY3JpcHRzLmdldChmcmFtZS5sb2NhdGlvbi5zY3JpcHRJZCksIGdldE1vZHVsZU5hbWUpLAogICAgICApOwoKICAgICAgLy8gRXZhbHVhdGUgYSBzY3JpcHQgaW4gdGhlIGN1cnJlbnRseSBwYXVzZWQgY29udGV4dAogICAgICBzZXNzaW9uLnBvc3QoCiAgICAgICAgJ1J1bnRpbWUuZXZhbHVhdGUnLAogICAgICAgIHsKICAgICAgICAgIC8vIEdyYWIgdGhlIHRyYWNlIGNvbnRleHQgZnJvbSB0aGUgY3VycmVudCBzY29wZQogICAgICAgICAgZXhwcmVzc2lvbjoKICAgICAgICAgICAgJ2NvbnN0IGN0eCA9IF9fU0VOVFJZX18uaHViLmdldFNjb3BlKCkuZ2V0UHJvcGFnYXRpb25Db250ZXh0KCk7IGN0eC50cmFjZUlkICsgIi0iICsgY3R4LnNwYW5JZCArICItIiArIGN0eC5wYXJlbnRTcGFuSWQnLAogICAgICAgICAgLy8gRG9uJ3QgcmUtdHJpZ2dlciB0aGUgZGVidWdnZXIgaWYgdGhpcyBjYXVzZXMgYW4gZXJyb3IKICAgICAgICAgIHNpbGVudDogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIChfLCBwYXJhbSkgPT4gewogICAgICAgICAgY29uc3QgdHJhY2VJZCA9IHBhcmFtICYmIHBhcmFtLnJlc3VsdCA/IChwYXJhbS5yZXN1bHQudmFsdWUgKSA6ICctLSc7CiAgICAgICAgICBjb25zdCBbdHJhY2VfaWQsIHNwYW5faWQsIHBhcmVudF9zcGFuX2lkXSA9IHRyYWNlSWQuc3BsaXQoJy0nKSA7CgogICAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5yZXN1bWUnKTsKICAgICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwoKICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSBfb3B0aW9uYWxDaGFpbihbdHJhY2VfaWQsICdvcHRpb25hbEFjY2VzcycsIF80ID0+IF80Lmxlbmd0aF0pICYmIF9vcHRpb25hbENoYWluKFtzcGFuX2lkLCAnb3B0aW9uYWxBY2Nlc3MnLCBfNSA9PiBfNS5sZW5ndGhdKSA/IHsgdHJhY2VfaWQsIHNwYW5faWQsIHBhcmVudF9zcGFuX2lkIH0gOiB1bmRlZmluZWQ7CiAgICAgICAgICBzZW5kQW5yRXZlbnQoc3RhY2tGcmFtZXMsIGNvbnRleHQpLnRoZW4obnVsbCwgKCkgPT4gewogICAgICAgICAgICBsb2coJ1NlbmRpbmcgQU5SIGV2ZW50IGZhaWxlZC4nKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucmVzdW1lJyk7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwogICAgICB0aHJvdyBlOwogICAgfQogIH0pOwoKICBkZWJ1Z2dlclBhdXNlID0gKCkgPT4gewogICAgdHJ5IHsKICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5lbmFibGUnLCAoKSA9PiB7CiAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5wYXVzZScpOwogICAgICB9KTsKICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgLy8KICAgIH0KICB9Owp9CgpmdW5jdGlvbiBjcmVhdGVIclRpbWVyKCkgewogIC8vIFRPRE8gKHY4KTogV2UgY2FuIHVzZSBwcm9jZXNzLmhydGltZS5iaWdpbnQoKSBhZnRlciB3ZSBkcm9wIG5vZGUgdjgKICBsZXQgbGFzdFBvbGwgPSBwcm9jZXNzLmhydGltZSgpOwoKICByZXR1cm4gewogICAgZ2V0VGltZU1zOiAoKSA9PiB7CiAgICAgIGNvbnN0IFtzZWNvbmRzLCBuYW5vU2Vjb25kc10gPSBwcm9jZXNzLmhydGltZShsYXN0UG9sbCk7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKHNlY29uZHMgKiAxZTMgKyBuYW5vU2Vjb25kcyAvIDFlNik7CiAgICB9LAogICAgcmVzZXQ6ICgpID0+IHsKICAgICAgbGFzdFBvbGwgPSBwcm9jZXNzLmhydGltZSgpOwogICAgfSwKICB9Owp9CgpmdW5jdGlvbiB3YXRjaGRvZ1RpbWVvdXQoKSB7CiAgbG9nKCdXYXRjaGRvZyB0aW1lb3V0Jyk7CgogIGlmIChkZWJ1Z2dlclBhdXNlKSB7CiAgICBsb2coJ1BhdXNpbmcgZGVidWdnZXIgdG8gY2FwdHVyZSBzdGFjayB0cmFjZScpOwogICAgZGVidWdnZXJQYXVzZSgpOwogIH0gZWxzZSB7CiAgICBsb2coJ0NhcHR1cmluZyBldmVudCB3aXRob3V0IGEgc3RhY2sgdHJhY2UnKTsKICAgIHNlbmRBbnJFdmVudCgpLnRoZW4obnVsbCwgKCkgPT4gewogICAgICBsb2coJ1NlbmRpbmcgQU5SIGV2ZW50IGZhaWxlZCBvbiB3YXRjaGRvZyB0aW1lb3V0LicpOwogICAgfSk7CiAgfQp9Cgpjb25zdCB7IHBvbGwgfSA9IHdhdGNoZG9nVGltZXIoY3JlYXRlSHJUaW1lciwgb3B0aW9ucy5wb2xsSW50ZXJ2YWwsIG9wdGlvbnMuYW5yVGhyZXNob2xkLCB3YXRjaGRvZ1RpbWVvdXQpOwoKX29wdGlvbmFsQ2hhaW4oW3BhcmVudFBvcnQsICdvcHRpb25hbEFjY2VzcycsIF82ID0+IF82Lm9uLCAnY2FsbCcsIF83ID0+IF83KCdtZXNzYWdlJywgKG1zZykgPT4gewogIGlmIChtc2cuc2Vzc2lvbikgewogICAgc2Vzc2lvbiA9IG1ha2VTZXNzaW9uKG1zZy5zZXNzaW9uKTsKICB9CgogIHBvbGwoKTsKfSldKTs="),{workerData:m});process.on("exit",(()=>{b.terminate()}));const f=setInterval((()=>{try{const e=(0,a.o5)().getSession(),t=e?{...e,toJSON:void 0}:void 0;b.postMessage({session:t})}catch(e){}}),m.pollInterval);f.unref(),b.on("message",(e=>{"session-ended"===e&&(d("ANR event sent from ANR worker. Clearing session in this thread."),(0,a.o5)().setSession(void 0))})),b.once("error",(e=>{clearInterval(f),d("ANR worker error",e)})),b.once("exit",(e=>{clearInterval(f),d("ANR worker exit",e)})),b.unref()}(s,t)))}}))),p=(0,s.F)("Anr",g)},3245:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i=(0,n(6936).kf)(process.versions.node)},4661:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BROWSER_TRACING_INTEGRATION_ID:()=>pt,BrowserTracing:()=>st,IdleTransaction:()=>ft,Integrations:()=>At,Span:()=>gt,SpanStatus:()=>vt,TRACEPARENT_REGEXP:()=>bt,Transaction:()=>dt,addExtensionMethods:()=>at,defaultRequestInstrumentationOptions:()=>ht,extractTraceparentData:()=>lt,getActiveTransaction:()=>ct,hasTracingEnabled:()=>mt,instrumentOutgoingRequests:()=>yt,spanStatusfromHttpCode:()=>ut,startIdleTransaction:()=>Ct,stripUrlQueryAndFragment:()=>It});var i=n(6849),o=n(8325),r=n(7998),s=n(1869),a=n(3741),c=n(7412),l=n(6524),u=n(9766),d=n(2719),g=n(3445),p=n(6341);const h=p.OW;var m=n(7930);const I=(e,t,n)=>{let i,o;return r=>{t.value>=0&&(r||n)&&(o=t.value-(i||0),(o||void 0===i)&&(i=t.value,t.delta=o,e(t)))}},b=()=>h.__WEB_VITALS_POLYFILL__?h.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||(()=>{const e=h.performance.timing,t=h.performance.navigation.type,n={entryType:"navigation",startTime:0,type:2==t?"back_forward":1===t?"reload":"navigate"};for(const t in e)"navigationStart"!==t&&"toJSON"!==t&&(n[t]=Math.max(e[t]-e.navigationStart,0));return n})()):h.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0],f=()=>{const e=b();return e&&e.activationStart||0},y=(e,t)=>{const n=b();let i="navigate";return n&&(i=h.document.prerendering||f()>0?"prerender":n.type.replace(/_/g,"-")),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:`v3-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:i}},C=(e,t,n)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const i=new PerformanceObserver((e=>{t(e.getEntries())}));return i.observe(Object.assign({type:e,buffered:!0},n||{})),i}}catch(e){}},v=(e,t)=>{const n=i=>{"pagehide"!==i.type&&"hidden"!==h.document.visibilityState||(e(i),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},A=e=>{const t=y("CLS",0);let n,i=0,o=[];const r=e=>{e.forEach((e=>{if(!e.hadRecentInput){const r=o[0],s=o[o.length-1];i&&0!==o.length&&e.startTime-s.startTime<1e3&&e.startTime-r.startTime<5e3?(i+=e.value,o.push(e)):(i=e.value,o=[e]),i>t.value&&(t.value=i,t.entries=o,n&&n())}}))},s=C("layout-shift",r);if(s){n=I(e,t);const i=()=>{r(s.takeRecords()),n(!0)};return v(i),i}};let Z=-1;const G=()=>(Z<0&&(Z="hidden"!==h.document.visibilityState||h.document.prerendering?1/0:0,v((({timeStamp:e})=>{Z=e}),!0)),{get firstHiddenTime(){return Z}}),B=e=>{const t=G(),n=y("FID");let i;const o=e=>{e.startTime<t.firstHiddenTime&&(n.value=e.processingStart-e.startTime,n.entries.push(e),i(!0))},r=e=>{e.forEach(o)},s=C("first-input",r);i=I(e,n),s&&v((()=>{r(s.takeRecords()),s.disconnect()}),!0)};let w=0,S=1/0,V=0;const W=e=>{e.forEach((e=>{e.interactionId&&(S=Math.min(S,e.interactionId),V=Math.max(V,e.interactionId),w=V?(V-S)/7+1:0)}))};let R;const T=()=>{"interactionCount"in performance||R||(R=C("event",W,{type:"event",buffered:!0,durationThreshold:0}))},N=()=>R?w:performance.interactionCount||0,_=[],H={},k=e=>{const t=_[_.length-1],n=H[e.interactionId];if(n||_.length<10||e.duration>t.latency){if(n)n.entries.push(e),n.latency=Math.max(n.latency,e.duration);else{const t={id:e.interactionId,latency:e.duration,entries:[e]};H[t.id]=t,_.push(t)}_.sort(((e,t)=>t.latency-e.latency)),_.splice(10).forEach((e=>{delete H[e.id]}))}},Y=(e,t)=>{t=t||{},T();const n=y("INP");let i;const o=e=>{e.forEach((e=>{e.interactionId&&k(e),"first-input"===e.entryType&&!_.some((t=>t.entries.some((t=>e.duration===t.duration&&e.startTime===t.startTime))))&&k(e)}));const t=(()=>{const e=Math.min(_.length-1,Math.floor(N()/50));return _[e]})();t&&t.latency!==n.value&&(n.value=t.latency,n.entries=t.entries,i())},r=C("event",o,{durationThreshold:t.durationThreshold||40});i=I(e,n,t.reportAllChanges),r&&(r.observe({type:"first-input",buffered:!0}),v((()=>{o(r.takeRecords()),n.value<0&&N()>0&&(n.value=0,n.entries=[]),i(!0)})))},X={},F=e=>{const t=G(),n=y("LCP");let i;const o=e=>{const o=e[e.length-1];if(o){const e=Math.max(o.startTime-f(),0);e<t.firstHiddenTime&&(n.value=e,n.entries=[o],i())}},r=C("largest-contentful-paint",o);if(r){i=I(e,n);const t=()=>{X[n.id]||(o(r.takeRecords()),r.disconnect(),X[n.id]=!0,i(!0))};return["keydown","click"].forEach((e=>{addEventListener(e,t,{once:!0,capture:!0})})),v(t,!0),t}},x={},E={};let J,K,P,z;function U(e,t){return q(e,t),E[e]||(function(e){const t={};"event"===e&&(t.durationThreshold=0),C(e,(t=>{O(e,{entries:t})}),t)}(e),E[e]=!0),$(e,t)}function O(e,t){const n=x[e];if(n&&n.length)for(const i of n)try{i(t)}catch(t){d.T&&c.vF.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${(0,m.qQ)(i)}\nError:`,t)}}function L(){return A((e=>{O("cls",{metric:e}),J=e}))}function D(){return B((e=>{O("fid",{metric:e}),K=e}))}function j(){return F((e=>{O("lcp",{metric:e}),P=e}))}function M(){return Y((e=>{O("inp",{metric:e}),z=e}))}function Q(e,t,n,i,o=!1){let r;return q(e,t),E[e]||(r=n(),E[e]=!0),i&&t({metric:i}),$(e,t,o?r:void 0)}function q(e,t){x[e]=x[e]||[],x[e].push(t)}function $(e,t,n){return()=>{n&&n();const i=x[e];if(!i)return;const o=i.indexOf(t);-1!==o&&i.splice(o,1)}}var ee=n(5527),te=n(831);n(8880);function ne(e){return[{type:"span"},e]}var ie=n(1939),oe=n(3551),re=n(4662),se=n(9297),ae=n(2879);function ce(e){return"number"==typeof e&&isFinite(e)}function le(e,{startTimestamp:t,...n}){return t&&e.startTimestamp>t&&(e.startTimestamp=t),e.startChild({startTimestamp:t,...n})}const ue=2147483647;function de(e){return e/1e3}function ge(){return h&&h.addEventListener&&h.performance}let pe,he,me=0,Ie={};function be(e,t,n,i,o,r){const s=r?t[r]:t[`${n}End`],a=t[`${n}Start`];a&&s&&le(e,{op:"browser",origin:"auto.browser.browser.metrics",description:o||n,startTimestamp:i+de(a),endTimestamp:i+de(s)})}function fe(e,t,n,i){const o=t[n];null!=o&&o<ue&&(e[i]=o)}var ye=n(3317),Ce=n(6641),ve=n(3095),Ae=n(5452),Ze=n(8411),Ge=n(5644);const Be=(0,p.VZ)();function we(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}var Se=n(718);function Ve(){(function(){if("string"==typeof EdgeRuntime)return!0;if(!function(){if(!("fetch"in Be))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}())return!1;if(we(Be.fetch))return!0;let e=!1;const t=Be.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=we(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){Ge.T&&c.vF.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e})()&&(0,Ze.GS)(p.OW,"fetch",(function(e){return function(...t){const{method:n,url:i}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:Re(t),method:We(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:Re(t),method:We(t,"method")?String(t.method).toUpperCase():"GET"}}(t),o={args:t,fetchData:{method:n,url:i},startTimestamp:Date.now()};return(0,Se.aj)("fetch",{...o}),e.apply(p.OW,t).then((e=>{const t={...o,endTimestamp:Date.now(),response:e};return(0,Se.aj)("fetch",t),e}),(e=>{const t={...o,endTimestamp:Date.now(),error:e};throw(0,Se.aj)("fetch",t),e}))}}))}function We(e,t){return!!e&&"object"==typeof e&&!!e[t]}function Re(e){return"string"==typeof e?e:e?We(e,"url")?e.url:e.toString?e.toString():"":""}var Te=n(3816);const Ne=p.OW,_e="__sentry_xhr_v3__";function He(){if(!Ne.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;(0,Ze.GS)(e,"open",(function(e){return function(...t){const n=Date.now(),i=(0,Te.Kg)(t[0])?t[0].toUpperCase():void 0,o=function(e){if((0,Te.Kg)(e))return e;try{return e.toString()}catch(e){}}(t[1]);if(!i||!o)return e.apply(this,t);this[_e]={method:i,url:o,request_headers:{}},"POST"===i&&o.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const r=()=>{const e=this[_e];if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}const t={args:[i,o],endTimestamp:Date.now(),startTimestamp:n,xhr:this};(0,Se.aj)("xhr",t)}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?(0,Ze.GS)(this,"onreadystatechange",(function(e){return function(...t){return r(),e.apply(this,t)}})):this.addEventListener("readystatechange",r),(0,Ze.GS)(this,"setRequestHeader",(function(e){return function(...t){const[n,i]=t,o=this[_e];return o&&(0,Te.Kg)(n)&&(0,Te.Kg)(i)&&(o.request_headers[n.toLowerCase()]=i),e.apply(this,t)}})),e.apply(this,t)}})),(0,Ze.GS)(e,"send",(function(e){return function(...t){const n=this[_e];if(!n)return e.apply(this,t);void 0!==t[0]&&(n.body=t[0]);const i={args:[n.method,n.url],startTimestamp:Date.now(),xhr:this};return(0,Se.aj)("xhr",i),e.apply(this,t)}}))}var ke=n(9653),Ye=n(5584);const Xe=["localhost",/^\/(?!\/)/],Fe={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:Xe,tracePropagationTargets:Xe};function xe(e){const{traceFetch:t,traceXHR:n,tracePropagationTargets:i,tracingOrigins:o,shouldCreateSpanForRequest:r,enableHTTPTimings:c}={traceFetch:Fe.traceFetch,traceXHR:Fe.traceXHR,...e},u="function"==typeof r?r:e=>!0,d=e=>function(e,t){return(0,ke.Xr)(e,t||Xe)}(e,i||o),p={};var h;t&&function(e){const t="fetch";(0,Se.s5)(t,(e=>{const t=function(e,t,n,i,o="auto.http.browser"){if(!(0,oe.w)()||!e.fetchData)return;const r=t(e.fetchData.url);if(e.endTimestamp&&r){const t=e.fetchData.__span;if(!t)return;const n=i[t];if(n){if(e.response){(0,ye.N8)(n,e.response.status);const t=e.response&&e.response.headers&&e.response.headers.get("content-length");if(t){const e=parseInt(t);e>0&&n.setAttribute("http.response_content_length",e)}}else e.error&&n.setStatus("internal_error");n.end(),delete i[t]}return}const c=(0,a.o5)(),u=(0,a.KU)(),{method:d,url:p}=e.fetchData,h=r?(0,ve.Uk)({name:`${d} ${p}`,onlyIfParent:!0,attributes:{url:p,type:"fetch","http.method":d,[s.JD]:o},op:"http.client"}):void 0;if(h&&(e.fetchData.__span=h.spanContext().spanId,i[h.spanContext().spanId]=h),n(e.fetchData.url)&&u){const t=e.args[0];e.args[1]=e.args[1]||{};const n=e.args[1];n.headers=function(e,t,n,i,o){const r=o||n.getSpan(),s=(0,Ce.rm)(),{traceId:a,spanId:c,sampled:u,dsc:d}={...s.getPropagationContext(),...n.getPropagationContext()},p=r?(0,g.Qh)(r):(0,l.TC)(a,c,u),h=(0,Ye.De)(d||(r?(0,Ae.k)(r):(0,Ae.l)(a,t,n))),m=i.headers||("undefined"!=typeof Request&&(0,Te.tH)(e,Request)?e.headers:void 0);if(m){if("undefined"!=typeof Headers&&(0,Te.tH)(m,Headers)){const e=new Headers(m);return e.append("sentry-trace",p),h&&e.append(Ye.hF,h),e}if(Array.isArray(m)){const e=[...m,["sentry-trace",p]];return h&&e.push([Ye.hF,h]),e}{const e="baggage"in m?m.baggage:void 0,t=[];return Array.isArray(e)?t.push(...e):e&&t.push(e),h&&t.push(h),{...m,"sentry-trace":p,baggage:t.length>0?t.join(","):void 0}}}return{"sentry-trace":p,baggage:h}}(t,u,c,n,h)}return h}(e,u,d,p);c&&t&&Ee(t)})),(0,Se.AS)(t,Ve)}(),n&&(h=e=>{const t=function(e,t,n,i){const o=e.xhr,r=o&&o[_e];if(!(0,oe.w)()||!o||o.__sentry_own_request__||!r)return;const c=t(r.url);if(e.endTimestamp&&c){const e=o.__sentry_xhr_span_id__;if(!e)return;const t=i[e];return void(t&&void 0!==r.status_code&&((0,ye.N8)(t,r.status_code),t.end(),delete i[e]))}const u=(0,a.o5)(),d=(0,Ce.rm)(),p=c?(0,ve.Uk)({name:`${r.method} ${r.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":r.method,url:r.url,[s.JD]:"auto.http.browser"},op:"http.client"}):void 0;p&&(o.__sentry_xhr_span_id__=p.spanContext().spanId,i[o.__sentry_xhr_span_id__]=p);const h=(0,a.KU)();if(o.setRequestHeader&&n(r.url)&&h){const{traceId:e,spanId:t,sampled:n,dsc:i}={...d.getPropagationContext(),...u.getPropagationContext()};!function(e,t,n){try{e.setRequestHeader("sentry-trace",t),n&&e.setRequestHeader(Ye.hF,n)}catch(e){}}(o,p?(0,g.Qh)(p):(0,l.TC)(e,t,n),(0,Ye.De)(i||(p?(0,Ae.k)(p):(0,Ae.l)(e,h,u))))}return p}(e,u,d,p);c&&t&&Ee(t)},(0,Se.s5)("xhr",h),(0,Se.AS)("xhr",He))}function Ee(e){const{url:t}=(0,g.et)(e).data||{};if(!t||"string"!=typeof t)return;const n=U("resource",(({entries:i})=>{i.forEach((i=>{(function(e){return"resource"===e.entryType&&"initiatorType"in e&&"string"==typeof e.nextHopProtocol&&("fetch"===e.initiatorType||"xmlhttprequest"===e.initiatorType)})(i)&&i.name.endsWith(t)&&(function(e){const{name:t,version:n}=function(e){let t="unknown",n="unknown",i="";for(const o of e){if("/"===o){[t,n]=e.split("/");break}if(!isNaN(Number(o))){t="h"===i?"http":i,n=e.split(i)[1];break}i+=o}return i===e&&(t=i),{name:t,version:n}}(e.nextHopProtocol),i=[];return i.push(["network.protocol.version",n],["network.protocol.name",t]),se.k3?[...i,["http.request.redirect_start",Je(e.redirectStart)],["http.request.fetch_start",Je(e.fetchStart)],["http.request.domain_lookup_start",Je(e.domainLookupStart)],["http.request.domain_lookup_end",Je(e.domainLookupEnd)],["http.request.connect_start",Je(e.connectStart)],["http.request.secure_connection_start",Je(e.secureConnectionStart)],["http.request.connection_end",Je(e.connectEnd)],["http.request.request_start",Je(e.requestStart)],["http.request.response_start",Je(e.responseStart)],["http.request.response_end",Je(e.responseEnd)]]:i}(i).forEach((t=>e.setAttribute(...t))),setTimeout(n))}))}))}function Je(e=0){return((se.k3||performance.timeOrigin)+e)/1e3}const Ke=(0,p.VZ)(),Pe=p.OW;let ze;function Ue(){if(!function(){const e=Ke.chrome,t=e&&e.app&&e.app.runtime,n="history"in Ke&&!!Ke.history.pushState&&!!Ke.history.replaceState;return!t&&n}())return;const e=Pe.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=ze,t=String(n);ze=t;const i={from:e,to:t};(0,Se.aj)("history",i)}return e.apply(this,t)}}Pe.onpopstate=function(...t){const n=Pe.location.href,i=ze;ze=n;const o={from:i,to:n};if((0,Se.aj)("history",o),e)try{return e.apply(this,t)}catch(e){}},(0,Ze.GS)(Pe.history,"pushState",t),(0,Ze.GS)(Pe.history,"replaceState",t)}const Oe="BrowserTracing",Le={...i.Cq,markBackgroundTransactions:!0,routingInstrumentation:function(e,t=!0,n=!0){if(!h||!h.location)return void(d.T&&c.vF.warn("Could not initialize routing instrumentation due to invalid location"));let i,o=h.location.href;t&&(i=e({name:h.location.pathname,startTimestamp:se.k3?se.k3/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),n&&function(t){const n="history";(0,Se.s5)(n,(({to:t,from:n})=>{void 0===n&&o&&-1!==o.indexOf(t)?o=void 0:n!==t&&(o=void 0,i&&(d.T&&c.vF.log(`[Tracing] Finishing current transaction with op: ${i.op}`),i.end()),i=e({name:h.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})),(0,Se.AS)(n,Ue)}()},startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,_experiments:{},...Fe};function De(e){const t=(0,u.NX)(`meta[name=${e}]`);return t?t.getAttribute("content"):void 0}function je(e){const t=e.attributes&&e.attributes[s.i_],n=e.data&&e.data[s.i_],i=e.metadata&&e.metadata.source;return t||n||i}function Me(e){return"duration"in e}var Qe=n(2581),qe=n(7927),$e=n(2543),et=n(5838),tt=n(875),nt=n(3114),it=n(9336),ot=n(5455),rt=n(9932);const st=class{constructor(e){this.name=Oe,this._hasSetTracePropagationTargets=!1,(0,o.U)(),d.T&&(this._hasSetTracePropagationTargets=!(!e||!e.tracePropagationTargets&&!e.tracingOrigins)),this.options={...Le,...e},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),e&&!e.tracePropagationTargets&&e.tracingOrigins&&(this.options.tracePropagationTargets=e.tracingOrigins),this._collectWebVitals=function(){const e=ge();if(e&&se.k3){e.mark&&h.performance.mark("sentry-tracing-init");const t=Q("fid",(({metric:e})=>{const t=e.entries[e.entries.length-1];if(!t)return;const n=de(se.k3),i=de(t.startTime);d.T&&c.vF.log("[Measurements] Adding FID"),Ie.fid={value:e.value,unit:"millisecond"},Ie["mark.fid"]={value:n+i,unit:"second"}}),D,K),n=function(e,t=!1){return Q("cls",e,L,J,t)}((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(d.T&&c.vF.log("[Measurements] Adding CLS"),Ie.cls={value:e.value,unit:""},he=t)}),!0),i=function(e,t=!1){return Q("lcp",e,j,P,t)}((({metric:e})=>{const t=e.entries[e.entries.length-1];t&&(d.T&&c.vF.log("[Measurements] Adding LCP"),Ie.lcp={value:e.value,unit:"millisecond"},pe=t)}),!0);return()=>{t(),n(),i()}}return()=>{}}(),this._interactionIdtoRouteNameMapping={},this.options.enableInp&&function(e){if(ge()&&se.k3){const t=function(e){return t=({metric:t})=>{const n=t.entries.find((e=>"click"===e.name||"pointerdown"===e.name)),i=(0,a.KU)();if(!n||!i)return;const o=i.getOptions(),r=de(se.k3+n.startTime),s=de(t.value),{routeName:l,parentContext:g,activeTransaction:p,user:m,replayId:I}=void 0!==n.interactionId?e[n.interactionId]:{routeName:void 0,parentContext:void 0,activeTransaction:void 0,user:void 0,replayId:void 0},b=void 0!==m?m.email||m.id||m.ip_address:void 0,f=void 0!==p?p.getProfileId():void 0,y=new ee.L({startTimestamp:r,endTimestamp:r+s,op:"ui.interaction.click",name:(0,u.Hd)(n.target),attributes:{release:o.release,environment:o.environment,transaction:l,...void 0!==b&&""!==b?{user:b}:{},...void 0!==f?{profile_id:f}:{},...void 0!==I?{replay_id:I}:{}},exclusiveTime:t.value,measurements:{inp:{value:t.value,unit:"millisecond"}}}),C=function(e,t){if(!(0,oe.w)(t))return!1;let n;return n=void 0!==e&&"function"==typeof t.tracesSampler?t.tracesSampler({transactionContext:e,name:e.name,parentSampled:e.parentSampled,attributes:{...e.data,...e.attributes},location:h.location}):void 0!==e&&void 0!==e.sampled?e.sampled:void 0!==t.tracesSampleRate?t.tracesSampleRate:1,(0,re.v)(n)?n:(d.T&&c.vF.warn("[Tracing] Discarding transaction because of invalid sample rate."),!1)}(g,o);if(C&&Math.random()<C){const e=y?function(t,n){const i={sent_at:(new Date).toISOString()};n&&(i.dsn=(0,te.SB)(n));const o=t.map(ne);return(0,e.h4)(i,o)}([y],i.getDsn()):void 0,t=i&&i.getTransport();t&&e&&t.send(e).then(null,(e=>{d.T&&c.vF.error("Error while sending interaction:",e)}))}},Q("inp",t,M,z);var t}(e);return()=>{t()}}}(this._interactionIdtoRouteNameMapping),this.options.enableLongTask&&U("longtask",(({entries:e})=>{for(const t of e){const e=(0,r.Z7)();if(!e)return;const n=de(se.k3+t.startTime),i=de(t.duration);e.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+i})}})),this.options._experiments.enableInteractions&&U("event",(({entries:e})=>{for(const t of e){const e=(0,r.Z7)();if(!e)return;if("click"===t.name){const n=de(se.k3+t.startTime),i=de(t.duration),o={description:(0,u.Hd)(t.target),op:`ui.interaction.${t.name}`,origin:"auto.ui.browser.metrics",startTimestamp:n,endTimestamp:n+i},r=(0,u.xE)(t.target);r&&(o.attributes={"ui.component_name":r}),e.startChild(o)}}})),this._latestRoute={name:void 0,context:void 0}}setupOnce(e,t){this._getCurrentHub=t;const n=t().getClient(),i=n&&n.getOptions(),{routingInstrumentation:o,startTransactionOnLocationChange:s,startTransactionOnPageLoad:a,markBackgroundTransactions:l,traceFetch:u,traceXHR:p,shouldCreateSpanForRequest:m,enableHTTPTimings:I,_experiments:b}=this.options,f=i&&i.tracePropagationTargets,y=f||this.options.tracePropagationTargets;d.T&&this._hasSetTracePropagationTargets&&f&&c.vF.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),o((e=>{const n=this._createRouteTransaction(e);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(n,e,t),n}),a,s),l&&(h&&h.document?h.document.addEventListener("visibilitychange",(()=>{const e=(0,r.Z7)();if(h.document.hidden&&e){const t="cancelled",{op:n,status:i}=(0,g.et)(e);d.T&&c.vF.log(`[Tracing] Transaction: ${t} -> since tab moved to the background, op: ${n}`),i||e.setStatus(t),e.setTag("visibilitychange","document.hidden"),e.end()}})):d.T&&c.vF.warn("[Tracing] Could not set up background tab detection due to lack of global document")),b.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),xe({traceFetch:u,traceXHR:p,tracePropagationTargets:y,shouldCreateSpanForRequest:m,enableHTTPTimings:I})}_createRouteTransaction(e){if(!this._getCurrentHub)return void(d.T&&c.vF.warn(`[Tracing] Did not create ${e.op} transaction because _getCurrentHub is invalid.`));const t=this._getCurrentHub(),{beforeNavigate:n,idleTimeout:i,finalTimeout:r,heartbeatInterval:s}=this.options,a="pageload"===e.op;let p;if(a){const t=a?De("sentry-trace"):"",n=a?De("baggage"):void 0,{traceId:i,dsc:o,parentSpanId:r,sampled:s}=(0,l.kM)(t,n);p={traceId:i,parentSpanId:r,parentSampled:s,...e,metadata:{...e.metadata,dynamicSamplingContext:o},trimEnd:!0}}else p={trimEnd:!0,...e};const m="function"==typeof n?n(p):p,I=void 0===m?{...p,sampled:!1}:m;I.metadata=I.name!==p.name?{...I.metadata,source:"custom"}:I.metadata,this._latestRoute.name=I.name,this._latestRoute.context=I,!1===I.sampled&&d.T&&c.vF.log(`[Tracing] Will not send ${I.op} transaction because of beforeNavigate.`),d.T&&c.vF.log(`[Tracing] Starting ${I.op} transaction on scope`);const{location:b}=h,f=(0,o.p)(t,I,i,r,!0,{location:b},s,a);return a&&(h.document.addEventListener("readystatechange",(()=>{["interactive","complete"].includes(h.document.readyState)&&f.sendAutoFinishSignal()})),["interactive","complete"].includes(h.document.readyState)&&f.sendAutoFinishSignal()),f.registerBeforeFinishCallback((e=>{this._collectWebVitals(),function(e){const t=ge();if(!t||!h.performance.getEntries||!se.k3)return;d.T&&c.vF.log("[Tracing] Adding & adjusting spans using Performance API");const n=de(se.k3),i=t.getEntries();let o,r;const{op:s,start_timestamp:a}=(0,g.et)(e);if(i.slice(me).forEach((t=>{const i=de(t.startTime),s=de(t.duration);if(!("navigation"===e.op&&a&&n+i<a))switch(t.entryType){case"navigation":!function(e,t,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach((i=>{be(e,t,i,n)})),be(e,t,"secureConnection",n,"TLS/SSL","connectEnd"),be(e,t,"fetch",n,"cache","domainLookupStart"),be(e,t,"domainLookup",n,"DNS"),function(e,t,n){t.responseEnd&&(le(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:n+de(t.requestStart),endTimestamp:n+de(t.responseEnd)}),le(e,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:n+de(t.responseStart),endTimestamp:n+de(t.responseEnd)}))}(e,t,n)}(e,t,n),o=n+de(t.responseStart),r=n+de(t.requestStart);break;case"mark":case"paint":case"measure":{!function(e,t,n,i,o){const r=o+n,s=r+i;le(e,{description:t.name,endTimestamp:s,op:t.entryType,origin:"auto.resource.browser.metrics",startTimestamp:r})}(e,t,i,s,n);const o=G(),r=t.startTime<o.firstHiddenTime;"first-paint"===t.name&&r&&(d.T&&c.vF.log("[Measurements] Adding FP"),Ie.fp={value:t.startTime,unit:"millisecond"}),"first-contentful-paint"===t.name&&r&&(d.T&&c.vF.log("[Measurements] Adding FCP"),Ie.fcp={value:t.startTime,unit:"millisecond"});break}case"resource":!function(e,t,n,i,o,r){if("xmlhttprequest"===t.initiatorType||"fetch"===t.initiatorType)return;const s=(0,ae.Dl)(n),a={};fe(a,t,"transferSize","http.response_transfer_size"),fe(a,t,"encodedBodySize","http.response_content_length"),fe(a,t,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in t&&(a["resource.render_blocking_status"]=t.renderBlockingStatus),s.protocol&&(a["url.scheme"]=s.protocol.split(":").pop()),s.host&&(a["server.address"]=s.host),a["url.same_origin"]=n.includes(h.location.origin);const c=r+i,l=c+o;le(e,{description:n.replace(h.location.origin,""),endTimestamp:l,op:t.initiatorType?`resource.${t.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:c,data:a})}(e,t,t.name,i,s,n)}})),me=Math.max(i.length-1,0),function(e){const t=h.navigator;if(!t)return;const n=t.connection;n&&(n.effectiveType&&e.setTag("effectiveConnectionType",n.effectiveType),n.type&&e.setTag("connectionType",n.type),ce(n.rtt)&&(Ie["connection.rtt"]={value:n.rtt,unit:"millisecond"})),ce(t.deviceMemory)&&e.setTag("deviceMemory",`${t.deviceMemory} GB`),ce(t.hardwareConcurrency)&&e.setTag("hardwareConcurrency",String(t.hardwareConcurrency))}(e),"pageload"===s){!function(e,t,n,i){"number"==typeof t&&i&&(d.T&&c.vF.log("[Measurements] Adding TTFB"),e.ttfb={value:1e3*Math.max(t-i,0),unit:"millisecond"},"number"==typeof n&&n<=t&&(e["ttfb.requestTime"]={value:1e3*(t-n),unit:"millisecond"}))}(Ie,o,r,a),["fcp","fp","lcp"].forEach((e=>{if(!Ie[e]||!a||n>=a)return;const t=Ie[e].value,i=n+de(t),o=Math.abs(1e3*(i-a)),r=o-t;d.T&&c.vF.log(`[Measurements] Normalized ${e} from ${t} to ${o} (${r})`),Ie[e].value=o}));const t=Ie["mark.fid"];t&&Ie.fid&&(le(e,{description:"first input delay",endTimestamp:t.value+de(Ie.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:t.value}),delete Ie["mark.fid"]),"fcp"in Ie||delete Ie.cls,Object.keys(Ie).forEach((e=>{(0,ie.X)(e,Ie[e].value,Ie[e].unit)})),function(e){pe&&(d.T&&c.vF.log("[Measurements] Adding LCP Data"),pe.element&&e.setTag("lcp.element",(0,u.Hd)(pe.element)),pe.id&&e.setTag("lcp.id",pe.id),pe.url&&e.setTag("lcp.url",pe.url.trim().slice(0,200)),e.setTag("lcp.size",pe.size)),he&&he.sources&&(d.T&&c.vF.log("[Measurements] Adding CLS Data"),he.sources.forEach(((t,n)=>e.setTag(`cls.source.${n+1}`,(0,u.Hd)(t.node)))))}(e)}pe=void 0,he=void 0,Ie={}}(e)})),f}_registerInteractionListener(){let e;const t=()=>{const{idleTimeout:t,finalTimeout:n,heartbeatInterval:i}=this.options,a="ui.action.click",l=(0,r.Z7)();if(l&&l.op&&["navigation","pageload"].includes(l.op))return void(d.T&&c.vF.warn(`[Tracing] Did not create ${a} transaction because a pageload or navigation transaction is in progress.`));if(e&&(e.setFinishReason("interactionInterrupted"),e.end(),e=void 0),!this._getCurrentHub)return void(d.T&&c.vF.warn(`[Tracing] Did not create ${a} transaction because _getCurrentHub is invalid.`));if(!this._latestRoute.name)return void(d.T&&c.vF.warn(`[Tracing] Did not create ${a} transaction because _latestRouteName is missing.`));const u=this._getCurrentHub(),{location:g}=h,p={name:this._latestRoute.name,op:a,trimEnd:!0,data:{[s.i_]:this._latestRoute.context?je(this._latestRoute.context):"url"}};e=(0,o.p)(u,p,t,n,!0,{location:g},i)};["click"].forEach((e=>{addEventListener(e,t,{once:!1,capture:!0})}))}_registerInpInteractionListener(){U("event",(({entries:e})=>{const t=(0,a.KU)(),n=void 0!==t&&void 0!==t.getIntegrationByName?t.getIntegrationByName("Replay"):void 0,i=void 0!==n?n.getReplayId():void 0,o=(0,r.Z7)(),s=(0,a.o5)(),c=void 0!==s?s.getUser():void 0;for(const t of e)if(Me(t)){const e=t.duration,n=Object.keys(this._interactionIdtoRouteNameMapping),r=n.length>0?n.reduce(((e,t)=>this._interactionIdtoRouteNameMapping[e].duration<this._interactionIdtoRouteNameMapping[t].duration?e:t)):void 0;if(void 0===r||e>this._interactionIdtoRouteNameMapping[r].duration){const n=t.interactionId,s=this._latestRoute.name,a=this._latestRoute.context;n&&s&&a&&(r&&Object.keys(this._interactionIdtoRouteNameMapping).length>=10&&delete this._interactionIdtoRouteNameMapping[r],this._interactionIdtoRouteNameMapping[n]={routeName:s,duration:e,parentContext:a,user:c,activeTransaction:o,replayId:i})}}}))}},at=Qe.l,ct=r.Z7,lt=r.nc,ut=ye.o6,dt=qe.Z,gt=ee.L,pt=Oe,ht=Fe,mt=oe.w,It=ae.f,bt=l.MI,ft=i.zX,yt=xe,Ct=o.p,vt=ye.Fp,At={BrowserTracing:st,Apollo:$e.I,Express:et.JF,GraphQL:tt.c,Mongo:nt.N,Mysql:it.d,Postgres:ot.E,Prisma:rt.D};("undefined"==typeof __SENTRY_TRACING__||__SENTRY_TRACING__)&&(0,Qe.l)()},5584:(e,t,n)=>{"use strict";n.d(t,{De:()=>d,hF:()=>s,yD:()=>u});var i=n(5644),o=n(3816),r=n(7412);const s="baggage",a="sentry-",c=/^sentry-/,l=8192;function u(e){if(!(0,o.Kg)(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce(((e,t)=>{const n=g(t);for(const t of Object.keys(n))e[t]=n[t];return e}),{});else{if(!e)return;t=g(e)}const n=Object.entries(t).reduce(((e,[t,n])=>(t.match(c)&&(e[t.slice(a.length)]=n),e)),{});return Object.keys(n).length>0?n:void 0}function d(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce(((e,[t,n],o)=>{const s=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,a=0===o?s:`${e},${s}`;return a.length>l?(i.T&&r.vF.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):a}),"")}(Object.entries(e).reduce(((e,[t,n])=>(n&&(e[`${a}${t}`]=n),e)),{}))}function g(e){return e.split(",").map((e=>e.split("=").map((e=>decodeURIComponent(e.trim()))))).reduce(((e,[t,n])=>(e[t]=n,e)),{})}},9766:(e,t,n)=>{"use strict";n.d(t,{Hd:()=>s,NX:()=>c,xE:()=>l});var i=n(3816);const o=(0,n(6341).VZ)(),r=80;function s(e,t={}){if(!e)return"<unknown>";try{let n=e;const i=5,o=[];let s=0,c=0;const l=" > ",u=l.length;let d;const g=Array.isArray(t)?t:t.keyAttrs,p=!Array.isArray(t)&&t.maxStringLength||r;for(;n&&s++<i&&(d=a(n,g),!("html"===d||s>1&&c+o.length*u+d.length>=p));)o.push(d),c+=d.length,n=n.parentNode;return o.reverse().join(l)}catch(e){return"<unknown>"}}function a(e,t){const n=e,r=[];let s,a,c,l,u;if(!n||!n.tagName)return"";if(o.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;r.push(n.tagName.toLowerCase());const d=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(d&&d.length)d.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&r.push(`#${n.id}`),s=n.className,s&&(0,i.Kg)(s))for(a=s.split(/\s+/),u=0;u<a.length;u++)r.push(`.${a[u]}`);const g=["aria-label","type","name","title","alt"];for(u=0;u<g.length;u++)c=g[u],l=n.getAttribute(c),l&&r.push(`[${c}="${l}"]`);return r.join("")}function c(e){return o.document&&o.document.querySelector?o.document.querySelector(e):null}function l(e){if(!o.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement&&t.dataset.sentryComponent)return t.dataset.sentryComponent;t=t.parentNode}return null}},853:(e,t,n)=>{"use strict";function i(e){let t,n=e[0],i=1;for(;i<e.length;){const o=e[i],r=e[i+1];if(i+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=r(n)):"call"!==o&&"optionalCall"!==o||(n=r(((...e)=>n.call(t,...e))),t=void 0)}return n}n.d(t,{z:()=>i})},5644:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__},831:(e,t,n)=>{"use strict";n.d(t,{AD:()=>c,SB:()=>s});var i=n(5644),o=n(7412);const r=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function s(e,t=!1){const{host:n,path:i,pass:o,port:r,projectId:s,protocol:a,publicKey:c}=e;return`${a}://${c}${t&&o?`:${o}`:""}@${n}${r?`:${r}`:""}/${i?`${i}/`:i}${s}`}function a(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function c(e){const t="string"==typeof e?function(e){const t=r.exec(e);if(!t)return void(0,o.pq)((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,i,s="",c,l="",u]=t.slice(1);let d="",g=u;const p=g.split("/");if(p.length>1&&(d=p.slice(0,-1).join("/"),g=p.pop()),g){const e=g.match(/^\d+/);e&&(g=e[0])}return a({host:c,pass:s,path:d,projectId:g,port:l,protocol:n,publicKey:i})}(e):a(e);if(t&&function(e){if(!i.T)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(o.vF.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(o.vF.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(o.vF.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(o.vF.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}},8880:(e,t,n)=>{"use strict";n.d(t,{Cj:()=>h,W3:()=>a,bN:()=>u,bm:()=>d,h4:()=>s,n2:()=>m,yH:()=>c,zk:()=>p});var i=n(831),o=n(2181),r=n(8411);function s(e,t=[]){return[e,t]}function a(e,t){const[n,i]=e;return[n,[...i,t]]}function c(e,t){const n=e[1];for(const e of n)if(t(e,e[0].type))return!0;return!1}function l(e,t){return(t||new TextEncoder).encode(e)}function u(e,t){const[n,i]=e;let r=JSON.stringify(n);function s(e){"string"==typeof r?r="string"==typeof e?r+e:[l(r,t),e]:r.push("string"==typeof e?l(e,t):e)}for(const e of i){const[t,n]=e;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)s(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify((0,o.S8)(n))}s(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let i=0;for(const t of e)n.set(t,i),i+=t.length;return n}(r)}function d(e,t){const n="string"==typeof e.data?l(e.data,t):e.data;return[(0,r.Ce)({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}const g={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"unknown"};function p(e){return g[e]}function h(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}function m(e,t,n,o){const s=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&o&&{dsn:(0,i.SB)(o)},...s&&{trace:(0,r.Ce)({...s})}}}},718:(e,t,n)=>{"use strict";n.d(t,{AS:()=>l,aj:()=>u,s5:()=>c});var i=n(5644),o=n(7412),r=n(7930);const s={},a={};function c(e,t){s[e]=s[e]||[],s[e].push(t)}function l(e,t){a[e]||(t(),a[e]=!0)}function u(e,t){const n=e&&s[e];if(n)for(const s of n)try{s(t)}catch(t){i.T&&o.vF.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${(0,r.qQ)(s)}\nError:`,t)}}},3816:(e,t,n)=>{"use strict";n.d(t,{Kg:()=>s,L2:()=>b,NF:()=>a,Qd:()=>l,Qg:()=>p,bJ:()=>o,gd:()=>g,mE:()=>h,sO:()=>c,tH:()=>I,vq:()=>d,xH:()=>u,yr:()=>m});const i=Object.prototype.toString;function o(e){switch(i.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return I(e,Error)}}function r(e,t){return i.call(e)===`[object ${t}]`}function s(e){return r(e,"String")}function a(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function c(e){return null===e||a(e)||"object"!=typeof e&&"function"!=typeof e}function l(e){return r(e,"Object")}function u(e){return"undefined"!=typeof Event&&I(e,Event)}function d(e){return"undefined"!=typeof Element&&I(e,Element)}function g(e){return r(e,"RegExp")}function p(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function h(e){return l(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function m(e){return"number"==typeof e&&e!=e}function I(e,t){try{return e instanceof t}catch(e){return!1}}function b(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}},7412:(e,t,n)=>{"use strict";n.d(t,{Ow:()=>r,Z9:()=>s,pq:()=>a,vF:()=>c});var i=n(5644),o=n(6341);const r=["debug","info","warn","error","log","assert","trace"],s={};function a(e){if(!("console"in o.OW))return e();const t=o.OW.console,n={},i=Object.keys(s);i.forEach((e=>{const i=s[e];n[e]=t[e],t[e]=i}));try{return e()}finally{i.forEach((e=>{t[e]=n[e]}))}}const c=function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return i.T?r.forEach((n=>{t[n]=(...t)=>{e&&a((()=>{o.OW.console[n](`Sentry Logger [${n}]:`,...t)}))}})):r.forEach((e=>{t[e]=()=>{}})),t}()},6936:(e,t,n)=>{"use strict";n.d(t,{$X:()=>c,GR:()=>h,M6:()=>u,db:()=>p,eJ:()=>s,gO:()=>l,k9:()=>m,kf:()=>g});var i=n(8411),o=n(9653),r=n(6341);function s(){const e=r.OW,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function a(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function c(e){const{message:t,event_id:n}=e;if(t)return t;const i=a(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function l(e,t,n){const i=e.exception=e.exception||{},o=i.values=i.values||[],r=o[0]=o[0]||{};r.value||(r.value=t||""),r.type||(r.type=n||"Error")}function u(e,t){const n=a(e);if(!n)return;const i=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...i,...t},t&&"data"in t){const e={...i&&i.data,...t.data};n.mechanism.data=e}}const d=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function g(e){const t=e.match(d)||[],n=parseInt(t[1],10),i=parseInt(t[2],10),o=parseInt(t[3],10);return{buildmetadata:t[5],major:isNaN(n)?void 0:n,minor:isNaN(i)?void 0:i,patch:isNaN(o)?void 0:o,prerelease:t[4]}}function p(e,t,n=5){if(void 0===t.lineno)return;const i=e.length,r=Math.max(Math.min(i-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,r-n),r).map((e=>(0,o.nC)(e,0))),t.context_line=(0,o.nC)(e[Math.min(i-1,r)],t.colno||0),t.post_context=e.slice(Math.min(r+1,i),r+1+n).map((e=>(0,o.nC)(e,0)))}function h(e){if(e&&e.__sentry_captured__)return!0;try{(0,i.my)(e,"__sentry_captured__",!0)}catch(e){}return!1}function m(e){return Array.isArray(e)?e:[e]}},258:(e,t,n)=>{"use strict";function i(){return!("undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&__SENTRY_BROWSER_BUNDLE__)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}function o(e,t){return e.require(t)}function r(t){let n;try{n=o(e,t)}catch(e){}try{const{cwd:i}=o(e,"process");n=o(e,`${i()}/node_modules/${t}`)}catch(e){}return n}n.d(t,{fj:()=>o,wD:()=>i,Vw:()=>r}),e=n.hmd(e)},2181:(e,t,n)=>{"use strict";n.d(t,{S8:()=>s,cd:()=>a});var i=n(3816),o=n(8411),r=n(7930);function s(e,t=100,n=1/0){try{return c("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function a(e,t=3,n=102400){const i=s(e,t);return o=i,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?a(e,t-1,n):i;var o}function c(e,t,n=1/0,s=1/0,a=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[l,u]=a;if(null==t||["number","boolean","string"].includes(typeof t)&&!(0,i.yr)(t))return t;const d=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if((0,i.L2)(t))return"[VueViewModel]";if((0,i.mE)(t))return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${(0,r.qQ)(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const n=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(e){return`**non-serializable** (${e})`}}(e,t);if(!d.startsWith("[object "))return d;if(t.__sentry_skip_normalization__)return t;const g="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===g)return d.replace("object ","");if(l(t))return"[Circular ~]";const p=t;if(p&&"function"==typeof p.toJSON)try{return c("",p.toJSON(),g-1,s,a)}catch(e){}const h=Array.isArray(t)?[]:{};let m=0;const I=(0,o.W4)(t);for(const e in I){if(!Object.prototype.hasOwnProperty.call(I,e))continue;if(m>=s){h[e]="[MaxProperties ~]";break}const t=I[e];h[e]=c(e,t,g-1,s,a),m++}return u(t),h}},8411:(e,t,n)=>{"use strict";n.d(t,{Ce:()=>I,GS:()=>c,HF:()=>m,W4:()=>g,my:()=>l,sp:()=>u,u4:()=>d});var i=n(9766),o=n(5644),r=n(3816),s=n(7412),a=n(9653);function c(e,t,n){if(!(t in e))return;const i=e[t],o=n(i);"function"==typeof o&&function(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,l(e,"__sentry_original__",t)}catch(e){}}(o,i),e[t]=o}function l(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){o.T&&s.vF.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function u(e){return e.__sentry_original__}function d(e){return Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&")}function g(e){if((0,r.bJ)(e))return{message:e.message,name:e.name,stack:e.stack,...h(e)};if((0,r.xH)(e)){const t={type:e.type,target:p(e.target),currentTarget:p(e.currentTarget),...h(e)};return"undefined"!=typeof CustomEvent&&(0,r.tH)(e,CustomEvent)&&(t.detail=e.detail),t}return e}function p(e){try{return(0,r.vq)(e)?(0,i.Hd)(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function h(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function m(e,t=40){const n=Object.keys(g(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return(0,a.xv)(n[0],t);for(let e=n.length;e>0;e--){const i=n.slice(0,e).join(", ");if(!(i.length>t))return e===n.length?i:(0,a.xv)(i,t)}return""}function I(e){return b(e,new Map)}function b(e,t){if(function(e){if(!(0,r.Qd)(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const i={};t.set(e,i);for(const n of Object.keys(e))void 0!==e[n]&&(i[n]=b(e[n],t));return i}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const i=[];return t.set(e,i),e.forEach((e=>{i.push(b(e,t))})),i}return e}},1040:(e,t,n)=>{"use strict";n.d(t,{cx:()=>c,GY:()=>g,em:()=>l,Up:()=>u,Rj:()=>d});var i=n(3816),o=n(2181),r=n(2879);const s={ip:!1,request:!0,transaction:!0,user:!0},a=["cookies","data","headers","method","query_string","url"],c=["id","username","email"];function l(e,t,n){if(e){if(!e.metadata.source||"url"===e.metadata.source){const[n,i]=u(t,{path:!0,method:!0});e.updateName(n),e.setMetadata({source:i})}e.setAttribute("url",t.originalUrl||t.url),t.baseUrl&&e.setAttribute("baseUrl",t.baseUrl),e.setData("query",p(t,n))}}function u(e,t={}){const n=e.method&&e.method.toUpperCase();let i="",o="url";t.customRoute||e.route?(i=t.customRoute||`${e.baseUrl||""}${e.route&&e.route.path}`,o="route"):(e.originalUrl||e.url)&&(i=(0,r.f)(e.originalUrl||e.url||""));let s="";return t.method&&n&&(s+=n),t.method&&t.path&&(s+=" "),t.path&&i&&(s+=i),[s,o]}function d(e,t){const{include:n=a,deps:r}=t||{},s={},c=e.headers||{},l=e.method,u=c.host||e.hostname||e.host||"<no host>",d="https"===e.protocol||e.socket&&e.socket.encrypted?"https":"http",g=e.originalUrl||e.url||"",h=g.startsWith(d)?g:`${d}://${u}${g}`;return n.forEach((t=>{switch(t){case"headers":s.headers=c,n.includes("cookies")||delete s.headers.cookie;break;case"method":s.method=l;break;case"url":s.url=h;break;case"cookies":s.cookies=e.cookies||c.cookie&&function(e){const t={};let n=0;for(;n<e.length;){const i=e.indexOf("=",n);if(-1===i)break;let o=e.indexOf(";",n);if(-1===o)o=e.length;else if(o<i){n=e.lastIndexOf(";",i-1)+1;continue}const r=e.slice(n,i).trim();if(void 0===t[r]){let n=e.slice(i+1,o).trim();34===n.charCodeAt(0)&&(n=n.slice(1,-1));try{t[r]=-1!==n.indexOf("%")?decodeURIComponent(n):n}catch(e){t[r]=n}}n=o+1}return t}(c.cookie)||{};break;case"query_string":s.query_string=p(e,r);break;case"data":if("GET"===l||"HEAD"===l)break;void 0!==e.body&&(s.data=(0,i.Kg)(e.body)?e.body:JSON.stringify((0,o.S8)(e.body)));break;default:({}).hasOwnProperty.call(e,t)&&(s[t]=e[t])}})),s}function g(e,t,n){const o={...s,...n&&n.include};if(o.request){const i=Array.isArray(o.request)?d(t,{include:o.request,deps:n&&n.deps}):d(t,{deps:n&&n.deps});e.request={...e.request,...i}}if(o.user){const n=t.user&&(0,i.Qd)(t.user)?function(e,t){const n={};return(Array.isArray(t)?t:c).forEach((t=>{e&&t in e&&(n[t]=e[t])})),n}(t.user,o.user):{};Object.keys(n).length&&(e.user={...e.user,...n})}if(o.ip){const n=t.ip||t.socket&&t.socket.remoteAddress;n&&(e.user={...e.user,ip_address:n})}return o.transaction&&!e.transaction&&(e.transaction=function(e,t){switch(t){case"path":return u(e,{path:!0})[0];case"handler":return e.route&&e.route.stack&&e.route.stack[0]&&e.route.stack[0].name||"<anonymous>";default:return u(e,{path:!0,method:!0,customRoute:e._reconstructedRoute?e._reconstructedRoute:void 0})[0]}}(t,o.transaction)),e}function p(e,t){let n=e.originalUrl||e.url||"";if(n){n.startsWith("/")&&(n=`http://dogs.are.great${n}`);try{return e.query||"undefined"!=typeof URL&&new URL(n).search.slice(1)||t&&t.url&&t.url.parse(n).query||void 0}catch(e){return}}}},7930:(e,t,n)=>{"use strict";function i(e,t=!1){return!(t||e&&!e.startsWith("/")&&!e.match(/^[A-Z]:/)&&!e.startsWith(".")&&!e.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//)||void 0===e||e.includes("node_modules/"))}function o(e){const t=/^\s*[-]{4,}$/,n=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return o=>{const r=o.match(n);if(r){let t,n,o,s,a;if(r[1]){o=r[1];let e=o.lastIndexOf(".");if("."===o[e-1]&&e--,e>0){t=o.slice(0,e),n=o.slice(e+1);const i=t.indexOf(".Module");i>0&&(o=o.slice(i+1),t=t.slice(0,i))}s=void 0}n&&(s=t,a=n),"<anonymous>"===n&&(a=void 0,o=void 0),void 0===o&&(a=a||"<anonymous>",o=s?`${s}.${a}`:a);let c=r[2]&&r[2].startsWith("file://")?r[2].slice(7):r[2];const l="native"===r[5];return c&&c.match(/\/[A-Z]:/)&&(c=c.slice(1)),c||!r[5]||l||(c=r[5]),{filename:c,module:e?e(c):void 0,function:o,lineno:parseInt(r[3],10)||void 0,colno:parseInt(r[4],10)||void 0,in_app:i(c,l)}}if(o.match(t))return{filename:o}}}n.d(t,{gd:()=>c,qQ:()=>d,o:()=>g,vk:()=>l});const r=50,s=/\(error: (.*)\)/,a=/captureMessage|captureException/;function c(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0)=>{const i=[],o=e.split("\n");for(let e=n;e<o.length;e++){const n=o[e];if(n.length>1024)continue;const a=s.test(n)?n.replace(s,"$1"):n;if(!a.match(/\S*Error: /)){for(const e of t){const t=e(a);if(t){i.push(t);break}}if(i.length>=r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),a.test(t[t.length-1].function||"")&&(t.pop(),a.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,r).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"})))}(i)}}function l(e){return Array.isArray(e)?c(...e):e}const u="<anonymous>";function d(e){try{return e&&"function"==typeof e&&e.name||u}catch(e){return u}}function g(e){return[90,o(e)]}},9653:(e,t,n)=>{"use strict";n.d(t,{Xr:()=>s,nC:()=>r,xv:()=>o});var i=n(3816);function o(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function r(e,t){let n=e;const i=n.length;if(i<=150)return n;t>i&&(t=i);let o=Math.max(t-60,0);o<5&&(o=0);let r=Math.min(o+140,i);return r>i-5&&(r=i),r===i&&(o=Math.max(r-140,0)),n=n.slice(o,r),o>0&&(n=`'{snip} ${n}`),r<i&&(n+=" {snip}"),n}function s(e,t=[],n=!1){return t.some((t=>function(e,t,n=!1){return!!(0,i.Kg)(e)&&((0,i.gd)(t)?t.test(e):!!(0,i.Kg)(t)&&(n?e===t:e.includes(t)))}(e,t,n)))}},690:(e,t,n)=>{"use strict";n.d(t,{T2:()=>a,XW:()=>r,xg:()=>s});var i,o=n(3816);function r(e){return new a((t=>{t(e)}))}function s(e){return new a(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"}(i||(i={}));class a{constructor(e){a.prototype.__init.call(this),a.prototype.__init2.call(this),a.prototype.__init3.call(this),a.prototype.__init4.call(this),this._state=i.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new a(((n,i)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){i(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){i(e)}else i(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new a(((t,n)=>{let i,o;return this.then((t=>{o=!1,i=t,e&&e()}),(t=>{o=!0,i=t,e&&e()})).then((()=>{o?n(i):t(i)}))}))}__init(){this._resolve=e=>{this._setResult(i.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(i.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===i.PENDING&&((0,o.Qg)(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===i.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===i.RESOLVED&&e[1](this._value),this._state===i.REJECTED&&e[2](this._value),e[0]=!0)}))}}}},9297:(e,t,n)=>{"use strict";n.d(t,{k3:()=>c,lu:()=>r,zf:()=>s});var i=n(6341);const o=1e3;function r(){return Date.now()/o}const s=function(){const{performance:e}=i.OW;if(!e||!e.now)return r;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/o}();let a;const c=(()=>{const{performance:e}=i.OW;if(!e||!e.now)return void(a="none");const t=36e5,n=e.now(),o=Date.now(),r=e.timeOrigin?Math.abs(e.timeOrigin+n-o):t,s=r<t,c=e.timing&&e.timing.navigationStart,l="number"==typeof c?Math.abs(c+n-o):t;return s||l<t?r<=l?(a="timeOrigin",e.timeOrigin):(a="navigationStart",c):(a="dateNow",o)})()},6524:(e,t,n)=>{"use strict";n.d(t,{E0:()=>a,MI:()=>r,TC:()=>l,kM:()=>c,nc:()=>s});var i=n(5584),o=n(6936);const r=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function s(e){if(!e)return;const t=e.match(r);if(!t)return;let n;return"1"===t[3]?n=!0:"0"===t[3]&&(n=!1),{traceId:t[1],parentSampled:n,parentSpanId:t[2]}}function a(e,t){const n=s(e),r=(0,i.yD)(t),{traceId:a,parentSpanId:c,parentSampled:l}=n||{};return n?{traceparentData:n,dynamicSamplingContext:r||{},propagationContext:{traceId:a||(0,o.eJ)(),parentSpanId:c||(0,o.eJ)().substring(16),spanId:(0,o.eJ)().substring(16),sampled:l,dsc:r||{}}}:{traceparentData:n,dynamicSamplingContext:void 0,propagationContext:{traceId:a||(0,o.eJ)(),spanId:(0,o.eJ)().substring(16)}}}function c(e,t){const n=s(e),r=(0,i.yD)(t),{traceId:a,parentSpanId:c,parentSampled:l}=n||{};return n?{traceId:a||(0,o.eJ)(),parentSpanId:c||(0,o.eJ)().substring(16),spanId:(0,o.eJ)().substring(16),sampled:l,dsc:r||{}}:{traceId:a||(0,o.eJ)(),spanId:(0,o.eJ)().substring(16)}}function l(e=(0,o.eJ)(),t=(0,o.eJ)().substring(16),n){let i="";return void 0!==n&&(i=n?"-1":"-0"),`${e}-${t}${i}`}},2879:(e,t,n)=>{"use strict";function i(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function o(e){return e.split(/[\?#]/,1)[0]}function r(e){return e.split(/\\?\//).filter((e=>e.length>0&&","!==e)).length}function s(e){const{protocol:t,host:n,path:i}=e;return`${t?`${t}://`:""}${n&&n.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||""}${i}`}n.d(t,{Dl:()=>i,c4:()=>r,e_:()=>s,f:()=>o})},6341:(e,t,n)=>{"use strict";function i(e){return e&&e.Math==Math?e:void 0}n.d(t,{BY:()=>s,OW:()=>o,VZ:()=>r});const o="object"==typeof globalThis&&i(globalThis)||"object"==typeof window&&i(window)||"object"==typeof self&&i(self)||"object"==typeof global&&i(global)||function(){return this}()||{};function r(){return o}function s(e,t,n){const i=n||o,r=i.__SENTRY__=i.__SENTRY__||{};return r[e]||(r[e]=t())}},6284:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={grad:.9,turn:360,rad:360/(2*Math.PI)},i=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},o=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n+0},r=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e>t?e:t},s=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},a=function(e){return{r:r(e.r,0,255),g:r(e.g,0,255),b:r(e.b,0,255),a:r(e.a)}},c=function(e){return{r:o(e.r),g:o(e.g),b:o(e.b),a:o(e.a,3)}},l=/^#([0-9a-f]{3,8})$/i,u=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,n=e.g,i=e.b,o=e.a,r=Math.max(t,n,i),s=r-Math.min(t,n,i),a=s?r===t?(n-i)/s:r===n?2+(i-t)/s:4+(t-n)/s:0;return{h:60*(a<0?a+6:a),s:r?s/r*100:0,v:r/255*100,a:o}},g=function(e){var t=e.h,n=e.s,i=e.v,o=e.a;t=t/360*6,n/=100,i/=100;var r=Math.floor(t),s=i*(1-n),a=i*(1-(t-r)*n),c=i*(1-(1-t+r)*n),l=r%6;return{r:255*[i,a,s,s,c,i][l],g:255*[c,i,i,a,s,s][l],b:255*[s,s,c,i,i,a][l],a:o}},p=function(e){return{h:s(e.h),s:r(e.s,0,100),l:r(e.l,0,100),a:r(e.a)}},h=function(e){return{h:o(e.h),s:o(e.s),l:o(e.l),a:o(e.a,3)}},m=function(e){return g((n=(t=e).s,{h:t.h,s:(n*=((i=t.l)<50?i:100-i)/100)>0?2*n/(i+n)*100:0,v:i+n,a:t.a}));var t,n,i},I=function(e){return{h:(t=d(e)).h,s:(o=(200-(n=t.s))*(i=t.v)/100)>0&&o<200?n*i/100/(o<=100?o:200-o)*100:0,l:o/2,a:t.a};var t,n,i,o},b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,f=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,C=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v={string:[[function(e){var t=l.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?o(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?o(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=y.exec(e)||C.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:a({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=b.exec(e)||f.exec(e);if(!t)return null;var i,o,r=p({h:(i=t[1],o=t[2],void 0===o&&(o="deg"),Number(i)*(n[o]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(r)},"hsl"]],object:[[function(e){var t=e.r,n=e.g,o=e.b,r=e.a,s=void 0===r?1:r;return i(t)&&i(n)&&i(o)?a({r:Number(t),g:Number(n),b:Number(o),a:Number(s)}):null},"rgb"],[function(e){var t=e.h,n=e.s,o=e.l,r=e.a,s=void 0===r?1:r;if(!i(t)||!i(n)||!i(o))return null;var a=p({h:Number(t),s:Number(n),l:Number(o),a:Number(s)});return m(a)},"hsl"],[function(e){var t=e.h,n=e.s,o=e.v,a=e.a,c=void 0===a?1:a;if(!i(t)||!i(n)||!i(o))return null;var l=function(e){return{h:s(e.h),s:r(e.s,0,100),v:r(e.v,0,100),a:r(e.a)}}({h:Number(t),s:Number(n),v:Number(o),a:Number(c)});return g(l)},"hsv"]]},A=function(e,t){for(var n=0;n<t.length;n++){var i=t[n][0](e);if(i)return[i,t[n][1]]}return[null,void 0]},Z=function(e){return"string"==typeof e?A(e.trim(),v.string):"object"==typeof e&&null!==e?A(e,v.object):[null,void 0]},G=function(e,t){var n=I(e);return{h:n.h,s:r(n.s+100*t,0,100),l:n.l,a:n.a}},B=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},w=function(e,t){var n=I(e);return{h:n.h,s:n.s,l:r(n.l+100*t,0,100),a:n.a}},S=function(){function e(e){this.parsed=Z(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return o(B(this.rgba),2)},e.prototype.isDark=function(){return B(this.rgba)<.5},e.prototype.isLight=function(){return B(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=c(this.rgba)).r,n=e.g,i=e.b,s=(r=e.a)<1?u(o(255*r)):"","#"+u(t)+u(n)+u(i)+s;var e,t,n,i,r,s},e.prototype.toRgb=function(){return c(this.rgba)},e.prototype.toRgbString=function(){return t=(e=c(this.rgba)).r,n=e.g,i=e.b,(o=e.a)<1?"rgba("+t+", "+n+", "+i+", "+o+")":"rgb("+t+", "+n+", "+i+")";var e,t,n,i,o},e.prototype.toHsl=function(){return h(I(this.rgba))},e.prototype.toHslString=function(){return t=(e=h(I(this.rgba))).h,n=e.s,i=e.l,(o=e.a)<1?"hsla("+t+", "+n+"%, "+i+"%, "+o+")":"hsl("+t+", "+n+"%, "+i+"%)";var e,t,n,i,o},e.prototype.toHsv=function(){return e=d(this.rgba),{h:o(e.h),s:o(e.s),v:o(e.v),a:o(e.a,3)};var e},e.prototype.invert=function(){return V({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),V(G(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),V(G(this.rgba,-e))},e.prototype.grayscale=function(){return V(G(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),V(w(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),V(w(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?V({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):o(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=I(this.rgba);return"number"==typeof e?V({h:e,s:t.s,l:t.l,a:t.a}):o(t.h)},e.prototype.isEqual=function(e){return this.toHex()===V(e).toHex()},e}(),V=function(e){return e instanceof S?e:new S(e)},W=[];t.Colord=S,t.colord=V,t.extend=function(e){e.forEach((function(e){W.indexOf(e)<0&&(e(S,v),W.push(e))}))},t.getFormat=function(e){return Z(e)[1]},t.random=function(){return new S({r:255*Math.random(),g:255*Math.random(),b:255*Math.random()})}},6022:e=>{!function(){"use strict";var t=[,function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.lengthOf=t.keysOf=t.isObject=t.isInfOrNaN=t.isFunction=t.isArguments=t.hasOwn=t.handleError=t.convertMapToObject=t.checkError=void 0,t.isFunction=function(e){return"function"==typeof e},t.isObject=function(e){return"object"===i(e)},t.keysOf=function(e){return Object.keys(e)},t.lengthOf=function(e){return Object.keys(e).length};var o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};t.hasOwn=o,t.convertMapToObject=function(e){return Array.from(e).reduce((function(e,t){var i,o,r=(o=2,function(e){if(Array.isArray(e))return e}(i=t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return r}}(i,o)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}(i,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=r[0],a=r[1];return e[s]=a,e}),{})},t.isArguments=function(e){return null!=e&&o(e,"callee")},t.isInfOrNaN=function(e){return Number.isNaN(e)||e===1/0||e===-1/0};var r={maxStack:function(e){return new RegExp("Maximum call stack size exceeded","g").test(e)}};t.checkError=r,t.handleError=function(e){return function(){try{return e.apply(this,arguments)}catch(e){if(r.maxStack(e.message))throw new Error("Converting circular structure to JSON");throw e}}}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64=void 0;for(var n=Object.create(null),i=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)},o=0;o<64;o++)n[i(o)]=o;var r=function(e){if("undefined"==typeof Uint8Array||"undefined"==typeof ArrayBuffer){for(var t=[],n=0;n<e;n++)t.push(0);return t.$Uint8ArrayPolyfill=!0,t}return new Uint8Array(new ArrayBuffer(e))},s={encode:function(e){if("string"==typeof e){var t=e;e=r(t.length);for(var n=0;n<t.length;n++){var o=t.charCodeAt(n);if(o>255)throw new Error("Not ascii. Base64.encode can only take ascii strings.");e[n]=o}}for(var s=[],a=null,c=null,l=null,u=null,d=0;d<e.length;d++)switch(d%3){case 0:a=e[d]>>2&63,c=(3&e[d])<<4;break;case 1:c|=e[d]>>4&15,l=(15&e[d])<<2;break;case 2:l|=e[d]>>6&3,u=63&e[d],s.push(i(a)),s.push(i(c)),s.push(i(l)),s.push(i(u)),a=null,c=null,l=null,u=null}return null!=a&&(s.push(i(a)),s.push(i(c)),null==l?s.push("="):s.push(i(l)),null==u&&s.push("=")),s.join("")},decode:function(e){var t=Math.floor(3*e.length/4);"="==e.charAt(e.length-1)&&(t--,"="==e.charAt(e.length-2)&&t--);for(var i,o=r(t),s=null,a=null,c=null,l=0,u=0;u<e.length;u++){var d="="===(i=e.charAt(u))?-1:n[i];switch(u%4){case 0:if(d<0)throw new Error("invalid base64 string");s=d<<2;break;case 1:if(d<0)throw new Error("invalid base64 string");s|=d>>4,o[l++]=s,a=(15&d)<<4;break;case 2:d>=0&&(a|=d>>2,o[l++]=a,c=(3&d)<<6);break;case 3:d>=0&&(o[l++]=c|d)}}return o},newBinary:r};t.Base64=s},function(e){e.exports={_noYieldsAllowed:function(e){return e()}}},function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function e(t,o,r,s,a){var c=o[t];switch(n(c)){case"string":return i(c);case"number":return isFinite(c)?String(c):"null";case"boolean":return String(c);case"object":if(!c)return"null";var l,u=s+r,d=[];if(Array.isArray(c)||{}.hasOwnProperty.call(c,"callee")){for(var g=c.length,p=0;p<g;p+=1)d[p]=e(p,c,r,u,a)||"null";return l=0===d.length?"[]":u?"[\n"+u+d.join(",\n"+u)+"\n"+s+"]":"["+d.join(",")+"]"}var h=Object.keys(c);return a&&(h=h.sort()),h.forEach((function(t){(l=e(t,c,r,u,a))&&d.push(i(t)+(u?": ":":")+l)})),l=0===d.length?"{}":u?"{\n"+u+d.join(",\n"+u)+"\n"+s+"}":"{"+d.join(",")+"}"}};t.default=function(e,t){var n=Object.assign({indent:"",canonical:!1},t);if(!0===n.indent)n.indent="  ";else if("number"==typeof n.indent){for(var i="",r=0;r<n.indent;r++)i+=" ";n.indent=i}return o("",{"":e},n.indent,"",n.canonical)},e.exports=t.default}],n={};function i(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,i),r.exports}var o={};!function(){var e=o,t=i(2).Base64,n=i(3);Object.defineProperty(e,"__esModule",{value:!0}),e.EJSON=void 0;var r=i(1),s={};e.EJSON=s;var a=new Map;s.addType=function(e,t){if(a.has(e))throw new Error("Type ".concat(e," already present"));a.set(e,t)};var c=[{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$date")&&1===(0,r.lengthOf)(e)},matchObject:function(e){return e instanceof Date},toJSONValue:function(e){return{$date:e.getTime()}},fromJSONValue:function(e){return new Date(e.$date)}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$regexp")&&(0,r.hasOwn)(e,"$flags")&&2===(0,r.lengthOf)(e)},matchObject:function(e){return e instanceof RegExp},toJSONValue:function(e){return{$regexp:e.source,$flags:e.flags}},fromJSONValue:function(e){return new RegExp(e.$regexp,e.$flags.slice(0,50).replace(/[^gimuy]/g,"").replace(/(.)(?=.*\1)/g,""))}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$InfNaN")&&1===(0,r.lengthOf)(e)},matchObject:r.isInfOrNaN,toJSONValue:function(e){return{$InfNaN:Number.isNaN(e)?0:e===1/0?1:-1}},fromJSONValue:function(e){return e.$InfNaN/0}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$binary")&&1===(0,r.lengthOf)(e)},matchObject:function(e){return"undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&(0,r.hasOwn)(e,"$Uint8ArrayPolyfill")},toJSONValue:function(e){return{$binary:t.encode(e)}},fromJSONValue:function(e){return t.decode(e.$binary)}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$escape")&&1===(0,r.lengthOf)(e)},matchObject:function(e){var t=!1;if(e){var n=(0,r.lengthOf)(e);1!==n&&2!==n||(t=c.some((function(t){return t.matchJSONValue(e)})))}return t},toJSONValue:function(e){var t={};return(0,r.keysOf)(e).forEach((function(n){t[n]=s.toJSONValue(e[n])})),{$escape:t}},fromJSONValue:function(e){var t={};return(0,r.keysOf)(e.$escape).forEach((function(n){t[n]=s.fromJSONValue(e.$escape[n])})),t}},{matchJSONValue:function(e){return(0,r.hasOwn)(e,"$type")&&(0,r.hasOwn)(e,"$value")&&2===(0,r.lengthOf)(e)},matchObject:function(e){return s._isCustomType(e)},toJSONValue:function(e){var t=n._noYieldsAllowed((function(){return e.toJSONValue()}));return{$type:e.typeName(),$value:t}},fromJSONValue:function(e){var t=e.$type;if(!a.has(t))throw new Error("Custom EJSON type ".concat(t," is not defined"));var i=a.get(t);return n._noYieldsAllowed((function(){return i(e.$value)}))}}];s._isCustomType=function(e){return e&&(0,r.isFunction)(e.toJSONValue)&&(0,r.isFunction)(e.typeName)&&a.has(e.typeName())},s._getTypes=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?a:(0,r.convertMapToObject)(a)},s._getConverters=function(){return c};var l=function(e){for(var t=0;t<c.length;t++){var n=c[t];if(n.matchObject(e))return n.toJSONValue(e)}},u=function e(t){if(null===t)return null;var n=l(t);return void 0!==n?n:(0,r.isObject)(t)?((0,r.keysOf)(t).forEach((function(n){var i=t[n];if((0,r.isObject)(i)||void 0===i||(0,r.isInfOrNaN)(i)){var o=l(i);o?t[n]=o:e(i)}})),t):t};s._adjustTypesToJSONValue=u,s.toJSONValue=function(e){var t=l(e);if(void 0!==t)return t;var n=e;return(0,r.isObject)(e)&&(n=s.clone(e),u(n)),n};var d=function(e){if((0,r.isObject)(e)&&null!==e){var t=(0,r.keysOf)(e);if(t.length<=2&&t.every((function(e){return"string"==typeof e&&"$"===e.substr(0,1)})))for(var n=0;n<c.length;n++){var i=c[n];if(i.matchJSONValue(e))return i.fromJSONValue(e)}}return e},g=function e(t){if(null===t)return null;var n=d(t);return n!==t?n:(0,r.isObject)(t)?((0,r.keysOf)(t).forEach((function(n){var i=t[n];if((0,r.isObject)(i)){var o=d(i);if(i!==o)return void(t[n]=o);e(i)}})),t):t};s._adjustTypesFromJSONValue=g,s.fromJSONValue=function(e){var t=d(e);return t===e&&(0,r.isObject)(e)&&(t=s.clone(e),g(t)),t},s.stringify=(0,r.handleError)((function(e,t){var n=s.toJSONValue(e);return t&&(t.canonical||t.indent)?i(4)(n,t):JSON.stringify(n)})),s.parse=function(e){if("string"!=typeof e)throw new Error("EJSON.parse argument should be a string");return s.fromJSONValue(JSON.parse(e))},s.isBinary=function(e){return!!("undefined"!=typeof Uint8Array&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},s.equals=function(e,t,n){var i,o=!(!n||!n.keyOrderSensitive);if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t)return!1;if(!(0,r.isObject)(e)||!(0,r.isObject)(t))return!1;if(e instanceof Date&&t instanceof Date)return e.valueOf()===t.valueOf();if(s.isBinary(e)&&s.isBinary(t)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}if((0,r.isFunction)(e.equals))return e.equals(t,n);if((0,r.isFunction)(t.equals))return t.equals(e,n);var a,c=Array.isArray(e),l=Array.isArray(t);if(c!==l)return!1;if(c&&l){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!s.equals(e[i],t[i],n))return!1;return!0}switch(s._isCustomType(e)+s._isCustomType(t)){case 1:return!1;case 2:return s.equals(s.toJSONValue(e),s.toJSONValue(t))}var u=(0,r.keysOf)(e),d=(0,r.keysOf)(t);return o?(i=0,a=u.every((function(o){return!(i>=d.length||o!==d[i]||!s.equals(e[o],t[d[i]],n)||(i++,0))}))):(i=0,a=u.every((function(o){return!!(0,r.hasOwn)(t,o)&&!!s.equals(e[o],t[o],n)&&(i++,!0)}))),a&&i===d.length},s.clone=function(e){var t;if(!(0,r.isObject)(e))return e;if(null===e)return null;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return e;if(s.isBinary(e)){t=s.newBinary(e.length);for(var n=0;n<e.length;n++)t[n]=e[n];return t}return Array.isArray(e)?e.map(s.clone):(0,r.isArguments)(e)?Array.from(e).map(s.clone):(0,r.isFunction)(e.clone)?e.clone():s._isCustomType(e)?s.fromJSONValue(s.clone(s.toJSONValue(e)),!0):(t={},(0,r.keysOf)(e).forEach((function(n){t[n]=s.clone(e[n])})),t)},s.newBinary=t.newBinary}(),e.exports=o.EJSON}()},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new o(i,r||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,i,o=[];if(0===this._eventsCount)return o;for(i in e=this._events)t.call(e,i)&&o.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,o,r,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,o),!0;case 5:return u.fn.call(u.context,t,i,o,r),!0;case 6:return u.fn.call(u.context,t,i,o,r,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var g,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,i);break;case 4:u[l].fn.call(u[l].context,t,i,o);break;default:if(!c)for(g=1,c=new Array(d-1);g<d;g++)c[g-1]=arguments[g];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,i,o){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||o&&!a.once||i&&a.context!==i||s(this,r);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||o&&!a[c].once||i&&a[c].context!==i)&&l.push(a[c]);l.length?this._events[r]=1===l.length?l[0]:l:s(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},2017:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,o,r;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(o=i;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=i;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,r[o]))return!1;for(o=i;0!=o--;){var s=r[o];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},6762:e=>{var t,n="__lodash_hash_undefined__",i=1/0,o="[object Function]",r="[object GeneratorFunction]",s="[object Symbol]",a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/,l=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,p="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,m=p||h||Function("return this")(),I=Array.prototype,b=Function.prototype,f=Object.prototype,y=m["__core-js_shared__"],C=(t=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"",v=b.toString,A=f.hasOwnProperty,Z=f.toString,G=RegExp("^"+v.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),B=m.Symbol,w=I.splice,S=Y(m,"Map"),V=Y(Object,"create"),W=B?B.prototype:void 0,R=W?W.toString:void 0;function T(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function N(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function _(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function H(e,t){for(var n,i,o=e.length;o--;)if((n=e[o][0])===(i=t)||n!=n&&i!=i)return o;return-1}function k(e,t){var n,i,o=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function Y(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){if(!J(e)||C&&C in e)return!1;var t=function(e){var t=J(e)?Z.call(e):"";return t==o||t==r}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?G:g;return t.test(function(e){if(null!=e){try{return v.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(n)?n:void 0}T.prototype.clear=function(){this.__data__=V?V(null):{}},T.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},T.prototype.get=function(e){var t=this.__data__;if(V){var i=t[e];return i===n?void 0:i}return A.call(t,e)?t[e]:void 0},T.prototype.has=function(e){var t=this.__data__;return V?void 0!==t[e]:A.call(t,e)},T.prototype.set=function(e,t){return this.__data__[e]=V&&void 0===t?n:t,this},N.prototype.clear=function(){this.__data__=[]},N.prototype.delete=function(e){var t=this.__data__,n=H(t,e);return!(n<0||(n==t.length-1?t.pop():w.call(t,n,1),0))},N.prototype.get=function(e){var t=this.__data__,n=H(t,e);return n<0?void 0:t[n][1]},N.prototype.has=function(e){return H(this.__data__,e)>-1},N.prototype.set=function(e,t){var n=this.__data__,i=H(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},_.prototype.clear=function(){this.__data__={hash:new T,map:new(S||N),string:new T}},_.prototype.delete=function(e){return k(this,e).delete(e)},_.prototype.get=function(e){return k(this,e).get(e)},_.prototype.has=function(e){return k(this,e).has(e)},_.prototype.set=function(e,t){return k(this,e).set(e,t),this};var X=x((function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(K(e))return R?R.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(t);var n=[];return l.test(e)&&n.push(""),e.replace(u,(function(e,t,i,o){n.push(i?o.replace(d,"$1"):t||e)})),n}));function F(e){if("string"==typeof e||K(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function x(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var s=e.apply(this,i);return n.cache=r.set(o,s),s};return n.cache=new(x.Cache||_),n}x.Cache=_;var E=Array.isArray;function J(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function K(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&Z.call(e)==s}e.exports=function(e,t,n){var i=null==e?void 0:function(e,t){var n;t=function(e,t){if(E(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!K(e))||c.test(e)||!a.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:E(n=t)?n:X(n);for(var i=0,o=t.length;null!=e&&i<o;)e=e[F(t[i++])];return i&&i==o?e:void 0}(e,t);return void 0===i?n:i}},4865:e=>{"use strict";const t=(e,t,i,o)=>{if("length"===i||"prototype"===i)return;if("arguments"===i||"caller"===i)return;const r=Object.getOwnPropertyDescriptor(e,i),s=Object.getOwnPropertyDescriptor(t,i);!n(r,s)&&o||Object.defineProperty(e,i,s)},n=function(e,t){return void 0===e||e.configurable||e.writable===t.writable&&e.enumerable===t.enumerable&&e.configurable===t.configurable&&(e.writable||e.value===t.value)},i=(e,t)=>`/* Wrapped ${e}*/\n${t}`,o=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),r=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name");e.exports=(e,n,{ignoreNonConfigurable:s=!1}={})=>{const{name:a}=e;for(const i of Reflect.ownKeys(n))t(e,n,i,s);return((e,t)=>{const n=Object.getPrototypeOf(t);n!==Object.getPrototypeOf(e)&&Object.setPrototypeOf(e,n)})(e,n),((e,t,n)=>{const s=""===n?"":`with ${n.trim()}() `,a=i.bind(null,s,t.toString());Object.defineProperty(a,"name",r),Object.defineProperty(e,"toString",{...o,value:a})})(e,n,a),e}},4070:(e,t,n)=>{const i=n(8611),o=n(5692),r=n(6982),s=n(4434),a=n(7016),c=n(9023),l=n(4840).linerase,u=n(4840).parseSOAPString,d=n(8805).parseString,g=n(8805).processors.stripPrefix,p=function(){};var h=function(e,t){s.EventEmitter.call(this),t=t||p,this.useSecure=e.useSecure||!1,this.secureOpts=e.secureOpts||{},this.hostname=e.hostname,this.username=e.username,this.password=e.password,this.port=e.port||(e.useSecure?443:80),this.path=e.path||"/onvif/device_service",this.timeout=e.timeout||12e4,this.agent=e.agent||!1,this.preserveAddress=e.preserveAddress||!1,this.events={},this.on("newListener",function(e){"event"===e&&0===this.listeners(e).length&&setImmediate(function(){this._eventRequest()}.bind(this))}.bind(this)),!1!==e.autoconnect&&setImmediate(function(){this.connect(t)}.bind(this))};c.inherits(h,s.EventEmitter),h.prototype.connect=function(e){this.getSystemDateAndTime(function(t,n,i){if(t)return e.call(this,t,null,i);function o(){var t=[];this.uri&&this.uri.media&&(t.push(this.getProfiles),t.push(this.getVideoSources));var n=t.length,i=!1;if(n>0)t.forEach(function(t){t.call(this,function(t){if(t)e&&!i&&(e.call(this,t),i=!0);else if(! --n&&(this.getActiveSources(),this.emit("connect"),e))return e.call(this,t)}.bind(this))}.bind(this));else if(this.emit("connect"),e)return e.call(this,!1)}this.getServices(!0,function(t){return t?this.getCapabilities(function(t,n,i){return t?e.call(this,t,null,i):o.call(this)}.bind(this)):this.media2Support?void this.getProfiles(function(e){return e&&(this.media2Support=!1),o.call(this)}.bind(this)):o.call(this)}.bind(this))}.bind(this))},h.prototype._request=function(e,t){if("function"!=typeof t)throw new Error("'callback' must be a function");if(void 0===e.body)throw new Error("'options.body' must be a defined");if(void 0===e.action||null===e.action){let n={xmlns:!0,tagNameProcessors:[g]};d(e.body,n,((n,i)=>{if(n)return t(n);for(const t of Object.keys(i.Envelope.Body[0])){const n=i.Envelope.Body[0][t];if(!1===t.startsWith("$")){e.action=n[0].$ns.uri+"/"+n[0].$ns.local;break}}this._requestPart2.call(this,e,t)}))}else this._requestPart2.call(this,e,t)},h.prototype._requestPart2=function(e,t){var n=this,r=!1,s=e.url||{hostname:this.hostname,port:this.port,agent:this.agent,path:e.service?this.uri[e.service]?this.uri[e.service].path:e.service:this.path,timeout:this.timeout};s.headers={"Content-Type":`application/soap+xml;charset=utf-8;action="${e.action}"`,"Content-Length":Buffer.byteLength(e.body,"utf8"),charset:"utf-8"},s.method="POST";var a=this.useSecure?o:i;s=this.useSecure?Object.assign({},this.secureOpts,s):s;var c=a.request(s,(function(e){const i=e.statusCode;var o=[],s=0;e.on("data",(function(e){o.push(e),s+=e.length})),e.on("end",(function(){if(!0!==r){r=!0;var e=Buffer.concat(o,s).toString("utf8");n.emit("rawResponse",e,i),u(e,t,i)}}))}));c.setTimeout(e.replyTimeout?e.replyTimeout:this.timeout,(function(){!0!==r&&(r=!0,t(new Error("Network timeout")),c.abort())})),c.on("error",(function(e){!0!==r&&(r=!0,"ECONNREFUSED"===e.code&&"ECONNREFUSED"===e.errno&&"connect"===e.syscall||"ECONNRESET"===e.code&&"ECONNRESET"===e.errno&&e.syscall,t(e))})),this.emit("rawRequest",e.body),c.write(e.body),c.end()},h.prototype.getSystemDateAndTime=function(e){this._request({body:'<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/></s:Body></s:Envelope>'},function(t,n,i,o){if(!t)try{let o,r=n[0].getSystemDateAndTimeResponse[0].systemDateAndTime[0],s=r.UTCDateTime||r.localDateTime;if(void 0===s)o=new Date;else{let e=l(s[0]);o=new Date(Date.UTC(e.date.year,e.date.month-1,e.date.day,e.time.hour,e.time.minute,e.time.second))}this.timeShift||(this.timeShift=o-1e3*process.uptime()),e.call(this,t,o,i)}catch(t){e.call(this,t,null,i)}if(t){let n="";i&&(n=i.toLowerCase()),o&&401===o||i&&(n.includes("sender not authorized")||n.includes("unauthorized")||n.includes("notauthorized"))?this._request({body:this._envelopeHeader()+'<GetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(t,n,i){try{let o,r=n[0].getSystemDateAndTimeResponse[0].systemDateAndTime[0],s=r.UTCDateTime||r.localDateTime;if(void 0===s)o=new Date;else{let e=l(s[0]);o=new Date(Date.UTC(e.date.year,e.date.month-1,e.date.day,e.time.hour,e.time.minute,e.time.second))}this.timeShift||(this.timeShift=o-1e3*process.uptime()),e.call(this,t,o,i)}catch(t){e.call(this,t,null,i)}}.bind(this)):e.call(this,t,null,i)}}.bind(this))},h.prototype.setSystemDateAndTime=function(e,t){if(-1===["Manual","NTP"].indexOf(e.dateTimeType))return t(new Error("DateTimeType should be `Manual` or `NTP`"));this._request({body:this._envelopeHeader()+'<SetSystemDateAndTime xmlns="http://www.onvif.org/ver10/device/wsdl"><DateTimeType>'+e.dateTimeType+"</DateTimeType><DaylightSavings>"+!!e.daylightSavings+"</DaylightSavings>"+(void 0!==e.timezone?'<TimeZone><TZ xmlns="http://www.onvif.org/ver10/schema">'+e.timezone+"</TZ></TimeZone>":"")+(void 0!==e.dateTime&&e.dateTime instanceof Date?'<UTCDateTime><Time xmlns="http://www.onvif.org/ver10/schema"><Hour>'+e.dateTime.getUTCHours()+"</Hour><Minute>"+e.dateTime.getUTCMinutes()+"</Minute><Second>"+e.dateTime.getUTCSeconds()+'</Second></Time><Date xmlns="http://www.onvif.org/ver10/schema"><Year>'+e.dateTime.getUTCFullYear()+"</Year><Month>"+(e.dateTime.getUTCMonth()+1)+"</Month><Day>"+e.dateTime.getUTCDate()+"</Day></Date></UTCDateTime>":"")+"</SetSystemDateAndTime>"+this._envelopeFooter()},function(e,n,i){if(e||""!==l(n).setSystemDateAndTimeResponse)return t.call(this,""!==l(n).setSystemDateAndTimeResponse?new Error("Wrong `SetSystemDateAndTime` response"):e,n,i);this.getSystemDateAndTime(t)}.bind(this))},h.prototype.getCapabilities=function(e){this._request({body:this._envelopeHeader()+'<GetCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl"><Category>All</Category></GetCapabilities>'+this._envelopeFooter()},function(t,n,i){if(!t&&(this.capabilities=l(n[0].getCapabilitiesResponse[0].capabilities[0]),this.uri||(this.uri={}),["PTZ","media","imaging","events","device"].forEach(function(e){this.capabilities[e]&&this.capabilities[e].XAddr&&(this.uri[e.toLowerCase()]=this._parseUrl(this.capabilities[e].XAddr))}.bind(this)),this.capabilities.extension&&Object.keys(this.capabilities.extension).forEach(function(e){this.capabilities.extension[e].XAddr&&(this.uri[e]=a.parse(this.capabilities.extension[e].XAddr))}.bind(this)),this.uri.replay&&!this.uri.recording)){var o=this.uri.replay.href.replace("replay","recording");console.warn("WARNING: Adding "+o+" for bad Profile G device"),this.uri.recording=a.parse(o)}e&&e.call(this,t,this.capabilities,i)}.bind(this))},h.prototype.getServiceCapabilities=function(e){this._request({body:this._envelopeHeader()+'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/device/wsdl" />'+this._envelopeFooter()},function(t,n,i){t||(n=l(n),this.serviceCapabilities={network:n.getServiceCapabilitiesResponse.capabilities.network.$,security:n.getServiceCapabilitiesResponse.capabilities.security.$,system:n.getServiceCapabilitiesResponse.capabilities.system.$},n.getServiceCapabilitiesResponse.capabilities.misc&&(this.serviceCapabilities.auxiliaryCommands=n.getServiceCapabilitiesResponse.capabilities.misc.$.AuxiliaryCommands.split(" "))),e&&e.call(this,t,this.serviceCapabilities,i)}.bind(this))},h.prototype.getActiveSources=function(){this.videoSources.$&&(this.videoSources=[this.videoSources]),this.defaultProfiles=[],this.activeSources=[],this.videoSources.forEach(function(e,t){var n=e.$.token,i=this.profiles.filter((function(e){if(e.videoSourceConfiguration&&e.videoEncoderConfiguration&&(e.videoSourceConfiguration.sourceToken===n||e.videoSourceConfiguration.sourceToken===e.videoSourceConfiguration.name))return!0}));if(0!==i.length){if(0===t&&(this.defaultProfile=i[0]),this.defaultProfiles[t]=i[0],this.activeSources[t]={sourceToken:e.$.token,profileToken:this.defaultProfiles[t].$.token,videoSourceConfigurationToken:this.defaultProfiles[t].videoSourceConfiguration.$.token},this.defaultProfiles[t].videoEncoderConfiguration){var o=this.defaultProfiles[t].videoEncoderConfiguration;this.activeSources[t].encoding=o.encoding,this.activeSources[t].width=o.resolution?o.resolution.width:"",this.activeSources[t].height=o.resolution?o.resolution.height:"",this.activeSources[t].fps=o.rateControl?o.rateControl.frameRateLimit:"",this.activeSources[t].bitrate=o.rateControl?o.rateControl.bitrateLimit:""}0===t&&(this.activeSource=this.activeSources[t]),this.defaultProfiles[t].PTZConfiguration&&(this.activeSources[t].ptz={name:this.defaultProfiles[t].PTZConfiguration.name,token:this.defaultProfiles[t].PTZConfiguration.$.token})}else if(0===t)throw new Error("Unrecognized configuration")}.bind(this)),0===this.activeSources.length&&this.emit("warning","There are no active sources at this device")},h.prototype.getServices=function(e,t){"function"==typeof e&&(t=e,e=!0),this._request({body:this._envelopeHeader()+'<GetServices xmlns="http://www.onvif.org/ver10/device/wsdl"><IncludeCapability>'+e+"</IncludeCapability></GetServices>"+this._envelopeFooter()},function(e,n,i){e||(this.services=l(n).getServicesResponse.service,this.uri||(this.uri={}),this.media2Support=!1,this.services.forEach((e=>{if(Object.prototype.hasOwnProperty.call(e,"namespace")&&Object.prototype.hasOwnProperty.call(e,"XAddr")){let t=a.parse(e.namespace);if("www.onvif.org"===t.hostname){let n=t.path.substring(1).split("/");"media"===n[1]&&"ver20"===n[0]&&(this.media2Support=!0,n[1]="media2"),this.uri[n[1]]=this._parseUrl(e.XAddr)}}}))),t&&t.call(this,e,this.services,i)}.bind(this))},h.prototype.getDeviceInformation=function(e){this._request({body:this._envelopeHeader()+'<GetDeviceInformation xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(t,n,i){t||(this.deviceInformation=l(n).getDeviceInformationResponse),e&&e.call(this,t,this.deviceInformation,i)}.bind(this))},h.prototype.getHostname=function(e){this._request({body:this._envelopeHeader()+'<GetHostname xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(t,n,i){e&&e.call(this,t,t?null:l(n).getHostnameResponse.hostnameInformation,i)}.bind(this))},h.prototype.getScopes=function(e){this._request({body:this._envelopeHeader()+'<GetScopes xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(t,n,i){t||(this.scopes=l(n).getScopesResponse.scopes,void 0===this.scopes?this.scopes=[]:Array.isArray(this.scopes)||(this.scopes=[this.scopes])),e&&e.call(this,t,this.scopes,i)}.bind(this))},h.prototype.setScopes=function(e,t){this._request({body:this._envelopeHeader()+'<SetScopes xmlns="http://www.onvif.org/ver10/device/wsdl">'+e.map((function(e){return"<Scopes>"+e+"</Scopes>"})).join("")+"</SetScopes>"+this._envelopeFooter()},function(e,n,i){if(e||""!==l(n).setScopesResponse)return t(""!==l(n).setScopesResponse?new Error("Wrong `SetScopes` response"):e,n,i);this.getScopes(t)}.bind(this))},h.prototype.systemReboot=function(e){this._request({service:"deviceIO",body:this._envelopeHeader()+'<SystemReboot xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},(function(t,n,i){t||(n=n[0].systemRebootResponse[0].message[0]),e.call(this,t,n,i)}))},h.prototype.setSystemFactoryDefault=function(e,t){void 0===t&&(t=e,e=!1);let n=this._envelopeHeader()+'<SetSystemFactoryDefault xmlns="http://www.onvif.org/ver10/device/wsdl"><FactoryDefault>'+(e?"Hard":"Soft")+"</FactoryDefault></SetSystemFactoryDefault>"+this._envelopeFooter();this._request({service:"device",body:n},(function(e,n,i){t&&t.call(this,e,null,i)}))},h.prototype._passwordDigest=function(){let e=new Date(1e3*process.uptime()+(this.timeShift||0)).toISOString(),t=Buffer.allocUnsafe(16);t.writeUIntLE(Math.ceil(4294967296*Math.random()),0,4),t.writeUIntLE(Math.ceil(4294967296*Math.random()),4,4),t.writeUIntLE(Math.ceil(4294967296*Math.random()),8,4),t.writeUIntLE(Math.ceil(4294967296*Math.random()),12,4);let n=r.createHash("sha1");return n.update(Buffer.concat([t,Buffer.from(e,"ascii"),Buffer.from(this.password,"ascii")])),{passdigest:n.digest("base64"),nonce:t.toString("base64"),timestamp:e}},h.prototype._envelopeHeader=function(e){var t='<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing"><s:Header>';if(this.username&&this.password){var n=this._passwordDigest();t+='<Security s:mustUnderstand="1" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"><UsernameToken><Username>'+this.username+'</Username><Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">'+n.passdigest+'</Password><Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">'+n.nonce+'</Nonce><Created xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">'+n.timestamp+"</Created></UsernameToken></Security>"}return void 0!==e&&e||(t+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">'),t},h.prototype._envelopeFooter=function(){return"</s:Body></s:Envelope>"},h.prototype._parseUrl=function(e){const t=a.parse(e);return!this.preserveAddress||this.hostname===t.hostname&&this.port===t.port||(t.hostname=this.hostname,t.host=this.hostname+":"+this.port,t.port=this.port,t.href=a.format(t)),t},e.exports={Cam:h},n(5495)(h),n(1504)(h),n(9153)(h),n(951)(h),n(8235)(h),n(1670)(h),n(3162)(h)},5495:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;e.prototype.getNTP=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetNTP xmlns="http://www.onvif.org/ver10/device/wsdl"/></s:Body></s:Envelope>'},(function(n,i,o){n||(this.NTP=t(i[0].getNTPResponse[0].NTPInformation[0])),e.call(this,n,n?null:this.NTP,o)}))},e.prototype.setNTP=function(e,t){Array.isArray(e.NTPManual)||(e.NTPManual=[]),(e.type||e.ipv4Address||e.ipv6Address||e.dnsName||e.extension)&&e.NTPManual.push({type:e.type,IPv4Address:e.ipv4Address,IPv6Address:e.ipv6Address,DNSname:e.dnsName,extension:e.extension});let n=this._envelopeHeader()+'<SetNTP xmlns="http://www.onvif.org/ver10/device/wsdl"><FromDHCP>'+e.fromDHCP+"</FromDHCP>";e.NTPManual&&Array.isArray(e.NTPManual)&&e.NTPManual.forEach((e=>{n+=e.type?'<NTPManual><Type xmlns="http://www.onvif.org/ver10/schema">'+e.type+"</Type>"+(e.IPv4Address?'<IPv4Address xmlns="http://www.onvif.org/ver10/schema">'+e.IPv4Address+"</IPv4Address>":"")+(e.IPv6Address?'<IPv6Address xmlns="http://www.onvif.org/ver10/schema">'+e.IPv6Address+"</IPv6Address>":"")+(e.DNSname?"<DNSname>"+e.DNSname+"</DNSname>":"")+(e.extension?"<Extension>"+e.extension+"</Extension>":"")+"</NTPManual>":""})),n+="</SetNTP>"+this._envelopeFooter(),this._request({service:"device",body:n},t.bind(this))},e.prototype.getNetworkInterfaces=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetNetworkInterfaces xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.networkInterfaces=t(i).getNetworkInterfacesResponse.networkInterfaces,Array.isArray(this.networkInterfaces)||(this.networkInterfaces=[this.networkInterfaces])),e&&e.call(this,n,this.networkInterfaces,o)}.bind(this))},e.prototype.setNetworkInterfaces=function(e,n){let i=e.networkInterface,o=!1,r=!1;if(i.IPv4)try{o=i.IPv4.manual.address!==this.hostname}catch(e){o=!1}else if(i.IPv6)try{r=i.IPv6.manual.address!==this.hostname}catch(e){r=!1}let s=this._envelopeHeader()+'<SetNetworkInterfaces xmlns="http://www.onvif.org/ver10/device/wsdl"><InterfaceToken>'+e.interfaceToken+'</InterfaceToken><NetworkInterface><Enabled xmlns="http://www.onvif.org/ver10/schema">'+i.enabled+"</Enabled>"+(i.link?'<Link xmlns="http://www.onvif.org/ver10/schema"><AutoNegotiation>'+i.link.autoNegotiation+"</AutoNegotiation><Speed>"+i.link.speed+"</Speed><Duplex>"+i.link.duplex+"</Duplex></Link>":"")+(isNaN(i.MTU)?"":'<MTU xmlns="http://www.onvif.org/ver10/schema">'+i.MTU+"</MTU>")+(i.IPv4?'<IPv4 xmlns="http://www.onvif.org/ver10/schema"><Enabled>'+i.IPv4.enabled+"</Enabled><Manual><Address>"+i.IPv4.manual.address+"</Address><PrefixLength>"+i.IPv4.manual.prefixLength+"</PrefixLength></Manual><DHCP>"+i.IPv4.DHCP+"</DHCP></IPv4>":"")+(i.IPv6?'<IPv6 xmlns="http://www.onvif.org/ver10/schema"><Enabled>'+i.IPv6.enabled+"</Enabled><AcceptRouterAdvert >"+i.IPv6.acceptRouterAdvert+"</AcceptRouterAdvert><Manual><Address>"+i.IPv6.manual.address+"</Address><PrefixLength>"+i.IPv6.manual.prefixLength+"</PrefixLength></Manual><DHCP>"+i.IPv6.DHCP+"</DHCP></IPv6>":"")+"</NetworkInterface></SetNetworkInterfaces>"+this._envelopeFooter();this._request({service:"device",body:s},function(e,s,a){n&&(e||(o&&(this.hostname=i.IPv4.manual.address),r&&(this.hostname=i.IPv6.manual.address),s=t(s[0].setNetworkInterfacesResponse)),n.call(this,e,s,a))}.bind(this))},e.prototype.getNetworkDefaultGateway=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetNetworkDefaultGateway xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(n,i,o){e&&(n||(this.networkDefaultGateway=t(i[0].getNetworkDefaultGatewayResponse[0].networkGateway)),e.call(this,n,this.networkDefaultGateway,o))}.bind(this))},e.prototype.setNetworkDefaultGateway=function(e,t){this._request({service:"device",body:this._envelopeHeader()+'<SetNetworkDefaultGateway xmlns="http://www.onvif.org/ver10/device/wsdl">'+(e.IPv4Address?"<IPv4Address>"+e.IPv4Address+"</IPv4Address>":"")+(e.IPv6Address?"<IPv6Address>"+e.IPv6Address+"</IPv6Address>":"")+"</SetNetworkDefaultGateway>"+this._envelopeFooter()},function(e,n,i){if(t){if(e)return t.call(this,e,n,i);this.getNetworkDefaultGateway(t.bind(this))}}.bind(this))},e.prototype.getDNS=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetDNS xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(n,i,o){e&&(n||(this.DNS=t(i[0].getDNSResponse[0].DNSInformation),this.DNS.DNSManual&&!Array.isArray(this.DNS.DNSManual)&&(this.DNS.DNSManual=[this.DNS.DNSManual]),this.DNS.DNSFromDHCP&&!Array.isArray(this.DNS.DNSFromDHCP)&&(this.DNS.DNSFromDHCP=[this.DNS.DNSFromDHCP])),e.call(this,n,this.DNS,o))}.bind(this))},e.prototype.setDNS=function(e,t){let n=this._envelopeHeader()+'<SetDNS xmlns="http://www.onvif.org/ver10/device/wsdl"><FromDHCP>'+!!e.fromDHCP+"</FromDHCP>"+(e.searchDomain?"<SearchDomain>"+e.searchDomain+"</SearchDomain>":"");e.DNSManual.forEach((function(e){n+='<DNSManual><Type xmlns="http://www.onvif.org/ver10/schema">'+("IPv6"===e.type?"IPv6":"IPv4")+"</Type>"+(e.IPv4Address?'<IPv4Address xmlns="http://www.onvif.org/ver10/schema">'+e.IPv4Address+"</IPv4Address>":"")+(e.IPv6Address?'<IPv6Address xmlns="http://www.onvif.org/ver10/schema">'+e.IPv6Address+"</IPv6Address>":"")+"</DNSManual>"})),n+="</SetDNS>"+this._envelopeFooter(),this._request({service:"device",body:n},function(e,n,i){if(t){if(e)return t.call(this,e,null,i);this.getDNS(t)}}.bind(this))},e.prototype.getNetworkProtocols=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetNetworkProtocols xmlns="http://www.onvif.org/ver10/device/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.networkProtocols=t(i).getNetworkProtocolsResponse),e&&e.call(this,n,this.networkProtocols,o)}.bind(this))},e.prototype.getUsers=function(e){this._request({service:"device",body:this._envelopeHeader()+'<GetUsers xmlns="http://www.onvif.org/ver10/device/wsdl" />'+this._envelopeFooter()},function(n,i,o){if(e){if(!n){var r=i[0].getUsersResponse[0].user;r=r.map((function(e){return t(e)})),this.users=r,i=r}e.call(this,n,i,o)}}.bind(this))},e.prototype.createUsers=function(e,t){if(e.every((function(e){return!!(e.username&&e.password&&e.userLevel)}))){var n="";e.forEach((function(e){n+='<User><Username xmlns="http://www.onvif.org/ver10/schema">'+e.username+'</Username><Password xmlns="http://www.onvif.org/ver10/schema">'+e.password+'</Password><UserLevel xmlns="http://www.onvif.org/ver10/schema">'+e.userLevel+"</UserLevel></User>"}));var i=this._envelopeHeader()+'<CreateUsers xmlns="http://www.onvif.org/ver10/device/wsdl">'+n+"</CreateUsers>"+this._envelopeFooter();this._request({service:"device",body:i},function(e,n,i){t&&(e?t.call(this,e,n,i):this.getUsers(t))}.bind(this))}else t.call(this,new Error("Missing username, password or user level"),null,null)},e.prototype.setUsers=function(e,t){if(e.every((function(e){return!!(e.username&&e.password&&e.userLevel)}))){var n="";e.forEach((function(e){n+='<User><Username xmlns="http://www.onvif.org/ver10/schema">'+e.username+'</Username><Password xmlns="http://www.onvif.org/ver10/schema">'+e.password+'</Password><UserLevel xmlns="http://www.onvif.org/ver10/schema">'+e.userLevel+"</UserLevel></User>"}));var i=this._envelopeHeader()+'<SetUser xmlns="http://www.onvif.org/ver10/device/wsdl">'+n+"</SetUser>"+this._envelopeFooter();this._request({service:"device",body:i},function(n,i,o){if(t)if(n)t.call(this,n,i,o);else{var r=!1;e.some((function(e){if(e.username===this.username)return r=!0,this.password=e.password,!0})),r?setTimeout(function(){this.getUsers(t)}.bind(this),2e3):this.getUsers(t)}}.bind(this))}else t.call(this,new Error("Missing username, password or user level"),null,null)},e.prototype.deleteUsers=function(e,t){var n=[];if(e.forEach((function(e){"string"==typeof e&&e.length>0?n.push(e):"object"==typeof e&&e.username&&n.push(e.username)})),!n.length)return t.call(this,new Error("No username"),null,null);var i="";n.forEach((function(e){i+="<Username>"+e+"</Username>"}));var o=this._envelopeHeader()+'<DeleteUsers xmlns="http://www.onvif.org/ver10/device/wsdl">'+i+"</DeleteUsers>"+this._envelopeFooter();this._request({service:"device",body:o},function(e,n,i){t&&(e?t.call(this,e,n,i):this.getUsers(t))}.bind(this))},e.prototype.sendAuxiliaryCommand=function(e,t){let n=this._envelopeHeader()+'<SendAuxiliaryCommand xmlns="http://www.onvif.org/ver10/device/wsdl"><AuxiliaryCommand xmlns="http://www.onvif.org/ver10/schema">'+e.data+"</AuxiliaryCommand></SendAuxiliaryCommand>"+this._envelopeFooter();this._request({service:"device",body:n},function(e,n,i){t&&t.call(this,e,n,i)}.bind(this))}}},5079:(e,t,n)=>{const i=n(4070).Cam,o=n(4434),r=n(4840).guid,s=n(4840).linerase,a=n(4840).parseSOAPString,c=n(7016),l=n(857);var u=Object.create(new o.EventEmitter);u.probe=function(e,t){void 0===t&&("function"==typeof e?(t=e,e={}):e=e||{}),t=t||function(){};var o={},d=[],g="urn:uuid:"+(e.messageId||r()),p=Buffer.from('<Envelope xmlns="http://www.w3.org/2003/05/soap-envelope" xmlns:dn="http://www.onvif.org/ver10/network/wsdl"><Header><wsa:MessageID xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">'+g+'</wsa:MessageID><wsa:To xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">urn:schemas-xmlsoap-org:ws:2005:04:discovery</wsa:To><wsa:Action xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing">http://schemas.xmlsoap.org/ws/2005/04/discovery/Probe</wsa:Action></Header><Body><Probe xmlns="http://schemas.xmlsoap.org/ws/2005/04/discovery" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><Types>dn:NetworkVideoTransmitter</Types><Scopes /></Probe></Body></Envelope>'),h=n(7194).createSocket("udp4");h.on("error",(function(e){u.emit("error",e),t(e)}));const m=function(t,n){a(t.toString(),(function(t,r,a,l){if(t||!r[0].probeMatches)d.push(t||new Error("Wrong SOAP message from "+n.address+":"+n.port,a)),u.emit("error","Wrong SOAP message from "+n.address+":"+n.port,a);else{var g=(r=s(r)).probeMatches.probeMatch.endpointReference.address;if(!o[g]){var p;if(!1!==e.resolve){var h=r.probeMatches.probeMatch.XAddrs.split(" ").map(c.parse),m=(I=h,b=n.address,I.filter((function(e){return e.hostname===b}))[0]||I[0]);(p=new i({hostname:m.hostname,port:m.port,path:m.path,urn:g})).xaddrs=h}else p=r;o[g]=p,u.emit("device",p,n,a)}}var I,b}),200)};if(e.device){var I=l.networkInterfaces();e.device in I&&I[e.device].some((function(t){if("IPv4"===t.family)return h.bind(e.listeningPort||null,t.address),!0}))}h.on("message",m),h.send(p,0,p.length,3702,"239.255.255.250"),setTimeout(function(){h.removeListener("message",m),h.close(),t(d.length?d:null,Object.keys(o).map((function(e){return o[e]})))}.bind(this),e.timeout||5e3)},e.exports={Discovery:u}},1504:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;function i(e){return new Date(Date.now()-e.currentTime.getTime()+e.terminationTime.getTime())}e.prototype.getEventProperties=function(e){this._request({service:"events",body:this._envelopeHeader()+'<GetEventProperties xmlns="http://www.onvif.org/ver10/events/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.events.properties=t(i).getEventPropertiesResponse),e.call(this,n,n?null:this.events.properties,o)}.bind(this))},e.prototype.getEventServiceCapabilities=function(e){this._request({service:"events",body:this._envelopeHeader()+'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/events/wsdl"/>'+this._envelopeFooter()},function(n,i,o){if(!n)var r=t(i[0].getServiceCapabilitiesResponse[0].capabilities[0].$);e.call(this,n,r,o)}.bind(this))},e.prototype.subscribe=function(e,n){let o=this._envelopeHeader(!0);o+="<a:ReplyTo><a:Address>"+e.url+"</a:Address></a:ReplyTo>",o+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><Subscribe xmlns="http://docs.oasis-open.org/wsn/b-2"><ConsumerReference><a:Address>'+e.url+"</a:Address></ConsumerReference><InitialTerminationTime>PT2M</InitialTerminationTime></Subscribe>"+this._envelopeFooter(),this._request({service:"events",body:o},function(e,o,r){e||(this.events.subscription=t(o[0].subscribeResponse[0]),this.events.subscription.subscriptionReference.address=this._parseUrl(this.events.subscription.subscriptionReference.address),this.events.terminationTime=i(this.events.subscription)),n.call(this,e,e?null:this.events.subscription,r)}.bind(this))},e.prototype.createPullPointSubscription=function(e){this._request({service:"events",body:this._envelopeHeader()+'<CreatePullPointSubscription xmlns="http://www.onvif.org/ver10/events/wsdl"><InitialTerminationTime>PT2M</InitialTerminationTime></CreatePullPointSubscription>'+this._envelopeFooter()},function(n,o,r){n||(this.events.subscription=t(o[0].createPullPointSubscriptionResponse[0]),this.events.subscription.subscriptionReference.address=this._parseUrl(this.events.subscription.subscriptionReference.address),this.events.terminationTime=i(this.events.subscription)),e.call(this,n,n?null:this.events.subscription,r)}.bind(this))},e.prototype.renew=function(e,n){let i=null,o=null;try{i=this.events.subscription.subscriptionReference.address}catch(e){throw new Error("You should create pull-point subscription first!")}try{o=this.events.subscription.subscriptionReference.referenceParameters.subscriptionId}catch(e){o=null}let r=this._envelopeHeader(!0);r+=o?'<a:To mustUnderstand="1">'+i.href+'</a:To><SubscriptionId xmlns="http://www.axis.com/2009/event" a:IsReferenceParameter="true">'+this.events.subscription.subscriptionReference.referenceParameters.subscriptionId+"</SubscriptionId>":"<a:To>"+i.href+"</a:To>",r+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><Renew xmlns="http://docs.oasis-open.org/wsn/b-2"><TerminationTime>PT2M</TerminationTime></Renew>'+this._envelopeFooter(),this._request({url:i,body:r},function(e,i,o){if(!e)var r=t(i).renewResponse;n.call(this,e,r,o)}.bind(this))},e.prototype.pullMessages=function(e,n){let i=null,o=null;try{i=this.events.subscription.subscriptionReference.address}catch(e){throw new Error("You should create pull-point subscription first!")}try{o=this.events.subscription.subscriptionReference.referenceParameters.subscriptionId}catch(e){o=null}let r=this._envelopeHeader(!0);r+=o?'<a:To mustUnderstand="1">'+i.href+'</a:To><SubscriptionId xmlns="http://www.axis.com/2009/event" a:IsReferenceParameter="true">'+o+"</SubscriptionId>":"<a:To>"+i.href+"</a:To>",r+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><PullMessages xmlns="http://www.onvif.org/ver10/events/wsdl"><Timeout>PT1M</Timeout><MessageLimit>'+(e.messageLimit||10)+"</MessageLimit></PullMessages>"+this._envelopeFooter(),this._request({url:i,body:r,replyTimeout:8e4},function(e,i,o){if(!e)var r=t(i).pullMessagesResponse;n.call(this,e,r,o)}.bind(this))},e.prototype.unsubscribe=function(e){let n=null,i=null;try{n=this.events.subscription.subscriptionReference.address}catch(e){throw new Error("You should create pull-point subscription first!")}try{i=this.events.subscription.subscriptionReference.referenceParameters.subscriptionId}catch(e){i=null}delete this.events.subscription,delete this.events.terminationTime;let o=this._envelopeHeader(!0);o+=i?'<a:To mustUnderstand="1">'+n.href+'</a:To><SubscriptionId xmlns="http://www.axis.com/2009/event" a:IsReferenceParameter="true">'+i+"</SubscriptionId>":"<a:To>"+n.href+"</a:To>",o+='</s:Header><s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><Unsubscribe xmlns="http://docs.oasis-open.org/wsn/b-2"/>'+this._envelopeFooter(),this._request({url:n,body:o},function(n,i,o){if(!n){this.removeAllListeners("event");var r=t(i).unsubscribeResponse}e&&e.call(this,n,r,o)}.bind(this))},e.prototype._eventRequest=function(){this.listeners("event").length?(this.events.messageLimit=this.events.messageLimit||10,!this.events.subscription||!this.events.terminationTime||Date.now()>this.events.terminationTime?this.createPullPointSubscription(function(e){e||this._eventPull()}.bind(this)):this._eventPull()):(delete this.events.terminationTime,this.unsubscribe())},e.prototype._eventPull=function(){this.listeners("event").length&&this.events.subscription?this.pullMessages({messageLimit:this.events.messageLimit},function(e,t,n){e?this.unsubscribe({},(function(e,t,n){this._eventRequest()})):(t.notificationMessage&&(Array.isArray(t.notificationMessage)||(t.notificationMessage=[t.notificationMessage]),t.notificationMessage.forEach(function(e){this.emit("event",e,n)}.bind(this))),this.events.terminationTime=i(t),this.renew({},(function(e,t){e||(this.events.terminationTime=i(t)),this._eventRequest()})))}.bind(this)):(delete this.events.terminationTime,this.events.subscription&&this.unsubscribe())}}},8235:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;e.prototype.getImagingSettings=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"imaging",body:this._envelopeHeader()+'<GetImagingSettings xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken  xmlns="http://www.onvif.org/ver20/imaging/wsdl" >'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></GetImagingSettings>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getImagingSettingsResponse.imagingSettings,o)}.bind(this))},e.prototype.setImagingSettings=function(e,n){this._request({service:"imaging",body:this._envelopeHeader()+'<SetImagingSettings xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken  xmlns="http://www.onvif.org/ver20/imaging/wsdl" >'+(e.token||this.activeSource.sourceToken)+'</VideoSourceToken><ImagingSettings xmlns="http://www.onvif.org/ver20/imaging/wsdl" >'+(e.brightness?'<Brightness xmlns="http://www.onvif.org/ver10/schema">'+e.brightness+"</Brightness>":"")+(e.colorSaturation?'<ColorSaturation xmlns="http://www.onvif.org/ver10/schema">'+e.colorSaturation+"</ColorSaturation>":"")+(e.contrast?'<Contrast xmlns="http://www.onvif.org/ver10/schema">'+e.contrast+"</Contrast>":"")+(e.exposure?'<Exposure  xmlns="http://www.onvif.org/ver10/schema">'+(e.exposure.mode?'<Mode xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.mode+"</Mode>":"")+(e.exposure.priority?'<Priority xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.priority+"</Priority>":"")+(e.exposure.minExposureTime?'<MinExposureTime xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.minExposureTime+"</MinExposureTime>":"")+(e.exposure.maxExposureTime?'<MaxExposureTime xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.maxExposureTime+"</MaxExposureTime>":"")+(e.exposure.minGain?'<MinGain xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.minGain+"</MinGain>":"")+(e.exposure.maxGain?'<MaxGain xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.maxGain+"</MaxGain>":"")+(e.exposure.minIris?'<MinIris xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.minIris+"</MinIris>":"")+(e.exposure.maxIris?'<MaxIris xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.maxIris+"</MaxIris>":"")+(e.exposure.exposureTime?'<ExposureTime xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.exposureTime+"</ExposureTime>":"")+(e.exposure.gain?'<Gain xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.gain+"</Gain>":"")+(e.exposure.iris?'<Iris xmlns="http://www.onvif.org/ver10/schema">'+e.exposure.iris+"</Iris>":"")+"</Exposure>":"")+(e.focus?'<Focus xmlns="http://www.onvif.org/ver10/schema">'+(e.focus.autoFocusMode?'<AutoFocusMode xmlns="http://www.onvif.org/ver10/schema">'+e.focus.autoFocusMode+"</AutoFocusMode>":"")+(e.focus.defaultSpeed?'<DefaultSpeed xmlns="http://www.onvif.org/ver10/schema">'+e.focus.defaultSpeed+"</DefaultSpeed>":"")+(e.focus.nearLimit?'<NearLimit xmlns="http://www.onvif.org/ver10/schema">'+e.focus.nearLimit+"</NearLimit>":"")+(e.focus.farLimit?'<FarLimit xmlns="http://www.onvif.org/ver10/schema">'+e.focus.farLimit+"</FarLimit>":"")+"</Focus>":"")+(e.sharpness?'<Sharpness xmlns="http://www.onvif.org/ver10/schema">'+e.sharpness+"</Sharpness>":"")+"</ImagingSettings></SetImagingSettings>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).setImagingSettingsResponse,o)}.bind(this))},e.prototype.getImagingServiceCapabilities=function(e){this._request({service:"imaging",body:this._envelopeHeader()+'<GetServiceCapabilities xmlns="http://www.onvif.org/ver20/imaging/wsdl" ></GetServiceCapabilities>'+this._envelopeFooter()},function(n,i,o){e&&e.call(this,n,n?null:t(i[0].getServiceCapabilitiesResponse[0].capabilities[0].$),o)}.bind(this))},e.prototype.getCurrentImagingPreset=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"imaging",body:this._envelopeHeader()+'<GetCurrentPreset xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken>'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></GetCurrentPreset>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getCurrentPresetResponse.preset,o)}.bind(this))},e.prototype.setCurrentImagingPreset=function(e,n){this._request({service:"imaging",body:this._envelopeHeader()+'<SetCurrentPreset xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken>'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken><PresetToken>"+e.presetToken+"</PresetToken></SetCurrentPreset>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).setCurrentPresetResponse,o)}.bind(this))},e.prototype.getVideoSourceOptions=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"imaging",body:this._envelopeHeader()+'<GetOptions xmlns="http://www.onvif.org/ver20/imaging/wsdl"><VideoSourceToken>'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></GetOptions>"+this._envelopeFooter()},function(e,i,o){if(n){let r=t(i),s={};r&&r.getOptionsResponse&&r.getOptionsResponse.imagingOptions&&(s=r.getOptionsResponse.imagingOptions),n.call(this,e,s,o)}}.bind(this))},e.prototype.imagingGetMoveOptions=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"imaging",body:this._envelopeHeader()+'<GetMoveOptions xmlns="http://www.onvif.org/ver20/imaging/wsdl"><VideoSourceToken>'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></GetMoveOptions>"+this._envelopeFooter()},function(e,i,o){if(n){let r=t(i),s={};r&&r.getMoveOptionsResponse&&r.getMoveOptionsResponse.moveOptions&&(s=r.getMoveOptionsResponse.moveOptions),n.call(this,e,s,o)}}.bind(this))},e.prototype.imagingGetStatus=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"imaging",body:this._envelopeHeader()+'<GetStatus xmlns="http://www.onvif.org/ver20/imaging/wsdl"><VideoSourceToken>'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></GetStatus>"+this._envelopeFooter()},function(e,i,o){if(n){let r=t(i),s={};r&&r.getStatusResponse&&r.getStatusResponse.status&&(s=r.getStatusResponse.status),n.call(this,e,s,o)}}.bind(this))},e.prototype.imagingMove=function(e,n){this._request({service:"imaging",body:this._envelopeHeader()+'<Move xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken  xmlns="http://www.onvif.org/ver20/imaging/wsdl" >'+(e.token||this.activeSource.sourceToken)+'</VideoSourceToken><Focus xmlns="http://www.onvif.org/ver20/imaging/wsdl">'+(e.absolute?'<Absolute xmlns="http://www.onvif.org/ver10/schema">'+(e.absolute.position?'<Position xmlns="http://www.onvif.org/ver10/schema">'+e.absolute.position+"</Position>":"")+(e.absolute.speed?'<Speed xmlns="http://www.onvif.org/ver10/schema">'+e.absolute.speed+"</Speed>":"")+"</Absolute>":"")+(e.relative?'<Relative xmlns="http://www.onvif.org/ver10/schema">'+(e.relative.distance?'<Distance xmlns="http://www.onvif.org/ver10/schema">'+e.relative.distance+"</Distance>":"")+(e.relative.speed?'<Speed xmlns="http://www.onvif.org/ver10/schema">'+e.relative.speed+"</Speed>":"")+"</Relative>":"")+(e.continuous?'<Continuous xmlns="http://www.onvif.org/ver10/schema">'+(e.continuous.speed?'<Speed xmlns="http://www.onvif.org/ver10/schema">'+e.continuous.speed+"</Speed>":"")+"</Continuous>":"")+"</Focus></Move>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).MoveResponse,o)}.bind(this))},e.prototype.imagingStop=function(e,n){this._request({service:"imaging",body:this._envelopeHeader()+'<Stop xmlns="http://www.onvif.org/ver20/imaging/wsdl" ><VideoSourceToken  xmlns="http://www.onvif.org/ver20/imaging/wsdl" >'+(e.token||this.activeSource.sourceToken)+"</VideoSourceToken></Stop>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).StopResponse,o)}.bind(this))}}},9153:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;e.prototype.getVideoSources=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetVideoSources xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.videoSources=t(i).getVideoSourcesResponse.videoSources,Array.isArray(this.videoSources)||(this.videoSources=[this.videoSources])),e&&e.call(this,n,this.videoSources,o)}.bind(this))},e.prototype.getVideoSourceConfigurations=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetVideoSourceConfigurations xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.videoSourceConfigurations=i[0].getVideoSourceConfigurationsResponse[0].configurations.map((function(e){var n=t(e);return{token:n.$.token,name:n.name,useCount:n.useCount,sourceToken:n.sourceToken,bounds:{height:n.bounds.$.height,width:n.bounds.$.width,x:n.bounds.$.x,y:n.bounds.$.y}}}))),e&&e.call(this,n,this.videoSourceConfigurations,o)}.bind(this))},e.prototype.getVideoEncoderConfiguration=function(e,n){if(void 0===n){if(n=e,!this.videoEncoderConfigurations||!this.videoEncoderConfigurations[0])return n(new Error("No video encoder configuration token is present!"));e=this.videoEncoderConfigurations[0].$.token}this._request({service:"media",body:this._envelopeHeader()+'<GetVideoEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ConfigurationToken>'+e+"</ConfigurationToken></GetVideoEncoderConfiguration>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i[0].getVideoEncoderConfigurationResponse[0].configuration),o)}.bind(this))},e.prototype.getVideoEncoderConfigurationOptions=function(e,n){if(void 0===n){if(n=e,!this.videoEncoderConfigurations||!this.videoEncoderConfigurations[0])return n(new Error("No video encoder configuration token is present!"));e={configurationToken:this.videoEncoderConfigurations[0].$.token}}else if("string"==typeof e)e={configurationToken:e};else if(!e||!e.configurationToken&&!e.profileToken)return n(new Error("'options' must have one or both 'configurationToken' or 'profileToken'"));this._request({service:"media",body:this._envelopeHeader()+(e?'<GetVideoEncoderConfigurationOptions xmlns="http://www.onvif.org/ver10/media/wsdl">'+(e.configurationToken?"<ConfigurationToken>"+e.configurationToken+"</ConfigurationToken>":"")+(e.profileToken?"<ProfileToken>"+e.profileToken+"</ProfileToken>":"")+"</GetVideoEncoderConfigurationOptions>":'<GetVideoEncoderConfigurationOptions xmlns="http://www.onvif.org/ver10/media/wsdl" />')+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i[0].getVideoEncoderConfigurationOptionsResponse[0].options),o)}.bind(this))},e.prototype.getVideoEncoderConfigurations=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetVideoEncoderConfigurations xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.videoEncoderConfigurations=i[0].getVideoEncoderConfigurationsResponse[0].configurations.map((function(e){return t(e)}))),e&&e.call(this,n,this.videoEncoderConfigurations,o)}.bind(this))},e.prototype.setVideoEncoderConfiguration=function(e,n){if(!(e.token||e.$&&e.$.token))return n(new Error("No video encoder configuration token is present!"));this._request({service:"media",body:this._envelopeHeader()+'<SetVideoEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><Configuration token = "'+(e.token||e.$.token)+'">'+(e.name?'<Name xmlns="http://www.onvif.org/ver10/schema">'+e.name+"</Name>":"")+(e.useCount?'<UseCount xmlns="http://www.onvif.org/ver10/schema">'+e.useCount+"</UseCount>":"")+(e.encoding?'<Encoding xmlns="http://www.onvif.org/ver10/schema">'+e.encoding+"</Encoding>":"")+(e.resolution?'<Resolution xmlns="http://www.onvif.org/ver10/schema">'+(e.resolution.width?"<Width>"+e.resolution.width+"</Width>":"")+(e.resolution.height?"<Height>"+e.resolution.height+"</Height>":"")+"</Resolution>":"")+(e.quality?'<Quality xmlns="http://www.onvif.org/ver10/schema">'+e.quality+"</Quality>":"")+(e.rateControl?'<RateControl xmlns="http://www.onvif.org/ver10/schema">'+(e.rateControl.frameRateLimit?"<FrameRateLimit>"+e.rateControl.frameRateLimit+"</FrameRateLimit>":"")+(e.rateControl.encodingInterval?"<EncodingInterval>"+e.rateControl.encodingInterval+"</EncodingInterval>":"")+(e.rateControl.bitrateLimit?"<BitrateLimit>"+e.rateControl.bitrateLimit+"</BitrateLimit>":"")+"</RateControl>":"")+(e.MPEG4?'<MPEG4 xmlns="http://www.onvif.org/ver10/schema">'+(e.MPEG4.govLength?"<GovLength>"+e.MPEG4.govLength+"</GovLength>":"")+(e.MPEG4.profile?"<MPEG4Profile>"+e.MPEG4.profile+"</MPEG4Profile>":"")+"</MPEG4>":"")+(e.H264?'<H264 xmlns="http://www.onvif.org/ver10/schema">'+(e.H264.govLength?"<GovLength>"+e.H264.govLength+"</GovLength>":"")+(e.H264.profile?"<H264Profile>"+e.H264.profile+"</H264Profile>":"")+"</H264>":"")+(e.multicast?'<Multicast xmlns="http://www.onvif.org/ver10/schema">'+(e.multicast.address?"<Address>"+(0===e.multicast.address?"0":(e.multicast.address.type?"<Type>"+e.multicast.address.type+"</Type>":"")+(e.multicast.address.IPv4Address?"<IPv4Address>"+e.multicast.address.IPv4Address+"</IPv4Address>":"")+(e.multicast.address.IPv6Address?"<IPv6Address>"+e.multicast.address.IPv6Address+"</IPv6Address>":""))+"</Address>":"")+(void 0!==e.multicast.port?"<Port>"+e.multicast.port+"</Port>":"")+(void 0!==e.multicast.TTL?"<TTL>"+e.multicast.TTL+"</TTL>":"")+(void 0!==e.multicast.autoStart?"<AutoStart>"+e.multicast.autoStart+"</AutoStart>":"")+"</Multicast>":"")+(e.sessionTimeout?'<SessionTimeout xmlns="http://www.onvif.org/ver10/schema">'+e.sessionTimeout+"</SessionTimeout>":"")+"</Configuration><ForcePersistence>true</ForcePersistence></SetVideoEncoderConfiguration>"+this._envelopeFooter()},function(i,o,r){if(i||""!==t(o).setVideoEncoderConfigurationResponse)return n.call(this,""!==t(o).setVideoEncoderConfigurationResponse?new Error("Wrong `SetVideoEncoderConfiguration` response"):i,o,r);this.getVideoEncoderConfiguration(e.token||e.$.token,n)}.bind(this))},e.prototype.getAudioSources=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetAudioSources xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.audioSources=i[0].getAudioSourcesResponse[0].audioSources.map((function(e){return t(e)}))),e&&e.call(this,n,this.audioSources,o)}.bind(this))},e.prototype.getAudioEncoderConfigurations=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetAudioEncoderConfigurations xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.audioEncoderConfigurations=i[0].getAudioEncoderConfigurationsResponse[0].configurations.map((function(e){return t(e)}))),e&&e.call(this,n,this.audioEncoderConfigurations,o)}.bind(this))},e.prototype.getAudioEncoderConfiguration=function(e,n){if(void 0===n){if(n=e,!this.audioEncoderConfigurations||!this.audioEncoderConfigurations[0])return n(new Error("No audio encoder configuration token is present!"));e=this.audioEncoderConfigurations[0].$.token}this._request({service:"media",body:this._envelopeHeader()+'<GetAudioEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ConfigurationToken>'+e+"</ConfigurationToken></GetAudioEncoderConfiguration>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i[0].getAudioEncoderConfigurationResponse[0].configuration),o)}.bind(this))},e.prototype.getAudioEncoderConfigurationOptions=function(e,n){if(void 0===n){if(n=e,!this.audioEncoderConfigurations||!this.audioEncoderConfigurations[0])return n(new Error("No audio encoder configuration token is present!"));e=this.audioEncoderConfigurations[0].$.token}this._request({service:"media",body:this._envelopeHeader()+'<GetAudioEncoderConfigurationOptions xmlns="http://www.onvif.org/ver10/media/wsdl"><ConfigurationToken>'+e+"</ConfigurationToken></GetAudioEncoderConfigurationOptions>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i[0].getAudioEncoderConfigurationOptionsResponse[0].options),o)}.bind(this))},e.prototype.setAudioEncoderConfiguration=function(e,n){if(!(e.token||e.$&&e.$.token))return n(new Error("No audio encoder configuration token is present!"));this._request({service:"media",body:this._envelopeHeader()+'<SetAudioEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><Configuration token = "'+(e.token||e.$.token)+'">'+(e.name?'<Name xmlns="http://www.onvif.org/ver10/schema">'+e.name+"</Name>":"")+(e.useCount?'<UseCount xmlns="http://www.onvif.org/ver10/schema">'+e.useCount+"</UseCount>":"")+(e.encoding?'<Encoding xmlns="http://www.onvif.org/ver10/schema">'+e.encoding+"</Encoding>":"")+(e.bitrate?'<Bitrate xmlns="http://www.onvif.org/ver10/schema">'+e.bitrate+"</Bitrate>":"")+(e.sampleRate?'<SampleRate xmlns="http://www.onvif.org/ver10/schema">'+e.sampleRate+"</SampleRate>":"")+(e.multicast?'<Multicast xmlns="http://www.onvif.org/ver10/schema">'+(e.multicast.address?"<Address>"+(0===e.multicast.address?"0":(e.multicast.address.type?"<Type>"+e.multicast.address.type+"</Type>":"")+(e.multicast.address.IPv4Address?"<IPv4Address>"+e.multicast.address.IPv4Address+"</IPv4Address>":"")+(e.multicast.address.IPv6Address?"<IPv6Address>"+e.multicast.address.IPv6Address+"</IPv6Address>":""))+"</Address>":"")+(void 0!==e.multicast.port?"<Port>"+e.multicast.port+"</Port>":"")+(void 0!==e.multicast.TTL?"<TTL>"+e.multicast.TTL+"</TTL>":"")+(void 0!==e.multicast.autoStart?"<AutoStart>"+e.multicast.autoStart+"</AutoStart>":"")+"</Multicast>":"")+(e.sessionTimeout?'<SessionTimeout xmlns="http://www.onvif.org/ver10/schema">'+e.sessionTimeout+"</SessionTimeout>":"")+"</Configuration><ForcePersistence>true</ForcePersistence></SetAudioEncoderConfiguration>"+this._envelopeFooter()},function(i,o,r){if(i||""!==t(o).setAudioEncoderConfigurationResponse)return n.call(this,""!==t(o).setAudioEncoderConfigurationResponse?new Error("Wrong `SetAudioEncoderConfiguration` response"):i,o,r);this.getAudioEncoderConfiguration(e.token||e.$.token,n)}.bind(this))},e.prototype.getAudioSourceConfigurations=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetAudioSourceConfigurations xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.audioSourceConfigurations=i[0].getAudioSourceConfigurationsResponse[0].configurations.map((function(e){return t(e)}))),e&&e.call(this,n,this.audioSourceConfigurations,o)}.bind(this))},e.prototype.getAudioOutputs=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetAudioOutputs xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.audioOutputs=i[0].getAudioOutputsResponse[0].audioOutputs.map((function(e){return t(e)}))),e&&e.call(this,n,this.audioOutputs,o)}.bind(this))},e.prototype.getAudioOutputConfigurations=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetAudioOutputConfigurations xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.audioOutputConfigurations=i[0].getAudioOutputConfigurationsResponse[0].configurations.map((function(e){return t(e)}))),e&&e.call(this,n,this.audioOutputConfigurations,o)}.bind(this))},e.prototype.addAudioEncoderConfiguration=function(e,t){let n=this._envelopeHeader()+'<AddAudioEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e.profileToken+"</ProfileToken><ConfigurationToken>"+e.configurationToken+"</ConfigurationToken></AddAudioEncoderConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.addAudioSourceConfiguration=function(e,t){let n=this._envelopeHeader()+'<AddAudioSourceConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e.profileToken+"</ProfileToken><ConfigurationToken>"+e.configurationToken+"</ConfigurationToken></AddAudioSourceConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.addVideoEncoderConfiguration=function(e,t){let n=this._envelopeHeader()+'<AddVideoEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e.profileToken+"</ProfileToken><ConfigurationToken>"+e.configurationToken+"</ConfigurationToken></AddVideoEncoderConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.addVideoSourceConfiguration=function(e,t){let n=this._envelopeHeader()+'<AddVideoSourceConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e.profileToken+"</ProfileToken><ConfigurationToken>"+e.configurationToken+"</ConfigurationToken></AddVideoSourceConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.removeAudioEncoderConfiguration=function(e,t){let n=this._envelopeHeader()+'<RemoveAudioEncoderConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e+"</ProfileToken></RemoveAudioEncoderConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.removeAudioSourceConfiguration=function(e,t){let n=this._envelopeHeader()+'<RemoveAudioSourceConfiguration xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e+"</ProfileToken></RemoveAudioSourceConfiguration>"+this._envelopeFooter();this._request({service:"media",body:n},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.getProfiles=function(e){this.media2Support?this._request({service:"media2",body:this._envelopeHeader()+'<GetProfiles xmlns="http://www.onvif.org/ver20/media/wsdl"><Type>All</Type></GetProfiles>'+this._envelopeFooter()},function(n,i,o){n||(this.profiles=i[0].getProfilesResponse[0].profiles.map((function(e){let n=t(e),i={};return i.$=n.$,i.name=n.name,n.configurations.videoSource&&(i.videoSourceConfiguration=n.configurations.videoSource),n.configurations.audioSource&&(i.audioSourceConfiguration=n.configurations.audioSource),n.configurations.videoEncoder&&(i.videoEncoderConfiguration=n.configurations.videoEncoder),n.configurations.audioEncoder&&(i.audioEncoderConfiguration=n.configurations.audioEncoder),n.configurations.PTZ&&(i.PTZConfiguration=n.configurations.PTZ),n.configurations.analytics&&(i.analyticsConfiguration=n.configurations.analytics),n.configurations.metadata&&(i.metadataConfiguration=n.configurations.metadata),n.configurations.audioOutput&&(i.audioOutputConfiguration=n.configurations.audioOutput),n.configurations.audioOutput&&(i.audioDecoderConfiguration=n.configurations.audioDecoder),i}))),e&&e.call(this,n,this.profiles,o)}.bind(this)):this._request({service:"media",body:this._envelopeHeader()+'<GetProfiles xmlns="http://www.onvif.org/ver10/media/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.profiles=i[0].getProfilesResponse[0].profiles.map((function(e){return t(e)}))),e&&e.call(this,n,this.profiles,o)}.bind(this))},e.prototype.createProfile=function(e,n){this._request({service:"media",body:this._envelopeHeader()+'<CreateProfile xmlns="http://www.onvif.org/ver10/media/wsdl"><Name>'+e.name+"</Name>"+(e.token?"<Token>"+e.token+"</Token>":"")+"</CreateProfile>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).createProfileResponse.profile,o)}.bind(this))},e.prototype.deleteProfile=function(e,n){this._request({service:"media",body:this._envelopeHeader()+'<DeleteProfile xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+e+"</ProfileToken></DeleteProfile>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).deleteProfileResponse,o)}.bind(this))},e.prototype.getStreamUri=function(e,n){if(void 0===n&&(n=e,e={}),this.media2Support){let i=e.protocol||"RTSP",o=e.stream||"RTP-Unicast";"HTTP"==i&&(i="RtspOverHttp"),"UDP"==i&&"RTP-Unicast"==o&&(i="RtspUnicast"),"UDP"==i&&"RTP-Multicast"==o&&(i="RtspMulticast"),this._request({service:"media2",body:this._envelopeHeader()+'<GetStreamUri xmlns="http://www.onvif.org/ver20/media/wsdl"><Protocol>'+i+"</Protocol><ProfileToken>"+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetStreamUri>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getStreamUriResponse,o)}.bind(this))}else this._request({service:"media",body:this._envelopeHeader()+'<GetStreamUri xmlns="http://www.onvif.org/ver10/media/wsdl"><StreamSetup><Stream xmlns="http://www.onvif.org/ver10/schema">'+(e.stream||"RTP-Unicast")+'</Stream><Transport xmlns="http://www.onvif.org/ver10/schema"><Protocol>'+(e.protocol||"RTSP")+"</Protocol></Transport></StreamSetup><ProfileToken>"+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetStreamUri>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getStreamUriResponse.mediaUri,o)}.bind(this))},e.prototype.getSnapshotUri=function(e,n){void 0===n&&(n=e,e={}),this.media2Support?this._request({service:"media2",body:this._envelopeHeader()+'<GetSnapshotUri xmlns="http://www.onvif.org/ver20/media/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetSnapshotUri>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:{uri:t(i).getSnapshotUriResponse.uri},o)}.bind(this)):this._request({service:"media",body:this._envelopeHeader()+'<GetSnapshotUri xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetSnapshotUri>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getSnapshotUriResponse.mediaUri,o)}.bind(this))},e.prototype.setSynchronizationPoint=function(e,t){void 0===t&&(t=e,e={}),this.media2Support?this._request({service:"media2",body:this._envelopeHeader()+'<SetSynchronizationPoint xmlns="http://www.onvif.org/ver20/media/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></SetSynchronizationPoint>"+this._envelopeFooter()},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this)):this._request({service:"media",body:this._envelopeHeader()+'<SetSynchronizationPoint xmlns="http://www.onvif.org/ver10/media/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></SetSynchronizationPoint>"+this._envelopeFooter()},function(e,n,i){t&&t.call(this,e,null,i)}.bind(this))},e.prototype.getOSDs=function(e,n){void 0===n&&(n=e,e="");let i=this.media2Support?"media2":"media",o=this.media2Support?"http://www.onvif.org/ver20/media/wsdl":"http://www.onvif.org/ver10/media/wsdl";this._request({service:i,body:this._envelopeHeader()+'<GetOSDs xmlns="'+o+'" >'+(e?"<ConfigurationToken>"+e+"</ConfigurationToken>":"")+"</GetOSDs>"+this._envelopeFooter()},function(e,i,o){let r={};e||(r=t(i),Array.isArray(r.getOSDsResponse.OSDs)||(r.getOSDsResponse.OSDs=[r.getOSDsResponse.OSDs])),n&&n.call(this,e,e?null:r,o)}.bind(this))},e.prototype.getOSDOptions=function(e,n){void 0===n&&(n=e,e={});let i=this.media2Support?"media2":"media",o=this.media2Support?"http://www.onvif.org/ver20/media/wsdl":"http://www.onvif.org/ver10/media/wsdl";this._request({service:i,body:this._envelopeHeader()+'<GetOSDOptions xmlns="'+o+'" ><ConfigurationToken>'+(e.videoSourceConfiguationToken||this.activeSource.videoSourceConfigurationToken)+"</ConfigurationToken></GetOSDOptions>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i),o)}.bind(this))},e.prototype.createOSD=function(e,n){void 0===n&&(n=e,e={});let i=this.media2Support?"media2":"media",o=this.media2Support?"http://www.onvif.org/ver20/media/wsdl":"http://www.onvif.org/ver10/media/wsdl";this._request({service:i,body:this._envelopeHeader()+`<wsdl:CreateOSD xmlns:wsdl="${o}" xmlns:sch="http://www.onvif.org/ver10/schema">\n         <wsdl:OSD token="">\n            <sch:VideoSourceConfigurationToken>${e.videoSourceConfiguationToken||this.activeSource.videoSourceConfigurationToken}</sch:VideoSourceConfigurationToken>\n            <sch:Type>Text</sch:Type>\n            <sch:Position>\n               <sch:Type>${e.position||"LowerLeft"}</sch:Type>\n            </sch:Position>\n            <sch:TextString IsPersistentText="false">\n               <sch:Type>Plain</sch:Type>\n               <sch:PlainText>${e.plaintext}</sch:PlainText>\n            </sch:TextString>\n         </wsdl:OSD>\n      </wsdl:CreateOSD>`+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i),o)}.bind(this))},e.prototype.setOSD=function(e,n){let i=this.media2Support?"media2":"media",o=this.media2Support?"http://www.onvif.org/ver20/media/wsdl":"http://www.onvif.org/ver10/media/wsdl";void 0===n&&(n=e,e={}),this._request({service:i,body:this._envelopeHeader()+`<wsdl:SetOSD xmlns:wsdl="${o}" xmlns:sch="http://www.onvif.org/ver10/schema">\n\t\t\t <wsdl:OSD token="${e.OSDToken}">\n\t\t\t\t<sch:VideoSourceConfigurationToken>${e.videoSourceConfigurationToken||this.activeSource.videoSourceConfigurationToken}</sch:VideoSourceConfigurationToken>\n\t\t\t\t<sch:Type>Text</sch:Type>\n\t\t\t\t<sch:Position>\n\t\t\t\t   <sch:Type>${"object"==typeof e.position?"Custom":e.position?e.position:"LowerLeft"}</sch:Type>\n\t\t\t\t   ${"object"==typeof e.position?'<sch:Pos x="'+e.position.x+'" y="'+e.position.y+'"/>':""}\n\t\t\t\t</sch:Position>\n\t\t\t\t<sch:TextString IsPersistentText="false">\n\t\t\t\t   <sch:Type>Plain</sch:Type>\n\t\t\t\t   <sch:PlainText>${e.plaintext}</sch:PlainText>\n\t\t\t\t</sch:TextString>\n\t\t\t </wsdl:OSD>\n\t\t  </wsdl:SetOSD>`+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i),o)}.bind(this))},e.prototype.deleteOSD=function(e,n){let i=this.media2Support?"media2":"media",o=this.media2Support?"http://www.onvif.org/ver20/media/wsdl":"http://www.onvif.org/ver10/media/wsdl";this._request({service:i,body:this._envelopeHeader()+'<DeleteOSD xmlns="'+o+'"><OSDToken>'+e+"</OSDToken></DeleteOSD>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i),o)}.bind(this))},e.prototype.getMediaServiceCapabilities=function(e){this._request({service:"media",body:this._envelopeHeader()+'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/media/wsdl" />'+this._envelopeFooter()},function(n,i,o){e&&(n||(i=t(i[0].getServiceCapabilitiesResponse[0].capabilities),this.mediaCapabilities=i),e.call(this,n,i,o))}.bind(this))}}},5447:(e,t,n)=>{e.exports={Cam:n(4070).Cam,Discovery:n(5079).Discovery}},951:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase,i=n(6762);e.prototype.getPresets=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"ptz",body:this._envelopeHeader()+'<GetPresets xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetPresets>"+this._envelopeFooter()},function(e,i,o){if(!e){this.presets={};var r=t(i).getPresetsResponse.preset;void 0!==r&&(Array.isArray(r)||(r=[r]),r.forEach(function(e){this.presets[e.name]=e.$.token}.bind(this)))}n&&n.call(this,e,this.presets,o)}.bind(this))},e.prototype.gotoPreset=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<GotoPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><PresetToken>"+e.preset+"</PresetToken>"+(e.speed?"<Speed>"+this._panTiltZoomVectors(e.speed)+"</Speed>":"")+"</GotoPreset>"+this._envelopeFooter()},t.bind(this))},e.prototype.setPreset=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<SetPreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><PresetName>"+e.presetName+"</PresetName>"+(e.presetToken?"<PresetToken>"+e.presetToken+"</PresetToken>":"")+"</SetPreset>"+this._envelopeFooter()},t.bind(this))},e.prototype.removePreset=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<RemovePreset xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><PresetToken>"+e.presetToken+"</PresetToken></RemovePreset>"+this._envelopeFooter()},t.bind(this))},e.prototype.gotoHomePosition=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<GotoHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken>"+(e.speed?"<Speed>"+this._panTiltZoomVectors(e.speed)+"</Speed>":"")+"</GotoHomePosition>"+this._envelopeFooter()},t.bind(this))},e.prototype.setHomePosition=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<SetHomePosition xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></SetHomePosition>"+this._envelopeFooter()},t.bind(this))},e.prototype.getStatus=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"ptz",body:this._envelopeHeader()+'<GetStatus xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken></GetStatus>"+this._envelopeFooter()},function(e,o,r){if(!e)var s=t(o).getStatusResponse.PTZStatus,a={position:{x:i(s,"position.panTilt.$.x",0),y:i(s,"position.panTilt.$.y",0),zoom:i(s,"position.zoom.$.x",0)},moveStatus:s.moveStatus,error:s.error,utcTime:s.utcTime};n.call(this,e,e?null:a,r)}.bind(this))},e.prototype.getNodes=function(e){this._request({service:"ptz",body:this._envelopeHeader()+'<GetNodes xmlns="http://www.onvif.org/ver20/ptz/wsdl" />'+this._envelopeFooter()},function(n,i,o){if(!n){var r=this.nodes={};i[0].getNodesResponse.forEach((function(e){r[e.PTZNode[0].$.token]=t(e.PTZNode[0]),delete r[e.PTZNode[0].$.token].$}))}e.call(this,n,r,o)}.bind(this))},e.prototype.getConfigurations=function(e){this._request({service:"ptz",body:this._envelopeHeader()+'<GetConfigurations xmlns="http://www.onvif.org/ver20/ptz/wsdl"></GetConfigurations>'+this._envelopeFooter()},function(t,n,i){if(!t){var o={};n[0].getConfigurationsResponse.forEach((function(e){e.PTZConfiguration.forEach((function(e){var t=e.name;if(Array.isArray(t)&&(t=t[0]),o[t]={},o[t].useCount=parseInt(e.useCount),"$"in e&&(o[t].token=e.$.token),"nodeToken"in e&&(o[t].nodeToken=e.nodeToken[0]),"defaultPTZSpeed"in e){var n=e.defaultPTZSpeed[0];o[t].defaultPTZSpeed={},"panTilt"in n&&(o[t].defaultPTZSpeed.x=n.panTilt[0].$.x,o[t].defaultPTZSpeed.y=n.panTilt[0].$.y),"zoom"in n&&(o[t].defaultPTZSpeed.zoom=n.zoom[0].$.x)}if("defaultPTZTimeout"in e&&(o[t].defaultPTZTimeout=e.defaultPTZTimeout[0]),"panTiltLimits"in e){o[t].panTiltLimits={};var i=e.panTiltLimits[0].range[0];o[t].panTiltLimits.XRange={},o[t].panTiltLimits.XRange.min=i.XRange[0].min[0],o[t].panTiltLimits.XRange.max=i.XRange[0].max[0],o[t].panTiltLimits.YRange={},o[t].panTiltLimits.YRange.min=i.YRange[0].min[0],o[t].panTiltLimits.YRange.max=i.YRange[0].max[0]}if("zoomLimits"in e){o[t].zoomLimits={};var r=e.zoomLimits[0].range[0];o[t].zoomLimits.XRange={},o[t].zoomLimits.XRange.min=r.XRange[0].min[0],o[t].zoomLimits.XRange.max=r.XRange[0].max[0]}}))})),this.configurations=o}e&&e.call(this,t,this.configurations,i)}.bind(this))},e.prototype.getConfigurationOptions=function(e,t){this._request({service:"ptz",body:this._envelopeHeader()+'<GetConfigurationOptions xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ConfigurationToken>'+e+"</ConfigurationToken></GetConfigurationOptions>"+this._envelopeFooter()},function(n,i,o){var r;if(!n){var s=i[0].getConfigurationOptionsResponse[0].PTZConfigurationOptions[0].spaces[0];(r={ptzTimeout:{min:i[0].getConfigurationOptionsResponse[0].PTZConfigurationOptions[0].PTZTimeout[0].min,max:i[0].getConfigurationOptionsResponse[0].PTZConfigurationOptions[0].PTZTimeout[0].max},spaces:{absolute:{x:{min:s.absolutePanTiltPositionSpace?parseFloat(s.absolutePanTiltPositionSpace[0].XRange[0].min[0]):0,max:s.absolutePanTiltPositionSpace?parseFloat(s.absolutePanTiltPositionSpace[0].XRange[0].max[0]):0,uri:s.absolutePanTiltPositionSpace?s.absolutePanTiltPositionSpace[0].URI:""},y:{min:s.absolutePanTiltPositionSpace?parseFloat(s.absolutePanTiltPositionSpace[0].YRange[0].min[0]):0,max:s.absolutePanTiltPositionSpace?parseFloat(s.absolutePanTiltPositionSpace[0].YRange[0].max[0]):0,uri:s.absolutePanTiltPositionSpace?s.absolutePanTiltPositionSpace[0].URI:""},zoom:{min:s.absoluteZoomPositionSpace?parseFloat(s.absoluteZoomPositionSpace[0].XRange[0].min[0]):0,max:s.absoluteZoomPositionSpace?parseFloat(s.absoluteZoomPositionSpace[0].XRange[0].max[0]):0,uri:s.absoluteZoomPositionSpace?s.absoluteZoomPositionSpace[0].URI:""}},relative:{x:{min:s.relativePanTiltTranslationSpace?parseFloat(s.relativePanTiltTranslationSpace[0].XRange[0].min[0]):0,max:s.relativePanTiltTranslationSpace?parseFloat(s.relativePanTiltTranslationSpace[0].XRange[0].max[0]):0,uri:s.relativePanTiltTranslationSpace?s.relativePanTiltTranslationSpace[0].URI:""},y:{min:s.relativePanTiltTranslationSpace?parseFloat(s.relativePanTiltTranslationSpace[0].YRange[0].min[0]):0,max:s.relativePanTiltTranslationSpace?parseFloat(s.relativePanTiltTranslationSpace[0].YRange[0].max[0]):0,uri:s.relativePanTiltTranslationSpace?s.relativePanTiltTranslationSpace[0].URI:""},zoom:{min:s.relativeZoomTranslationSpace?parseFloat(s.relativeZoomTranslationSpace[0].XRange[0].min[0]):0,max:s.relativeZoomTranslationSpace?parseFloat(s.relativeZoomTranslationSpace[0].XRange[0].max[0]):0,uri:s.relativeZoomTranslationSpace?s.relativeZoomTranslationSpace[0].URI:""}},continuous:{x:{min:s.continuousPanTiltVelocitySpace?parseFloat(s.continuousPanTiltVelocitySpace[0].XRange[0].min[0]):0,max:s.continuousPanTiltVelocitySpace?parseFloat(s.continuousPanTiltVelocitySpace[0].XRange[0].max[0]):0,uri:s.continuousPanTiltVelocitySpace?s.continuousPanTiltVelocitySpace[0].URI:""},y:{min:s.continuousPanTiltVelocitySpace?parseFloat(s.continuousPanTiltVelocitySpace[0].YRange[0].min[0]):0,max:s.continuousPanTiltVelocitySpace?parseFloat(s.continuousPanTiltVelocitySpace[0].YRange[0].max[0]):0,uri:s.continuousPanTiltVelocitySpace?s.continuousPanTiltVelocitySpace[0].URI:""},zoom:{min:s.continuousZoomVelocitySpace?parseFloat(s.continuousZoomVelocitySpace[0].XRange[0].min[0]):0,max:s.continuousZoomVelocitySpace?parseFloat(s.continuousZoomVelocitySpace[0].XRange[0].max[0]):0,uri:s.continuousZoomVelocitySpace?s.continuousZoomVelocitySpace[0].URI:""}},common:{x:{min:s.panTiltSpeedSpace?parseFloat(s.panTiltSpeedSpace[0].XRange[0].min[0]):0,max:s.panTiltSpeedSpace?parseFloat(s.panTiltSpeedSpace[0].XRange[0].max[0]):0,uri:s.panTiltSpeedSpace?s.panTiltSpeedSpace[0].URI:""},zoom:{min:s.zoomSpeedSpace?parseFloat(s.zoomSpeedSpace[0].XRange[0].min[0]):0,max:s.zoomSpeedSpace?parseFloat(s.zoomSpeedSpace[0].XRange[0].max[0]):0,uri:s.zoomSpeedSpace?s.zoomSpeedSpace[0].URI:""}}}}).ptzspaces=[];for(const e of Object.keys(s))for(const t of s[e]){let n={name:e,uri:t.URI[0]};t.XRange&&(n.x={min:parseFloat(t.XRange[0].min[0]),max:parseFloat(t.XRange[0].max[0])}),t.YRange&&(n.y={min:parseFloat(t.YRange[0].min[0]),max:parseFloat(t.YRange[0].max[0])}),r.ptzspaces.push(n)}this.configurations&&this.configurations[e]&&Object.assign(this.configurations[e],r)}t&&t.call(this,n,r,o)}.bind(this))},e.prototype.relativeMove=function(e,t){t=t?t.bind(this):function(){},e.x=e.x||0,e.y=e.y||0,e.zoom=e.zoom||0,this._request({service:"ptz",body:this._envelopeHeader()+'<RelativeMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><Translation>"+this._panTiltZoomVectors(e)+"</Translation>"+(e.speed?"<Speed>"+this._panTiltZoomVectors(e.speed)+"</Speed>":"")+"</RelativeMove>"+this._envelopeFooter()},t.bind(this))},e.prototype.absoluteMove=function(e,t){t=t?t.bind(this):function(){},e.x=e.x||0,e.y=e.y||0,e.zoom=e.zoom||0,e.onlySendPanTilt&&delete e.zoom,e.onlySendZoom&&(delete e.x,delete e.y),this._request({service:"ptz",body:this._envelopeHeader()+'<AbsoluteMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><Position>"+this._panTiltZoomVectors(e)+"</Position>"+(e.speed?"<Speed>"+this._panTiltZoomVectors(e.speed)+"</Speed>":"")+"</AbsoluteMove>"+this._envelopeFooter()},t.bind(this))},e.prototype.continuousMove=function(e,t){t=t?t.bind(this):function(){},e.x=e.x||0,e.y=e.y||0,e.zoom=e.zoom||0,e.onlySendPanTilt&&delete e.zoom,e.onlySendZoom&&(delete e.x,delete e.y),this._request({service:"ptz",body:this._envelopeHeader()+'<ContinuousMove xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken><Velocity>"+this._panTiltZoomVectors(e)+"</Velocity>"+(e.timeout?"<Timeout>PT"+e.timeout/1e3+"S</Timeout>":"")+"</ContinuousMove>"+this._envelopeFooter()},t.bind(this))},e.prototype.stop=function(e,t){if(void 0===t)switch(typeof e){case"object":t=function(){};break;case"function":t=e,e={};break;default:t=function(){},e={}}this._request({service:"ptz",body:this._envelopeHeader()+'<Stop xmlns="http://www.onvif.org/ver20/ptz/wsdl"><ProfileToken>'+(e.profileToken||this.activeSource.profileToken)+"</ProfileToken>"+(e.panTilt?"<PanTilt>"+e.panTilt+"</PanTilt>":"")+(e.zoom?"<Zoom>"+e.zoom+"</Zoom>":"")+"</Stop>"+this._envelopeFooter()},t.bind(this))},e.prototype._panTiltZoomVectors=function(e){const t=void 0!==e.xyspace?' space="'+e.xyspace+'"':"",n=void 0!==e.zoomspace?' space="'+e.zoomspace+'"':"";return e?(void 0!==e.x&&void 0!==e.y?'<PanTilt x="'+e.x+'" y="'+e.y+'"'+t+' xmlns="http://www.onvif.org/ver10/schema"/>':"")+(void 0!==e.zoom?'<Zoom x="'+e.zoom+'"'+n+' xmlns="http://www.onvif.org/ver10/schema"/>':""):""}}},1670:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;e.prototype.getRecordings=function(e){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordings xmlns="http://www.onvif.org/ver10/recording/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.recordingItems=t(i).getRecordingsResponse.recordingItem),e&&e.call(this,n,this.recordingItems,o)}.bind(this))},e.prototype.getRecordingJobs=function(e){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordingJobs xmlns="http://www.onvif.org/ver10/recording/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.jobItem=t(i).getRecordingJobsResponse.jobItem),e&&e.call(this,n,this.jobItem,o)}.bind(this))},e.prototype.createRecordingJob=function(e,n){let i;try{i='<CreateRecordingJob xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobConfiguration><ScheduleToken>'+(e.scheduleToken||"")+"</ScheduleToken><RecordingToken>"+(e.recordingToken||"")+"</RecordingToken><Mode>"+(e.mode||"")+"</Mode><Priority>"+(e.priority||"")+"</Priority><Source><SourceToken><Type>"+(e.source.sourceToken.type||"")+"</Type><Token>"+(e.source.sourceToken.token||"")+"</Token></SourceToken><AutoCreateReceiver>"+(e.source.autoCreateReceiver||"")+"</AutoCreateReceiver><Tracks><SourceTag>"+((e&&e.source&&e.source.tracks?e.source.tracks.sourceTag:"")||"")+"</SourceTag><Destination>"+((e&&e.source&&e.source.tracks?e.source.tracks.destination:"")||"")+"</Destination></Tracks><Extension>"+(e.source.extension||"")+"</Extension></Source><Extension>"+(e.extension||"")+"</Extension></JobConfiguration></CreateRecordingJob>"}catch(e){console.log(e)}this._request({service:"recording",body:this._envelopeHeader()+i+this._envelopeFooter()},function(e,i,o){e||(this.recordingJob=t(i).createRecordingJobResponse),n&&n.call(this,e,this.recordingJob,o)}.bind(this))},e.prototype.deleteRecordingJob=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<DeleteRecordingJob xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobToken>'+e.JobToken+"</JobToken></DeleteRecordingJob>"+this._envelopeFooter()},function(e,i,o){let r;e||(r=t(i).getRecordingJobsResponse),n&&n.call(this,e,r,o)}.bind(this))},e.prototype.getRecordingSummary=function(e){this._request({service:"search",body:this._envelopeHeader()+'<GetRecordingSummary xmlns="http://www.onvif.org/ver10/search/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.recordingSummary=t(i).getRecordingSummaryResponse.summary),e&&e.call(this,n,this.recordingSummary,o)}.bind(this))},e.prototype.getRecordingInformation=function(e,n){this._request({service:"search",body:this._envelopeHeader()+'<GetRecordingInformation xmlns="http://www.onvif.org/ver10/search/wsdl"><RecordingToken>'+e.RecordingToken+"</RecordingToken></GetRecordingInformation>"+this._envelopeFooter()},function(e,i,o){e||(this.summary=t(i).getRecordingSummaryResponse.summary),n&&n.call(this,e,this.summary,o)}.bind(this))},e.prototype.getRecordingConfiguration=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordingConfiguration xmlns="http://www.onvif.org/ver10/recording/wsdl"><RecordingToken>'+e.RecordingToken+"</RecordingToken></GetRecordingConfiguration>"+this._envelopeFooter()},function(e,i,o){e||(this.recordingConfiguration=t(i).getRecordingConfigurationResponse.recordingConfiguration),n&&n.call(this,e,this.recordingConfiguration,o)}.bind(this))},e.prototype.getRecordingJobState=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordingJobState xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobToken>'+e.JobToken+"</JobToken></GetRecordingJobState>"+this._envelopeFooter()},function(e,i,o){e||(this.recordingJobState=t(i).getRecordingJobStateResponse.state),n&&n.call(this,e,this.recordingJobState,o)}.bind(this))},e.prototype.deleteRecordingJob=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<DeleteRecordingJob xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobToken>'+e.JobToken+"</JobToken></DeleteRecordingJob>"+this._envelopeFooter()},function(e,i,o){let r={};e||(r=t(i).deleteRecordingJobResponse),n&&n.call(this,e,r,o)}.bind(this))},e.prototype.getRecordingOptions=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordingOptions xmlns="http://www.onvif.org/ver10/recording/wsdl"><RecordingToken>'+e.RecordingToken+"</RecordingToken></GetRecordingOptions>"+this._envelopeFooter()},function(e,i,o){e||(this.recordingOptions=t(i).getRecordingOptionsResponse.options),n&&n.call(this,e,this.recordingOptions,o)}.bind(this))},e.prototype.getRecordingServiceCapabilities=function(e){this._request({service:"recording",body:this._envelopeHeader()+'<GetServiceCapabilities xmlns="http://www.onvif.org/ver10/recording/wsdl"/>'+this._envelopeFooter()},function(n,i,o){n||(this.searchCapabilities=t(i).getServiceCapabilitiesResponse.capabilities),e&&e.call(this,n,this.searchCapabilities,o)}.bind(this))},e.prototype.getTrackConfiguration=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<GetTrackConfiguration xmlns="http://www.onvif.org/ver10/recording/wsdl"><RecordingToken>'+e.recordingToken+"</RecordingToken><TrackToken>"+e.trackToken+"</TrackToken></GetTrackConfiguration>"+this._envelopeFooter()},function(e,i,o){e||(this.trackConfiguration=t(i).getTrackConfigurationResponse.trackConfiguration),n&&n.call(this,e,this.trackConfiguration,o)}.bind(this))},e.prototype.getRecordingJobConfiguration=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<GetRecordingJobConfiguration xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobToken>'+(e.JobToken||"")+"</JobToken></GetRecordingJobConfiguration>"+this._envelopeFooter()},function(e,i,o){e||(this.recordingJobConfiguration=t(i).getRecordingJobConfigurationResponse.jobConfiguration),n&&n.call(this,e,this.recordingJobConfiguration,o)}.bind(this))},e.prototype.setRecordingJobMode=function(e,n){this._request({service:"recording",body:this._envelopeHeader()+'<SetRecordingJobMode xmlns="http://www.onvif.org/ver10/recording/wsdl"><JobToken>'+(e.JobToken||"")+"</JobToken><Mode>"+(e.Mode||"")+"</Mode></SetRecordingJobMode>"+this._envelopeFooter()},function(e,i,o){e||(this.recordingJobMode=t(i).SetRecordingJobMode),n&&n.call(this,e,this.recordingJobMode,o)}.bind(this))}}},3162:(e,t,n)=>{e.exports=function(e){const t=n(4840).linerase;e.prototype.getReplayUri=function(e,n){void 0===n&&(n=e,e={}),this._request({service:"replay",body:this._envelopeHeader()+'<GetReplayUri xmlns="http://www.onvif.org/ver10/replay/wsdl"><StreamSetup><Stream xmlns="http://www.onvif.org/ver10/schema">'+(e.stream||"RTP-Unicast")+'</Stream><Transport xmlns="http://www.onvif.org/ver10/schema"><Protocol>'+(e.protocol||"RTSP")+"</Protocol></Transport></StreamSetup><RecordingToken>"+e.recordingToken+"</RecordingToken></GetReplayUri>"+this._envelopeFooter()},function(e,i,o){n&&n.call(this,e,e?null:t(i).getReplayUriResponse.uri,o)}.bind(this))}}},4840:(e,t,n)=>{const i=n(8805),o=/^-?([1-9]\d*|0)(\.\d*)?$/,r=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(.\d+)?Z$/,s=/(?!xmlns)^.*:/,a=function(e){if(Array.isArray(e)){if(e.length>1)return e.map(a);e=e[0]}if("object"==typeof e){var t={};return Object.keys(e).forEach((function(n){t[n]=a(e[n])})),t}return"true"===e||"false"!==e&&(o.test(e)?parseFloat(e):r.test(e)?new Date(e):e)},c=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};e.exports={linerase:a,parseSOAPString:function(e,t,n){e=e.replace(/xmlns([^=]*?)=(".*?")/g,"");try{i.parseString(e,{tagNameProcessors:[function(e){var t=(e=e.replace(s,"")).charAt(1);return t&&t.toUpperCase()!==t?e.charAt(0).toLowerCase()+e.slice(1):e}]},(function(i,o){if(o&&o.envelope&&o.envelope.body){if(!i&&o.envelope.body[0].fault){var r,s=o.envelope.body[0].fault[0];try{s.reason[0].text[0]._&&(r=s.reason[0].text[0]._)}catch(e){r=""}if(!r)try{r=JSON.stringify(a(s.code[0]))}catch(e){r=""}var c="";try{c=s.detail[0].text[0]}catch(e){c=""}i=new Error("ONVIF SOAP Fault: "+r+c)}t(i,o.envelope.body,e,n)}else t(new Error("Wrong ONVIF SOAP response"),null,e,n)}))}catch(i){t(i,"",e,n)}},guid:function(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}}},4617:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},3290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(228),o=n(7685),r=n(4774),s=()=>{},a=new o.TimeoutError;t.default=class extends i{constructor(e){var t,n,i,o;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=s,this._resolveIdle=s,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:r.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(o=null===(i=e.interval)||void 0===i?void 0:i.toString())&&void 0!==o?o:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=s,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=s,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((n,i)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const r=void 0===this._timeout&&void 0===t.timeout?e():o.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&i(a)}));n(await r)}catch(e){i(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},9998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let i=0,o=e.length;for(;o>0;){const r=o/2|0;let s=i+r;n(e[s],t)<=0?(i=++s,o-=r+1):o=r}return i}},4774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(9998);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(n);const o=i.default(this._queue,n,((e,t)=>t.priority-e.priority));this._queue.splice(o,0,n)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},7685:(e,t,n)=>{"use strict";const i=n(4617);class o extends Error{constructor(e){super(e),this.name="TimeoutError"}}const r=(e,t,n)=>new Promise(((r,s)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void r(e);const a=setTimeout((()=>{if("function"==typeof n){try{r(n())}catch(e){s(e)}return}const i=n instanceof Error?n:new o("string"==typeof n?n:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),s(i)}),t);i(e.then(r,s),(()=>{clearTimeout(a)}))}));e.exports=r,e.exports.default=r,e.exports.TimeoutError=o},4043:(e,t,n)=>{!function(e){e.parser=function(e,t){return new o(e,t)},e.SAXParser=o,e.SAXStream=s,e.createStream=function(e,t){return new s(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function o(t,n){if(!(this instanceof o))return new o(t,n);var r=this;!function(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""}(r),r.q=r.c="",r.bufferCheckPosition=e.MAX_BUFFER_LENGTH,r.opt=n||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!t,r.noscript=!(!t&&!r.opt.noscript),r.state=G.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(d)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),w(r,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),o.prototype={end:function(){T(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return R(n,"Cannot write after close. Assign an onready handler.");if(null===t)return T(n);"object"==typeof t&&(t=t.toString());for(var o=0,r="";r=E(t,o++),n.c=r,r;)switch(n.trackPosition&&(n.position++,"\n"===r?(n.line++,n.column=0):n.column++),n.state){case G.BEGIN:if(n.state=G.BEGIN_WHITESPACE,"\ufeff"===r)continue;x(n,r);continue;case G.BEGIN_WHITESPACE:x(n,r);continue;case G.TEXT:if(n.sawRoot&&!n.closedRoot){for(var s=o-1;r&&"<"!==r&&"&"!==r;)(r=E(t,o++))&&n.trackPosition&&(n.position++,"\n"===r?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(s,o-1)}"<"!==r||n.sawRoot&&n.closedRoot&&!n.strict?(I(r)||n.sawRoot&&!n.closedRoot||N(n,"Text data outside of root node."),"&"===r?n.state=G.TEXT_ENTITY:n.textNode+=r):(n.state=G.OPEN_WAKA,n.startTagPosition=n.position);continue;case G.SCRIPT:"<"===r?n.state=G.SCRIPT_ENDING:n.script+=r;continue;case G.SCRIPT_ENDING:"/"===r?n.state=G.CLOSE_TAG:(n.script+="<"+r,n.state=G.SCRIPT);continue;case G.OPEN_WAKA:if("!"===r)n.state=G.SGML_DECL,n.sgmlDecl="";else if(I(r));else if(y(g,r))n.state=G.OPEN_TAG,n.tagName=r;else if("/"===r)n.state=G.CLOSE_TAG,n.tagName="";else if("?"===r)n.state=G.PROC_INST,n.procInstName=n.procInstBody="";else{if(N(n,"Unencoded <"),n.startTagPosition+1<n.position){var l=n.position-n.startTagPosition;r=new Array(l).join(" ")+r}n.textNode+="<"+r,n.state=G.TEXT}continue;case G.SGML_DECL:(n.sgmlDecl+r).toUpperCase()===a?(S(n,"onopencdata"),n.state=G.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+r==="--"?(n.state=G.COMMENT,n.comment="",n.sgmlDecl=""):(n.sgmlDecl+r).toUpperCase()===c?(n.state=G.DOCTYPE,(n.doctype||n.sawRoot)&&N(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===r?(S(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=G.TEXT):b(r)?(n.state=G.SGML_DECL_QUOTED,n.sgmlDecl+=r):n.sgmlDecl+=r;continue;case G.SGML_DECL_QUOTED:r===n.q&&(n.state=G.SGML_DECL,n.q=""),n.sgmlDecl+=r;continue;case G.DOCTYPE:">"===r?(n.state=G.TEXT,S(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=r,"["===r?n.state=G.DOCTYPE_DTD:b(r)&&(n.state=G.DOCTYPE_QUOTED,n.q=r));continue;case G.DOCTYPE_QUOTED:n.doctype+=r,r===n.q&&(n.q="",n.state=G.DOCTYPE);continue;case G.DOCTYPE_DTD:n.doctype+=r,"]"===r?n.state=G.DOCTYPE:b(r)&&(n.state=G.DOCTYPE_DTD_QUOTED,n.q=r);continue;case G.DOCTYPE_DTD_QUOTED:n.doctype+=r,r===n.q&&(n.state=G.DOCTYPE_DTD,n.q="");continue;case G.COMMENT:"-"===r?n.state=G.COMMENT_ENDING:n.comment+=r;continue;case G.COMMENT_ENDING:"-"===r?(n.state=G.COMMENT_ENDED,n.comment=W(n.opt,n.comment),n.comment&&S(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+r,n.state=G.COMMENT);continue;case G.COMMENT_ENDED:">"!==r?(N(n,"Malformed comment"),n.comment+="--"+r,n.state=G.COMMENT):n.state=G.TEXT;continue;case G.CDATA:"]"===r?n.state=G.CDATA_ENDING:n.cdata+=r;continue;case G.CDATA_ENDING:"]"===r?n.state=G.CDATA_ENDING_2:(n.cdata+="]"+r,n.state=G.CDATA);continue;case G.CDATA_ENDING_2:">"===r?(n.cdata&&S(n,"oncdata",n.cdata),S(n,"onclosecdata"),n.cdata="",n.state=G.TEXT):"]"===r?n.cdata+="]":(n.cdata+="]]"+r,n.state=G.CDATA);continue;case G.PROC_INST:"?"===r?n.state=G.PROC_INST_ENDING:I(r)?n.state=G.PROC_INST_BODY:n.procInstName+=r;continue;case G.PROC_INST_BODY:if(!n.procInstBody&&I(r))continue;"?"===r?n.state=G.PROC_INST_ENDING:n.procInstBody+=r;continue;case G.PROC_INST_ENDING:">"===r?(S(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=G.TEXT):(n.procInstBody+="?"+r,n.state=G.PROC_INST_BODY);continue;case G.OPEN_TAG:y(p,r)?n.tagName+=r:(_(n),">"===r?Y(n):"/"===r?n.state=G.OPEN_TAG_SLASH:(I(r)||N(n,"Invalid character in tag name"),n.state=G.ATTRIB));continue;case G.OPEN_TAG_SLASH:">"===r?(Y(n,!0),X(n)):(N(n,"Forward-slash in opening tag not followed by >"),n.state=G.ATTRIB);continue;case G.ATTRIB:if(I(r))continue;">"===r?Y(n):"/"===r?n.state=G.OPEN_TAG_SLASH:y(g,r)?(n.attribName=r,n.attribValue="",n.state=G.ATTRIB_NAME):N(n,"Invalid attribute name");continue;case G.ATTRIB_NAME:"="===r?n.state=G.ATTRIB_VALUE:">"===r?(N(n,"Attribute without value"),n.attribValue=n.attribName,k(n),Y(n)):I(r)?n.state=G.ATTRIB_NAME_SAW_WHITE:y(p,r)?n.attribName+=r:N(n,"Invalid attribute name");continue;case G.ATTRIB_NAME_SAW_WHITE:if("="===r)n.state=G.ATTRIB_VALUE;else{if(I(r))continue;N(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",S(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===r?Y(n):y(g,r)?(n.attribName=r,n.state=G.ATTRIB_NAME):(N(n,"Invalid attribute name"),n.state=G.ATTRIB)}continue;case G.ATTRIB_VALUE:if(I(r))continue;b(r)?(n.q=r,n.state=G.ATTRIB_VALUE_QUOTED):(N(n,"Unquoted attribute value"),n.state=G.ATTRIB_VALUE_UNQUOTED,n.attribValue=r);continue;case G.ATTRIB_VALUE_QUOTED:if(r!==n.q){"&"===r?n.state=G.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=r;continue}k(n),n.q="",n.state=G.ATTRIB_VALUE_CLOSED;continue;case G.ATTRIB_VALUE_CLOSED:I(r)?n.state=G.ATTRIB:">"===r?Y(n):"/"===r?n.state=G.OPEN_TAG_SLASH:y(g,r)?(N(n,"No whitespace between attributes"),n.attribName=r,n.attribValue="",n.state=G.ATTRIB_NAME):N(n,"Invalid attribute name");continue;case G.ATTRIB_VALUE_UNQUOTED:if(!f(r)){"&"===r?n.state=G.ATTRIB_VALUE_ENTITY_U:n.attribValue+=r;continue}k(n),">"===r?Y(n):n.state=G.ATTRIB;continue;case G.CLOSE_TAG:if(n.tagName)">"===r?X(n):y(p,r)?n.tagName+=r:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=G.SCRIPT):(I(r)||N(n,"Invalid tagname in closing tag"),n.state=G.CLOSE_TAG_SAW_WHITE);else{if(I(r))continue;C(g,r)?n.script?(n.script+="</"+r,n.state=G.SCRIPT):N(n,"Invalid tagname in closing tag."):n.tagName=r}continue;case G.CLOSE_TAG_SAW_WHITE:if(I(r))continue;">"===r?X(n):N(n,"Invalid characters in closing tag");continue;case G.TEXT_ENTITY:case G.ATTRIB_VALUE_ENTITY_Q:case G.ATTRIB_VALUE_ENTITY_U:var u,d;switch(n.state){case G.TEXT_ENTITY:u=G.TEXT,d="textNode";break;case G.ATTRIB_VALUE_ENTITY_Q:u=G.ATTRIB_VALUE_QUOTED,d="attribValue";break;case G.ATTRIB_VALUE_ENTITY_U:u=G.ATTRIB_VALUE_UNQUOTED,d="attribValue"}if(";"===r)if(n.opt.unparsedEntities){var v=F(n);n.entity="",n.state=u,n.write(v)}else n[d]+=F(n),n.entity="",n.state=u;else y(n.entity.length?m:h,r)?n.entity+=r:(N(n,"Invalid character in entity name"),n[d]+="&"+n.entity+r,n.entity="",n.state=u);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),o=0,r=0,s=i.length;r<s;r++){var a=t[i[r]].length;if(a>n)switch(i[r]){case"textNode":V(t);break;case"cdata":S(t,"oncdata",t.cdata),t.cdata="";break;case"script":S(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+i[r])}o=Math.max(o,a)}var c=e.MAX_BUFFER_LENGTH-o;t.bufferCheckPosition=c+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;V(e=this),""!==e.cdata&&(S(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(S(e,"onscript",e.script),e.script="")}};try{t=n(2203).Stream}catch(e){t=function(){}}t||(t=function(){});var r=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,n){if(!(this instanceof s))return new s(e,n);t.apply(this),this._parser=new o(e,n),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(e){i.emit("error",e),i._parser.error=null},this._decoder=null,r.forEach((function(e){Object.defineProperty(i,"on"+e,{get:function(){return i._parser["on"+e]},set:function(t){if(!t)return i.removeAllListeners(e),i._parser["on"+e]=t,t;i.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(t.prototype,{constructor:{value:s}}),s.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=n(3193).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,n){var i=this;return i._parser["on"+e]||-1===r.indexOf(e)||(i._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),i.emit.apply(i,t)}),t.prototype.on.call(i,e,n)};var a="[CDATA[",c="DOCTYPE",l="http://www.w3.org/XML/1998/namespace",u="http://www.w3.org/2000/xmlns/",d={xml:l,xmlns:u},g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function I(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function b(e){return'"'===e||"'"===e}function f(e){return">"===e||I(e)}function y(e,t){return e.test(t)}function C(e,t){return!y(e,t)}var v,A,Z,G=0;for(var B in e.STATE={BEGIN:G++,BEGIN_WHITESPACE:G++,TEXT:G++,TEXT_ENTITY:G++,OPEN_WAKA:G++,SGML_DECL:G++,SGML_DECL_QUOTED:G++,DOCTYPE:G++,DOCTYPE_QUOTED:G++,DOCTYPE_DTD:G++,DOCTYPE_DTD_QUOTED:G++,COMMENT_STARTING:G++,COMMENT:G++,COMMENT_ENDING:G++,COMMENT_ENDED:G++,CDATA:G++,CDATA_ENDING:G++,CDATA_ENDING_2:G++,PROC_INST:G++,PROC_INST_BODY:G++,PROC_INST_ENDING:G++,OPEN_TAG:G++,OPEN_TAG_SLASH:G++,ATTRIB:G++,ATTRIB_NAME:G++,ATTRIB_NAME_SAW_WHITE:G++,ATTRIB_VALUE:G++,ATTRIB_VALUE_QUOTED:G++,ATTRIB_VALUE_CLOSED:G++,ATTRIB_VALUE_UNQUOTED:G++,ATTRIB_VALUE_ENTITY_Q:G++,ATTRIB_VALUE_ENTITY_U:G++,CLOSE_TAG:G++,CLOSE_TAG_SAW_WHITE:G++,SCRIPT:G++,SCRIPT_ENDING:G++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var n=e.ENTITIES[t],i="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=i})),e.STATE)e.STATE[e.STATE[B]]=B;function w(e,t,n){e[t]&&e[t](n)}function S(e,t,n){e.textNode&&V(e),w(e,t,n)}function V(e){e.textNode=W(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode=""}function W(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return V(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,w(e,"onerror",t),e}function T(e){return e.sawRoot&&!e.closedRoot&&N(e,"Unclosed root tag"),e.state!==G.BEGIN&&e.state!==G.BEGIN_WHITESPACE&&e.state!==G.TEXT&&R(e,"Unexpected end"),V(e),e.c="",e.closed=!0,w(e,"onend"),o.call(e,e.strict,e.opt),e}function N(e,t){if("object"!=typeof e||!(e instanceof o))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function _(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,S(e,"onopentagstart",n)}function H(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),i=n[0],o=n[1];return t&&"xmlns"===e&&(i="xmlns",o=""),{prefix:i,local:o}}function k(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=H(e.attribName,!0),n=t.prefix,i=t.local;if("xmlns"===n)if("xml"===i&&e.attribValue!==l)N(e,"xml: prefix must be bound to "+l+"\nActual: "+e.attribValue);else if("xmlns"===i&&e.attribValue!==u)N(e,"xmlns: prefix must be bound to "+u+"\nActual: "+e.attribValue);else{var o=e.tag,r=e.tags[e.tags.length-1]||e;o.ns===r.ns&&(o.ns=Object.create(r.ns)),o.ns[i]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,S(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function Y(e,t){if(e.opt.xmlns){var n=e.tag,i=H(e.tagName);n.prefix=i.prefix,n.local=i.local,n.uri=n.ns[i.prefix]||"",n.prefix&&!n.uri&&(N(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=i.prefix);var o=e.tags[e.tags.length-1]||e;n.ns&&o.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){S(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var r=0,s=e.attribList.length;r<s;r++){var a=e.attribList[r],c=a[0],l=a[1],u=H(c,!0),d=u.prefix,g=u.local,p=""===d?"":n.ns[d]||"",h={name:c,value:l,prefix:d,local:g,uri:p};d&&"xmlns"!==d&&!p&&(N(e,"Unbound namespace prefix: "+JSON.stringify(d)),h.uri=d),e.tag.attributes[c]=h,S(e,"onattribute",h)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),S(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=G.TEXT:e.state=G.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function X(e){if(!e.tagName)return N(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=G.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=G.SCRIPT);S(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var i=n;t--&&e.tags[t].name!==i;)N(e,"Unexpected close tag");if(t<0)return N(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=G.TEXT);e.tagName=n;for(var o=e.tags.length;o-- >t;){var r=e.tag=e.tags.pop();e.tagName=e.tag.name,S(e,"onclosetag",e.tagName);var s={};for(var a in r.ns)s[a]=r.ns[a];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&r.ns!==c.ns&&Object.keys(r.ns).forEach((function(t){var n=r.ns[t];S(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=G.TEXT}function F(e){var t,n=e.entity,i=n.toLowerCase(),o="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[i]?e.ENTITIES[i]:("#"===(n=i).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),o=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),o=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(t)||o.toLowerCase()!==n?(N(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function x(e,t){"<"===t?(e.state=G.OPEN_WAKA,e.startTagPosition=e.position):I(t)||(N(e,"Non-whitespace before first tag."),e.textNode=t,e.state=G.TEXT)}function E(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}G=e.STATE,String.fromCodePoint||(v=String.fromCharCode,A=Math.floor,Z=function(){var e,t,n=[],i=-1,o=arguments.length;if(!o)return"";for(var r="";++i<o;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||A(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?n.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,n.push(e,t)),(i+1===o||n.length>16384)&&(r+=v.apply(null,n),n.length=0)}return r},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Z,configurable:!0,writable:!0}):String.fromCodePoint=Z)}(t)},3177:function(e,t){(function(){"use strict";t.stripBOM=function(e){return"\ufeff"===e[0]?e.substring(1):e}}).call(this)},6712:function(e,t,n){(function(){"use strict";var e,i,o,r,s,a={}.hasOwnProperty;e=n(9665),i=n(6465).defaults,r=function(e){return"string"==typeof e&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)},s=function(e){return"<![CDATA["+o(e)+"]]>"},o=function(e){return e.replace("]]>","]]]]><![CDATA[>")},t.Builder=function(){function t(e){var t,n,o;for(t in this.options={},n=i[.2])a.call(n,t)&&(o=n[t],this.options[t]=o);for(t in e)a.call(e,t)&&(o=e[t],this.options[t]=o)}return t.prototype.buildObject=function(t){var n,o,c,l,u,d;return n=this.options.attrkey,o=this.options.charkey,1===Object.keys(t).length&&this.options.rootName===i[.2].rootName?t=t[u=Object.keys(t)[0]]:u=this.options.rootName,d=this,c=function(e,t){var i,l,u,g,p,h;if("object"!=typeof t)d.options.cdata&&r(t)?e.raw(s(t)):e.txt(t);else if(Array.isArray(t)){for(g in t)if(a.call(t,g))for(p in l=t[g])u=l[p],e=c(e.ele(p),u).up()}else for(p in t)if(a.call(t,p))if(l=t[p],p===n){if("object"==typeof l)for(i in l)h=l[i],e=e.att(i,h)}else if(p===o)e=d.options.cdata&&r(l)?e.raw(s(l)):e.txt(l);else if(Array.isArray(l))for(g in l)a.call(l,g)&&(e="string"==typeof(u=l[g])?d.options.cdata&&r(u)?e.ele(p).raw(s(u)).up():e.ele(p,u).up():c(e.ele(p),u).up());else"object"==typeof l?e=c(e.ele(p),l).up():"string"==typeof l&&d.options.cdata&&r(l)?e=e.ele(p).raw(s(l)).up():(null==l&&(l=""),e=e.ele(p,l.toString()).up());return e},l=e.create(u,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(l,t).end(this.options.renderOpts)},t}()}).call(this)},6465:function(e,t){(function(){t.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},1912:function(e,t,n){(function(){"use strict";var e,i,o,r,s,a,c,l,u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;c=n(4043),o=n(4434),e=n(3177),a=n(2114),l=n(3557).setImmediate,i=n(6465).defaults,r=function(e){return"object"==typeof e&&null!=e&&0===Object.keys(e).length},s=function(e,t,n){var i,o;for(i=0,o=e.length;i<o;i++)t=(0,e[i])(t,n);return t},t.Parser=function(n){function o(e){var n,o,r;if(this.parseStringPromise=u(this.parseStringPromise,this),this.parseString=u(this.parseString,this),this.reset=u(this.reset,this),this.assignOrPush=u(this.assignOrPush,this),this.processAsync=u(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(n in this.options={},o=i[.2])d.call(o,n)&&(r=o[n],this.options[n]=r);for(n in e)d.call(e,n)&&(r=e[n],this.options[n]=r);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(e,t){for(var n in t)d.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(o,n),o.prototype.processAsync=function(){var e,t;try{return this.remaining.length<=this.options.chunkSize?(e=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(e),this.saxParser.close()):(e=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(e),l(this.processAsync))}catch(e){if(t=e,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(t)}},o.prototype.assignOrPush=function(e,t,n){return t in e?(e[t]instanceof Array||(e[t]=[e[t]]),e[t].push(n)):this.options.explicitArray?e[t]=[n]:e[t]=n},o.prototype.reset=function(){var e,t,n,i,o;return this.removeAllListeners(),this.saxParser=c.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(o=this,function(e){if(o.saxParser.resume(),!o.saxParser.errThrown)return o.saxParser.errThrown=!0,o.emit("error",e)}),this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended)return e.saxParser.ended=!0,e.emit("end",e.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,i=[],e=this.options.attrkey,t=this.options.charkey,this.saxParser.onopentag=function(n){return function(o){var r,a,c,l,u;if((c=Object.create(null))[t]="",!n.options.ignoreAttrs)for(r in u=o.attributes)d.call(u,r)&&(e in c||n.options.mergeAttrs||(c[e]=Object.create(null)),a=n.options.attrValueProcessors?s(n.options.attrValueProcessors,o.attributes[r],r):o.attributes[r],l=n.options.attrNameProcessors?s(n.options.attrNameProcessors,r):r,n.options.mergeAttrs?n.assignOrPush(c,l,a):c[e][l]=a);return c["#name"]=n.options.tagNameProcessors?s(n.options.tagNameProcessors,o.name):o.name,n.options.xmlns&&(c[n.options.xmlnskey]={uri:o.uri,local:o.local}),i.push(c)}}(this),this.saxParser.onclosetag=function(e){return function(){var n,o,a,c,l,u,g,p,h,m;if(u=i.pop(),l=u["#name"],e.options.explicitChildren&&e.options.preserveChildrenOrder||delete u["#name"],!0===u.cdata&&(n=u.cdata,delete u.cdata),h=i[i.length-1],u[t].match(/^\s*$/)&&!n?(o=u[t],delete u[t]):(e.options.trim&&(u[t]=u[t].trim()),e.options.normalize&&(u[t]=u[t].replace(/\s{2,}/g," ").trim()),u[t]=e.options.valueProcessors?s(e.options.valueProcessors,u[t],l):u[t],1===Object.keys(u).length&&t in u&&!e.EXPLICIT_CHARKEY&&(u=u[t])),r(u)&&(u="function"==typeof e.options.emptyTag?e.options.emptyTag():""!==e.options.emptyTag?e.options.emptyTag:o),null!=e.options.validator&&(m="/"+function(){var e,t,n;for(n=[],e=0,t=i.length;e<t;e++)c=i[e],n.push(c["#name"]);return n}().concat(l).join("/"),function(){var t;try{return u=e.options.validator(m,h&&h[l],u)}catch(n){return t=n,e.emit("error",t)}}()),e.options.explicitChildren&&!e.options.mergeAttrs&&"object"==typeof u)if(e.options.preserveChildrenOrder){if(h){for(a in h[e.options.childkey]=h[e.options.childkey]||[],g=Object.create(null),u)d.call(u,a)&&(g[a]=u[a]);h[e.options.childkey].push(g),delete u["#name"],1===Object.keys(u).length&&t in u&&!e.EXPLICIT_CHARKEY&&(u=u[t])}}else c=Object.create(null),e.options.attrkey in u&&(c[e.options.attrkey]=u[e.options.attrkey],delete u[e.options.attrkey]),!e.options.charsAsChildren&&e.options.charkey in u&&(c[e.options.charkey]=u[e.options.charkey],delete u[e.options.charkey]),Object.getOwnPropertyNames(u).length>0&&(c[e.options.childkey]=u),u=c;return i.length>0?e.assignOrPush(h,l,u):(e.options.explicitRoot&&(p=u,(u=Object.create(null))[l]=p),e.resultObject=u,e.saxParser.ended=!0,e.emit("end",e.resultObject))}}(this),n=function(e){return function(n){var o,r;if(r=i[i.length-1])return r[t]+=n,e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||""!==n.replace(/\\n/g,"").trim())&&(r[e.options.childkey]=r[e.options.childkey]||[],(o={"#name":"__text__"})[t]=n,e.options.normalize&&(o[t]=o[t].replace(/\s{2,}/g," ").trim()),r[e.options.childkey].push(o)),r}}(this),this.saxParser.ontext=n,this.saxParser.oncdata=function(e){var t;if(t=n(e))return t.cdata=!0}},o.prototype.parseString=function(t,n){var i;null!=n&&"function"==typeof n&&(this.on("end",(function(e){return this.reset(),n(null,e)})),this.on("error",(function(e){return this.reset(),n(e)})));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,l(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(e){if(i=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",i),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw i}},o.prototype.parseStringPromise=function(e){return new Promise((t=this,function(n,i){return t.parseString(e,(function(e,t){return e?i(e):n(t)}))}));var t},o}(o),t.parseString=function(e,n,i){var o,r;return null!=i?("function"==typeof i&&(o=i),"object"==typeof n&&(r=n)):("function"==typeof n&&(o=n),r={}),new t.Parser(r).parseString(e,o)},t.parseStringPromise=function(e,n){var i;return"object"==typeof n&&(i=n),new t.Parser(i).parseStringPromise(e)}}).call(this)},2114:function(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/),t.normalize=function(e){return e.toLowerCase()},t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},t.stripPrefix=function(t){return t.replace(e,"")},t.parseNumbers=function(e){return isNaN(e)||(e=e%1==0?parseInt(e,10):parseFloat(e)),e},t.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e="true"===e.toLowerCase()),e}}).call(this)},8805:function(e,t,n){(function(){"use strict";var e,i,o,r,s={}.hasOwnProperty;i=n(6465),e=n(6712),o=n(1912),r=n(2114),t.defaults=i.defaults,t.processors=r,t.ValidationError=function(e){function t(e){this.message=e}return function(e,t){for(var n in t)s.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,Error),t}(),t.Builder=e.Builder,t.Parser=o.Parser,t.parseString=o.parseString,t.parseStringPromise=o.parseStringPromise}).call(this)},4923:function(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},1737:function(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},9241:function(e){(function(){var t,n,i,o,r,s,a,c=[].slice,l={}.hasOwnProperty;t=function(){var e,t,n,i,o,s;if(s=arguments[0],o=2<=arguments.length?c.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(e=0,n=o.length;e<n;e++)if(null!=(i=o[e]))for(t in i)l.call(i,t)&&(s[t]=i[t]);return s},r=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},s=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},i=function(e){return r(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},o=function(e){var t;if(i(e))return!e.length;for(t in e)if(l.call(e,t))return!1;return!0},a=function(e){var t,n;return s(e)&&(n=Object.getPrototypeOf(e))&&(t=n.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},n=function(e){return r(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=r,e.exports.isObject=s,e.exports.isArray=i,e.exports.isEmpty=o,e.exports.isPlainObject=a,e.exports.getValue=n}).call(this)},8753:function(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},4238:function(e,t,n){(function(){var t;t=n(1737),n(468),e.exports=function(){function e(e,n,i){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(i),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(e){return e.namespaceURI===this.namespaceURI&&e.prefix===this.prefix&&e.localName===this.localName&&e.value===this.value},e}()}).call(this)},2691:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;t=n(1737),i=n(7457),e.exports=function(e){function n(e,i){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(i)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},7457:function(e,t,n){(function(){var t,i={}.hasOwnProperty;t=n(468),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.value=""}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceData=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(e){return!!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.data===this.data},t}(t)}).call(this)},2679:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;t=n(1737),i=n(7457),e.exports=function(e){function n(e,i){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(i)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},3074:function(e,t,n){(function(){var t,i;t=n(5660),i=n(2527),e.exports=function(){function e(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),e.prototype.getParameter=function(e){return this.params.hasOwnProperty(e)?this.params[e]:null},e.prototype.canSetParameter=function(e,t){return!0},e.prototype.setParameter=function(e,t){return null!=t?this.params[e]=t:delete this.params[e]},e}()}).call(this)},5660:function(e){(function(){e.exports=function(){function e(){}return e.prototype.handleError=function(e){throw new Error(e)},e}()}).call(this)},7260:function(e){(function(){e.exports=function(){function e(){}return e.prototype.hasFeature=function(e,t){return!0},e.prototype.createDocumentType=function(e,t,n){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(e,t,n){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},2527:function(e){(function(){e.exports=function(){function e(e){this.arr=e||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(e){return this.arr[e]||null},e.prototype.contains=function(e){return-1!==this.arr.indexOf(e)},e}()}).call(this)},4111:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;i=n(468),t=n(1737),e.exports=function(e){function n(e,i,o,r,s,a){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==o)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!r)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(o),this.attributeType=this.stringify.dtdAttType(r),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},7696:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;i=n(468),t=n(1737),e.exports=function(e){function n(e,i,o){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());o||(o="(#PCDATA)"),Array.isArray(o)&&(o="("+o.join(",")+")"),this.name=this.stringify.name(i),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(o)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},5529:function(e,t,n){(function(){var t,i,o,r={}.hasOwnProperty;o=n(9241).isObject,i=n(468),t=n(1737),e.exports=function(e){function n(e,i,r,s){if(n.__super__.constructor.call(this,e),null==r)throw new Error("Missing DTD entity name. "+this.debugInfo(r));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(r));if(this.pe=!!i,this.name=this.stringify.name(r),this.type=t.EntityDeclaration,o(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(r));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(r));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(r))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(n.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(n.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"xmlVersion",{get:function(){return null}}),n.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},8012:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;i=n(468),t=n(1737),e.exports=function(e){function n(e,i,o){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!o.pubID&&!o.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=t.NotationDeclaration,null!=o.pubID&&(this.pubID=this.stringify.dtdPubID(o.pubID)),null!=o.sysID&&(this.sysID=this.stringify.dtdSysID(o.sysID))}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),n.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},4130:function(e,t,n){(function(){var t,i,o,r={}.hasOwnProperty;o=n(9241).isObject,i=n(468),t=n(1737),e.exports=function(e){function n(e,i,r,s){var a;n.__super__.constructor.call(this,e),o(i)&&(i=(a=i).version,r=a.encoding,s=a.standalone),i||(i="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(i),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},6376:function(e,t,n){(function(){var t,i,o,r,s,a,c,l,u={}.hasOwnProperty;l=n(9241).isObject,c=n(468),t=n(1737),i=n(4111),r=n(5529),o=n(7696),s=n(8012),a=n(4797),e.exports=function(e){function n(e,i,o){var r,s,a,c,u,d;if(n.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(s=0,a=(c=e.children).length;s<a;s++)if((r=c[s]).type===t.Element){this.name=r.name;break}this.documentObject=e,l(i)&&(i=(u=i).pubID,o=u.sysID),null==o&&(o=(d=[i,o])[0],i=d[1]),null!=i&&(this.pubID=this.stringify.dtdPubID(i)),null!=o&&(this.sysID=this.stringify.dtdSysID(o))}return function(e,t){for(var n in t)u.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"entities",{get:function(){var e,n,i,o,r;for(o={},n=0,i=(r=this.children).length;n<i;n++)(e=r[n]).type!==t.EntityDeclaration||e.pe||(o[e.name]=e);return new a(o)}}),Object.defineProperty(n.prototype,"notations",{get:function(){var e,n,i,o,r;for(o={},n=0,i=(r=this.children).length;n<i;n++)(e=r[n]).type===t.NotationDeclaration&&(o[e.name]=e);return new a(o)}}),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(n.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),n.prototype.element=function(e,t){var n;return n=new o(this,e,t),this.children.push(n),this},n.prototype.attList=function(e,t,n,o,r){var s;return s=new i(this,e,t,n,o,r),this.children.push(s),this},n.prototype.entity=function(e,t){var n;return n=new r(this,!1,e,t),this.children.push(n),this},n.prototype.pEntity=function(e,t){var n;return n=new r(this,!0,e,t),this.children.push(n),this},n.prototype.notation=function(e,t){var n;return n=new s(this,e,t),this.children.push(n),this},n.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))},n.prototype.ele=function(e,t){return this.element(e,t)},n.prototype.att=function(e,t,n,i,o){return this.attList(e,t,n,i,o)},n.prototype.ent=function(e,t){return this.entity(e,t)},n.prototype.pent=function(e,t){return this.pEntity(e,t)},n.prototype.not=function(e,t){return this.notation(e,t)},n.prototype.up=function(){return this.root()||this.documentObject},n.prototype.isEqualNode=function(e){return!!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.name===this.name&&e.publicId===this.publicId&&e.systemId===this.systemId},n}(c)}).call(this)},1933:function(e,t,n){(function(){var t,i,o,r,s,a,c,l={}.hasOwnProperty;c=n(9241).isPlainObject,o=n(7260),i=n(3074),r=n(468),t=n(1737),a=n(3976),s=n(382),e.exports=function(e){function n(e){n.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new i,e||(e={}),e.writer||(e.writer=new s),this.options=e,this.stringify=new a(e)}return function(e,t){for(var n in t)l.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"implementation",{value:new o}),Object.defineProperty(n.prototype,"doctype",{get:function(){var e,n,i,o;for(n=0,i=(o=this.children).length;n<i;n++)if((e=o[n]).type===t.DocType)return e;return null}}),Object.defineProperty(n.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(n.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(n.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(n.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(n.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(n.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(n.prototype,"origin",{get:function(){return null}}),Object.defineProperty(n.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(n.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(n.prototype,"contentType",{get:function(){return null}}),n.prototype.end=function(e){var t;return t={},e?c(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))},n.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))},n.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.renameNode=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createNodeIterator=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createTreeWalker=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n}(r)}).call(this)},400:function(e,t,n){(function(){var t,i,o,r,s,a,c,l,u,d,g,p,h,m,I,b,f,y,C,v,A,Z,G,B={}.hasOwnProperty;G=n(9241),A=G.isObject,v=G.isFunction,Z=G.isPlainObject,C=G.getValue,t=n(1737),p=n(1933),h=n(3906),r=n(2691),s=n(2679),I=n(1268),y=n(2535),m=n(5915),d=n(4130),g=n(6376),a=n(4111),l=n(5529),c=n(7696),u=n(8012),o=n(4238),f=n(3976),b=n(382),i=n(8753),e.exports=function(){function e(e,n,i){var o;this.name="?xml",this.type=t.Document,e||(e={}),o={},e.writer?Z(e.writer)&&(o=e.writer,e.writer=new b):e.writer=new b,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(o),this.stringify=new f(e),this.onDataCallback=n||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.createChildNode=function(e){var n,i,o,r,s,a,c,l;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(i in o={},c=e.attribs)B.call(c,i)&&(n=c[i],o[i]=n.value);this.node(e.name,o);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(s=0,a=(l=e.children).length;s<a;s++)r=l[s],this.createChildNode(r),r.type===t.Element&&this.up();return this},e.prototype.dummy=function(){return this},e.prototype.node=function(e,t,n){var i;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=C(e),null==t&&(t={}),t=C(t),A(t)||(n=(i=[t,n])[0],t=i[1]),this.currentNode=new h(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},e.prototype.element=function(e,n,i){var o,r,s,a,c,l;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||A(e)||v(e))for(a=this.options.noValidation,this.options.noValidation=!0,(l=new p(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=a,r=0,s=(c=l.children).length;r<s;r++)o=c[r],this.createChildNode(o),o.type===t.Element&&this.up();else this.node(e,n,i);return this},e.prototype.attribute=function(e,t){var n,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=C(e)),A(e))for(n in e)B.call(e,n)&&(i=e[n],this.attribute(n,i));else v(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new o(this,e,""):null!=t&&(this.currentNode.attribs[e]=new o(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new y(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new r(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new s(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new I(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.instruction=function(e,t){var n,i,o,r,s;if(this.openCurrent(),null!=e&&(e=C(e)),null!=t&&(t=C(t)),Array.isArray(e))for(n=0,r=e.length;n<r;n++)i=e[n],this.instruction(i);else if(A(e))for(i in e)B.call(e,i)&&(o=e[i],this.instruction(i,o));else v(t)&&(t=t.apply()),s=new m(this,e,t),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},e.prototype.declaration=function(e,t,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new d(this,e,t,n),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.doctype=function(e,t,n){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new g(this,t,n),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var n;return this.openCurrent(),n=new c(this,e,t),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.attList=function(e,t,n,i,o){var r;return this.openCurrent(),r=new a(this,e,t,n,i,o),this.onData(this.writer.dtdAttList(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.entity=function(e,t){var n;return this.openCurrent(),n=new l(this,!1,e,t),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.pEntity=function(e,t){var n;return this.openCurrent(),n=new l(this,!0,e,t),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.notation=function(e,t){var n;return this.openCurrent(),n=new u(this,e,t),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){var n,o,r,s;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),o="",e.type===t.Element){for(r in this.writerOptions.state=i.OpenTag,o=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,s=e.attribs)B.call(s,r)&&(n=s[r],o+=this.writer.attribute(n,this.writerOptions,this.currentLevel));o+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,o=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?o+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(o+=' SYSTEM "'+e.sysID+'"'),e.children?(o+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,o+=">"),o+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(o,this.currentLevel),e.isOpen=!0}},e.prototype.closeNode=function(e){var n;if(!e.isClosed)return"",this.writerOptions.state=i.CloseTag,n=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(n,this.currentLevel),e.isClosed=!0},e.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,n){return this.node(e,t,n)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},e.prototype.dtd=function(e,t,n){return this.doctype(e,t,n)},e.prototype.e=function(e,t,n){return this.element(e,t,n)},e.prototype.n=function(e,t,n){return this.node(e,t,n)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},1218:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;i=n(468),t=n(1737),e.exports=function(e){function n(e){n.__super__.constructor.call(this,e),this.type=t.Dummy}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return""},n}(i)}).call(this)},3906:function(e,t,n){(function(){var t,i,o,r,s,a,c,l,u={}.hasOwnProperty;l=n(9241),c=l.isObject,a=l.isFunction,s=l.getValue,r=n(468),t=n(1737),i=n(4238),o=n(4797),e.exports=function(e){function n(e,i,o){var r,s,a,c;if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(i),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=o&&this.attribute(o),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(s=0,a=(c=e.children).length;s<a;s++)if((r=c[s]).type===t.DocType){r.name=this.name;break}}return function(e,t){for(var n in t)u.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(n.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(n.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new o(this.attribs)),this.attributeMap}}),n.prototype.clone=function(){var e,t,n,i;for(t in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},i=this.attribs)u.call(i,t)&&(e=i[t],n.attribs[t]=e.clone());return n.children=[],this.children.forEach((function(e){var t;return(t=e.clone()).parent=n,n.children.push(t)})),n},n.prototype.attribute=function(e,t){var n,o;if(null!=e&&(e=s(e)),c(e))for(n in e)u.call(e,n)&&(o=e[n],this.attribute(n,o));else a(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new i(this,e,""):null!=t&&(this.attribs[e]=new i(this,e,t));return this},n.prototype.removeAttribute=function(e){var t,n,i;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=s(e),Array.isArray(e))for(n=0,i=e.length;n<i;n++)t=e[n],delete this.attribs[t];else delete this.attribs[e];return this},n.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))},n.prototype.att=function(e,t){return this.attribute(e,t)},n.prototype.a=function(e,t){return this.attribute(e,t)},n.prototype.getAttribute=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null},n.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNode=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null},n.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setAttributeNS=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)},n.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setIdAttribute=function(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t},n.prototype.setIdAttributeNS=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.isEqualNode=function(e){var t,i,o;if(!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=i=0,o=this.attribs.length-1;0<=o?i<=o:i>=o;t=0<=o?++i:--i)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0},n}(r)}).call(this)},4797:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(e){return this.nodes[e]},e.prototype.setNamedItem=function(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null},e.prototype.removeNamedItem=function(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null},e.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},e.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},468:function(e,t,n){(function(){var t,i,o,r,s,a,c,l,u,d,g,p,h,m,I,b,f,y={}.hasOwnProperty;f=n(9241),b=f.isObject,I=f.isFunction,m=f.isEmpty,h=f.getValue,l=null,o=null,r=null,s=null,a=null,g=null,p=null,d=null,c=null,i=null,u=null,t=null,e.exports=function(){function e(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,l||(l=n(3906),o=n(2691),r=n(2679),s=n(4130),a=n(6376),g=n(1268),p=n(2535),d=n(5915),c=n(1218),i=n(1737),u=n(6684),n(4797),t=n(4923))}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,n,o,r;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(r="",t=0,n=(o=this.children).length;t<n;t++)(e=o[t]).textContent&&(r+=e.textContent);return r}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e.prototype.setParent=function(e){var t,n,i,o,r;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),r=[],n=0,i=(o=this.children).length;n<i;n++)t=o[n],r.push(t.setParent(this));return r},e.prototype.element=function(e,t,n){var i,o,r,s,a,c,l,u,d,g,p;if(c=null,null===t&&null==n&&(t=(d=[{},null])[0],n=d[1]),null==t&&(t={}),t=h(t),b(t)||(n=(g=[t,n])[0],t=g[1]),null!=e&&(e=h(e)),Array.isArray(e))for(r=0,l=e.length;r<l;r++)o=e[r],c=this.element(o);else if(I(e))c=this.element(e.apply());else if(b(e)){for(a in e)if(y.call(e,a))if(p=e[a],I(p)&&(p=p.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))c=this.attribute(a.substr(this.stringify.convertAttKey.length),p);else if(!this.options.separateArrayItems&&Array.isArray(p)&&m(p))c=this.dummy();else if(b(p)&&m(p))c=this.element(a);else if(this.options.keepNullNodes||null!=p)if(!this.options.separateArrayItems&&Array.isArray(p))for(s=0,u=p.length;s<u;s++)o=p[s],(i={})[a]=o,c=this.element(i);else b(p)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?c=this.element(p):(c=this.element(a)).element(p):c=this.element(a,p);else c=this.dummy()}else c=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),n):this.node(e,t,n):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return c},e.prototype.insertBefore=function(e,t,n){var i,o,r,s,a;if(null!=e?e.type:void 0)return s=t,(r=e).setParent(this),s?(o=children.indexOf(s),a=children.splice(o),children.push(r),Array.prototype.push.apply(children,a)):children.push(r),r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return o=this.parent.children.indexOf(this),a=this.parent.children.splice(o),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,a),i},e.prototype.insertAfter=function(e,t,n){var i,o,r;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return o=this.parent.children.indexOf(this),r=this.parent.children.splice(o+1),i=this.parent.element(e,t,n),Array.prototype.push.apply(this.parent.children,r),i},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.node=function(e,t,n){var i,o;return null!=e&&(e=h(e)),t||(t={}),t=h(t),b(t)||(n=(o=[t,n])[0],t=o[1]),i=new l(this,e,t),null!=n&&i.text(n),this.children.push(i),i},e.prototype.text=function(e){var t;return b(e)&&this.element(e),t=new p(this,e),this.children.push(t),this},e.prototype.cdata=function(e){var t;return t=new o(this,e),this.children.push(t),this},e.prototype.comment=function(e){var t;return t=new r(this,e),this.children.push(t),this},e.prototype.commentBefore=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.commentAfter=function(e){var t,n;return t=this.parent.children.indexOf(this),n=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.raw=function(e){var t;return t=new g(this,e),this.children.push(t),this},e.prototype.dummy=function(){return new c(this)},e.prototype.instruction=function(e,t){var n,i,o,r,s;if(null!=e&&(e=h(e)),null!=t&&(t=h(t)),Array.isArray(e))for(r=0,s=e.length;r<s;r++)n=e[r],this.instruction(n);else if(b(e))for(n in e)y.call(e,n)&&(i=e[n],this.instruction(n,i));else I(t)&&(t=t.apply()),o=new d(this,e,t),this.children.push(o);return this},e.prototype.instructionBefore=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.instructionAfter=function(e,t){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.declaration=function(e,t,n){var o,r;return o=this.document(),r=new s(o,e,t,n),0===o.children.length?o.children.unshift(r):o.children[0].type===i.Declaration?o.children[0]=r:o.children.unshift(r),o.root()||o},e.prototype.dtd=function(e,t){var n,o,r,s,c,l,u,d,g;for(n=this.document(),o=new a(n,e,t),r=s=0,l=(d=n.children).length;s<l;r=++s)if(d[r].type===i.DocType)return n.children[r]=o,o;for(r=c=0,u=(g=n.children).length;c<u;r=++c)if(g[r].isRoot)return n.children.splice(r,0,o),o;return n.children.push(o),o},e.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;for(e=this;e;){if(e.type===i.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}},e.prototype.document=function(){var e;for(e=this;e;){if(e.type===i.Document)return e;e=e.parent}},e.prototype.end=function(e){return this.document().end(e)},e.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},e.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},e.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},e.prototype.debugInfo=function(e){var t,n;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},e.prototype.ele=function(e,t,n){return this.element(e,t,n)},e.prototype.nod=function(e,t,n){return this.node(e,t,n)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.doc=function(){return this.document()},e.prototype.dec=function(e,t,n){return this.declaration(e,t,n)},e.prototype.e=function(e,t,n){return this.element(e,t,n)},e.prototype.n=function(e,t,n){return this.node(e,t,n)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.u=function(){return this.up()},e.prototype.importXMLBuilder=function(e){return this.importDocument(e)},e.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.hasChildNodes=function(){return 0!==this.children.length},e.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isSupported=function(e,t){return!0},e.prototype.hasAttributes=function(){return 0!==this.attribs.length},e.prototype.compareDocumentPosition=function(e){var n,i;return(n=this)===e?0:this.document()!==e.document()?(i=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?i|=t.Preceding:i|=t.Following,i):n.isAncestor(e)?t.Contains|t.Preceding:n.isDescendant(e)?t.Contains|t.Following:n.isPreceding(e)?t.Preceding:t.Following},e.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(e){var t,n,i;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=n=0,i=this.children.length-1;0<=i?n<=i:n>=i;t=0<=i?++n:--n)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.setUserData=function(e,t,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.contains=function(e){return!!e&&(e===this||this.isDescendant(e))},e.prototype.isDescendant=function(e){var t,n,i,o;for(n=0,i=(o=this.children).length;n<i;n++){if(e===(t=o[n]))return!0;if(t.isDescendant(e))return!0}return!1},e.prototype.isAncestor=function(e){return e.isDescendant(this)},e.prototype.isPreceding=function(e){var t,n;return t=this.treePosition(e),n=this.treePosition(this),-1!==t&&-1!==n&&t<n},e.prototype.isFollowing=function(e){var t,n;return t=this.treePosition(e),n=this.treePosition(this),-1!==t&&-1!==n&&t>n},e.prototype.treePosition=function(e){var t,n;return n=0,t=!1,this.foreachTreeNode(this.document(),(function(i){if(n++,!t&&i===e)return t=!0})),t?n:-1},e.prototype.foreachTreeNode=function(e,t){var n,i,o,r,s;for(e||(e=this.document()),i=0,o=(r=e.children).length;i<o;i++){if(s=t(n=r[i]))return s;if(s=this.foreachTreeNode(n,t))return s}},e}()}).call(this)},6684:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(e){return this.nodes[e]||null},e}()}).call(this)},5915:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;t=n(1737),i=n(7457),e.exports=function(e){function n(e,i,o){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,o&&(this.value=this.stringify.insValue(o))}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))},n.prototype.isEqualNode=function(e){return!!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.target===this.target},n}(i)}).call(this)},1268:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;t=n(1737),i=n(468),e.exports=function(e){function n(e,i){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(i)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))},n}(i)}).call(this)},6775:function(e,t,n){(function(){var t,i,o,r={}.hasOwnProperty;t=n(1737),o=n(6286),i=n(8753),e.exports=function(e){function n(e,t){this.stream=e,n.__super__.constructor.call(this,t)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),n.prototype.endline=function(e,t,o){return e.isLastRootNode&&t.state===i.CloseTag?"":n.__super__.endline.call(this,e,t,o)},n.prototype.document=function(e,t){var n,i,o,r,s,a,c,l,u;for(i=o=0,s=(c=e.children).length;o<s;i=++o)(n=c[i]).isLastRootNode=i===e.children.length-1;for(t=this.filterOptions(t),u=[],r=0,a=(l=e.children).length;r<a;r++)n=l[r],u.push(this.writeChildNode(n,t,0));return u},n.prototype.attribute=function(e,t,i){return this.stream.write(n.__super__.attribute.call(this,e,t,i))},n.prototype.cdata=function(e,t,i){return this.stream.write(n.__super__.cdata.call(this,e,t,i))},n.prototype.comment=function(e,t,i){return this.stream.write(n.__super__.comment.call(this,e,t,i))},n.prototype.declaration=function(e,t,i){return this.stream.write(n.__super__.declaration.call(this,e,t,i))},n.prototype.docType=function(e,t,n){var o,r,s,a;if(n||(n=0),this.openNode(e,t,n),t.state=i.OpenTag,this.stream.write(this.indent(e,t,n)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,n)),t.state=i.InsideTag,r=0,s=(a=e.children).length;r<s;r++)o=a[r],this.writeChildNode(o,t,n+1);t.state=i.CloseTag,this.stream.write("]")}return t.state=i.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,n)),t.state=i.None,this.closeNode(e,t,n)},n.prototype.element=function(e,n,o){var s,a,c,l,u,d,g,p,h;for(g in o||(o=0),this.openNode(e,n,o),n.state=i.OpenTag,this.stream.write(this.indent(e,n,o)+"<"+e.name),p=e.attribs)r.call(p,g)&&(s=p[g],this.attribute(s,n,o));if(l=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))n.allowEmpty?(this.stream.write(">"),n.state=i.CloseTag,this.stream.write("</"+e.name+">")):(n.state=i.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==c||l.type!==t.Text&&l.type!==t.Raw||null==l.value){for(this.stream.write(">"+this.endline(e,n,o)),n.state=i.InsideTag,u=0,d=(h=e.children).length;u<d;u++)a=h[u],this.writeChildNode(a,n,o+1);n.state=i.CloseTag,this.stream.write(this.indent(e,n,o)+"</"+e.name+">")}else this.stream.write(">"),n.state=i.InsideTag,n.suppressPrettyCount++,this.writeChildNode(l,n,o+1),n.suppressPrettyCount--,n.state=i.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,n,o)),n.state=i.None,this.closeNode(e,n,o)},n.prototype.processingInstruction=function(e,t,i){return this.stream.write(n.__super__.processingInstruction.call(this,e,t,i))},n.prototype.raw=function(e,t,i){return this.stream.write(n.__super__.raw.call(this,e,t,i))},n.prototype.text=function(e,t,i){return this.stream.write(n.__super__.text.call(this,e,t,i))},n.prototype.dtdAttList=function(e,t,i){return this.stream.write(n.__super__.dtdAttList.call(this,e,t,i))},n.prototype.dtdElement=function(e,t,i){return this.stream.write(n.__super__.dtdElement.call(this,e,t,i))},n.prototype.dtdEntity=function(e,t,i){return this.stream.write(n.__super__.dtdEntity.call(this,e,t,i))},n.prototype.dtdNotation=function(e,t,i){return this.stream.write(n.__super__.dtdNotation.call(this,e,t,i))},n}(o)}).call(this)},382:function(e,t,n){(function(){var t,i={}.hasOwnProperty;t=n(6286),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,e),t.prototype.document=function(e,t){var n,i,o,r,s;for(t=this.filterOptions(t),r="",i=0,o=(s=e.children).length;i<o;i++)n=s[i],r+=this.writeChildNode(n,t,0);return t.pretty&&r.slice(-t.newline.length)===t.newline&&(r=r.slice(0,-t.newline.length)),r},t}(t)}).call(this)},3976:function(e){(function(){var t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty;e.exports=function(){function e(e){var i,o,r;for(i in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),o=e.stringify||{})n.call(o,i)&&(r=o[i],this[i]=r)}return e.prototype.name=function(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")},e.prototype.text=function(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))},e.prototype.cdata=function(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))},e.prototype.comment=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return this.options.noValidation?e:""+e||""},e.prototype.attValue=function(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))},e.prototype.insTarget=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.insValue=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)},e.prototype.xmlVersion=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)},e.prototype.xmlStandalone=function(e){return this.options.noValidation?e:e?"yes":"no"},e.prototype.dtdPubID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdSysID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdElementValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttType=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttDefault=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdEntityValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdNData=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,n;if(this.options.noValidation)return e;if(t="","1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=e.match(t))throw new Error("Invalid character in string: "+e+" at index "+n.index)}else if("1.1"===this.options.version&&(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=e.match(t)))throw new Error("Invalid character in string: "+e+" at index "+n.index);return e},e.prototype.assertLegalName=function(e){var t;if(this.options.noValidation)return e;if(this.assertLegalChar(e),t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!e.match(t))throw new Error("Invalid character in name");return e},e.prototype.textEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},e.prototype.attEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},e}()}).call(this)},2535:function(e,t,n){(function(){var t,i,o={}.hasOwnProperty;t=n(1737),i=n(7457),e.exports=function(e){function n(e,i){if(n.__super__.constructor.call(this,e),null==i)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(i)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(n,e),Object.defineProperty(n.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"wholeText",{get:function(){var e,t,n;for(n="",t=this.previousSibling;t;)n=t.data+n,t=t.previousSibling;for(n+=this.data,e=this.nextSibling;e;)n+=e.data,e=e.nextSibling;return n}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))},n.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n}(i)}).call(this)},6286:function(e,t,n){(function(){var t,i,o,r={}.hasOwnProperty;o=n(9241).assign,t=n(1737),n(4130),n(6376),n(2691),n(2679),n(3906),n(1268),n(2535),n(5915),n(1218),n(4111),n(7696),n(5529),n(8012),i=n(8753),e.exports=function(){function e(e){var t,n,i;for(t in e||(e={}),this.options=e,n=e.writer||{})r.call(n,t)&&(i=n[t],this["_"+t]=this[t],this[t]=i)}return e.prototype.filterOptions=function(e){var t,n,r,s,a,c,l,u;return e||(e={}),e=o({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(n=e.indent)?n:"  ",t.newline=null!=(r=e.newline)?r:"\n",t.offset=null!=(s=e.offset)?s:0,t.dontPrettyTextNodes=null!=(a=null!=(c=e.dontPrettyTextNodes)?c:e.dontprettytextnodes)?a:0,t.spaceBeforeSlash=null!=(l=null!=(u=e.spaceBeforeSlash)?u:e.spacebeforeslash)?l:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=i.None,t},e.prototype.indent=function(e,t,n){var i;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(i=(n||0)+t.offset+1)>0?new Array(i).join(t.indent):""},e.prototype.endline=function(e,t,n){return!t.pretty||t.suppressPrettyCount?"":t.newline},e.prototype.attribute=function(e,t,n){var i;return this.openAttribute(e,t,n),i=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,n),i},e.prototype.cdata=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<![CDATA[",t.state=i.InsideTag,o+=e.value,t.state=i.CloseTag,o+="]]>"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.comment=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"\x3c!-- ",t.state=i.InsideTag,o+=e.value,t.state=i.CloseTag,o+=" --\x3e"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.declaration=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<?xml",t.state=i.InsideTag,o+=' version="'+e.version+'"',null!=e.encoding&&(o+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(o+=' standalone="'+e.standalone+'"'),t.state=i.CloseTag,o+=t.spaceBeforeSlash+"?>",o+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.docType=function(e,t,n){var o,r,s,a,c;if(n||(n=0),this.openNode(e,t,n),t.state=i.OpenTag,a=this.indent(e,t,n),a+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?a+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(a+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(a+=" [",a+=this.endline(e,t,n),t.state=i.InsideTag,r=0,s=(c=e.children).length;r<s;r++)o=c[r],a+=this.writeChildNode(o,t,n+1);t.state=i.CloseTag,a+="]"}return t.state=i.CloseTag,a+=t.spaceBeforeSlash+">",a+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),a},e.prototype.element=function(e,n,o){var s,a,c,l,u,d,g,p,h,m,I,b,f,y;for(h in o||(o=0),m=!1,I="",this.openNode(e,n,o),n.state=i.OpenTag,I+=this.indent(e,n,o)+"<"+e.name,b=e.attribs)r.call(b,h)&&(s=b[h],I+=this.attribute(s,n,o));if(l=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))n.allowEmpty?(I+=">",n.state=i.CloseTag,I+="</"+e.name+">"+this.endline(e,n,o)):(n.state=i.CloseTag,I+=n.spaceBeforeSlash+"/>"+this.endline(e,n,o));else if(!n.pretty||1!==c||l.type!==t.Text&&l.type!==t.Raw||null==l.value){if(n.dontPrettyTextNodes)for(u=0,g=(f=e.children).length;u<g;u++)if(((a=f[u]).type===t.Text||a.type===t.Raw)&&null!=a.value){n.suppressPrettyCount++,m=!0;break}for(I+=">"+this.endline(e,n,o),n.state=i.InsideTag,d=0,p=(y=e.children).length;d<p;d++)a=y[d],I+=this.writeChildNode(a,n,o+1);n.state=i.CloseTag,I+=this.indent(e,n,o)+"</"+e.name+">",m&&n.suppressPrettyCount--,I+=this.endline(e,n,o),n.state=i.None}else I+=">",n.state=i.InsideTag,n.suppressPrettyCount++,m=!0,I+=this.writeChildNode(l,n,o+1),n.suppressPrettyCount--,m=!1,n.state=i.CloseTag,I+="</"+e.name+">"+this.endline(e,n,o);return this.closeNode(e,n,o),I},e.prototype.writeChildNode=function(e,n,i){switch(e.type){case t.CData:return this.cdata(e,n,i);case t.Comment:return this.comment(e,n,i);case t.Element:return this.element(e,n,i);case t.Raw:return this.raw(e,n,i);case t.Text:return this.text(e,n,i);case t.ProcessingInstruction:return this.processingInstruction(e,n,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,n,i);case t.DocType:return this.docType(e,n,i);case t.AttributeDeclaration:return this.dtdAttList(e,n,i);case t.ElementDeclaration:return this.dtdElement(e,n,i);case t.EntityDeclaration:return this.dtdEntity(e,n,i);case t.NotationDeclaration:return this.dtdNotation(e,n,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},e.prototype.processingInstruction=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<?",t.state=i.InsideTag,o+=e.target,e.value&&(o+=" "+e.value),t.state=i.CloseTag,o+=t.spaceBeforeSlash+"?>",o+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.raw=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n),t.state=i.InsideTag,o+=e.value,t.state=i.CloseTag,o+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.text=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n),t.state=i.InsideTag,o+=e.value,t.state=i.CloseTag,o+=this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.dtdAttList=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<!ATTLIST",t.state=i.InsideTag,o+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(o+=" "+e.defaultValueType),e.defaultValue&&(o+=' "'+e.defaultValue+'"'),t.state=i.CloseTag,o+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.dtdElement=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<!ELEMENT",t.state=i.InsideTag,o+=" "+e.name+" "+e.value,t.state=i.CloseTag,o+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.dtdEntity=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<!ENTITY",t.state=i.InsideTag,e.pe&&(o+=" %"),o+=" "+e.name,e.value?o+=' "'+e.value+'"':(e.pubID&&e.sysID?o+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(o+=' SYSTEM "'+e.sysID+'"'),e.nData&&(o+=" NDATA "+e.nData)),t.state=i.CloseTag,o+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.dtdNotation=function(e,t,n){var o;return this.openNode(e,t,n),t.state=i.OpenTag,o=this.indent(e,t,n)+"<!NOTATION",t.state=i.InsideTag,o+=" "+e.name,e.pubID&&e.sysID?o+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?o+=' PUBLIC "'+e.pubID+'"':e.sysID&&(o+=' SYSTEM "'+e.sysID+'"'),t.state=i.CloseTag,o+=t.spaceBeforeSlash+">"+this.endline(e,t,n),t.state=i.None,this.closeNode(e,t,n),o},e.prototype.openNode=function(e,t,n){},e.prototype.closeNode=function(e,t,n){},e.prototype.openAttribute=function(e,t,n){},e.prototype.closeAttribute=function(e,t,n){},e}()}).call(this)},9665:function(e,t,n){(function(){var t,i,o,r,s,a,c,l,u,d;d=n(9241),l=d.assign,u=d.isFunction,o=n(7260),r=n(1933),s=n(400),c=n(382),a=n(6775),t=n(1737),i=n(8753),e.exports.create=function(e,t,n,i){var o,s;if(null==e)throw new Error("Root element needs a name.");return i=l({},t,n,i),s=(o=new r(i)).element(e),i.headless||(o.declaration(i),null==i.pubID&&null==i.sysID||o.dtd(i)),s},e.exports.begin=function(e,t,n){var i;return u(e)&&(t=(i=[e,t])[0],n=i[1],e={}),t?new s(e,t,n):new r(e)},e.exports.stringWriter=function(e){return new c(e)},e.exports.streamWriter=function(e,t){return new a(e,t)},e.exports.implementation=new o,e.exports.nodeType=t,e.exports.writerState=i}).call(this)},9367:e=>{e.exports={initActions:function(){let e=this,t={};t.panTiltLeft={name:"Pan Left",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]}],callback:async function(t){let n={x:t.options.velocity};e.continuousMove(n)}},t.panTiltRight={name:"Pan Right",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n={x:t.options.velocity};e.continuousMove(n)}},t.panTiltUp={name:"Tilt Up",options:[{type:"dropdown",label:"Tilt Velocity",id:"velocity",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n={y:t.options.velocity};e.continuousMove(n)}},t.panTiltDown={name:"Tilt Down",options:[{type:"dropdown",label:"Tilt Velocity",id:"velocity",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]}],callback:async function(t){let n={y:t.options.velocity};e.continuousMove(n)}},t.panTiltUpLeft={name:"Pan/Tilt Up Left",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity_pan",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]},{type:"dropdown",label:"Tilt Velocity",id:"velocity_tilt",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n=t.options,i={x:n.velocity_pan,y:n.velocity_tilt};e.continuousMove(i)}},t.panTiltUpRight={name:"Pan/Tilt Up Right",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity_pan",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]},{type:"dropdown",label:"Tilt Velocity",id:"velocity_tilt",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n=t.options,i={x:n.velocity_pan,y:n.velocity_tilt};e.continuousMove(i)}},t.panTiltDownLeft={name:"Pan/Tilt Down Left",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity_pan",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]},{type:"dropdown",label:"Tilt Velocity",id:"velocity_tilt",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]}],callback:async function(t){let n=t.options,i={x:n.velocity_pan,y:n.velocity_tilt};e.continuousMove(i)}},t.panTiltDownRight={name:"Pan/Tilt Down Right",options:[{type:"dropdown",label:"Pan Velocity",id:"velocity_pan",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]},{type:"dropdown",label:"Tilt Velocity",id:"velocity_tilt",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]}],callback:async function(t){let n=t.options,i={x:n.velocity_pan,y:n.velocity_tilt};e.continuousMove(i)}},t.panTiltStop={name:"Pan/Tilt Stop",options:[],callback:async function(){e.stop({panTilt:!0})}},t.zoomIn={name:"Zoom In",options:[{type:"dropdown",label:"Zoom Velocity",id:"velocity",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n={zoom:t.options.velocity};e.continuousMove(n)}},t.zoomOut={name:"Zoom Out",options:[{type:"dropdown",label:"Zoom Velocity",id:"velocity",default:-.5,choices:[{id:-.1,label:"Speed 1"},{id:-.2,label:"Speed 2"},{id:-.3,label:"Speed 3"},{id:-.4,label:"Speed 4"},{id:-.5,label:"Speed 5"},{id:-.6,label:"Speed 6"},{id:-.7,label:"Speed 7"},{id:-.8,label:"Speed 8"},{id:-.9,label:"Speed 9"},{id:-1,label:"Speed 10"}]}],callback:async function(t){let n={zoom:t.options.velocity};e.continuousMove(n)}},t.zoomStop={name:"Zoom Stop",options:[],callback:async function(){e.stop({zoom:!0})}},t.relativeMove={name:"Advanced - Relative Move from Current Position",options:[{type:"number",label:"Pan",id:"pan",default:.1,min:-1,max:1,step:.1,required:!0,tooltip:"The amount to move the camera left or right. Negative values move left, positive values move right. A value of 0 stops movement."},{type:"number",label:"Pan Speed",id:"speed_pan",default:1,min:0,max:1,step:.1,required:!0,tooltip:"The speed at which to move the camera left or right. A value of 0 stops movement."},{type:"number",label:"Tilt",id:"tilt",default:.1,min:-1,max:1,step:.1,required:!0,tooltip:"The amount to move the camera up or down. Negative values move down, positive values move up. A value of 0 stops movement."},{type:"number",label:"Tilt Speed",id:"speed_tilt",default:1,min:0,max:1,step:.1,required:!0,tooltip:"The speed at which to move the camera up or down. A value of 0 stops movement."},{type:"number",label:"Zoom",id:"zoom",default:.1,min:-1,max:1,step:.1,required:!0,tooltip:"The amount to zoom the camera in or out. Negative values zoom out, positive values zoom in. A value of 0 stops movement."},{type:"number",label:"Zoom Speed",id:"speed_zoom",default:1,min:0,max:1,step:.1,required:!0,tooltip:"The speed at which to zoom the camera in or out. A value of 0 stops movement."}],callback:async function(t){let n=t.options,i={x:n.pan,y:n.tilt,zoom:n.zoom,speed:{x:n.speed_pan,y:n.speed_tilt,zoom:n.speed_zoom}};e.relativeMove(i)}},t.absoluteMove={name:"Advanced - Absolute Move to Position",options:[{type:"number",label:"Pan",id:"pan",default:.1,min:-1,max:1,required:!0},{type:"number",label:"Pan Speed",id:"speed_pan",default:1,min:0,max:1,step:.1,required:!0},{type:"number",label:"Tilt",id:"tilt",default:.1,min:-1,max:1,required:!0},{type:"number",label:"Tilt Speed",id:"speed_tilt",default:1,min:0,max:1,step:.1,required:!0},{type:"number",label:"Zoom",id:"zoom",default:.1,min:-1,max:1,required:!0},{type:"number",label:"Zoom Speed",id:"speed_zoom",default:1,min:0,max:1,step:.1,required:!0}],callback:async function(t){let n=t.options,i={x:n.pan,y:n.tilt,zoom:n.zoom,speed:{x:n.speed_pan,y:n.speed_tilt,zoom:n.speed_zoom}};e.absoluteMove(i)}},t.continuousMove={name:"Advanced - Continuous Move",options:[{type:"number",label:"Pan Velocity",id:"pan",default:0,min:-1,max:1,required:!0},{type:"number",label:"Tilt Velocity",id:"tilt",default:0,min:-1,max:1,required:!0},{type:"number",label:"Zoom Velocity",id:"zoom",default:0,min:-1,max:1,required:!0},{type:"number",label:"Timeout (in seconds)",id:"timeout",default:1,min:1,max:600,required:!0}],callback:async function(t){let n=t.options,i={x:n.pan,y:n.tilt,zoom:n.zoom,timeout:1e3*n.timeout};e.continuousMove(i)}},t.stop={name:"Stop PTZ Move",options:[{type:"checkbox",label:"Stop Pan/Tile",id:"panTilt",default:!0},{type:"checkbox",label:"Stop Zoom",id:"zoom",default:!0}],callback:async function(t){let n=t.options,i={panTilt:n.panTilt,zoom:n.zoom};e.stop(i)}},t.gotoHomePosition={name:"Go to Home Position",options:[{type:"dropdown",label:"Pan Speed",id:"pan",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]},{type:"dropdown",label:"Tilt Speed",id:"tilt",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]},{type:"dropdown",label:"Zoom Speed",id:"zoom",default:.5,choices:[{id:.1,label:"Speed 1"},{id:.2,label:"Speed 2"},{id:.3,label:"Speed 3"},{id:.4,label:"Speed 4"},{id:.5,label:"Speed 5"},{id:.6,label:"Speed 6"},{id:.7,label:"Speed 7"},{id:.8,label:"Speed 8"},{id:.9,label:"Speed 9"},{id:1,label:"Speed 10"}]}],callback:async function(t){let n=t.options,i={speed:{x:n.pan,y:n.tilt,zoom:n.zoom}};console.log(i),e.gotoHomePosition(i)}},t.setHomePosition={name:"Set Home Position",callback:async function(){e.setHomePosition()}},t.recallPreset={name:"Recall Preset",options:[{type:"dropdown",label:"Preset",id:"preset",default:e.CHOICES_PRESETS[0].id,choices:e.CHOICES_PRESETS}],callback:async function(t){let n={preset:t.options.preset};e.gotoPreset(n)}},t.setPreset={name:"Set Preset",options:[{type:"dropdown",label:"Preset",id:"preset",default:e.CHOICES_PRESETS[0].id,choices:e.CHOICES_PRESETS},{type:"textinput",label:"Preset Name",id:"presetName",default:"",required:!0}],callback:async function(t){let n=t.options,i={presetToken:n.preset,presetName:n.presetName};e.setPreset(i)}},t.setBrightness={name:"Set Brightness",options:[{type:"number",label:"Brightness",id:"brightness",default:50,min:0,max:100,required:!0}],callback:async function(t){let n={brightness:t.options.brightness};e.setImaging(n)}},t.setColorSaturation={name:"Set Color Saturation",options:[{type:"number",label:"Color Saturation",id:"colorSaturation",default:50,min:0,max:100,required:!0}],callback:async function(t){let n={colorSaturation:t.options.colorSaturation};e.setImaging(n)}},t.setContrast={name:"Set Contrast",options:[{type:"number",label:"Contrast",id:"contrast",default:50,min:0,max:100,required:!0}],callback:async function(t){let n={contrast:t.options.contrast};e.setImaging(n)}},t.setExposure={name:"Set Exposure",options:[{type:"dropdown",label:"Exposure Mode",id:"exposureMode",default:"AUTO",choices:[{id:"AUTO",label:"Auto"},{id:"MANUAL",label:"Manual"}]},{type:"number",label:"Exposure Time (ms)",id:"exposureTime",default:33,min:33,max:4e4,required:!0},{type:"number",label:"Gain",id:"gain",default:0,min:0,max:100,required:!0}],callback:async function(t){let n=t.options,i={exposure:{mode:n.exposureMode,minExposureTime:n.exposureTime,maxExposureTime:4e4,minGain:0,maxGain:100}};e.setImaging(i)}},t.setFocus={name:"Set Focus",options:[{type:"dropdown",label:"Auto Focus Mode",id:"autoFocusMode",default:"AUTO",choices:[{id:"AUTO",label:"Auto"},{id:"MANUAL",label:"Manual"}]},{type:"number",label:"Near Limit",id:"nearLimit",default:150,min:0,max:1e3,required:!0}],callback:async function(t){let n=t.options,i={focus:{autoFocusMode:n.autoFocusMode,nearLimit:n.nearLimit}};e.setImaging(i)}},t.setIrCutFilter={name:"Set IR Cut Filter",options:[{type:"dropdown",label:"IR Cut Filter",id:"irCutFilter",default:"AUTO",choices:[{id:"AUTO",label:"Auto"},{id:"ON",label:"On"},{id:"OFF",label:"Off"}]}],callback:async function(t){let n={irCutFilter:t.options.irCutFilter};e.setImaging(n)}},e.setActionDefinitions(t)}}},6672:(e,t,n)=>{const{InstanceStatus:i}=n(6278),o=n(5447).Cam;e.exports={initConnection:function(){let e=this;clearInterval(e.pollingInterval),null==e.config.port&&(e.config.port=80),e.config.host&&""!==e.config.host&&e.config.username&&""!==e.config.username&&e.config.password&&""!==e.config.password&&(e.DEVICE=new o({hostname:e.config.host,username:e.config.username,password:e.config.password,path:e.config.path,port:e.config.port},(function(t){if(t)return e.updateStatus(i.ConnectionFailure,"Error connecting. See log for details."),e.log("error","Error connecting to "+e.config.host+": "+String(t)),void e.log("error",'Check your ONVIF device configuration. The authentication mode should be set to "digest/wsse".');e.updateStatus(i.Ok),e.getDeviceInformation(),e.getSystemDateAndTime(),e.getServices(),e.getServiceCapabilities(),e.getStatus(),e.getNodes(),e.getPresets(),e.getImagingSettings(),e.startPolling()})))},getDeviceInformation:function(){let e=this;e.DEVICE.getDeviceInformation(((t,n)=>{t?e.log("error","Error getting device information: "+String(t)):(e.DATA.deviceInformation=n,e.checkFeedbacks(),e.checkVariables())}))},getSystemDateAndTime:function(){let e=this;e.DEVICE.getSystemDateAndTime(((t,n)=>{t?e.log("error","Error getting system date and time: "+String(t)):(e.DATA.systemDateAndTime=n,e.checkFeedbacks(),e.checkVariables())}))},getServices:function(){let e=this;e.DEVICE.getServices(((t,n)=>{t?e.log("error","Error getting services: "+String(t)):(e.DATA.services=n,e.checkFeedbacks(),e.checkVariables())}))},getServiceCapabilities:function(){let e=this;e.DEVICE.getServiceCapabilities(((t,n)=>{t?e.log("error","Error getting service capabilities: "+String(t)):(e.DATA.serviceCapabilities=n,e.checkFeedbacks(),e.checkVariables())}))},getStatus:function(){let e=this;e.DEVICE.getStatus(((t,n)=>{t||(e.DATA.status=n,e.checkFeedbacks(),e.checkVariables())}))},getNodes:function(){let e=this;e.DEVICE.getNodes(((t,n)=>{t||(e.DATA.nodes=n)}))},getPresets:function(){let e=this;e.DEVICE.getPresets(((t,n)=>{if(t)return;e.DATA.presets=n;let i=e.CHOICES_PRESETS;e.CHOICES_PRESETS=[];for(let t in n)e.CHOICES_PRESETS.push({id:n[t],label:t});0===e.CHOICES_PRESETS.length&&e.CHOICES_PRESETS.push({id:0,label:"(no presets loaded)"}),JSON.stringify(i)!==JSON.stringify(e.CHOICES_PRESETS)&&(e.initActions(),e.initFeedbacks(),e.initVariables(),e.checkFeedbacks(),e.checkVariables())}))},getImagingSettings:function(){let e=this;e.DEVICE.getImagingSettings(((t,n)=>{t?e.log("error","Error getting imaging settings: "+String(t)):e.DATA.imagingSettings=n}))},startPolling:function(){let e=this;e.config.polling&&(e.pollingInterval=setInterval((()=>{e.getStatus(),e.getPresets()}),e.config.interval))},relativeMove:function(e){this.DEVICE&&this.DEVICE.relativeMove(e)},absoluteMove:function(e){this.DEVICE&&this.DEVICE.absoluteMove(e)},continuousMove:function(e){this.DEVICE&&this.DEVICE.continuousMove(e)},stop:function(){this.DEVICE&&this.DEVICE.stop()},gotoHomePosition:function(e){let t=this;t.DEVICE&&t.DEVICE.gotoHomePosition(e,((e,n)=>{e?t.log("error","Error going to home position: "+String(e)):console.log(n)}))},setHomePosition:function(){let e=this;e.DEVICE&&e.DEVICE.setHomePosition(((t,n)=>{t?e.log("error","Error setting home position: "+String(t)):console.log(n)}))},gotoPreset:function(e){let t=this;t.DEVICE&&t.DEVICE.gotoPreset(e,((e,n)=>{e?t.log("error","Error going to preset: "+String(e)):console.log(n)}))},setPreset:function(e){let t=this;t.DEVICE&&t.DEVICE.setPreset(e,((e,n)=>{e?t.log("error","Error setting preset: "+String(e)):(console.log(n),t.getPresets())}))},setImaging:function(e){let t=this;t.DEVICE&&t.DEVICE.setImagingSettings(e,((e,n)=>{e?t.log("error","Error setting imaging settings: "+String(e)):console.log(n)}))},systemReboot:function(){let e=this;e.DEVICE&&e.DEVICE.systemReboot(((t,n)=>{t?e.log("error","Error rebooting system: "+String(t)):console.log(n)}))}}},8384:(e,t,n)=>{const{Regex:i}=n(6278);e.exports={getConfigFields:()=>[{type:"static-text",id:"info",width:12,label:"Information",value:"This module controls cameras using the ONVIF protocol."},{type:"textinput",id:"host",label:"IP",width:4,default:"",regex:i.IP},{type:"textinput",id:"port",label:"Port",width:4,default:"80",regex:i.PORT},{type:"textinput",id:"username",label:"Username",width:4,default:"admin"},{type:"textinput",id:"password",label:"Password",width:4,default:"admin"},{type:"static-text",id:"hr1",width:12,label:" ",value:"<hr />"},{type:"textinput",id:"path",label:"ONVIF Device Path",width:6,default:"/onvif/device_service"},{type:"static-text",id:"pathInfo",width:6,label:"",value:"The path to the ONVIF device service. The default is usually fine, but you can customize it here if needed."},{type:"static-text",id:"hr2",width:12,label:" ",value:"<hr />"},{type:"checkbox",id:"polling",width:3,label:"Enable Polling",default:!0},{type:"static-text",id:"intervalInfo",width:12,label:"Update Interval",value:"Enter the amount of time in milliseconds to request new information from the camera.",isVisible:e=>1==e.polling},{type:"number",id:"interval",label:"Update Interval",width:3,default:5e3,min:100,max:6e4,isVisible:e=>1==e.polling},{type:"static-text",id:"hr3",width:12,label:" ",value:"<hr />"},{type:"checkbox",id:"verbose",width:3,label:"Verbose Mode",default:!0},{type:"static-text",id:"verboseInfo",width:9,label:"",value:"When enabled, the module will log additional information to the console."}]}},8404:(e,t,n)=>{const{combineRgb:i}=n(6278);e.exports={initFeedbacks:function(){let e=this,t={};const n=i(255,255,255),o=i(255,0,0);t.isMoving={type:"boolean",name:"Camera is Moving (Pan/Tilt)",description:"Indicate if Camera is Moving",defaultStyle:{color:n,bgcolor:o},options:[{type:"dropdown",label:"State",id:"state",default:"MOVING",choices:[{id:"MOVING",label:"Moving"},{id:"IDLE",label:"Idle"}]}],callback:function(t){let n=t.options;return e.DATA?.status?.moveStatus?.panTilt===n.state}},t.isZooming={type:"boolean",name:"Camera is Zooming",description:"Indicate if Camera is Zooming",defaultStyle:{color:n,bgcolor:o},options:[{type:"dropdown",label:"State",id:"state",default:"MOVING",choices:[{id:"MOVING",label:"Moving"},{id:"IDLE",label:"Idle"}]}],callback:function(t){let n=t.options;return e.DATA?.status?.moveStatus?.zoom===n.state}},e.setFeedbackDefinitions(t)}}},4302:e=>{e.exports={UP:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6AQMAAAApyY3OAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAIFJREFUKM+90EEKgzAQRmFDFy49ghcp5FquVPBighcRegHBjWDJ68D8U6F7m00+EnhkUlW3ru6rdyCV0INQzSg1zFLLKmU2aeCQQMEEJXIQORRsTLNyKJhNm3IoaPBg4mQorp2Mh1+00kKN307o/bZrpt5O/FlPU/c75X91/fPd6wPRD1eHyHEL4wAAAABJRU5ErkJggg==",DOWN:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6AQMAAAApyY3OAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAIlJREFUKM/F0DEOwyAMBVAjDxk5Qo7CtdiClIv1KJF6gUpZIhXxY2zTDJ2benoS8LFN9MsKbYjxF2XRS1UZ4bCeGFztFmNqphURpidm146kpwFvLDYJpPQtLSLNoySyP2bRpoqih2oSFW8K3lYAxmJGXA88XMnjeuDmih7XA8vXvNeeqX6U6aY6AacbWAQNWOPUAAAAAElFTkSuQmCC",LEFT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6AQMAAAApyY3OAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAHpJREFUKM+1kTEOgCAQBM9Q2JjwA/mJPA2fxlN4giWF8TRBBhMpbKSaZie3i8gPb4Y8FNZKGm8YIAONkNWacIruQLejy+gyug1dQhfRqZa0v6gYA6QfqSWapZnto1B6XdUuFaVHoJunr2MD21nIdJYUEhLYfoGmP777BKKIXC0eYSD5AAAAAElFTkSuQmCC",RIGHT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6AQMAAAApyY3OAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAHhJREFUKM+10LERgCAMQFE4CktHcBRWcRMYzVEcwdKCI+od+fGksVCq3/AuiXOfvZnaNXzRClVrEKtMLdSqP2RTRQAFMAFGwAlw7MAk0sAzGnhVoerLKg/F5Pv4NoFNZZNGpk9sxJYeLsDdL5T7S8IFOM/R3OZ+fQeQZV9pMy+bVgAAAABJRU5ErkJggg==",UP_RIGHT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAMAAAAk2e+/AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAABhlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+X02G5AAAAgXRSTlMAAte32QZhZx7d+TywDTf8/d5VstYPOxULNvKmSY8TFBrxyeGCluJeELQ5uw7ULND4BedlKuv2P/vDA8UgCk30WO41s8+5X8dABAz6QhHVaR156JpPnihSfTJDNOMBm4bzSICqr23NsRjcGRbtjTCS2lzsOmyu9+WLKb2fTL8+RPDhqO4yAAABfElEQVRYw+3WZW/CUBQG4AO0FBsOwwcMm7sLc3d3d3e388/HGGs7lpD0tsm+9P3S5CT3SdPec+8BkCNHzv9FAVAAEABYdQDkA7jo9GNUIDMBzstb5vr0/Gx8Z35zOjI36R2xbu+619eWa2xCoK0FClF5h1cWxDHEwilEOyLlQc8hokoAlMRcESBh7siQlJBWKkijNaHuPrWBED9iYiDQ7Pv1D4Z4/DXyFo2JgeAghQEkEgAvT6IgNo/PIUmgd62oj80mqEIpINoXRkmg2j2UBDIWVXKLTSXEUIOF/xbV5aRQsJvvUOoqMqjZZ+c7FcX8ThYCtTbxHV0fkEGDA73D3Dpzi/6rWEYAdSn579PZ/t3IBJChkef0dLRlHXdkJ6TSmSnmiYPq1LQIiGHX9BvZYinJ7/+R6q1czUG0j9KSOTxDc6UhshZhMIQrS78mncwZtzErrNcYL6V2Zd0tJ6i7QFtAYPcvHv25W6J+/Y3BrRA/x6WGuGN5mpUjhyyfsGtrpKE95HoAAAAASUVORK5CYII=",DOWN_RIGHT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAMAAAAk2e+/AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAABXFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9jYfXuAAAAc3RSTlMAQ98Ox1j9gAtRNTqBPfgu9p/MTQ+G1Qfx7Y0VBYyJgjkGd3ysU+Zz1IQvMM20PgwBp8Mi4TSUiDvlPxylsaF2WfcjJh0S+wLzQLmY4l/ovX3ra1rPLAOSKa4RUEvgcZwbFHqPzodGbX7qPMvCtsEq1laguT+HEwAAAVlJREFUWMPt1sduwkAQgOGxDfFCIITe0nvvvZHee++992TeX4pJQIC9hPWaQ6T41x6skfY7WGPJAGZm/6qgZjIH4AMgOp2Lq32batTkdW/trPt9+qC70DVmSKS2BXF7A1fX9DDnN2FUSpe8y5hID3SZuJMmrcwmoSFm5vD0BDWSNTnCUmZoD1PZtJCDGfIgRUpBMjPkR4rEAwUtFIkHAkKRuCCaxAdRJE5IK/FCGumWF1JLEW5ILfFD2ST9UBaJA6JLPBCQ57xAJcp5NQbtSgBReJSsH8QI5No8ODo+u397ecL3T35IGhcRA4jig8E9qmjAX2OGnAV5ggrxr0ELOaByVmg6B1TGvEYyTvxcKUaMv/ii7xN/VAZYY2dfSHkkPOYY7Kpf7OmLzLfGPIFGd6izWrRUjdYt9Xfo+ULsLpgRKqGtGyadAEIUmnuhXSAwMAXD5j+omZlZRl+X30CWTm2dHwAAAABJRU5ErkJggg==",UP_LEFT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAMAAAAk2e+/AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAABLFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9PVkEkAAAAY3RSTlMAAQ/6Uc0OEAvHTzL7TcudsMHvdwnfUwMcG8UGiIfTrIkg9QI+/ZTDe460km73LNovCo1vQUuR4Lwk45/OK+3UERTkekziZlSK8QQnoOsFaaXmLqOylvPZLYDRZTUWUpiTDfAuEmiSAAABUklEQVRYw+3WZ2+DMBAG4EtTygrQ7NHsJt1777333vv+/38o6gIMSo0dqf3AK1lIZ/mRjPEJgCBBgvxtQr8WqDKbCiWUG1AnYXU7C7UJqKQSR5oKQwqIPphsYW24nEPjJCYXilf9F+G+qeTmThTP5w8X8gK9NLqOGMGPhD8fdXtBkGihlmlsmF5aqK2xg9FmQe3/DupuEhTpoT41z/V1HVHfxWRRo/6ORBfyjILx9mRo+2MDlS3ggF5q4uP9qzmVNjfOA+EDdDLcWA8IW6FJEJPkCbFI3hCDZEFVPsmC7mQuyYJ0iUuyIAG4JDvEJTkgHskJcUgExC6RECmxQ4REDa24ILsU6wL/rfYHskmX9C87Pfi9aA5cUmnRx/kffDmncSCkat7X342KSzOIuesNR1WSl7GU8Xfbbs9Gyoo0TvRp6Tie8d2TOsyx51UMEiQIS94B13oTqqYgGGoAAAAASUVORK5CYII=",DOWN_LEFT:"iVBORw0KGgoAAAANSUhEUgAAAEgAAAA6CAMAAAAk2e+/AAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+LUNEtwAAAARnQU1BAACxjwv8YQUAAAABc1JHQgCuzhzpAAABg1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8aT76cAAAAgHRSTlMAafwJfflezc+3WA7Z5Rk6PAvpBNE73kJT89QxZ48czNIv9A1DnI3qKQUaymjT4a7HdVuGf85LR20CVHr+tLBlA0GvYSTYZEnbAcazNPX4yB4GrAgnmL6Bcj4qIVKIe8kdVadIEe27B90bOG/3Er1rYJq1wibyh+4Q5CMzRllMXDo5euMAAAGfSURBVFjD7dblUwJBGAbw5aSlBJRGQERBkLC7u7u7u7veP90jDnaEcdhjP+k9X5h9Zu43O7PLe4eQECH/KGsIaUooOEcLK75LpehH628idSrE+nMANfyQ3MY2BRm0C6mM462tUwJAJtVyUB1WmsoSFZEk46D6TBcYS3UKPpCYawxD5VxHImVD/RHIxMQbGintkGQcppkcOkuutQPYfkDfmjck556ZTSydve2YY5UWk0Mww672VPh+XFqCU8tA+whtL+KOpa+bF3Rh8B4ymDNaSnSzG9IPIpsL34/HTPZfS58auMPYuYNMWcQXOsD3U9ZDOkZkkCvqwSIqUI2WfEDmgiQxRANiIp8GKtDLO6/Znw19oOdXhKoROtEUBr1F5Y9f4dt1XygqKgh6YqcHwMQkQBWICr1H6czTgrpoQde0IGnekJEWNEwLMv/GPDDB/M/fDioVeLYA5GqoYt+xNRY4toJkCiBUG7vTEVxJu2Z549RbqXQuba7uVDZWO66mgw6d7kYaEPvvCb+REIp/srGzLP4aa0n8zKFkKUSIkD+Qb9QrYMvxAbaBAAAAAElFTkSuQmCC"}},44:(e,t,n)=>{const{InstanceBase:i,runEntrypoint:o}=n(6278),r=n(3487),s=n(8384),a=n(9367),c=n(8404),l=n(7969),u=n(1632),d=n(6672),g=n(7413);o(class extends i{constructor(e){super(e),Object.assign(this,{...s,...a,...c,...l,...u,...d,...g}),this.DEVICE=null,this.DATA={deviceInformation:{},systemDateAndTime:{},services:{},serviceCapabilities:{},status:{},presets:[]},this.CHOICES_PRESETS=[{id:0,label:"(no presets loaded)"}]}async destroy(){}async init(e){this.configUpdated(e)}async configUpdated(e){this.updateStatus("connecting"),this.config=e,this.initActions(),this.initFeedbacks(),this.initVariables(),this.initPresets(),""!==this.config.host&&(this.updateStatus("Connecting"),this.initConnection()),this.checkVariables(),this.checkFeedbacks()}},r)},1632:(e,t,n)=>{const{combineRgb:i}=n(6278),o=n(4302);e.exports={initPresets:function(){let e={};e.cameraName={category:"System",type:"button",name:"Camera Name",style:{text:"$(onvif:cameraName)",size:"14",color:"16777215",bgcolor:i(0,0,0)},steps:[],feedbacks:[]},e.panTiltUp={category:"Pan/Tilt",type:"button",name:"UP",style:{style:"png",text:"",png64:o.UP,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltUp",options:{velocity:.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltDown={category:"Pan/Tilt",type:"button",name:"DOWN",style:{style:"png",text:"",png64:o.DOWN,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltDown",options:{velocity:-.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltLeft={category:"Pan/Tilt",type:"button",name:"LEFT",style:{style:"png",text:"",png64:o.LEFT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltLeft",options:{velocity:-.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltRight={category:"Pan/Tilt",type:"button",name:"RIGHT",style:{style:"png",text:"",png64:o.RIGHT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltRight",options:{velocity:.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltUpLeft={category:"Pan/Tilt",type:"button",name:"UP LEFT",style:{style:"png",text:"",png64:o.UP_LEFT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltUpLeft",options:{velocity_pan:-.5,velocity_tilt:.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltUpRight={category:"Pan/Tilt",type:"button",name:"UP RIGHT",style:{style:"png",text:"",png64:o.UP_RIGHT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltUpRight",options:{velocity_pan:.5,velocity_tilt:.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltDownLeft={category:"Pan/Tilt",type:"button",name:"DOWN LEFT",style:{style:"png",text:"",png64:o.DOWN_LEFT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltDownLeft",options:{velocity_pan:-.5,velocity_tilt:-.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltDownRight={category:"Pan/Tilt",type:"button",name:"DOWN RIGHT",style:{style:"png",text:"",png64:o.DOWN_RIGHT,pngalignment:"center:center",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"panTiltDownRight",options:{velocity_pan:.5,velocity_tilt:-.5}}],up:[{actionId:"panTiltStop",options:{}}]}],feedbacks:[]},e.panTiltHome={category:"Pan/Tilt",type:"button",name:"Home",style:{text:"HOME",size:"18",color:"16777215",bgcolor:i(0,0,0)},steps:[{down:[{actionId:"gotoHomePosition",options:{pan:.5,tilt:.5,zoom:.5}}],up:[]}],feedbacks:[]},this.setPresetDefinitions(e)}}},3487:e=>{e.exports=[function(e,t){return{updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}}]},7413:e=>{e.exports={}},7969:e=>{e.exports={initVariables:function(){let e=this,t=[];if(t.push({variableId:"manufacturer",name:"Manufacturer"}),t.push({variableId:"model",name:"Model"}),t.push({variableId:"firmwareVersion",name:"Firmware Version"}),t.push({variableId:"serialNumber",name:"Serial Number"}),t.push({variableId:"hardwareId",name:"Hardware ID"}),t.push({variableId:"ptzPosition_x",name:"PTZ Position X (Pan)"}),t.push({variableId:"ptzPosition_y",name:"PTZ Position Y (Tilt)"}),t.push({variableId:"ptzPosition_zoom",name:"PTZ Position Zoom"}),t.push({variableId:"movestatus_pantilt",name:"Move Status Pan/Tilt"}),t.push({variableId:"movestatus_zoom",name:"Move Status Zoom"}),t.push({variableId:"error_state",name:"Error State"}),t.push({variableId:"utc_time",name:"UTC Time"}),e.CHOICES_PRESETS.length>0&&0!==e.CHOICES_PRESETS[0].id)for(let n=0;n<e.CHOICES_PRESETS.length;n++)t.push({variableId:`preset_${n+1}`,name:`Preset ${n+1} Name`});e.setVariableDefinitions(t)},checkVariables:function(){let e=this;try{let t={};if(t.manufacturer=e.DATA?.deviceInformation?.manufacturer||"",t.model=e.DATA?.deviceInformation?.model||"",t.firmwareVersion=e.DATA?.deviceInformation?.firmwareVersion||"",t.serialNumber=e.DATA?.deviceInformation?.serialNumber||"",t.hardwareId=e.DATA?.deviceInformation?.hardwareId||"",t.ptzPosition_x=e.DATA?.status?.position?.x||"",t.ptzPosition_y=e.DATA?.status?.position?.y||"",t.ptzPosition_z=e.DATA?.status?.position?.zoom||"",t.movestatus_pantilt=e.DATA?.status?.moveStatus?.panTilt||"",t.movestatus_zoom=e.DATA?.status?.moveStatus?.zoom||"",t.error_state=e.DATA?.status?.error||"",t.utc_time=e.DATA?.status?.utcTime||"",e.CHOICES_PRESETS.length>0&&0!==e.CHOICES_PRESETS[0].id)for(let n=0;n<e.CHOICES_PRESETS.length;n++)t[`preset_${n+1}`]=e.CHOICES_PRESETS[n].label||"";e.setVariableValues(t)}catch(t){e.log("error","Error parsing Variables from Device: "+String(t)),console.log(t)}}}},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},1637:e=>{"use strict";e.exports=require("diagnostics_channel")},4434:e=>{"use strict";e.exports=require("events")},1943:e=>{"use strict";e.exports=require("fs/promises")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},264:e=>{"use strict";e.exports=require("inspector")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},3193:e=>{"use strict";e.exports=require("string_decoder")},3557:e=>{"use strict";e.exports=require("timers")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},4581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4326:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=void 0;const i=n(1635),o=n(9967),r=i.__importDefault(n(1943)),s=n(360),a=n(8737);n(4661);const c=n(4044),l=i.__importDefault(n(6928));let u,d=!1;t.runEntrypoint=function(e,t){Promise.resolve().then((async()=>{if(d)throw new Error("runEntrypoint can only be called once");d=!0;const n=process.env.MODULE_MANIFEST;if(!n)throw new Error("Module initialise is missing MODULE_MANIFEST");const i=await r.default.readFile(n),g=JSON.parse(i.toString());if(g.runtime?.api!==o.HostApiNodeJsIpc)throw new Error("Module manifest 'api' mismatch");if(!g.runtime.apiVersion)throw new Error("Module manifest 'apiVersion' missing");let p=g.runtime.apiVersion;if("0.0.0"===p)try{const e=await r.default.readFile(l.default.join(__dirname,"../package.json")),t=JSON.parse(e.toString());"@companion-module/base"===t.name&&(p=t.version)}catch(e){throw new Error("Failed to determine module api version")}if(!process.send)throw new Error("Module is not being run with ipc");console.log(`Starting up module class: ${e.name}`);const h=process.env.CONNECTION_ID;if("string"!=typeof h||!h)throw new Error("Module initialise is missing CONNECTION_ID");const m=process.env.VERIFICATION_TOKEN;if("string"!=typeof m||!m)throw new Error("Module initialise is missing VERIFICATION_TOKEN");const I=process.env.SENTRY_DSN,b=process.env.SENTRY_USERID,f=process.env.SENTRY_COMPANION_VERSION;I&&b&&"https://"==I.substring(0,8)?(console.log("Sentry enabled"),(0,a.init)({dsn:I,release:`${g.name}@${g.version}`,beforeSend:e=>(e.exception&&console.log("sentry","error",e.exception),e)}),(0,a.configureScope)((e=>{e.setUser({id:b}),e.setTag("companion",f)}))):console.log("Sentry disabled");const y=new c.IpcWrapper({},(e=>{process.send(e)}),5e3);process.once("message",(e=>{y.receivedMessage(e)})),u=new e((0,s.literal)({id:h,upgradeScripts:t,_isInstanceBaseProps:!0})),y.sendWithCb("register",{apiVersion:p,connectionId:h,verificationToken:m}).then((()=>{console.log("Module-host accepted registration")}),(e=>{console.error("Module registration failed",e),process.exit(11)}))})).catch((e=>{console.error("Failed to startup module:"),console.error(e.stack||e.message),process.exit(1)}))}},6160:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=t.TelnetHelper=t.TCPHelper=void 0;var i=n(8895);Object.defineProperty(t,"TCPHelper",{enumerable:!0,get:function(){return i.TCPHelper}});var o=n(1118);Object.defineProperty(t,"TelnetHelper",{enumerable:!0,get:function(){return o.TelnetHelper}});var r=n(6259);Object.defineProperty(t,"UDPHelper",{enumerable:!0,get:function(){return r.UDPHelper}})},8895:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCPHelper=void 0;const i=n(1635).__importDefault(n(9278)),o=n(228),r=n(1400);class s extends o.EventEmitter{#e;#t;_socket;#n;#i=!1;#o=!1;#r=!1;#s;#a;get isConnected(){return this.#i}get isConnecting(){return this.#o}get isDestroyed(){return this.#r}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={reconnect_interval:2e3,reconnect:!0,...n},this._socket=new i.default.Socket,this._socket.setKeepAlive(!0),this._socket.setNoDelay(!0),this._socket.on("error",(e=>{this.#o=!1,this.#i=!1,this.#n.reconnect&&this.#c(),this.#l(r.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this._socket.on("ready",(()=>{this.#i=!0,this.#o=!1,this.#l(r.InstanceStatus.Ok),this.emit("connect")})),this._socket.on("end",(()=>{this.#i=!1,this.#l(r.InstanceStatus.Disconnected),!this.#o&&this.#n.reconnect&&this.#c(),this.emit("end")})),this._socket.on("data",(e=>this.emit("data",e))),this._socket.on("drain",(()=>this.emit("drain"))),setImmediate((()=>this.connect())),setTimeout((()=>{this.#r||this.listenerCount("error")||console.error(`Danger: TCP client for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}connect(){if(this.#r)throw new Error("Cannot connect destroyed socket");return!this.#o&&(this.#o=!0,this._socket.connect(this.#t,this.#e),!0)}async send(e){if(this.#r||this._socket.destroyed)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");if(!this.#i)return!1;try{return new Promise(((t,n)=>{this._socket.write(e,(e=>{e?n(e):t(!0)}))}))}catch(e){this.#i=!1;const t=e instanceof Error?e:new Error(`${e}`);throw this.#l(r.InstanceStatus.UnknownError,t.message),this.emit("error",t),t}}destroy(){this.#r=!0,void 0!==this.#a&&clearTimeout(this.#a),this._socket.removeAllListeners(),this.removeAllListeners(),this._socket.destroy()}#c(){void 0!==this.#a&&clearTimeout(this.#a),this.#a=setTimeout((()=>{this.#a=void 0,this.#l(r.InstanceStatus.Connecting),this.connect()}),this.#n.reconnect_interval)}#l(e,t){this.#s!=e&&(this.#s=e,this.emit("status_change",e,t))}}t.TCPHelper=s},1118:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelnetHelper=void 0;const i=n(1635).__importDefault(n(228)),o=n(2203),r=n(8895);class s extends i.default{#u;#d;get isConnected(){return this.#u.isConnected}get isConnecting(){return this.#u.isConnecting}get isDestroyed(){return this.#u.isDestroyed}constructor(e,t,n){super(),this.#u=new r.TCPHelper(e,t,n),this.#d=new a,this.#u._socket.pipe(this.#d),this.#u.on("connect",(()=>this.emit("connect"))),this.#u.on("end",(()=>this.emit("end"))),this.#u.on("error",(e=>this.emit("error",e))),this.#u.on("status_change",((e,t)=>this.emit("status_change",e,t))),this.#d.on("iac",((e,t)=>this.emit("iac",e,t))),this.#d.on("sb",(e=>this.emit("sb",e))),this.#d.on("data",(e=>this.emit("data",e))),this.#d.on("drain",(()=>this.emit("drain"))),setTimeout((()=>{this.isDestroyed||this.listenerCount("error")||console.error(`Danger: Telnet client for ${e}:${t} is missing an error handler!`)}),5e3)}connect(){return this.#u.connect()}async send(e){return this.#u.send(e)}destroy(){this.#u.destroy(),this.#d.removeAllListeners(),this.#d.destroy()}}t.TelnetHelper=s;class a extends o.Transform{#g;#p;#h;constructor(e){super(e),this.#g=Buffer.alloc(0),this.#p=Buffer.alloc(0),this.#h=0}_transform(e,t,n){for(let t=0;t<e.length;++t)this.#m(e[t]);const i=this.#I();i.length&&this.push(i),n()}#m(e){if(0===this.#h){if(255===e)return void(this.#h=255);this.#g=Buffer.concat([this.#g,Buffer.from([e])])}else if(255===this.#h)switch(e){case 250:case 251:case 252:case 253:case 254:this.#h=e;break;default:this.#h=0}else{if(this.#h>=251&&this.#h<=254){let t;switch(this.#h){case 251:t="WILL";break;case 252:t="WONT";break;case 253:t="DO";break;case 254:t="DONT";break;default:return}return this.emit("iac",t,e),void(this.#h=0)}if(250===this.#h){if(240===e)return this.emit("sb",this.#p),this.#h=0,void(this.#p=Buffer.alloc(0));this.#p=Buffer.concat([this.#p,Buffer.from([e])])}}}#I(){const e=this.#g;return this.#g=Buffer.alloc(0),e}}},6259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UDPHelper=void 0;const i=n(1635).__importDefault(n(7194)),o=n(228),r=n(1400);class s extends o.EventEmitter{#e;#t;#b;#n;#r=!1;#s;get isDestroyed(){return this.#r}constructor(e,t,n){super(),this.#e=e,this.#t=t,this.#n={...n},this.#b=i.default.createSocket("udp4");try{this.#b.bind(this.#n.bind_port||0,this.#n.bind_ip)}catch(e){throw new Error(`Unable to bind to ip/port: ${this.#n.bind_ip}:${this.#n.bind_port}`)}this.#n.broadcast&&this.#b.setBroadcast(!0),void 0!==this.#n.ttl&&this.#b.setTTL(this.#n.ttl),void 0!==this.#n.multicast_ttl&&this.#b.setMulticastTTL(this.#n.multicast_ttl),this.#b.on("error",(e=>{this.#l(r.InstanceStatus.UnknownError,e.message),this.emit("error",e)})),this.#b.on("listening",(()=>{this.#n.multicast_interface&&this.#b.setMulticastInterface(this.#n.multicast_interface),this.#l(r.InstanceStatus.Ok),this.emit("listening")})),this.#b.on("message",(e=>this.emit("data",e))),setTimeout((()=>{this.#r||this.listenerCount("error")||console.error(`Danger: UDP socket for ${this.#e}:${this.#t} is missing an error handler!`)}),5e3)}async send(e){if(this.#r)throw new Error("Cannot write to destroyed socket");if(!e||!e.length)throw new Error("No message to send");return new Promise(((t,n)=>{this.#b.send(e,this.#t,this.#e,(e=>{e?n(e):t()}))}))}destroy(){this.#r=!0,this.#b.removeAllListeners(),this.#b.close(),this.removeAllListeners()}#l(e,t){this.#s!=e&&(this.#s=e,this.emit("status_change",e,t))}}t.UDPHelper=s},4044:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcWrapper=void 0;const i=n(1635),o=n(360),r=i.__importDefault(n(6022));t.IpcWrapper=class{#f;#y;#C;#v=1;#A=new Map;constructor(e,t,n){this.#f=e,this.#y=t,this.#C=n}async sendWithCb(e,t,n,i=0){i<=0&&(i=this.#C);const o={timeout:void 0,resolve:()=>null,reject:()=>null},s=new Promise(((e,t)=>{o.resolve=e,o.reject=t}));this.#v>268435456&&(this.#v=1);const a=this.#v++;this.#A.set(a,o),this.#y({direction:"call",name:String(e),payload:r.default.stringify(t),callbackId:a});const c=new Error("Call timed out");return o.timeout=setTimeout((()=>{o.reject(n?n():c),this.#A.delete(a)}),i),s}sendWithNoCb(e,t){this.#y({direction:"call",name:String(e),payload:r.default.stringify(t),callbackId:void 0})}receivedMessage(e){const t=e;switch(e.direction){case"call":{const t=this.#f[e.name];if(!t)return void(e.callbackId&&this.#y({direction:"response",callbackId:e.callbackId,success:!1,payload:r.default.stringify({message:`Unknown command "${e.name}"`})}));t(e.payload?r.default.parse(e.payload):void 0).then((t=>{e.callbackId&&this.#y({direction:"response",callbackId:e.callbackId,success:!0,payload:r.default.stringify(t)})}),(t=>{e.callbackId&&this.#y({direction:"response",callbackId:e.callbackId,success:!1,payload:t instanceof Error?JSON.stringify(t,Object.getOwnPropertyNames(t)):r.default.stringify(t)})}));break}case"response":{if(!e.callbackId)return void console.error("Ipc: Response message has no callbackId");const t=this.#A.get(e.callbackId);if(this.#A.delete(e.callbackId),!t)return;clearTimeout(t.timeout);const n=e.payload?r.default.parse(e.payload):void 0;if(e.success)t.resolve(n);else{let e=n;n&&"message"in n&&(e=new Error(n.message),n.stack&&(e.stack=n.stack)),t.reject(e)}break}default:(0,o.assertNever)(e),console.error(`Ipc: Message of unknown direction "${t.direction}"`)}}}},9967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HostApiNodeJsIpc=void 0,t.HostApiNodeJsIpc="nodejs-ipc"},6278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runEntrypoint=t.assertNever=t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.literal=void 0;const i=n(1635);i.__exportStar(n(9077),t),i.__exportStar(n(2018),t),i.__exportStar(n(4581),t);var o=n(360);Object.defineProperty(t,"literal",{enumerable:!0,get:function(){return o.literal}}),Object.defineProperty(t,"combineRgb",{enumerable:!0,get:function(){return o.combineRgb}}),Object.defineProperty(t,"splitRgb",{enumerable:!0,get:function(){return o.splitRgb}}),Object.defineProperty(t,"splitHsl",{enumerable:!0,get:function(){return o.splitHsl}}),Object.defineProperty(t,"splitHsv",{enumerable:!0,get:function(){return o.splitHsv}}),Object.defineProperty(t,"splitHex",{enumerable:!0,get:function(){return o.splitHex}}),Object.defineProperty(t,"assertNever",{enumerable:!0,get:function(){return o.assertNever}}),i.__exportStar(n(6160),t);var r=n(4326);Object.defineProperty(t,"runEntrypoint",{enumerable:!0,get:function(){return r.runEntrypoint}})},4289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionManager=void 0;const i=n(2593);function o(e){return{id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options}}t.ActionManager=class{#Z;#G;#B;#w=new Map;#S=new Map;constructor(e,t,n){this.#Z=e,this.#G=t,this.#B=n}async handleExecuteAction(e){const t=this.#w.get(e.action.actionId);if(!t)throw new Error(`Unknown action: ${e.action.actionId}`);const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};await t.callback({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:e.surfaceId},n)}handleUpdateActions(e){for(const[t,n]of Object.entries(e)){const e=this.#S.get(t);if(e){const t=this.#w.get(e.actionId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(o(e),n)).catch((t=>{this.#B("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#S.delete(t);else{this.#S.set(t,n);const e=this.#w.get(n.actionId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#Z({text:e,controlId:n.controlId,actionInstanceId:n.id,feedbackInstanceId:void 0})).text};Promise.resolve(e.subscribe(o(n),t)).catch((e=>{this.#B("error",`Action subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}}}}async handleLearnAction(e){const t=this.#w.get(e.action.actionId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.action.controlId,actionInstanceId:e.action.id,feedbackInstanceId:void 0})).text};return{options:await t.learn({id:e.action.id,actionId:e.action.actionId,controlId:e.action.controlId,options:e.action.options,surfaceId:void 0},n)}}return{options:void 0}}setActionDefinitions(e){const t=[];this.#w.clear();for(const[n,o]of Object.entries(e))o&&(t.push({id:n,name:o.name,description:o.description,options:(0,i.serializeIsVisibleFn)(o.options),hasLearn:!!o.learn,learnTimeout:o.learnTimeout}),this.#w.set(n,o));this.#G({actions:t})}_getAllActions(){return Array.from(this.#S.values()).map((e=>({id:e.id,actionId:e.actionId,controlId:e.controlId,options:e.options})))}subscribeActions(e){let t=Array.from(this.#S.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#w.get(e.actionId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.subscribe(o(e),n)).catch((t=>{this.#B("error",`Action subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeActions(e){let t=Array.from(this.#S.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.actionId))));for(const e of t){const t=this.#w.get(e.actionId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:e.id,feedbackInstanceId:void 0})).text};Promise.resolve(t.unsubscribe(o(e),n)).catch((t=>{this.#B("error",`Action unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},2593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceBaseProps=t.serializeIsVisibleFn=void 0,t.serializeIsVisibleFn=function(e){return(e??[]).map((e=>"isVisible"in e&&"function"==typeof e.isVisible?{...e,isVisibleFn:e.isVisible.toString(),isVisible:void 0}:{...e,isVisibleFn:void 0}))},t.isInstanceBaseProps=function(e){const t=e;return"object"==typeof t&&"string"==typeof t.id&&!0===t._isInstanceBaseProps}},8039:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FeedbackManager=void 0;const i=n(1635),o=n(2593),r=i.__importDefault(n(7e3));function s(e,t){return{type:e,id:t.id,feedbackId:t.feedbackId,controlId:t.controlId,options:t.options}}t.FeedbackManager=class{#Z;#V;#W;#B;#R=new Map;#T=new Map;#N=new Map;#_=new Map;#H;get parseVariablesContext(){return this.#H}constructor(e,t,n,i){this.#Z=e,this.#V=t,this.#W=n,this.#B=i}getDefinitionIds(){return Array.from(this.#R.keys())}getInstanceIds(){return Array.from(this.#T.keys())}handleUpdateFeedbacks(e){for(const[t,n]of Object.entries(e)){const e=this.#T.get(t);if(e){const t=this.#R.get(e.feedbackId);if(t?.unsubscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(s(t.type,e),n)).catch((t=>{this.#B("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}if(!n||n.disabled)this.#T.delete(t);else{this.#T.set(t,{...n,referencedVariables:null});const e=this.#R.get(n.feedbackId);if(e?.subscribe){const t={parseVariablesInString:async e=>(await this.#Z({text:e,controlId:n.controlId,actionInstanceId:void 0,feedbackInstanceId:n.id})).text};Promise.resolve(e.subscribe(s(e.type,n),t)).catch((e=>{this.#B("error",`Feedback subscribe failed: ${JSON.stringify(n)} - ${e?.message??e} ${e?.stack}`)}))}this.#k(t)}}}async handleLearnFeedback(e){const t=this.#R.get(e.feedback.feedbackId);if(t&&t.learn){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.feedback.controlId,actionInstanceId:void 0,feedbackInstanceId:e.feedback.id})).text};return{options:await t.learn({id:e.feedback.id,feedbackId:e.feedback.feedbackId,controlId:e.feedback.controlId,options:e.feedback.options,type:t.type},n)}}return{options:void 0}}handleVariablesChanged(e){if(!e.variablesIds.length)return;const t=new Set(e.variablesIds);for(const t of this.#_.values())for(const n of e.variablesIds)t.changedVariables.add(n);const n=new Set;for(const e of this.#T.values())if(!this.#_.has(e.id)&&e.referencedVariables)for(const i of e.referencedVariables)if(t.has(i)){n.add(e.id);break}for(const e of n)setImmediate((()=>{this.#k(e)}))}#k(e){const t=this.#_.get(e);if(t)return void(t.needsRecheck=!0);const n=this.#T.get(e);if(!n)return;const i=n,o={needsRecheck:!1,changedVariables:new Set};this.#_.set(e,o),Promise.resolve().then((async()=>{const t=this.#R.get(i.feedbackId);let n;const o=new Set;if(t){this.#H=`Feedback ${i.feedbackId} (${e})`;const r={parseVariablesInString:async t=>{const n=await this.#Z({text:t,controlId:i.controlId,actionInstanceId:void 0,feedbackInstanceId:e});if(n.variableIds&&n.variableIds.length)for(const e of n.variableIds)o.add(e);return n.text}};n="boolean"===t.type?t.callback({...s("boolean",i),type:"boolean"},r):t.callback({...s("advanced",i),type:"advanced",image:i.image},r),this.#H=void 0}const r=await n;this.#N.set(e,{id:e,controlId:i.controlId,value:r}),this.#Y(),i.referencedVariables=o.size>0?Array.from(o):null})).catch((e=>{console.error(`Feedback check failed: ${JSON.stringify(i)} - ${e?.message??e} ${e?.stack}`)})).finally((()=>{this.#H=void 0,this.#_.delete(e);let t=!1;if(i.referencedVariables)for(const e of i.referencedVariables)if(o.changedVariables.has(e)){t=!0;break}(t||o.needsRecheck)&&setImmediate((()=>{this.#k(e)}))}))}#Y=(0,r.default)((()=>{const e=this.#N;this.#N=new Map,e.size>0&&this.#V({values:Array.from(e.values())})}),{wait:5,maxWait:25});setFeedbackDefinitions(e){const t=[];this.#R.clear();for(const[n,i]of Object.entries(e))i&&(t.push({id:n,name:i.name,description:i.description,options:(0,o.serializeIsVisibleFn)(i.options),type:i.type,defaultStyle:"boolean"===i.type?i.defaultStyle:void 0,hasLearn:!!i.learn,learnTimeout:i.learnTimeout,showInvert:"boolean"===i.type&&i.showInvert}),this.#R.set(n,i));this.#W({feedbacks:t})}checkFeedbacks(e){const t=new Set(e);for(const[e,n]of this.#T.entries())this.#R.get(n.feedbackId)&&(0===t.size||t.has(n.feedbackId))&&this.#k(e)}checkFeedbacksById(e){for(const t of e)this.#k(t)}_getAllFeedbacks(){return Array.from(this.#T.values()).map((e=>({id:e.id,feedbackId:e.feedbackId,controlId:e.controlId,options:e.options})))}subscribeFeedbacks(e){let t=Array.from(this.#T.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#R.get(e.feedbackId);if(t?.subscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.subscribe(s(t.type,e),n)).catch((t=>{this.#B("error",`Feedback subscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}unsubscribeFeedbacks(e){let t=Array.from(this.#T.values());const n=new Set(e);n.size&&(t=t.filter((e=>n.has(e.feedbackId))));for(const e of t){const t=this.#R.get(e.feedbackId);if(t&&t.unsubscribe){const n={parseVariablesInString:async t=>(await this.#Z({text:t,controlId:e.controlId,actionInstanceId:void 0,feedbackInstanceId:e.id})).text};Promise.resolve(t.unsubscribe(s(t.type,e),n)).catch((t=>{this.#B("error",`Feedback unsubscribe failed: ${JSON.stringify(e)} - ${t?.message??t} ${t?.stack}`)}))}}}}},1706:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runThroughUpgradeScripts=void 0;const i=n(360);function o(e){return JSON.parse(JSON.stringify(e))}t.runThroughUpgradeScripts=function(e,t,n,r,s,a){const c=new Map,l=e=>{let t=c.get(e);return t||(t={actions:[],feedbacks:[],config:!1},c.set(e,t)),t};for(const t of Object.values(e)){const e=t?.upgradeIndex??n;t&&"number"==typeof e&&l(e).actions.push(t.id)}for(const e of Object.values(t)){const t=e?.upgradeIndex??n;e&&"number"==typeof t&&l(t).feedbacks.push(e.id)}if(!a)for(let e=n??-1;e<r.length;e++)l(e).config=!0;const u={},d={};let g;if(c.size>0){const a=Array.from(c.keys()).sort(),l=Math.min(...a,n??-1)+1,p=[],h=[],m=r.length;for(let n=l;n<m;n++){const a=c.get(n-1);a&&(p.push(...a.actions),h.push(...a.feedbacks));const l=!!a?.config;if(!l&&0===p.length&&0===h.length)continue;const m=g??s,I=(0,r[n])({currentConfig:o(m)},{config:l?m:null,actions:p.map((t=>{const n=e[t];if(n)return(0,i.literal)({id:n.id,controlId:n.controlId,actionId:n.actionId,options:void 0!==n.options?o(n.options):{}})})).filter((e=>!!e)),feedbacks:h.map((e=>{const n=t[e];if(n)return(0,i.literal)({id:n.id,controlId:n.controlId,feedbackId:n.feedbackId,options:void 0!==n.options?o(n.options):{},isInverted:n.isInverted})})).filter((e=>!!e))});l&&I.updatedConfig&&(g=I.updatedConfig);for(const t of I.updatedActions)if(t){const n=e[t.id];n&&(n.actionId=t.actionId,n.options=t.options,d[t.id]=n)}for(const e of I.updatedFeedbacks)if(e){const n=t[e.id];n&&(n.feedbackId=e.feedbackId,n.options=e.options,u[e.id]={...n,style:u[e.id]?.style??e.style,isInverted:e.isInverted??!1})}}for(const[t,n]of Object.entries(e))d[t]||"number"!=typeof n?.upgradeIndex||(d[t]=n);for(const[e,n]of Object.entries(t))u[e]||"number"!=typeof n?.upgradeIndex||(u[e]=n)}return{updatedActions:d,updatedFeedbacks:u,updatedConfig:g}}},9077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateManifest=void 0;const i=n(1635).__importDefault(n(7281));t.validateManifest=function(e){const t=JSON.stringify(e);if(t.includes("companion-module-your-module-name"))throw new Error("Manifest incorrectly references template module 'companion-module-your-module-name'");if(t.includes("module-shortname"))throw new Error("Manifest incorrectly references template module 'module-shortname'");if(t.includes("A short one line description of your module"))throw new Error("Manifest incorrectly references template module 'A short one line description of your module'");if(t.includes("Your name"))throw new Error("Manifest incorrectly references template module 'Your name'");if(t.includes("Your email"))throw new Error("Manifest incorrectly references template module 'Your email'");if(t.includes("Your company"))throw new Error("Manifest incorrectly references template module 'Your company'");if(t.includes("Your product"))throw new Error("Manifest incorrectly references template module 'Your product'");if(!(0,i.default)(e)){const e=i.default.errors;if(!e)throw new Error("Manifest failed validation with unknown reason");throw new Error(`Manifest validation failed: ${JSON.stringify(e)}`)}}},3730:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstanceBase=void 0;const i=n(1635),o=n(360),r=i.__importDefault(n(3290)),s=n(2593),a=n(1706),c=n(8039),l=n(4044),u=n(4289);t.InstanceBase=class{#X;#F;id;#x=new r.default({concurrency:1});#E=!1;#J=!1;#K={};#P;#z;#U=new Map;#O=new Map;#n;#L;get instanceOptions(){return this.#n}get label(){return this.#L}constructor(e){if(!(0,s.isInstanceBaseProps)(e)||!e._isInstanceBaseProps)throw new Error("Module instance is being constructed incorrectly. Make sure you aren't trying to do this manually");this.#n={disableVariableValidation:!1},this.#X=new l.IpcWrapper({init:this._handleInit.bind(this),destroy:this._handleDestroy.bind(this),updateConfigAndLabel:this._handleConfigUpdateAndLabel.bind(this),updateConfig:async()=>{},executeAction:this._handleExecuteAction.bind(this),updateFeedbacks:this._handleUpdateFeedbacks.bind(this),updateActions:this._handleUpdateActions.bind(this),getConfigFields:this._handleGetConfigFields.bind(this),handleHttpRequest:this._handleHttpRequest.bind(this),learnAction:this._handleLearnAction.bind(this),learnFeedback:this._handleLearnFeedback.bind(this),startStopRecordActions:this._handleStartStopRecordActions.bind(this),variablesChanged:this._handleVariablesChanged.bind(this)},(e=>{process.send(e)}),5e3),process.on("message",(e=>{this.#X.receivedMessage(e)})),this.#P=new u.ActionManager((async e=>this.#X.sendWithCb("parseVariablesInString",e)),(e=>this.#X.sendWithNoCb("setActionDefinitions",e)),this.log.bind(this)),this.#z=new c.FeedbackManager((async e=>this.#X.sendWithCb("parseVariablesInString",e)),(e=>this.#X.sendWithNoCb("updateFeedbackValues",e)),(e=>this.#X.sendWithNoCb("setFeedbackDefinitions",e)),this.log.bind(this)),this.#F=e.upgradeScripts,this.id=e.id,this.#L=e.id,this.log("debug","Initializing")}async _handleInit(e){return this.#x.add((async()=>{if(this.#E)throw new Error("Already initialized");const t=e.actions,n=e.feedbacks;if(this.#K=e.config,this.#L=e.label,e.isFirstInit){const t={},n=this.getConfigFields();for(const e of n)"default"in e&&(t[e.id]=e.default);this.#K=t,this.saveConfig(this.#K),e.lastUpgradeIndex=this.#F.length-1}const{updatedActions:i,updatedFeedbacks:o,updatedConfig:r}=(0,a.runThroughUpgradeScripts)(t,n,e.lastUpgradeIndex,this.#F,this.#K,!1);this.#K=r??this.#K;const s=this.#X.sendWithCb("upgradedItems",{updatedActions:i,updatedFeedbacks:o});try{await this.init(this.#K,!!e.isFirstInit),this.#E=!0}catch(e){throw console.trace(`Init failed: ${e}`),e}finally{await s}return setImmediate((()=>{this._handleUpdateActions({actions:t},!0).catch((e=>{this.log("error",`Receive actions failed: ${e}`)})),this._handleUpdateFeedbacks({feedbacks:n},!0).catch((e=>{this.log("error",`Receive feedbacks failed: ${e}`)}))})),{hasHttpHandler:"function"==typeof this.handleHttpRequest,hasRecordActionsHandler:"function"==typeof this.handleStartStopRecordActions,newUpgradeIndex:this.#F.length-1,updatedConfig:this.#K}}))}async _handleDestroy(){await this.#x.add((async()=>{if(!this.#E)throw new Error("Not initialized");await this.destroy(),this.#E=!1}))}async _handleConfigUpdateAndLabel(e){await this.#x.add((async()=>{if(!this.#E)throw new Error("Not initialized");this.#L=e.label,this.#K=e.config,await this.configUpdated(this.#K)}))}async _handleExecuteAction(e){return this.#P.handleExecuteAction(e)}async _handleUpdateFeedbacks(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)({},e.feedbacks,null,this.#F,this.#K,!0);this.#X.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded feedbacks: ${e}`)}))}this.#z.handleUpdateFeedbacks(e.feedbacks)}async _handleUpdateActions(e,t){if(!t){const t=(0,a.runThroughUpgradeScripts)(e.actions,{},null,this.#F,this.#K,!0);this.#X.sendWithCb("upgradedItems",{updatedActions:t.updatedActions,updatedFeedbacks:t.updatedFeedbacks}).catch((e=>{this.log("error",`Failed to save upgraded actions: ${e}`)}))}this.#P.handleUpdateActions(e.actions)}async _handleGetConfigFields(e){return{fields:(0,s.serializeIsVisibleFn)(this.getConfigFields())}}async _handleHttpRequest(e){if(!this.handleHttpRequest)throw new Error("handleHttpRequest is not supported!");return{response:await this.handleHttpRequest(e.request)}}async _handleLearnAction(e){return this.#P.handleLearnAction(e)}async _handleLearnFeedback(e){return this.#z.handleLearnFeedback(e)}async _handleStartStopRecordActions(e){if(e.recording){if(this.#J)return}else if(!this.#J)return;if(!this.handleStartStopRecordActions)throw this.#J=!1,new Error("Recording actions is not supported by this module!");this.#J=e.recording,this.handleStartStopRecordActions(this.#J)}async _handleVariablesChanged(e){this.#z.handleVariablesChanged(e)}saveConfig(e){this.#K=e,this.#X.sendWithNoCb("saveConfig",{config:e})}setActionDefinitions(e){this.#P.setActionDefinitions(e)}setFeedbackDefinitions(e){this.#z.setFeedbackDefinitions(e)}setPresetDefinitions(e){const t=[];for(const[n,i]of Object.entries(e))i&&t.push({...i,id:n});this.#X.sendWithNoCb("setPresetDefinitions",{presets:t})}setVariableDefinitions(e){const t=[],n=[];this.#U.clear();for(const i of e)t.push({id:i.variableId,name:i.name}),this.#U.set(i.variableId,i),this.#O.has(i.variableId)||(this.#O.set(i.variableId,""),n.push({id:i.variableId,value:""}));if(!this.#n.disableVariableValidation){const e=new Set(this.#U.keys());for(const t of this.#O.keys())e.has(t)||(this.#O.delete(t),n.push({id:t,value:void 0}))}this.#X.sendWithNoCb("setVariableDefinitions",{variables:t,newValues:n})}setVariableValues(e){const t=[];for(const[n,i]of Object.entries(e))this.#n.disableVariableValidation?(void 0===i?this.#O.delete(n):this.#O.set(n,i),t.push({id:n,value:i})):this.#U.has(n)?(this.#O.set(n,i??""),t.push({id:n,value:i??""})):t.push({id:n,value:void 0});this.#X.sendWithNoCb("setVariableValues",{newValues:t})}getVariableValue(e){return this.#O.get(e)}async parseVariablesInString(e){const t=this.#z.parseVariablesContext;return t&&this.log("debug",`parseVariablesInString called while in: ${t}. You should use the parseVariablesInString provided to the callback instead`),(await this.#X.sendWithCb("parseVariablesInString",{text:e,controlId:void 0,actionInstanceId:void 0,feedbackInstanceId:void 0})).text}checkFeedbacks(...e){this.#z.checkFeedbacks(e)}checkFeedbacksById(...e){this.#z.checkFeedbacksById(e)}_getAllActions(){return this.#P._getAllActions()}subscribeActions(...e){this.#P.subscribeActions(e)}unsubscribeActions(...e){this.#P.unsubscribeActions(e)}_getAllFeedbacks(){return this.#z._getAllFeedbacks()}subscribeFeedbacks(...e){this.#z.subscribeFeedbacks(e)}unsubscribeFeedbacks(...e){this.#z.unsubscribeFeedbacks(e)}recordAction(e,t){if(!this.#J)throw new Error("Not currently recording actions");this.#X.sendWithNoCb("recordAction",{uniquenessId:t??null,actionId:e.actionId,options:e.options})}setCustomVariableValue(e,t){this.#X.sendWithNoCb("setCustomVariable",{customVariableId:e,value:t})}oscSend(e,t,n,i){this.#X.sendWithNoCb("send-osc",(0,o.literal)({host:e,port:t,path:n,args:i}))}updateStatus(e,t){this.#X.sendWithNoCb("set-status",(0,o.literal)({status:e,message:t??null}))}log(e,t){this.#X.sendWithNoCb("log-message",(0,o.literal)({level:e,message:t}))}}},7386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1400:(e,t)=>{"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Regex=t.InstanceStatus=void 0,(i=t.InstanceStatus||(t.InstanceStatus={})).Ok="ok",i.Connecting="connecting",i.Disconnected="disconnected",i.ConnectionFailure="connection_failure",i.BadConfig="bad_config",i.UnknownError="unknown_error",i.UnknownWarning="unknown_warning",(n=t.Regex||(t.Regex={})).IP="/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/",n.HOSTNAME="/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$/",n.BOOLEAN="/^(true|false|0|1)$/i",n.PORT="/^([1-9]|[1-8][0-9]|9[0-9]|[1-8][0-9]{2}|9[0-8][0-9]|99[0-9]|[1-8][0-9]{3}|9[0-8][0-9]{2}|99[0-8][0-9]|999[0-9]|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-4])$/",n.MAC_ADDRESS="/^(?:[a-fA-F0-9]{2}:){5}([a-fA-F0-9]{2})$/",n.PERCENT="/^(100|[0-9]|[0-9][0-9])$/",n.FLOAT="/^([0-9]*\\.)?[0-9]+$/",n.SIGNED_FLOAT="/^[+-]?([0-9]*\\.)?[0-9]+$/",n.FLOAT_OR_INT="/^([0-9]+)(\\.[0-9]+)?$/",n.NUMBER="/^\\d+$/",n.SIGNED_NUMBER="/^[+-]?\\d+$/",n.SOMETHING="/^.+$/",n.TIMECODE="/^(0*[0-9]|1[0-9]|2[0-4]):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[1-5][0-9]|60):(0*[0-9]|[12][0-9]|30)$/"},8983:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8104:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2018:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(1635);i.__exportStar(n(3730),t),i.__exportStar(n(1649),t),i.__exportStar(n(7386),t),i.__exportStar(n(1400),t),i.__exportStar(n(8983),t),i.__exportStar(n(8104),t),i.__exportStar(n(3258),t),i.__exportStar(n(131),t),i.__exportStar(n(3371),t),i.__exportStar(n(9786),t),i.__exportStar(n(6132),t)},3258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3371:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9786:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=t.CreateConvertToBooleanFeedbackUpgradeScript=t.EmptyUpgradeScript=void 0,t.EmptyUpgradeScript=()=>({updatedConfig:null,updatedActions:[],updatedFeedbacks:[]}),t.CreateConvertToBooleanFeedbackUpgradeScript=function(e){return(t,n)=>{const i=[];for(const t of n.feedbacks){let n=e[t.feedbackId];if(!0===n&&(n={bg:"bgcolor",bgcolor:"bgcolor",fg:"color",color:"color",png64:"png64",png:"png64"}),n){t.style||(t.style={});for(const[e,o]of Object.entries(n))void 0!==t.options[e]&&(t.style[o]=t.options[e],delete t.options[e],i.push(t))}}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:i}}},t.CreateUseBuiltinInvertForFeedbacksUpgradeScript=function(e){return(t,n)=>{const i=[];for(const t of n.feedbacks){const n=e[t.feedbackId];if("string"!=typeof n)continue;const o=t.options[n];void 0!==o&&(delete t.options[n],t.isInverted="true"===o||!0===o||Number(o)>0,i.push(t))}return{updatedConfig:null,updatedActions:[],updatedFeedbacks:i}}}},6132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},360:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitHex=t.splitHsv=t.splitHsl=t.splitRgb=t.combineRgb=t.assertNever=t.literal=void 0;const i=n(6284);function o(e){if("number"==typeof e)return e>16777215?{r:e>>16&255,g:e>>8&255,b:255&e,a:(255-(e>>24&255))/255}:{r:e>>16&255,g:e>>8&255,b:255&e,a:1};if("string"==typeof e&&(0,i.colord)(e).isValid()){const t=(0,i.colord)(e).toRgb();return{r:t.r,g:t.g,b:t.b,a:t.a}}return{r:0,g:0,b:0,a:1}}t.literal=function(e){return e},t.assertNever=function(e){},t.combineRgb=function(e,t,n,i){let o=(255&e)<<16|(255&t)<<8|255&n;return i&&i>=0&&i<1&&(o+=16777216*Math.round(255*(1-i))),o},t.splitRgb=o,t.splitHsl=function(e){const t=o(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsl()},t.splitHsv=function(e){const t=o(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHsv()},t.splitHex=function(e){const t=o(e);return(0,i.colord)(`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`).toHex()}},7281:(e,t,n)=>{"use strict";e.exports=a,e.exports.default=a;const i={$schema:"http://json-schema.org/draft-07/schema#",type:"object",title:"ModuleManifest",properties:{$schema:{type:"string"},id:{type:"string",description:"Unique identifier for the module"},name:{type:"string",description:"Name of the module"},shortname:{type:"string"},description:{type:"string",description:"Description of the module "},version:{type:"string",description:"Current version of the module"},license:{type:"string",description:"SPDX identifier for license of the module"},repository:{type:"string",description:"URL to the source repository"},bugs:{type:"string",description:"URL to bug tracker"},maintainers:{type:"array",description:"List of active maintiners",uniqueItems:!0,items:{type:"object",title:"ModuleManifestMaintainer",properties:{name:{type:"string"},email:{type:"string"},github:{type:"string"}},required:["name"]}},legacyIds:{type:"array",description:"If the module had a different unique identifier previously, then specify it here",uniqueItems:!0,items:{type:"string"}},runtime:{type:"object",title:"ModuleManifestRuntime",description:"Information on how to execute the module",properties:{type:{type:"string",description:"Type of the module. Must be: node18"},api:{type:"string",description:"Which host-api does it use. In the future alternate options will be allowed",enum:["nodejs-ipc"]},apiVersion:{type:"string",description:"The version of the host-api used"},entrypoint:{type:"string",description:"Entrypoint to pass to the runtime. eg index.js"}},required:["type","api","apiVersion","entrypoint"]},manufacturer:{type:"string"},products:{type:"array",uniqueItems:!0,items:{type:"string"}},keywords:{type:"array",uniqueItems:!0,items:{type:"string"}},bonjourQueries:{type:"object",description:"If the device or software for your module supports bonjour announcements, Companion will offer an easy way to watch for these announcements.\nEach query you define must have a matching config field of type 'bonjour-device' with the same name",patternProperties:{"":{type:"object",title:"ModuleBonjourQuery",description:"",properties:{type:{type:"string"},protocol:{type:"string",enum:["tcp","udp"]},txt:{type:"object",description:"Match on any txt values returned in the query. This is useful to filter out devices of the same 'type' that are not supported",patternProperties:{"":{type:"string"}},additionalProperties:!1}},required:["type","protocol"],additionalProperties:!1}},additionalProperties:!1}},additionalProperties:!1,required:["id","name","shortname","description","version","license","repository","bugs","maintainers","legacyIds","runtime","manufacturer","products","keywords"]},o=Object.prototype.hasOwnProperty,r=n(7169).A,s=new RegExp("","u");function a(e,{instancePath:t="",parentData:n,parentDataProperty:c,rootData:l=e}={}){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.id&&(n="id")||void 0===e.name&&(n="name")||void 0===e.shortname&&(n="shortname")||void 0===e.description&&(n="description")||void 0===e.version&&(n="version")||void 0===e.license&&(n="license")||void 0===e.repository&&(n="repository")||void 0===e.bugs&&(n="bugs")||void 0===e.maintainers&&(n="maintainers")||void 0===e.legacyIds&&(n="legacyIds")||void 0===e.runtime&&(n="runtime")||void 0===e.manufacturer&&(n="manufacturer")||void 0===e.products&&(n="products")||void 0===e.keywords&&(n="keywords"))return a.errors=[{instancePath:t,schemaPath:"#/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;{const n=0;for(const n in e)if(!o.call(i.properties,n))return a.errors=[{instancePath:t,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"}],!1;if(0===n){if(void 0!==e.$schema){const n=0;if("string"!=typeof e.$schema)return a.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=0===n}else u=!0;if(u){if(void 0!==e.id){const n=0;if("string"!=typeof e.id)return a.errors=[{instancePath:t+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.name){const n=0;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.shortname){const n=0;if("string"!=typeof e.shortname)return a.errors=[{instancePath:t+"/shortname",schemaPath:"#/properties/shortname/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.description){const n=0;if("string"!=typeof e.description)return a.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.version){const n=0;if("string"!=typeof e.version)return a.errors=[{instancePath:t+"/version",schemaPath:"#/properties/version/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.license){const n=0;if("string"!=typeof e.license)return a.errors=[{instancePath:t+"/license",schemaPath:"#/properties/license/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.repository){const n=0;if("string"!=typeof e.repository)return a.errors=[{instancePath:t+"/repository",schemaPath:"#/properties/repository/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.bugs){const n=0;if("string"!=typeof e.bugs)return a.errors=[{instancePath:t+"/bugs",schemaPath:"#/properties/bugs/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.maintainers){let n=e.maintainers;const i=0;if(0===i){if(!Array.isArray(n))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var d=!0;const e=n.length;for(let i=0;i<e;i++){let e=n[i];const o=0;if(0===o){if(!e||"object"!=typeof e||Array.isArray(e))return a.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===e.name&&(n="name"))return a.errors=[{instancePath:t+"/maintainers/"+i,schemaPath:"#/properties/maintainers/items/required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;if(void 0!==e.name){const n=0;if("string"!=typeof e.name)return a.errors=[{instancePath:t+"/maintainers/"+i+"/name",schemaPath:"#/properties/maintainers/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=0===n}else g=!0;if(g){if(void 0!==e.email){const n=0;if("string"!=typeof e.email)return a.errors=[{instancePath:t+"/maintainers/"+i+"/email",schemaPath:"#/properties/maintainers/items/properties/email/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=0===n}else g=!0;if(g)if(void 0!==e.github){const n=0;if("string"!=typeof e.github)return a.errors=[{instancePath:t+"/maintainers/"+i+"/github",schemaPath:"#/properties/maintainers/items/properties/github/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;g=0===n}else g=!0}}}if(!(d=0===o))break}if(d){let e,i=n.length;if(i>1)for(;i--;)for(e=i;e--;)if(r(n[i],n[e]))return a.errors=[{instancePath:t+"/maintainers",schemaPath:"#/properties/maintainers/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1}}}u=0===i}else u=!0;if(u){if(void 0!==e.legacyIds){let n=e.legacyIds;const i=0;if(0===i){if(!Array.isArray(n))return a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var p=!0;const e=n.length;for(let i=0;i<e;i++){const e=0;if("string"!=typeof n[i])return a.errors=[{instancePath:t+"/legacyIds/"+i,schemaPath:"#/properties/legacyIds/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(p=0===e))break}if(p){let e,i=n.length;if(i>1){const o={};for(;i--;){let r=n[i];if("string"==typeof r){if("number"==typeof o[r])return e=o[r],a.errors=[{instancePath:t+"/legacyIds",schemaPath:"#/properties/legacyIds/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;o[r]=i}}}}}}u=0===i}else u=!0;if(u){if(void 0!==e.runtime){let n=e.runtime;const o=0;if(0===o){if(!n||"object"!=typeof n||Array.isArray(n))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===n.type&&(e="type")||void 0===n.api&&(e="api")||void 0===n.apiVersion&&(e="apiVersion")||void 0===n.entrypoint&&(e="entrypoint"))return a.errors=[{instancePath:t+"/runtime",schemaPath:"#/properties/runtime/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1;if(void 0!==n.type){const e=0;if("string"!=typeof n.type)return a.errors=[{instancePath:t+"/runtime/type",schemaPath:"#/properties/runtime/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=0===e}else h=!0;if(h){if(void 0!==n.api){let e=n.api;const o=0;if("string"!=typeof e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("nodejs-ipc"!==e)return a.errors=[{instancePath:t+"/runtime/api",schemaPath:"#/properties/runtime/properties/api/enum",keyword:"enum",params:{allowedValues:i.properties.runtime.properties.api.enum},message:"must be equal to one of the allowed values"}],!1;h=0===o}else h=!0;if(h){if(void 0!==n.apiVersion){const e=0;if("string"!=typeof n.apiVersion)return a.errors=[{instancePath:t+"/runtime/apiVersion",schemaPath:"#/properties/runtime/properties/apiVersion/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=0===e}else h=!0;if(h)if(void 0!==n.entrypoint){const e=0;if("string"!=typeof n.entrypoint)return a.errors=[{instancePath:t+"/runtime/entrypoint",schemaPath:"#/properties/runtime/properties/entrypoint/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;h=0===e}else h=!0}}}}u=0===o}else u=!0;if(u){if(void 0!==e.manufacturer){const n=0;if("string"!=typeof e.manufacturer)return a.errors=[{instancePath:t+"/manufacturer",schemaPath:"#/properties/manufacturer/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;u=0===n}else u=!0;if(u){if(void 0!==e.products){let n=e.products;const i=0;if(0===i){if(!Array.isArray(n))return a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var m=!0;const e=n.length;for(let i=0;i<e;i++){const e=0;if("string"!=typeof n[i])return a.errors=[{instancePath:t+"/products/"+i,schemaPath:"#/properties/products/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(m=0===e))break}if(m){let e,i=n.length;if(i>1){const o={};for(;i--;){let r=n[i];if("string"==typeof r){if("number"==typeof o[r])return e=o[r],a.errors=[{instancePath:t+"/products",schemaPath:"#/properties/products/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;o[r]=i}}}}}}u=0===i}else u=!0;if(u){if(void 0!==e.keywords){let n=e.keywords;const i=0;if(0===i){if(!Array.isArray(n))return a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var I=!0;const e=n.length;for(let i=0;i<e;i++){const e=0;if("string"!=typeof n[i])return a.errors=[{instancePath:t+"/keywords/"+i,schemaPath:"#/properties/keywords/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(I=0===e))break}if(I){let e,i=n.length;if(i>1){const o={};for(;i--;){let r=n[i];if("string"==typeof r){if("number"==typeof o[r])return e=o[r],a.errors=[{instancePath:t+"/keywords",schemaPath:"#/properties/keywords/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;o[r]=i}}}}}}u=0===i}else u=!0;if(u)if(void 0!==e.bonjourQueries){let n=e.bonjourQueries;const o=0;if(0===o){if(!n||"object"!=typeof n||Array.isArray(n))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const e=0;for(const e in n)if(!s.test(e))return a.errors=[{instancePath:t+"/bonjourQueries",schemaPath:"#/properties/bonjourQueries/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:e},message:"must NOT have additional properties"}],!1;if(0===e)for(const e in n)if(s.test(e)){let o=n[e];const r=0;if(0===r){if(!o||"object"!=typeof o||Array.isArray(o))return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let n;if(void 0===o.type&&(n="type")||void 0===o.protocol&&(n="protocol"))return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//required",keyword:"required",params:{missingProperty:n},message:"must have required property '"+n+"'"}],!1;{const n=0;for(const n in o)if("type"!==n&&"protocol"!==n&&"txt"!==n)return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//additionalProperties",keyword:"additionalProperties",params:{additionalProperty:n},message:"must NOT have additional properties"}],!1;if(0===n){if(void 0!==o.type){const n=0;if("string"!=typeof o.type)return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/properties/bonjourQueries/patternProperties//properties/type/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var b=0===n}else b=!0;if(b){if(void 0!==o.protocol){let n=o.protocol;const r=0;if("string"!=typeof n)return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/properties/bonjourQueries/patternProperties//properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if("tcp"!==n&&"udp"!==n)return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/protocol",schemaPath:"#/properties/bonjourQueries/patternProperties//properties/protocol/enum",keyword:"enum",params:{allowedValues:i.properties.bonjourQueries.patternProperties[""].properties.protocol.enum},message:"must be equal to one of the allowed values"}],!1;b=0===r}else b=!0;if(b)if(void 0!==o.txt){let n=o.txt;const i=0;if(0===i){if(!n||"object"!=typeof n||Array.isArray(n))return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/properties/bonjourQueries/patternProperties//properties/txt/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{const i=0;for(const i in n)if(!s.test(i))return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt",schemaPath:"#/properties/bonjourQueries/patternProperties//properties/txt/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:i},message:"must NOT have additional properties"}],!1;if(0===i)for(const i in n)if(s.test(i)){const o=0;if("string"!=typeof n[i])return a.errors=[{instancePath:t+"/bonjourQueries/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/txt/"+i.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/bonjourQueries/patternProperties//properties/txt/patternProperties//type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(0!==o)break}}}b=0===i}else b=!0}}}}}if(0!==r)break}}}u=0===o}else u=!0}}}}}}}}}}}}}}}}}return a.errors=null,!0}},7e3:(e,t,n)=>{"use strict";const i=n(4865);e.exports=(e,t={})=>{if("function"!=typeof e)throw new TypeError(`Expected the first argument to be a function, got \`${typeof e}\``);const{wait:n=0,maxWait:o=0,before:r=!1,after:s=!0}=t;if(!r&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let a,c,l;const u=function(...t){const i=this,u=r&&!a;return clearTimeout(a),a=setTimeout((()=>{a=void 0,c&&(clearTimeout(c),c=void 0),s&&(l=e.apply(i,t))}),n),o>0&&!c&&s&&(c=setTimeout((()=>{c=void 0,a&&(clearTimeout(a),a=void 0),l=e.apply(i,t)}),o)),u&&(l=e.apply(i,t)),l};return i(u,e),u.cancel=()=>{a&&(clearTimeout(a),a=void 0),c&&(clearTimeout(c),c=void 0)},u}},1635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>H,__assign:()=>r,__asyncDelegator:()=>B,__asyncGenerator:()=>G,__asyncValues:()=>w,__await:()=>Z,__awaiter:()=>h,__classPrivateFieldGet:()=>T,__classPrivateFieldIn:()=>_,__classPrivateFieldSet:()=>N,__createBinding:()=>I,__decorate:()=>a,__disposeResources:()=>Y,__esDecorate:()=>l,__exportStar:()=>b,__extends:()=>o,__generator:()=>m,__importDefault:()=>R,__importStar:()=>W,__makeTemplateObject:()=>S,__metadata:()=>p,__param:()=>c,__propKey:()=>d,__read:()=>y,__rest:()=>s,__runInitializers:()=>u,__setFunctionName:()=>g,__spread:()=>C,__spreadArray:()=>A,__spreadArrays:()=>v,__values:()=>f,default:()=>X});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function a(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,i){t(n,i,e)}}function l(e,t,n,i,o,r){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?i.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,i.name):{}),g=!1,p=n.length-1;p>=0;p--){var h={};for(var m in i)h[m]="access"===m?{}:i[m];for(var m in i.access)h.access[m]=i.access[m];h.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");r.push(s(e||null))};var I=(0,n[p])("accessor"===c?{get:d.get,set:d.set}:d[l],h);if("accessor"===c){if(void 0===I)continue;if(null===I||"object"!=typeof I)throw new TypeError("Object expected");(a=s(I.get))&&(d.get=a),(a=s(I.set))&&(d.set=a),(a=s(I.init))&&o.unshift(a)}else(a=s(I))&&("field"===c?o.unshift(a):d[l]=a)}u&&Object.defineProperty(u,i.name,d),g=!0}function u(e,t,n){for(var i=arguments.length>2,o=0;o<t.length;o++)n=i?t[o].call(e,n):t[o].call(e);return i?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function m(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var I=Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function b(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||I(t,e,n)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,o++)i[o]=r[s];return i}function A(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function Z(e){return this instanceof Z?(this.v=e,this):new Z(e)}function G(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n.apply(e,t||[]),r=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){o[e]&&(i[e]=function(t){return new Promise((function(n,i){r.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof Z?Promise.resolve(n.value.v).then(c,l):u(r[0][2],n)}catch(e){u(r[0][3],e)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}function B(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,o){t[i]=e[i]?function(t){return(n=!n)?{value:Z(e[i](t)),done:!1}:o?o(t):t}:o}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,o){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,o,(t=e[n](t)).done,t.value)}))}}}function S(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var V=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function W(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&I(t,e,n);return V(t,e),t}function R(e){return e&&e.__esModule?e:{default:e}}function T(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function N(e,t,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(e,n):o?o.value=n:t.set(e,n),n}function _(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function H(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:n})}else n&&e.stack.push({async:!0});return t}var k="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var i=new Error(n);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function Y(e){function t(t){e.error=e.hasError?new k(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var i=e.stack.pop();try{var o=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(o).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const X={__extends:o,__assign:r,__rest:s,__decorate:a,__param:c,__metadata:p,__awaiter:h,__generator:m,__createBinding:I,__exportStar:b,__values:f,__read:y,__spread:C,__spreadArrays:v,__spreadArray:A,__await:Z,__asyncGenerator:G,__asyncDelegator:B,__asyncValues:w,__makeTemplateObject:S,__importStar:W,__importDefault:R,__classPrivateFieldGet:T,__classPrivateFieldSet:N,__classPrivateFieldIn:_,__addDisposableResource:H,__disposeResources:Y}}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.c=t,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(n.s=44)})();